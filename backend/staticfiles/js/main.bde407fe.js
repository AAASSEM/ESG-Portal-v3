/*! For license information please see main.bde407fe.js.LICENSE.txt */
(()=>{"use strict";var e={43:(e,t,s)=>{e.exports=s(202)},153:(e,t,s)=>{var a=s(43),n=Symbol.for("react.element"),r=Symbol.for("react.fragment"),l=Object.prototype.hasOwnProperty,i=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,o={key:!0,ref:!0,__self:!0,__source:!0};function c(e,t,s){var a,r={},c=null,d=null;for(a in void 0!==s&&(c=""+s),void 0!==t.key&&(c=""+t.key),void 0!==t.ref&&(d=t.ref),t)l.call(t,a)&&!o.hasOwnProperty(a)&&(r[a]=t[a]);if(e&&e.defaultProps)for(a in t=e.defaultProps)void 0===r[a]&&(r[a]=t[a]);return{$$typeof:n,type:e,key:c,ref:d,props:r,_owner:i.current}}t.Fragment=r,t.jsx=c,t.jsxs=c},202:(e,t)=>{var s=Symbol.for("react.element"),a=Symbol.for("react.portal"),n=Symbol.for("react.fragment"),r=Symbol.for("react.strict_mode"),l=Symbol.for("react.profiler"),i=Symbol.for("react.provider"),o=Symbol.for("react.context"),c=Symbol.for("react.forward_ref"),d=Symbol.for("react.suspense"),u=Symbol.for("react.memo"),m=Symbol.for("react.lazy"),f=Symbol.iterator;var x={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},p=Object.assign,h={};function g(e,t,s){this.props=e,this.context=t,this.refs=h,this.updater=s||x}function y(){}function b(e,t,s){this.props=e,this.context=t,this.refs=h,this.updater=s||x}g.prototype.isReactComponent={},g.prototype.setState=function(e,t){if("object"!==typeof e&&"function"!==typeof e&&null!=e)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")},g.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")},y.prototype=g.prototype;var v=b.prototype=new y;v.constructor=b,p(v,g.prototype),v.isPureReactComponent=!0;var j=Array.isArray,w=Object.prototype.hasOwnProperty,N={current:null},k={key:!0,ref:!0,__self:!0,__source:!0};function S(e,t,a){var n,r={},l=null,i=null;if(null!=t)for(n in void 0!==t.ref&&(i=t.ref),void 0!==t.key&&(l=""+t.key),t)w.call(t,n)&&!k.hasOwnProperty(n)&&(r[n]=t[n]);var o=arguments.length-2;if(1===o)r.children=a;else if(1<o){for(var c=Array(o),d=0;d<o;d++)c[d]=arguments[d+2];r.children=c}if(e&&e.defaultProps)for(n in o=e.defaultProps)void 0===r[n]&&(r[n]=o[n]);return{$$typeof:s,type:e,key:l,ref:i,props:r,_owner:N.current}}function C(e){return"object"===typeof e&&null!==e&&e.$$typeof===s}var _=/\/+/g;function E(e,t){return"object"===typeof e&&null!==e&&null!=e.key?function(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(e){return t[e]})}(""+e.key):t.toString(36)}function P(e,t,n,r,l){var i=typeof e;"undefined"!==i&&"boolean"!==i||(e=null);var o=!1;if(null===e)o=!0;else switch(i){case"string":case"number":o=!0;break;case"object":switch(e.$$typeof){case s:case a:o=!0}}if(o)return l=l(o=e),e=""===r?"."+E(o,0):r,j(l)?(n="",null!=e&&(n=e.replace(_,"$&/")+"/"),P(l,t,n,"",function(e){return e})):null!=l&&(C(l)&&(l=function(e,t){return{$$typeof:s,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}(l,n+(!l.key||o&&o.key===l.key?"":(""+l.key).replace(_,"$&/")+"/")+e)),t.push(l)),1;if(o=0,r=""===r?".":r+":",j(e))for(var c=0;c<e.length;c++){var d=r+E(i=e[c],c);o+=P(i,t,n,d,l)}else if(d=function(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=f&&e[f]||e["@@iterator"])?e:null}(e),"function"===typeof d)for(e=d.call(e),c=0;!(i=e.next()).done;)o+=P(i=i.value,t,n,d=r+E(i,c++),l);else if("object"===i)throw t=String(e),Error("Objects are not valid as a React child (found: "+("[object Object]"===t?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return o}function A(e,t,s){if(null==e)return e;var a=[],n=0;return P(e,a,"","",function(e){return t.call(s,e,n++)}),a}function T(e){if(-1===e._status){var t=e._result;(t=t()).then(function(t){0!==e._status&&-1!==e._status||(e._status=1,e._result=t)},function(t){0!==e._status&&-1!==e._status||(e._status=2,e._result=t)}),-1===e._status&&(e._status=0,e._result=t)}if(1===e._status)return e._result.default;throw e._result}var L={current:null},O={transition:null},R={ReactCurrentDispatcher:L,ReactCurrentBatchConfig:O,ReactCurrentOwner:N};function F(){throw Error("act(...) is not supported in production builds of React.")}t.Children={map:A,forEach:function(e,t,s){A(e,function(){t.apply(this,arguments)},s)},count:function(e){var t=0;return A(e,function(){t++}),t},toArray:function(e){return A(e,function(e){return e})||[]},only:function(e){if(!C(e))throw Error("React.Children.only expected to receive a single React element child.");return e}},t.Component=g,t.Fragment=n,t.Profiler=l,t.PureComponent=b,t.StrictMode=r,t.Suspense=d,t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=R,t.act=F,t.cloneElement=function(e,t,a){if(null===e||void 0===e)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var n=p({},e.props),r=e.key,l=e.ref,i=e._owner;if(null!=t){if(void 0!==t.ref&&(l=t.ref,i=N.current),void 0!==t.key&&(r=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(c in t)w.call(t,c)&&!k.hasOwnProperty(c)&&(n[c]=void 0===t[c]&&void 0!==o?o[c]:t[c])}var c=arguments.length-2;if(1===c)n.children=a;else if(1<c){o=Array(c);for(var d=0;d<c;d++)o[d]=arguments[d+2];n.children=o}return{$$typeof:s,type:e.type,key:r,ref:l,props:n,_owner:i}},t.createContext=function(e){return(e={$$typeof:o,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null}).Provider={$$typeof:i,_context:e},e.Consumer=e},t.createElement=S,t.createFactory=function(e){var t=S.bind(null,e);return t.type=e,t},t.createRef=function(){return{current:null}},t.forwardRef=function(e){return{$$typeof:c,render:e}},t.isValidElement=C,t.lazy=function(e){return{$$typeof:m,_payload:{_status:-1,_result:e},_init:T}},t.memo=function(e,t){return{$$typeof:u,type:e,compare:void 0===t?null:t}},t.startTransition=function(e){var t=O.transition;O.transition={};try{e()}finally{O.transition=t}},t.unstable_act=F,t.useCallback=function(e,t){return L.current.useCallback(e,t)},t.useContext=function(e){return L.current.useContext(e)},t.useDebugValue=function(){},t.useDeferredValue=function(e){return L.current.useDeferredValue(e)},t.useEffect=function(e,t){return L.current.useEffect(e,t)},t.useId=function(){return L.current.useId()},t.useImperativeHandle=function(e,t,s){return L.current.useImperativeHandle(e,t,s)},t.useInsertionEffect=function(e,t){return L.current.useInsertionEffect(e,t)},t.useLayoutEffect=function(e,t){return L.current.useLayoutEffect(e,t)},t.useMemo=function(e,t){return L.current.useMemo(e,t)},t.useReducer=function(e,t,s){return L.current.useReducer(e,t,s)},t.useRef=function(e){return L.current.useRef(e)},t.useState=function(e){return L.current.useState(e)},t.useSyncExternalStore=function(e,t,s){return L.current.useSyncExternalStore(e,t,s)},t.useTransition=function(){return L.current.useTransition()},t.version="18.3.1"},234:(e,t)=>{function s(e,t){var s=e.length;e.push(t);e:for(;0<s;){var a=s-1>>>1,n=e[a];if(!(0<r(n,t)))break e;e[a]=t,e[s]=n,s=a}}function a(e){return 0===e.length?null:e[0]}function n(e){if(0===e.length)return null;var t=e[0],s=e.pop();if(s!==t){e[0]=s;e:for(var a=0,n=e.length,l=n>>>1;a<l;){var i=2*(a+1)-1,o=e[i],c=i+1,d=e[c];if(0>r(o,s))c<n&&0>r(d,o)?(e[a]=d,e[c]=s,a=c):(e[a]=o,e[i]=s,a=i);else{if(!(c<n&&0>r(d,s)))break e;e[a]=d,e[c]=s,a=c}}}return t}function r(e,t){var s=e.sortIndex-t.sortIndex;return 0!==s?s:e.id-t.id}if("object"===typeof performance&&"function"===typeof performance.now){var l=performance;t.unstable_now=function(){return l.now()}}else{var i=Date,o=i.now();t.unstable_now=function(){return i.now()-o}}var c=[],d=[],u=1,m=null,f=3,x=!1,p=!1,h=!1,g="function"===typeof setTimeout?setTimeout:null,y="function"===typeof clearTimeout?clearTimeout:null,b="undefined"!==typeof setImmediate?setImmediate:null;function v(e){for(var t=a(d);null!==t;){if(null===t.callback)n(d);else{if(!(t.startTime<=e))break;n(d),t.sortIndex=t.expirationTime,s(c,t)}t=a(d)}}function j(e){if(h=!1,v(e),!p)if(null!==a(c))p=!0,O(w);else{var t=a(d);null!==t&&R(j,t.startTime-e)}}function w(e,s){p=!1,h&&(h=!1,y(C),C=-1),x=!0;var r=f;try{for(v(s),m=a(c);null!==m&&(!(m.expirationTime>s)||e&&!P());){var l=m.callback;if("function"===typeof l){m.callback=null,f=m.priorityLevel;var i=l(m.expirationTime<=s);s=t.unstable_now(),"function"===typeof i?m.callback=i:m===a(c)&&n(c),v(s)}else n(c);m=a(c)}if(null!==m)var o=!0;else{var u=a(d);null!==u&&R(j,u.startTime-s),o=!1}return o}finally{m=null,f=r,x=!1}}"undefined"!==typeof navigator&&void 0!==navigator.scheduling&&void 0!==navigator.scheduling.isInputPending&&navigator.scheduling.isInputPending.bind(navigator.scheduling);var N,k=!1,S=null,C=-1,_=5,E=-1;function P(){return!(t.unstable_now()-E<_)}function A(){if(null!==S){var e=t.unstable_now();E=e;var s=!0;try{s=S(!0,e)}finally{s?N():(k=!1,S=null)}}else k=!1}if("function"===typeof b)N=function(){b(A)};else if("undefined"!==typeof MessageChannel){var T=new MessageChannel,L=T.port2;T.port1.onmessage=A,N=function(){L.postMessage(null)}}else N=function(){g(A,0)};function O(e){S=e,k||(k=!0,N())}function R(e,s){C=g(function(){e(t.unstable_now())},s)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(e){e.callback=null},t.unstable_continueExecution=function(){p||x||(p=!0,O(w))},t.unstable_forceFrameRate=function(e){0>e||125<e?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):_=0<e?Math.floor(1e3/e):5},t.unstable_getCurrentPriorityLevel=function(){return f},t.unstable_getFirstCallbackNode=function(){return a(c)},t.unstable_next=function(e){switch(f){case 1:case 2:case 3:var t=3;break;default:t=f}var s=f;f=t;try{return e()}finally{f=s}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(e,t){switch(e){case 1:case 2:case 3:case 4:case 5:break;default:e=3}var s=f;f=e;try{return t()}finally{f=s}},t.unstable_scheduleCallback=function(e,n,r){var l=t.unstable_now();switch("object"===typeof r&&null!==r?r="number"===typeof(r=r.delay)&&0<r?l+r:l:r=l,e){case 1:var i=-1;break;case 2:i=250;break;case 5:i=1073741823;break;case 4:i=1e4;break;default:i=5e3}return e={id:u++,callback:n,priorityLevel:e,startTime:r,expirationTime:i=r+i,sortIndex:-1},r>l?(e.sortIndex=r,s(d,e),null===a(c)&&e===a(d)&&(h?(y(C),C=-1):h=!0,R(j,r-l))):(e.sortIndex=i,s(c,e),p||x||(p=!0,O(w))),e},t.unstable_shouldYield=P,t.unstable_wrapCallback=function(e){var t=f;return function(){var s=f;f=t;try{return e.apply(this,arguments)}finally{f=s}}}},391:(e,t,s)=>{var a=s(950);t.createRoot=a.createRoot,t.hydrateRoot=a.hydrateRoot},579:(e,t,s)=>{e.exports=s(153)},730:(e,t,s)=>{var a=s(43),n=s(853);function r(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,s=1;s<arguments.length;s++)t+="&args[]="+encodeURIComponent(arguments[s]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var l=new Set,i={};function o(e,t){c(e,t),c(e+"Capture",t)}function c(e,t){for(i[e]=t,e=0;e<t.length;e++)l.add(t[e])}var d=!("undefined"===typeof window||"undefined"===typeof window.document||"undefined"===typeof window.document.createElement),u=Object.prototype.hasOwnProperty,m=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,f={},x={};function p(e,t,s,a,n,r,l){this.acceptsBooleans=2===t||3===t||4===t,this.attributeName=a,this.attributeNamespace=n,this.mustUseProperty=s,this.propertyName=e,this.type=t,this.sanitizeURL=r,this.removeEmptyString=l}var h={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){h[e]=new p(e,0,!1,e,null,!1,!1)}),[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];h[t]=new p(t,1,!1,e[1],null,!1,!1)}),["contentEditable","draggable","spellCheck","value"].forEach(function(e){h[e]=new p(e,2,!1,e.toLowerCase(),null,!1,!1)}),["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){h[e]=new p(e,2,!1,e,null,!1,!1)}),"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){h[e]=new p(e,3,!1,e.toLowerCase(),null,!1,!1)}),["checked","multiple","muted","selected"].forEach(function(e){h[e]=new p(e,3,!0,e,null,!1,!1)}),["capture","download"].forEach(function(e){h[e]=new p(e,4,!1,e,null,!1,!1)}),["cols","rows","size","span"].forEach(function(e){h[e]=new p(e,6,!1,e,null,!1,!1)}),["rowSpan","start"].forEach(function(e){h[e]=new p(e,5,!1,e.toLowerCase(),null,!1,!1)});var g=/[\-:]([a-z])/g;function y(e){return e[1].toUpperCase()}function b(e,t,s,a){var n=h.hasOwnProperty(t)?h[t]:null;(null!==n?0!==n.type:a||!(2<t.length)||"o"!==t[0]&&"O"!==t[0]||"n"!==t[1]&&"N"!==t[1])&&(function(e,t,s,a){if(null===t||"undefined"===typeof t||function(e,t,s,a){if(null!==s&&0===s.type)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return!a&&(null!==s?!s.acceptsBooleans:"data-"!==(e=e.toLowerCase().slice(0,5))&&"aria-"!==e);default:return!1}}(e,t,s,a))return!0;if(a)return!1;if(null!==s)switch(s.type){case 3:return!t;case 4:return!1===t;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}(t,s,n,a)&&(s=null),a||null===n?function(e){return!!u.call(x,e)||!u.call(f,e)&&(m.test(e)?x[e]=!0:(f[e]=!0,!1))}(t)&&(null===s?e.removeAttribute(t):e.setAttribute(t,""+s)):n.mustUseProperty?e[n.propertyName]=null===s?3!==n.type&&"":s:(t=n.attributeName,a=n.attributeNamespace,null===s?e.removeAttribute(t):(s=3===(n=n.type)||4===n&&!0===s?"":""+s,a?e.setAttributeNS(a,t,s):e.setAttribute(t,s))))}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(g,y);h[t]=new p(t,1,!1,e,null,!1,!1)}),"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(g,y);h[t]=new p(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)}),["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(g,y);h[t]=new p(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)}),["tabIndex","crossOrigin"].forEach(function(e){h[e]=new p(e,1,!1,e.toLowerCase(),null,!1,!1)}),h.xlinkHref=new p("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1),["src","href","action","formAction"].forEach(function(e){h[e]=new p(e,1,!1,e.toLowerCase(),null,!0,!0)});var v=a.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,j=Symbol.for("react.element"),w=Symbol.for("react.portal"),N=Symbol.for("react.fragment"),k=Symbol.for("react.strict_mode"),S=Symbol.for("react.profiler"),C=Symbol.for("react.provider"),_=Symbol.for("react.context"),E=Symbol.for("react.forward_ref"),P=Symbol.for("react.suspense"),A=Symbol.for("react.suspense_list"),T=Symbol.for("react.memo"),L=Symbol.for("react.lazy");Symbol.for("react.scope"),Symbol.for("react.debug_trace_mode");var O=Symbol.for("react.offscreen");Symbol.for("react.legacy_hidden"),Symbol.for("react.cache"),Symbol.for("react.tracing_marker");var R=Symbol.iterator;function F(e){return null===e||"object"!==typeof e?null:"function"===typeof(e=R&&e[R]||e["@@iterator"])?e:null}var D,M=Object.assign;function U(e){if(void 0===D)try{throw Error()}catch(s){var t=s.stack.trim().match(/\n( *(at )?)/);D=t&&t[1]||""}return"\n"+D+e}var z=!1;function I(e,t){if(!e||z)return"";z=!0;var s=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),"object"===typeof Reflect&&Reflect.construct){try{Reflect.construct(t,[])}catch(c){var a=c}Reflect.construct(e,[],t)}else{try{t.call()}catch(c){a=c}e.call(t.prototype)}else{try{throw Error()}catch(c){a=c}e()}}catch(c){if(c&&a&&"string"===typeof c.stack){for(var n=c.stack.split("\n"),r=a.stack.split("\n"),l=n.length-1,i=r.length-1;1<=l&&0<=i&&n[l]!==r[i];)i--;for(;1<=l&&0<=i;l--,i--)if(n[l]!==r[i]){if(1!==l||1!==i)do{if(l--,0>--i||n[l]!==r[i]){var o="\n"+n[l].replace(" at new "," at ");return e.displayName&&o.includes("<anonymous>")&&(o=o.replace("<anonymous>",e.displayName)),o}}while(1<=l&&0<=i);break}}}finally{z=!1,Error.prepareStackTrace=s}return(e=e?e.displayName||e.name:"")?U(e):""}function G(e){switch(e.tag){case 5:return U(e.type);case 16:return U("Lazy");case 13:return U("Suspense");case 19:return U("SuspenseList");case 0:case 2:case 15:return e=I(e.type,!1);case 11:return e=I(e.type.render,!1);case 1:return e=I(e.type,!0);default:return""}}function B(e){if(null==e)return null;if("function"===typeof e)return e.displayName||e.name||null;if("string"===typeof e)return e;switch(e){case N:return"Fragment";case w:return"Portal";case S:return"Profiler";case k:return"StrictMode";case P:return"Suspense";case A:return"SuspenseList"}if("object"===typeof e)switch(e.$$typeof){case _:return(e.displayName||"Context")+".Consumer";case C:return(e._context.displayName||"Context")+".Provider";case E:var t=e.render;return(e=e.displayName)||(e=""!==(e=t.displayName||t.name||"")?"ForwardRef("+e+")":"ForwardRef"),e;case T:return null!==(t=e.displayName||null)?t:B(e.type)||"Memo";case L:t=e._payload,e=e._init;try{return B(e(t))}catch(s){}}return null}function W(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=(e=t.render).displayName||e.name||"",t.displayName||(""!==e?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return B(t);case 8:return t===k?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if("function"===typeof t)return t.displayName||t.name||null;if("string"===typeof t)return t}return null}function q(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":case"object":return e;default:return""}}function V(e){var t=e.type;return(e=e.nodeName)&&"input"===e.toLowerCase()&&("checkbox"===t||"radio"===t)}function H(e){e._valueTracker||(e._valueTracker=function(e){var t=V(e)?"checked":"value",s=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),a=""+e[t];if(!e.hasOwnProperty(t)&&"undefined"!==typeof s&&"function"===typeof s.get&&"function"===typeof s.set){var n=s.get,r=s.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return n.call(this)},set:function(e){a=""+e,r.call(this,e)}}),Object.defineProperty(e,t,{enumerable:s.enumerable}),{getValue:function(){return a},setValue:function(e){a=""+e},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}(e))}function Q(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var s=t.getValue(),a="";return e&&(a=V(e)?e.checked?"true":"false":e.value),(e=a)!==s&&(t.setValue(e),!0)}function $(e){if("undefined"===typeof(e=e||("undefined"!==typeof document?document:void 0)))return null;try{return e.activeElement||e.body}catch(t){return e.body}}function J(e,t){var s=t.checked;return M({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:null!=s?s:e._wrapperState.initialChecked})}function Y(e,t){var s=null==t.defaultValue?"":t.defaultValue,a=null!=t.checked?t.checked:t.defaultChecked;s=q(null!=t.value?t.value:s),e._wrapperState={initialChecked:a,initialValue:s,controlled:"checkbox"===t.type||"radio"===t.type?null!=t.checked:null!=t.value}}function K(e,t){null!=(t=t.checked)&&b(e,"checked",t,!1)}function X(e,t){K(e,t);var s=q(t.value),a=t.type;if(null!=s)"number"===a?(0===s&&""===e.value||e.value!=s)&&(e.value=""+s):e.value!==""+s&&(e.value=""+s);else if("submit"===a||"reset"===a)return void e.removeAttribute("value");t.hasOwnProperty("value")?ee(e,t.type,s):t.hasOwnProperty("defaultValue")&&ee(e,t.type,q(t.defaultValue)),null==t.checked&&null!=t.defaultChecked&&(e.defaultChecked=!!t.defaultChecked)}function Z(e,t,s){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var a=t.type;if(!("submit"!==a&&"reset"!==a||void 0!==t.value&&null!==t.value))return;t=""+e._wrapperState.initialValue,s||t===e.value||(e.value=t),e.defaultValue=t}""!==(s=e.name)&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,""!==s&&(e.name=s)}function ee(e,t,s){"number"===t&&$(e.ownerDocument)===e||(null==s?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+s&&(e.defaultValue=""+s))}var te=Array.isArray;function se(e,t,s,a){if(e=e.options,t){t={};for(var n=0;n<s.length;n++)t["$"+s[n]]=!0;for(s=0;s<e.length;s++)n=t.hasOwnProperty("$"+e[s].value),e[s].selected!==n&&(e[s].selected=n),n&&a&&(e[s].defaultSelected=!0)}else{for(s=""+q(s),t=null,n=0;n<e.length;n++){if(e[n].value===s)return e[n].selected=!0,void(a&&(e[n].defaultSelected=!0));null!==t||e[n].disabled||(t=e[n])}null!==t&&(t.selected=!0)}}function ae(e,t){if(null!=t.dangerouslySetInnerHTML)throw Error(r(91));return M({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function ne(e,t){var s=t.value;if(null==s){if(s=t.children,t=t.defaultValue,null!=s){if(null!=t)throw Error(r(92));if(te(s)){if(1<s.length)throw Error(r(93));s=s[0]}t=s}null==t&&(t=""),s=t}e._wrapperState={initialValue:q(s)}}function re(e,t){var s=q(t.value),a=q(t.defaultValue);null!=s&&((s=""+s)!==e.value&&(e.value=s),null==t.defaultValue&&e.defaultValue!==s&&(e.defaultValue=s)),null!=a&&(e.defaultValue=""+a)}function le(e){var t=e.textContent;t===e._wrapperState.initialValue&&""!==t&&null!==t&&(e.value=t)}function ie(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function oe(e,t){return null==e||"http://www.w3.org/1999/xhtml"===e?ie(t):"http://www.w3.org/2000/svg"===e&&"foreignObject"===t?"http://www.w3.org/1999/xhtml":e}var ce,de,ue=(de=function(e,t){if("http://www.w3.org/2000/svg"!==e.namespaceURI||"innerHTML"in e)e.innerHTML=t;else{for((ce=ce||document.createElement("div")).innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=ce.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}},"undefined"!==typeof MSApp&&MSApp.execUnsafeLocalFunction?function(e,t,s,a){MSApp.execUnsafeLocalFunction(function(){return de(e,t)})}:de);function me(e,t){if(t){var s=e.firstChild;if(s&&s===e.lastChild&&3===s.nodeType)return void(s.nodeValue=t)}e.textContent=t}var fe={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},xe=["Webkit","ms","Moz","O"];function pe(e,t,s){return null==t||"boolean"===typeof t||""===t?"":s||"number"!==typeof t||0===t||fe.hasOwnProperty(e)&&fe[e]?(""+t).trim():t+"px"}function he(e,t){for(var s in e=e.style,t)if(t.hasOwnProperty(s)){var a=0===s.indexOf("--"),n=pe(s,t[s],a);"float"===s&&(s="cssFloat"),a?e.setProperty(s,n):e[s]=n}}Object.keys(fe).forEach(function(e){xe.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),fe[t]=fe[e]})});var ge=M({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function ye(e,t){if(t){if(ge[e]&&(null!=t.children||null!=t.dangerouslySetInnerHTML))throw Error(r(137,e));if(null!=t.dangerouslySetInnerHTML){if(null!=t.children)throw Error(r(60));if("object"!==typeof t.dangerouslySetInnerHTML||!("__html"in t.dangerouslySetInnerHTML))throw Error(r(61))}if(null!=t.style&&"object"!==typeof t.style)throw Error(r(62))}}function be(e,t){if(-1===e.indexOf("-"))return"string"===typeof t.is;switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var ve=null;function je(e){return(e=e.target||e.srcElement||window).correspondingUseElement&&(e=e.correspondingUseElement),3===e.nodeType?e.parentNode:e}var we=null,Ne=null,ke=null;function Se(e){if(e=bn(e)){if("function"!==typeof we)throw Error(r(280));var t=e.stateNode;t&&(t=jn(t),we(e.stateNode,e.type,t))}}function Ce(e){Ne?ke?ke.push(e):ke=[e]:Ne=e}function _e(){if(Ne){var e=Ne,t=ke;if(ke=Ne=null,Se(e),t)for(e=0;e<t.length;e++)Se(t[e])}}function Ee(e,t){return e(t)}function Pe(){}var Ae=!1;function Te(e,t,s){if(Ae)return e(t,s);Ae=!0;try{return Ee(e,t,s)}finally{Ae=!1,(null!==Ne||null!==ke)&&(Pe(),_e())}}function Le(e,t){var s=e.stateNode;if(null===s)return null;var a=jn(s);if(null===a)return null;s=a[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(a=!a.disabled)||(a=!("button"===(e=e.type)||"input"===e||"select"===e||"textarea"===e)),e=!a;break e;default:e=!1}if(e)return null;if(s&&"function"!==typeof s)throw Error(r(231,t,typeof s));return s}var Oe=!1;if(d)try{var Re={};Object.defineProperty(Re,"passive",{get:function(){Oe=!0}}),window.addEventListener("test",Re,Re),window.removeEventListener("test",Re,Re)}catch(de){Oe=!1}function Fe(e,t,s,a,n,r,l,i,o){var c=Array.prototype.slice.call(arguments,3);try{t.apply(s,c)}catch(d){this.onError(d)}}var De=!1,Me=null,Ue=!1,ze=null,Ie={onError:function(e){De=!0,Me=e}};function Ge(e,t,s,a,n,r,l,i,o){De=!1,Me=null,Fe.apply(Ie,arguments)}function Be(e){var t=e,s=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do{0!==(4098&(t=e).flags)&&(s=t.return),e=t.return}while(e)}return 3===t.tag?s:null}function We(e){if(13===e.tag){var t=e.memoizedState;if(null===t&&(null!==(e=e.alternate)&&(t=e.memoizedState)),null!==t)return t.dehydrated}return null}function qe(e){if(Be(e)!==e)throw Error(r(188))}function Ve(e){return null!==(e=function(e){var t=e.alternate;if(!t){if(null===(t=Be(e)))throw Error(r(188));return t!==e?null:e}for(var s=e,a=t;;){var n=s.return;if(null===n)break;var l=n.alternate;if(null===l){if(null!==(a=n.return)){s=a;continue}break}if(n.child===l.child){for(l=n.child;l;){if(l===s)return qe(n),e;if(l===a)return qe(n),t;l=l.sibling}throw Error(r(188))}if(s.return!==a.return)s=n,a=l;else{for(var i=!1,o=n.child;o;){if(o===s){i=!0,s=n,a=l;break}if(o===a){i=!0,a=n,s=l;break}o=o.sibling}if(!i){for(o=l.child;o;){if(o===s){i=!0,s=l,a=n;break}if(o===a){i=!0,a=l,s=n;break}o=o.sibling}if(!i)throw Error(r(189))}}if(s.alternate!==a)throw Error(r(190))}if(3!==s.tag)throw Error(r(188));return s.stateNode.current===s?e:t}(e))?He(e):null}function He(e){if(5===e.tag||6===e.tag)return e;for(e=e.child;null!==e;){var t=He(e);if(null!==t)return t;e=e.sibling}return null}var Qe=n.unstable_scheduleCallback,$e=n.unstable_cancelCallback,Je=n.unstable_shouldYield,Ye=n.unstable_requestPaint,Ke=n.unstable_now,Xe=n.unstable_getCurrentPriorityLevel,Ze=n.unstable_ImmediatePriority,et=n.unstable_UserBlockingPriority,tt=n.unstable_NormalPriority,st=n.unstable_LowPriority,at=n.unstable_IdlePriority,nt=null,rt=null;var lt=Math.clz32?Math.clz32:function(e){return e>>>=0,0===e?32:31-(it(e)/ot|0)|0},it=Math.log,ot=Math.LN2;var ct=64,dt=4194304;function ut(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return 4194240&e;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return 130023424&e;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function mt(e,t){var s=e.pendingLanes;if(0===s)return 0;var a=0,n=e.suspendedLanes,r=e.pingedLanes,l=268435455&s;if(0!==l){var i=l&~n;0!==i?a=ut(i):0!==(r&=l)&&(a=ut(r))}else 0!==(l=s&~n)?a=ut(l):0!==r&&(a=ut(r));if(0===a)return 0;if(0!==t&&t!==a&&0===(t&n)&&((n=a&-a)>=(r=t&-t)||16===n&&0!==(4194240&r)))return t;if(0!==(4&a)&&(a|=16&s),0!==(t=e.entangledLanes))for(e=e.entanglements,t&=a;0<t;)n=1<<(s=31-lt(t)),a|=e[s],t&=~n;return a}function ft(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;default:return-1}}function xt(e){return 0!==(e=-1073741825&e.pendingLanes)?e:1073741824&e?1073741824:0}function pt(){var e=ct;return 0===(4194240&(ct<<=1))&&(ct=64),e}function ht(e){for(var t=[],s=0;31>s;s++)t.push(e);return t}function gt(e,t,s){e.pendingLanes|=t,536870912!==t&&(e.suspendedLanes=0,e.pingedLanes=0),(e=e.eventTimes)[t=31-lt(t)]=s}function yt(e,t){var s=e.entangledLanes|=t;for(e=e.entanglements;s;){var a=31-lt(s),n=1<<a;n&t|e[a]&t&&(e[a]|=t),s&=~n}}var bt=0;function vt(e){return 1<(e&=-e)?4<e?0!==(268435455&e)?16:536870912:4:1}var jt,wt,Nt,kt,St,Ct=!1,_t=[],Et=null,Pt=null,At=null,Tt=new Map,Lt=new Map,Ot=[],Rt="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Ft(e,t){switch(e){case"focusin":case"focusout":Et=null;break;case"dragenter":case"dragleave":Pt=null;break;case"mouseover":case"mouseout":At=null;break;case"pointerover":case"pointerout":Tt.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":Lt.delete(t.pointerId)}}function Dt(e,t,s,a,n,r){return null===e||e.nativeEvent!==r?(e={blockedOn:t,domEventName:s,eventSystemFlags:a,nativeEvent:r,targetContainers:[n]},null!==t&&(null!==(t=bn(t))&&wt(t)),e):(e.eventSystemFlags|=a,t=e.targetContainers,null!==n&&-1===t.indexOf(n)&&t.push(n),e)}function Mt(e){var t=yn(e.target);if(null!==t){var s=Be(t);if(null!==s)if(13===(t=s.tag)){if(null!==(t=We(s)))return e.blockedOn=t,void St(e.priority,function(){Nt(s)})}else if(3===t&&s.stateNode.current.memoizedState.isDehydrated)return void(e.blockedOn=3===s.tag?s.stateNode.containerInfo:null)}e.blockedOn=null}function Ut(e){if(null!==e.blockedOn)return!1;for(var t=e.targetContainers;0<t.length;){var s=Jt(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(null!==s)return null!==(t=bn(s))&&wt(t),e.blockedOn=s,!1;var a=new(s=e.nativeEvent).constructor(s.type,s);ve=a,s.target.dispatchEvent(a),ve=null,t.shift()}return!0}function zt(e,t,s){Ut(e)&&s.delete(t)}function It(){Ct=!1,null!==Et&&Ut(Et)&&(Et=null),null!==Pt&&Ut(Pt)&&(Pt=null),null!==At&&Ut(At)&&(At=null),Tt.forEach(zt),Lt.forEach(zt)}function Gt(e,t){e.blockedOn===t&&(e.blockedOn=null,Ct||(Ct=!0,n.unstable_scheduleCallback(n.unstable_NormalPriority,It)))}function Bt(e){function t(t){return Gt(t,e)}if(0<_t.length){Gt(_t[0],e);for(var s=1;s<_t.length;s++){var a=_t[s];a.blockedOn===e&&(a.blockedOn=null)}}for(null!==Et&&Gt(Et,e),null!==Pt&&Gt(Pt,e),null!==At&&Gt(At,e),Tt.forEach(t),Lt.forEach(t),s=0;s<Ot.length;s++)(a=Ot[s]).blockedOn===e&&(a.blockedOn=null);for(;0<Ot.length&&null===(s=Ot[0]).blockedOn;)Mt(s),null===s.blockedOn&&Ot.shift()}var Wt=v.ReactCurrentBatchConfig,qt=!0;function Vt(e,t,s,a){var n=bt,r=Wt.transition;Wt.transition=null;try{bt=1,Qt(e,t,s,a)}finally{bt=n,Wt.transition=r}}function Ht(e,t,s,a){var n=bt,r=Wt.transition;Wt.transition=null;try{bt=4,Qt(e,t,s,a)}finally{bt=n,Wt.transition=r}}function Qt(e,t,s,a){if(qt){var n=Jt(e,t,s,a);if(null===n)Wa(e,t,a,$t,s),Ft(e,a);else if(function(e,t,s,a,n){switch(t){case"focusin":return Et=Dt(Et,e,t,s,a,n),!0;case"dragenter":return Pt=Dt(Pt,e,t,s,a,n),!0;case"mouseover":return At=Dt(At,e,t,s,a,n),!0;case"pointerover":var r=n.pointerId;return Tt.set(r,Dt(Tt.get(r)||null,e,t,s,a,n)),!0;case"gotpointercapture":return r=n.pointerId,Lt.set(r,Dt(Lt.get(r)||null,e,t,s,a,n)),!0}return!1}(n,e,t,s,a))a.stopPropagation();else if(Ft(e,a),4&t&&-1<Rt.indexOf(e)){for(;null!==n;){var r=bn(n);if(null!==r&&jt(r),null===(r=Jt(e,t,s,a))&&Wa(e,t,a,$t,s),r===n)break;n=r}null!==n&&a.stopPropagation()}else Wa(e,t,a,null,s)}}var $t=null;function Jt(e,t,s,a){if($t=null,null!==(e=yn(e=je(a))))if(null===(t=Be(e)))e=null;else if(13===(s=t.tag)){if(null!==(e=We(t)))return e;e=null}else if(3===s){if(t.stateNode.current.memoizedState.isDehydrated)return 3===t.tag?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return $t=e,null}function Yt(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Xe()){case Ze:return 1;case et:return 4;case tt:case st:return 16;case at:return 536870912;default:return 16}default:return 16}}var Kt=null,Xt=null,Zt=null;function es(){if(Zt)return Zt;var e,t,s=Xt,a=s.length,n="value"in Kt?Kt.value:Kt.textContent,r=n.length;for(e=0;e<a&&s[e]===n[e];e++);var l=a-e;for(t=1;t<=l&&s[a-t]===n[r-t];t++);return Zt=n.slice(e,1<t?1-t:void 0)}function ts(e){var t=e.keyCode;return"charCode"in e?0===(e=e.charCode)&&13===t&&(e=13):e=t,10===e&&(e=13),32<=e||13===e?e:0}function ss(){return!0}function as(){return!1}function ns(e){function t(t,s,a,n,r){for(var l in this._reactName=t,this._targetInst=a,this.type=s,this.nativeEvent=n,this.target=r,this.currentTarget=null,e)e.hasOwnProperty(l)&&(t=e[l],this[l]=t?t(n):n[l]);return this.isDefaultPrevented=(null!=n.defaultPrevented?n.defaultPrevented:!1===n.returnValue)?ss:as,this.isPropagationStopped=as,this}return M(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var e=this.nativeEvent;e&&(e.preventDefault?e.preventDefault():"unknown"!==typeof e.returnValue&&(e.returnValue=!1),this.isDefaultPrevented=ss)},stopPropagation:function(){var e=this.nativeEvent;e&&(e.stopPropagation?e.stopPropagation():"unknown"!==typeof e.cancelBubble&&(e.cancelBubble=!0),this.isPropagationStopped=ss)},persist:function(){},isPersistent:ss}),t}var rs,ls,is,os={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},cs=ns(os),ds=M({},os,{view:0,detail:0}),us=ns(ds),ms=M({},ds,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:ks,button:0,buttons:0,relatedTarget:function(e){return void 0===e.relatedTarget?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==is&&(is&&"mousemove"===e.type?(rs=e.screenX-is.screenX,ls=e.screenY-is.screenY):ls=rs=0,is=e),rs)},movementY:function(e){return"movementY"in e?e.movementY:ls}}),fs=ns(ms),xs=ns(M({},ms,{dataTransfer:0})),ps=ns(M({},ds,{relatedTarget:0})),hs=ns(M({},os,{animationName:0,elapsedTime:0,pseudoElement:0})),gs=M({},os,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),ys=ns(gs),bs=ns(M({},os,{data:0})),vs={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},js={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},ws={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function Ns(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):!!(e=ws[e])&&!!t[e]}function ks(){return Ns}var Ss=M({},ds,{key:function(e){if(e.key){var t=vs[e.key]||e.key;if("Unidentified"!==t)return t}return"keypress"===e.type?13===(e=ts(e))?"Enter":String.fromCharCode(e):"keydown"===e.type||"keyup"===e.type?js[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:ks,charCode:function(e){return"keypress"===e.type?ts(e):0},keyCode:function(e){return"keydown"===e.type||"keyup"===e.type?e.keyCode:0},which:function(e){return"keypress"===e.type?ts(e):"keydown"===e.type||"keyup"===e.type?e.keyCode:0}}),Cs=ns(Ss),_s=ns(M({},ms,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0})),Es=ns(M({},ds,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:ks})),Ps=ns(M({},os,{propertyName:0,elapsedTime:0,pseudoElement:0})),As=M({},ms,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),Ts=ns(As),Ls=[9,13,27,32],Os=d&&"CompositionEvent"in window,Rs=null;d&&"documentMode"in document&&(Rs=document.documentMode);var Fs=d&&"TextEvent"in window&&!Rs,Ds=d&&(!Os||Rs&&8<Rs&&11>=Rs),Ms=String.fromCharCode(32),Us=!1;function zs(e,t){switch(e){case"keyup":return-1!==Ls.indexOf(t.keyCode);case"keydown":return 229!==t.keyCode;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Is(e){return"object"===typeof(e=e.detail)&&"data"in e?e.data:null}var Gs=!1;var Bs={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function Ws(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return"input"===t?!!Bs[e.type]:"textarea"===t}function qs(e,t,s,a){Ce(a),0<(t=Va(t,"onChange")).length&&(s=new cs("onChange","change",null,s,a),e.push({event:s,listeners:t}))}var Vs=null,Hs=null;function Qs(e){Ma(e,0)}function $s(e){if(Q(vn(e)))return e}function Js(e,t){if("change"===e)return t}var Ys=!1;if(d){var Ks;if(d){var Xs="oninput"in document;if(!Xs){var Zs=document.createElement("div");Zs.setAttribute("oninput","return;"),Xs="function"===typeof Zs.oninput}Ks=Xs}else Ks=!1;Ys=Ks&&(!document.documentMode||9<document.documentMode)}function ea(){Vs&&(Vs.detachEvent("onpropertychange",ta),Hs=Vs=null)}function ta(e){if("value"===e.propertyName&&$s(Hs)){var t=[];qs(t,Hs,e,je(e)),Te(Qs,t)}}function sa(e,t,s){"focusin"===e?(ea(),Hs=s,(Vs=t).attachEvent("onpropertychange",ta)):"focusout"===e&&ea()}function aa(e){if("selectionchange"===e||"keyup"===e||"keydown"===e)return $s(Hs)}function na(e,t){if("click"===e)return $s(t)}function ra(e,t){if("input"===e||"change"===e)return $s(t)}var la="function"===typeof Object.is?Object.is:function(e,t){return e===t&&(0!==e||1/e===1/t)||e!==e&&t!==t};function ia(e,t){if(la(e,t))return!0;if("object"!==typeof e||null===e||"object"!==typeof t||null===t)return!1;var s=Object.keys(e),a=Object.keys(t);if(s.length!==a.length)return!1;for(a=0;a<s.length;a++){var n=s[a];if(!u.call(t,n)||!la(e[n],t[n]))return!1}return!0}function oa(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function ca(e,t){var s,a=oa(e);for(e=0;a;){if(3===a.nodeType){if(s=e+a.textContent.length,e<=t&&s>=t)return{node:a,offset:t-e};e=s}e:{for(;a;){if(a.nextSibling){a=a.nextSibling;break e}a=a.parentNode}a=void 0}a=oa(a)}}function da(e,t){return!(!e||!t)&&(e===t||(!e||3!==e.nodeType)&&(t&&3===t.nodeType?da(e,t.parentNode):"contains"in e?e.contains(t):!!e.compareDocumentPosition&&!!(16&e.compareDocumentPosition(t))))}function ua(){for(var e=window,t=$();t instanceof e.HTMLIFrameElement;){try{var s="string"===typeof t.contentWindow.location.href}catch(a){s=!1}if(!s)break;t=$((e=t.contentWindow).document)}return t}function ma(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&("input"===t&&("text"===e.type||"search"===e.type||"tel"===e.type||"url"===e.type||"password"===e.type)||"textarea"===t||"true"===e.contentEditable)}function fa(e){var t=ua(),s=e.focusedElem,a=e.selectionRange;if(t!==s&&s&&s.ownerDocument&&da(s.ownerDocument.documentElement,s)){if(null!==a&&ma(s))if(t=a.start,void 0===(e=a.end)&&(e=t),"selectionStart"in s)s.selectionStart=t,s.selectionEnd=Math.min(e,s.value.length);else if((e=(t=s.ownerDocument||document)&&t.defaultView||window).getSelection){e=e.getSelection();var n=s.textContent.length,r=Math.min(a.start,n);a=void 0===a.end?r:Math.min(a.end,n),!e.extend&&r>a&&(n=a,a=r,r=n),n=ca(s,r);var l=ca(s,a);n&&l&&(1!==e.rangeCount||e.anchorNode!==n.node||e.anchorOffset!==n.offset||e.focusNode!==l.node||e.focusOffset!==l.offset)&&((t=t.createRange()).setStart(n.node,n.offset),e.removeAllRanges(),r>a?(e.addRange(t),e.extend(l.node,l.offset)):(t.setEnd(l.node,l.offset),e.addRange(t)))}for(t=[],e=s;e=e.parentNode;)1===e.nodeType&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for("function"===typeof s.focus&&s.focus(),s=0;s<t.length;s++)(e=t[s]).element.scrollLeft=e.left,e.element.scrollTop=e.top}}var xa=d&&"documentMode"in document&&11>=document.documentMode,pa=null,ha=null,ga=null,ya=!1;function ba(e,t,s){var a=s.window===s?s.document:9===s.nodeType?s:s.ownerDocument;ya||null==pa||pa!==$(a)||("selectionStart"in(a=pa)&&ma(a)?a={start:a.selectionStart,end:a.selectionEnd}:a={anchorNode:(a=(a.ownerDocument&&a.ownerDocument.defaultView||window).getSelection()).anchorNode,anchorOffset:a.anchorOffset,focusNode:a.focusNode,focusOffset:a.focusOffset},ga&&ia(ga,a)||(ga=a,0<(a=Va(ha,"onSelect")).length&&(t=new cs("onSelect","select",null,t,s),e.push({event:t,listeners:a}),t.target=pa)))}function va(e,t){var s={};return s[e.toLowerCase()]=t.toLowerCase(),s["Webkit"+e]="webkit"+t,s["Moz"+e]="moz"+t,s}var ja={animationend:va("Animation","AnimationEnd"),animationiteration:va("Animation","AnimationIteration"),animationstart:va("Animation","AnimationStart"),transitionend:va("Transition","TransitionEnd")},wa={},Na={};function ka(e){if(wa[e])return wa[e];if(!ja[e])return e;var t,s=ja[e];for(t in s)if(s.hasOwnProperty(t)&&t in Na)return wa[e]=s[t];return e}d&&(Na=document.createElement("div").style,"AnimationEvent"in window||(delete ja.animationend.animation,delete ja.animationiteration.animation,delete ja.animationstart.animation),"TransitionEvent"in window||delete ja.transitionend.transition);var Sa=ka("animationend"),Ca=ka("animationiteration"),_a=ka("animationstart"),Ea=ka("transitionend"),Pa=new Map,Aa="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ta(e,t){Pa.set(e,t),o(t,[e])}for(var La=0;La<Aa.length;La++){var Oa=Aa[La];Ta(Oa.toLowerCase(),"on"+(Oa[0].toUpperCase()+Oa.slice(1)))}Ta(Sa,"onAnimationEnd"),Ta(Ca,"onAnimationIteration"),Ta(_a,"onAnimationStart"),Ta("dblclick","onDoubleClick"),Ta("focusin","onFocus"),Ta("focusout","onBlur"),Ta(Ea,"onTransitionEnd"),c("onMouseEnter",["mouseout","mouseover"]),c("onMouseLeave",["mouseout","mouseover"]),c("onPointerEnter",["pointerout","pointerover"]),c("onPointerLeave",["pointerout","pointerover"]),o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),o("onBeforeInput",["compositionend","keypress","textInput","paste"]),o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ra="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),Fa=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ra));function Da(e,t,s){var a=e.type||"unknown-event";e.currentTarget=s,function(e,t,s,a,n,l,i,o,c){if(Ge.apply(this,arguments),De){if(!De)throw Error(r(198));var d=Me;De=!1,Me=null,Ue||(Ue=!0,ze=d)}}(a,t,void 0,e),e.currentTarget=null}function Ma(e,t){t=0!==(4&t);for(var s=0;s<e.length;s++){var a=e[s],n=a.event;a=a.listeners;e:{var r=void 0;if(t)for(var l=a.length-1;0<=l;l--){var i=a[l],o=i.instance,c=i.currentTarget;if(i=i.listener,o!==r&&n.isPropagationStopped())break e;Da(n,i,c),r=o}else for(l=0;l<a.length;l++){if(o=(i=a[l]).instance,c=i.currentTarget,i=i.listener,o!==r&&n.isPropagationStopped())break e;Da(n,i,c),r=o}}}if(Ue)throw e=ze,Ue=!1,ze=null,e}function Ua(e,t){var s=t[pn];void 0===s&&(s=t[pn]=new Set);var a=e+"__bubble";s.has(a)||(Ba(t,e,2,!1),s.add(a))}function za(e,t,s){var a=0;t&&(a|=4),Ba(s,e,a,t)}var Ia="_reactListening"+Math.random().toString(36).slice(2);function Ga(e){if(!e[Ia]){e[Ia]=!0,l.forEach(function(t){"selectionchange"!==t&&(Fa.has(t)||za(t,!1,e),za(t,!0,e))});var t=9===e.nodeType?e:e.ownerDocument;null===t||t[Ia]||(t[Ia]=!0,za("selectionchange",!1,t))}}function Ba(e,t,s,a){switch(Yt(t)){case 1:var n=Vt;break;case 4:n=Ht;break;default:n=Qt}s=n.bind(null,t,s,e),n=void 0,!Oe||"touchstart"!==t&&"touchmove"!==t&&"wheel"!==t||(n=!0),a?void 0!==n?e.addEventListener(t,s,{capture:!0,passive:n}):e.addEventListener(t,s,!0):void 0!==n?e.addEventListener(t,s,{passive:n}):e.addEventListener(t,s,!1)}function Wa(e,t,s,a,n){var r=a;if(0===(1&t)&&0===(2&t)&&null!==a)e:for(;;){if(null===a)return;var l=a.tag;if(3===l||4===l){var i=a.stateNode.containerInfo;if(i===n||8===i.nodeType&&i.parentNode===n)break;if(4===l)for(l=a.return;null!==l;){var o=l.tag;if((3===o||4===o)&&((o=l.stateNode.containerInfo)===n||8===o.nodeType&&o.parentNode===n))return;l=l.return}for(;null!==i;){if(null===(l=yn(i)))return;if(5===(o=l.tag)||6===o){a=r=l;continue e}i=i.parentNode}}a=a.return}Te(function(){var a=r,n=je(s),l=[];e:{var i=Pa.get(e);if(void 0!==i){var o=cs,c=e;switch(e){case"keypress":if(0===ts(s))break e;case"keydown":case"keyup":o=Cs;break;case"focusin":c="focus",o=ps;break;case"focusout":c="blur",o=ps;break;case"beforeblur":case"afterblur":o=ps;break;case"click":if(2===s.button)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":o=fs;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":o=xs;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":o=Es;break;case Sa:case Ca:case _a:o=hs;break;case Ea:o=Ps;break;case"scroll":o=us;break;case"wheel":o=Ts;break;case"copy":case"cut":case"paste":o=ys;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":o=_s}var d=0!==(4&t),u=!d&&"scroll"===e,m=d?null!==i?i+"Capture":null:i;d=[];for(var f,x=a;null!==x;){var p=(f=x).stateNode;if(5===f.tag&&null!==p&&(f=p,null!==m&&(null!=(p=Le(x,m))&&d.push(qa(x,p,f)))),u)break;x=x.return}0<d.length&&(i=new o(i,c,null,s,n),l.push({event:i,listeners:d}))}}if(0===(7&t)){if(o="mouseout"===e||"pointerout"===e,(!(i="mouseover"===e||"pointerover"===e)||s===ve||!(c=s.relatedTarget||s.fromElement)||!yn(c)&&!c[xn])&&(o||i)&&(i=n.window===n?n:(i=n.ownerDocument)?i.defaultView||i.parentWindow:window,o?(o=a,null!==(c=(c=s.relatedTarget||s.toElement)?yn(c):null)&&(c!==(u=Be(c))||5!==c.tag&&6!==c.tag)&&(c=null)):(o=null,c=a),o!==c)){if(d=fs,p="onMouseLeave",m="onMouseEnter",x="mouse","pointerout"!==e&&"pointerover"!==e||(d=_s,p="onPointerLeave",m="onPointerEnter",x="pointer"),u=null==o?i:vn(o),f=null==c?i:vn(c),(i=new d(p,x+"leave",o,s,n)).target=u,i.relatedTarget=f,p=null,yn(n)===a&&((d=new d(m,x+"enter",c,s,n)).target=f,d.relatedTarget=u,p=d),u=p,o&&c)e:{for(m=c,x=0,f=d=o;f;f=Ha(f))x++;for(f=0,p=m;p;p=Ha(p))f++;for(;0<x-f;)d=Ha(d),x--;for(;0<f-x;)m=Ha(m),f--;for(;x--;){if(d===m||null!==m&&d===m.alternate)break e;d=Ha(d),m=Ha(m)}d=null}else d=null;null!==o&&Qa(l,i,o,d,!1),null!==c&&null!==u&&Qa(l,u,c,d,!0)}if("select"===(o=(i=a?vn(a):window).nodeName&&i.nodeName.toLowerCase())||"input"===o&&"file"===i.type)var h=Js;else if(Ws(i))if(Ys)h=ra;else{h=aa;var g=sa}else(o=i.nodeName)&&"input"===o.toLowerCase()&&("checkbox"===i.type||"radio"===i.type)&&(h=na);switch(h&&(h=h(e,a))?qs(l,h,s,n):(g&&g(e,i,a),"focusout"===e&&(g=i._wrapperState)&&g.controlled&&"number"===i.type&&ee(i,"number",i.value)),g=a?vn(a):window,e){case"focusin":(Ws(g)||"true"===g.contentEditable)&&(pa=g,ha=a,ga=null);break;case"focusout":ga=ha=pa=null;break;case"mousedown":ya=!0;break;case"contextmenu":case"mouseup":case"dragend":ya=!1,ba(l,s,n);break;case"selectionchange":if(xa)break;case"keydown":case"keyup":ba(l,s,n)}var y;if(Os)e:{switch(e){case"compositionstart":var b="onCompositionStart";break e;case"compositionend":b="onCompositionEnd";break e;case"compositionupdate":b="onCompositionUpdate";break e}b=void 0}else Gs?zs(e,s)&&(b="onCompositionEnd"):"keydown"===e&&229===s.keyCode&&(b="onCompositionStart");b&&(Ds&&"ko"!==s.locale&&(Gs||"onCompositionStart"!==b?"onCompositionEnd"===b&&Gs&&(y=es()):(Xt="value"in(Kt=n)?Kt.value:Kt.textContent,Gs=!0)),0<(g=Va(a,b)).length&&(b=new bs(b,e,null,s,n),l.push({event:b,listeners:g}),y?b.data=y:null!==(y=Is(s))&&(b.data=y))),(y=Fs?function(e,t){switch(e){case"compositionend":return Is(t);case"keypress":return 32!==t.which?null:(Us=!0,Ms);case"textInput":return(e=t.data)===Ms&&Us?null:e;default:return null}}(e,s):function(e,t){if(Gs)return"compositionend"===e||!Os&&zs(e,t)?(e=es(),Zt=Xt=Kt=null,Gs=!1,e):null;switch(e){case"paste":default:return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return Ds&&"ko"!==t.locale?null:t.data}}(e,s))&&(0<(a=Va(a,"onBeforeInput")).length&&(n=new bs("onBeforeInput","beforeinput",null,s,n),l.push({event:n,listeners:a}),n.data=y))}Ma(l,t)})}function qa(e,t,s){return{instance:e,listener:t,currentTarget:s}}function Va(e,t){for(var s=t+"Capture",a=[];null!==e;){var n=e,r=n.stateNode;5===n.tag&&null!==r&&(n=r,null!=(r=Le(e,s))&&a.unshift(qa(e,r,n)),null!=(r=Le(e,t))&&a.push(qa(e,r,n))),e=e.return}return a}function Ha(e){if(null===e)return null;do{e=e.return}while(e&&5!==e.tag);return e||null}function Qa(e,t,s,a,n){for(var r=t._reactName,l=[];null!==s&&s!==a;){var i=s,o=i.alternate,c=i.stateNode;if(null!==o&&o===a)break;5===i.tag&&null!==c&&(i=c,n?null!=(o=Le(s,r))&&l.unshift(qa(s,o,i)):n||null!=(o=Le(s,r))&&l.push(qa(s,o,i))),s=s.return}0!==l.length&&e.push({event:t,listeners:l})}var $a=/\r\n?/g,Ja=/\u0000|\uFFFD/g;function Ya(e){return("string"===typeof e?e:""+e).replace($a,"\n").replace(Ja,"")}function Ka(e,t,s){if(t=Ya(t),Ya(e)!==t&&s)throw Error(r(425))}function Xa(){}var Za=null,en=null;function tn(e,t){return"textarea"===e||"noscript"===e||"string"===typeof t.children||"number"===typeof t.children||"object"===typeof t.dangerouslySetInnerHTML&&null!==t.dangerouslySetInnerHTML&&null!=t.dangerouslySetInnerHTML.__html}var sn="function"===typeof setTimeout?setTimeout:void 0,an="function"===typeof clearTimeout?clearTimeout:void 0,nn="function"===typeof Promise?Promise:void 0,rn="function"===typeof queueMicrotask?queueMicrotask:"undefined"!==typeof nn?function(e){return nn.resolve(null).then(e).catch(ln)}:sn;function ln(e){setTimeout(function(){throw e})}function on(e,t){var s=t,a=0;do{var n=s.nextSibling;if(e.removeChild(s),n&&8===n.nodeType)if("/$"===(s=n.data)){if(0===a)return e.removeChild(n),void Bt(t);a--}else"$"!==s&&"$?"!==s&&"$!"!==s||a++;s=n}while(s);Bt(t)}function cn(e){for(;null!=e;e=e.nextSibling){var t=e.nodeType;if(1===t||3===t)break;if(8===t){if("$"===(t=e.data)||"$!"===t||"$?"===t)break;if("/$"===t)return null}}return e}function dn(e){e=e.previousSibling;for(var t=0;e;){if(8===e.nodeType){var s=e.data;if("$"===s||"$!"===s||"$?"===s){if(0===t)return e;t--}else"/$"===s&&t++}e=e.previousSibling}return null}var un=Math.random().toString(36).slice(2),mn="__reactFiber$"+un,fn="__reactProps$"+un,xn="__reactContainer$"+un,pn="__reactEvents$"+un,hn="__reactListeners$"+un,gn="__reactHandles$"+un;function yn(e){var t=e[mn];if(t)return t;for(var s=e.parentNode;s;){if(t=s[xn]||s[mn]){if(s=t.alternate,null!==t.child||null!==s&&null!==s.child)for(e=dn(e);null!==e;){if(s=e[mn])return s;e=dn(e)}return t}s=(e=s).parentNode}return null}function bn(e){return!(e=e[mn]||e[xn])||5!==e.tag&&6!==e.tag&&13!==e.tag&&3!==e.tag?null:e}function vn(e){if(5===e.tag||6===e.tag)return e.stateNode;throw Error(r(33))}function jn(e){return e[fn]||null}var wn=[],Nn=-1;function kn(e){return{current:e}}function Sn(e){0>Nn||(e.current=wn[Nn],wn[Nn]=null,Nn--)}function Cn(e,t){Nn++,wn[Nn]=e.current,e.current=t}var _n={},En=kn(_n),Pn=kn(!1),An=_n;function Tn(e,t){var s=e.type.contextTypes;if(!s)return _n;var a=e.stateNode;if(a&&a.__reactInternalMemoizedUnmaskedChildContext===t)return a.__reactInternalMemoizedMaskedChildContext;var n,r={};for(n in s)r[n]=t[n];return a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=r),r}function Ln(e){return null!==(e=e.childContextTypes)&&void 0!==e}function On(){Sn(Pn),Sn(En)}function Rn(e,t,s){if(En.current!==_n)throw Error(r(168));Cn(En,t),Cn(Pn,s)}function Fn(e,t,s){var a=e.stateNode;if(t=t.childContextTypes,"function"!==typeof a.getChildContext)return s;for(var n in a=a.getChildContext())if(!(n in t))throw Error(r(108,W(e)||"Unknown",n));return M({},s,a)}function Dn(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||_n,An=En.current,Cn(En,e),Cn(Pn,Pn.current),!0}function Mn(e,t,s){var a=e.stateNode;if(!a)throw Error(r(169));s?(e=Fn(e,t,An),a.__reactInternalMemoizedMergedChildContext=e,Sn(Pn),Sn(En),Cn(En,e)):Sn(Pn),Cn(Pn,s)}var Un=null,zn=!1,In=!1;function Gn(e){null===Un?Un=[e]:Un.push(e)}function Bn(){if(!In&&null!==Un){In=!0;var e=0,t=bt;try{var s=Un;for(bt=1;e<s.length;e++){var a=s[e];do{a=a(!0)}while(null!==a)}Un=null,zn=!1}catch(n){throw null!==Un&&(Un=Un.slice(e+1)),Qe(Ze,Bn),n}finally{bt=t,In=!1}}return null}var Wn=[],qn=0,Vn=null,Hn=0,Qn=[],$n=0,Jn=null,Yn=1,Kn="";function Xn(e,t){Wn[qn++]=Hn,Wn[qn++]=Vn,Vn=e,Hn=t}function Zn(e,t,s){Qn[$n++]=Yn,Qn[$n++]=Kn,Qn[$n++]=Jn,Jn=e;var a=Yn;e=Kn;var n=32-lt(a)-1;a&=~(1<<n),s+=1;var r=32-lt(t)+n;if(30<r){var l=n-n%5;r=(a&(1<<l)-1).toString(32),a>>=l,n-=l,Yn=1<<32-lt(t)+n|s<<n|a,Kn=r+e}else Yn=1<<r|s<<n|a,Kn=e}function er(e){null!==e.return&&(Xn(e,1),Zn(e,1,0))}function tr(e){for(;e===Vn;)Vn=Wn[--qn],Wn[qn]=null,Hn=Wn[--qn],Wn[qn]=null;for(;e===Jn;)Jn=Qn[--$n],Qn[$n]=null,Kn=Qn[--$n],Qn[$n]=null,Yn=Qn[--$n],Qn[$n]=null}var sr=null,ar=null,nr=!1,rr=null;function lr(e,t){var s=Tc(5,null,null,0);s.elementType="DELETED",s.stateNode=t,s.return=e,null===(t=e.deletions)?(e.deletions=[s],e.flags|=16):t.push(s)}function ir(e,t){switch(e.tag){case 5:var s=e.type;return null!==(t=1!==t.nodeType||s.toLowerCase()!==t.nodeName.toLowerCase()?null:t)&&(e.stateNode=t,sr=e,ar=cn(t.firstChild),!0);case 6:return null!==(t=""===e.pendingProps||3!==t.nodeType?null:t)&&(e.stateNode=t,sr=e,ar=null,!0);case 13:return null!==(t=8!==t.nodeType?null:t)&&(s=null!==Jn?{id:Yn,overflow:Kn}:null,e.memoizedState={dehydrated:t,treeContext:s,retryLane:1073741824},(s=Tc(18,null,null,0)).stateNode=t,s.return=e,e.child=s,sr=e,ar=null,!0);default:return!1}}function or(e){return 0!==(1&e.mode)&&0===(128&e.flags)}function cr(e){if(nr){var t=ar;if(t){var s=t;if(!ir(e,t)){if(or(e))throw Error(r(418));t=cn(s.nextSibling);var a=sr;t&&ir(e,t)?lr(a,s):(e.flags=-4097&e.flags|2,nr=!1,sr=e)}}else{if(or(e))throw Error(r(418));e.flags=-4097&e.flags|2,nr=!1,sr=e}}}function dr(e){for(e=e.return;null!==e&&5!==e.tag&&3!==e.tag&&13!==e.tag;)e=e.return;sr=e}function ur(e){if(e!==sr)return!1;if(!nr)return dr(e),nr=!0,!1;var t;if((t=3!==e.tag)&&!(t=5!==e.tag)&&(t="head"!==(t=e.type)&&"body"!==t&&!tn(e.type,e.memoizedProps)),t&&(t=ar)){if(or(e))throw mr(),Error(r(418));for(;t;)lr(e,t),t=cn(t.nextSibling)}if(dr(e),13===e.tag){if(!(e=null!==(e=e.memoizedState)?e.dehydrated:null))throw Error(r(317));e:{for(e=e.nextSibling,t=0;e;){if(8===e.nodeType){var s=e.data;if("/$"===s){if(0===t){ar=cn(e.nextSibling);break e}t--}else"$"!==s&&"$!"!==s&&"$?"!==s||t++}e=e.nextSibling}ar=null}}else ar=sr?cn(e.stateNode.nextSibling):null;return!0}function mr(){for(var e=ar;e;)e=cn(e.nextSibling)}function fr(){ar=sr=null,nr=!1}function xr(e){null===rr?rr=[e]:rr.push(e)}var pr=v.ReactCurrentBatchConfig;function hr(e,t,s){if(null!==(e=s.ref)&&"function"!==typeof e&&"object"!==typeof e){if(s._owner){if(s=s._owner){if(1!==s.tag)throw Error(r(309));var a=s.stateNode}if(!a)throw Error(r(147,e));var n=a,l=""+e;return null!==t&&null!==t.ref&&"function"===typeof t.ref&&t.ref._stringRef===l?t.ref:(t=function(e){var t=n.refs;null===e?delete t[l]:t[l]=e},t._stringRef=l,t)}if("string"!==typeof e)throw Error(r(284));if(!s._owner)throw Error(r(290,e))}return e}function gr(e,t){throw e=Object.prototype.toString.call(t),Error(r(31,"[object Object]"===e?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function yr(e){return(0,e._init)(e._payload)}function br(e){function t(t,s){if(e){var a=t.deletions;null===a?(t.deletions=[s],t.flags|=16):a.push(s)}}function s(s,a){if(!e)return null;for(;null!==a;)t(s,a),a=a.sibling;return null}function a(e,t){for(e=new Map;null!==t;)null!==t.key?e.set(t.key,t):e.set(t.index,t),t=t.sibling;return e}function n(e,t){return(e=Oc(e,t)).index=0,e.sibling=null,e}function l(t,s,a){return t.index=a,e?null!==(a=t.alternate)?(a=a.index)<s?(t.flags|=2,s):a:(t.flags|=2,s):(t.flags|=1048576,s)}function i(t){return e&&null===t.alternate&&(t.flags|=2),t}function o(e,t,s,a){return null===t||6!==t.tag?((t=Mc(s,e.mode,a)).return=e,t):((t=n(t,s)).return=e,t)}function c(e,t,s,a){var r=s.type;return r===N?u(e,t,s.props.children,a,s.key):null!==t&&(t.elementType===r||"object"===typeof r&&null!==r&&r.$$typeof===L&&yr(r)===t.type)?((a=n(t,s.props)).ref=hr(e,t,s),a.return=e,a):((a=Rc(s.type,s.key,s.props,null,e.mode,a)).ref=hr(e,t,s),a.return=e,a)}function d(e,t,s,a){return null===t||4!==t.tag||t.stateNode.containerInfo!==s.containerInfo||t.stateNode.implementation!==s.implementation?((t=Uc(s,e.mode,a)).return=e,t):((t=n(t,s.children||[])).return=e,t)}function u(e,t,s,a,r){return null===t||7!==t.tag?((t=Fc(s,e.mode,a,r)).return=e,t):((t=n(t,s)).return=e,t)}function m(e,t,s){if("string"===typeof t&&""!==t||"number"===typeof t)return(t=Mc(""+t,e.mode,s)).return=e,t;if("object"===typeof t&&null!==t){switch(t.$$typeof){case j:return(s=Rc(t.type,t.key,t.props,null,e.mode,s)).ref=hr(e,null,t),s.return=e,s;case w:return(t=Uc(t,e.mode,s)).return=e,t;case L:return m(e,(0,t._init)(t._payload),s)}if(te(t)||F(t))return(t=Fc(t,e.mode,s,null)).return=e,t;gr(e,t)}return null}function f(e,t,s,a){var n=null!==t?t.key:null;if("string"===typeof s&&""!==s||"number"===typeof s)return null!==n?null:o(e,t,""+s,a);if("object"===typeof s&&null!==s){switch(s.$$typeof){case j:return s.key===n?c(e,t,s,a):null;case w:return s.key===n?d(e,t,s,a):null;case L:return f(e,t,(n=s._init)(s._payload),a)}if(te(s)||F(s))return null!==n?null:u(e,t,s,a,null);gr(e,s)}return null}function x(e,t,s,a,n){if("string"===typeof a&&""!==a||"number"===typeof a)return o(t,e=e.get(s)||null,""+a,n);if("object"===typeof a&&null!==a){switch(a.$$typeof){case j:return c(t,e=e.get(null===a.key?s:a.key)||null,a,n);case w:return d(t,e=e.get(null===a.key?s:a.key)||null,a,n);case L:return x(e,t,s,(0,a._init)(a._payload),n)}if(te(a)||F(a))return u(t,e=e.get(s)||null,a,n,null);gr(t,a)}return null}function p(n,r,i,o){for(var c=null,d=null,u=r,p=r=0,h=null;null!==u&&p<i.length;p++){u.index>p?(h=u,u=null):h=u.sibling;var g=f(n,u,i[p],o);if(null===g){null===u&&(u=h);break}e&&u&&null===g.alternate&&t(n,u),r=l(g,r,p),null===d?c=g:d.sibling=g,d=g,u=h}if(p===i.length)return s(n,u),nr&&Xn(n,p),c;if(null===u){for(;p<i.length;p++)null!==(u=m(n,i[p],o))&&(r=l(u,r,p),null===d?c=u:d.sibling=u,d=u);return nr&&Xn(n,p),c}for(u=a(n,u);p<i.length;p++)null!==(h=x(u,n,p,i[p],o))&&(e&&null!==h.alternate&&u.delete(null===h.key?p:h.key),r=l(h,r,p),null===d?c=h:d.sibling=h,d=h);return e&&u.forEach(function(e){return t(n,e)}),nr&&Xn(n,p),c}function h(n,i,o,c){var d=F(o);if("function"!==typeof d)throw Error(r(150));if(null==(o=d.call(o)))throw Error(r(151));for(var u=d=null,p=i,h=i=0,g=null,y=o.next();null!==p&&!y.done;h++,y=o.next()){p.index>h?(g=p,p=null):g=p.sibling;var b=f(n,p,y.value,c);if(null===b){null===p&&(p=g);break}e&&p&&null===b.alternate&&t(n,p),i=l(b,i,h),null===u?d=b:u.sibling=b,u=b,p=g}if(y.done)return s(n,p),nr&&Xn(n,h),d;if(null===p){for(;!y.done;h++,y=o.next())null!==(y=m(n,y.value,c))&&(i=l(y,i,h),null===u?d=y:u.sibling=y,u=y);return nr&&Xn(n,h),d}for(p=a(n,p);!y.done;h++,y=o.next())null!==(y=x(p,n,h,y.value,c))&&(e&&null!==y.alternate&&p.delete(null===y.key?h:y.key),i=l(y,i,h),null===u?d=y:u.sibling=y,u=y);return e&&p.forEach(function(e){return t(n,e)}),nr&&Xn(n,h),d}return function e(a,r,l,o){if("object"===typeof l&&null!==l&&l.type===N&&null===l.key&&(l=l.props.children),"object"===typeof l&&null!==l){switch(l.$$typeof){case j:e:{for(var c=l.key,d=r;null!==d;){if(d.key===c){if((c=l.type)===N){if(7===d.tag){s(a,d.sibling),(r=n(d,l.props.children)).return=a,a=r;break e}}else if(d.elementType===c||"object"===typeof c&&null!==c&&c.$$typeof===L&&yr(c)===d.type){s(a,d.sibling),(r=n(d,l.props)).ref=hr(a,d,l),r.return=a,a=r;break e}s(a,d);break}t(a,d),d=d.sibling}l.type===N?((r=Fc(l.props.children,a.mode,o,l.key)).return=a,a=r):((o=Rc(l.type,l.key,l.props,null,a.mode,o)).ref=hr(a,r,l),o.return=a,a=o)}return i(a);case w:e:{for(d=l.key;null!==r;){if(r.key===d){if(4===r.tag&&r.stateNode.containerInfo===l.containerInfo&&r.stateNode.implementation===l.implementation){s(a,r.sibling),(r=n(r,l.children||[])).return=a,a=r;break e}s(a,r);break}t(a,r),r=r.sibling}(r=Uc(l,a.mode,o)).return=a,a=r}return i(a);case L:return e(a,r,(d=l._init)(l._payload),o)}if(te(l))return p(a,r,l,o);if(F(l))return h(a,r,l,o);gr(a,l)}return"string"===typeof l&&""!==l||"number"===typeof l?(l=""+l,null!==r&&6===r.tag?(s(a,r.sibling),(r=n(r,l)).return=a,a=r):(s(a,r),(r=Mc(l,a.mode,o)).return=a,a=r),i(a)):s(a,r)}}var vr=br(!0),jr=br(!1),wr=kn(null),Nr=null,kr=null,Sr=null;function Cr(){Sr=kr=Nr=null}function _r(e){var t=wr.current;Sn(wr),e._currentValue=t}function Er(e,t,s){for(;null!==e;){var a=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,null!==a&&(a.childLanes|=t)):null!==a&&(a.childLanes&t)!==t&&(a.childLanes|=t),e===s)break;e=e.return}}function Pr(e,t){Nr=e,Sr=kr=null,null!==(e=e.dependencies)&&null!==e.firstContext&&(0!==(e.lanes&t)&&(yi=!0),e.firstContext=null)}function Ar(e){var t=e._currentValue;if(Sr!==e)if(e={context:e,memoizedValue:t,next:null},null===kr){if(null===Nr)throw Error(r(308));kr=e,Nr.dependencies={lanes:0,firstContext:e}}else kr=kr.next=e;return t}var Tr=null;function Lr(e){null===Tr?Tr=[e]:Tr.push(e)}function Or(e,t,s,a){var n=t.interleaved;return null===n?(s.next=s,Lr(t)):(s.next=n.next,n.next=s),t.interleaved=s,Rr(e,a)}function Rr(e,t){e.lanes|=t;var s=e.alternate;for(null!==s&&(s.lanes|=t),s=e,e=e.return;null!==e;)e.childLanes|=t,null!==(s=e.alternate)&&(s.childLanes|=t),s=e,e=e.return;return 3===s.tag?s.stateNode:null}var Fr=!1;function Dr(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Mr(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Ur(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function zr(e,t,s){var a=e.updateQueue;if(null===a)return null;if(a=a.shared,0!==(2&Eo)){var n=a.pending;return null===n?t.next=t:(t.next=n.next,n.next=t),a.pending=t,Rr(e,s)}return null===(n=a.interleaved)?(t.next=t,Lr(a)):(t.next=n.next,n.next=t),a.interleaved=t,Rr(e,s)}function Ir(e,t,s){if(null!==(t=t.updateQueue)&&(t=t.shared,0!==(4194240&s))){var a=t.lanes;s|=a&=e.pendingLanes,t.lanes=s,yt(e,s)}}function Gr(e,t){var s=e.updateQueue,a=e.alternate;if(null!==a&&s===(a=a.updateQueue)){var n=null,r=null;if(null!==(s=s.firstBaseUpdate)){do{var l={eventTime:s.eventTime,lane:s.lane,tag:s.tag,payload:s.payload,callback:s.callback,next:null};null===r?n=r=l:r=r.next=l,s=s.next}while(null!==s);null===r?n=r=t:r=r.next=t}else n=r=t;return s={baseState:a.baseState,firstBaseUpdate:n,lastBaseUpdate:r,shared:a.shared,effects:a.effects},void(e.updateQueue=s)}null===(e=s.lastBaseUpdate)?s.firstBaseUpdate=t:e.next=t,s.lastBaseUpdate=t}function Br(e,t,s,a){var n=e.updateQueue;Fr=!1;var r=n.firstBaseUpdate,l=n.lastBaseUpdate,i=n.shared.pending;if(null!==i){n.shared.pending=null;var o=i,c=o.next;o.next=null,null===l?r=c:l.next=c,l=o;var d=e.alternate;null!==d&&((i=(d=d.updateQueue).lastBaseUpdate)!==l&&(null===i?d.firstBaseUpdate=c:i.next=c,d.lastBaseUpdate=o))}if(null!==r){var u=n.baseState;for(l=0,d=c=o=null,i=r;;){var m=i.lane,f=i.eventTime;if((a&m)===m){null!==d&&(d=d.next={eventTime:f,lane:0,tag:i.tag,payload:i.payload,callback:i.callback,next:null});e:{var x=e,p=i;switch(m=t,f=s,p.tag){case 1:if("function"===typeof(x=p.payload)){u=x.call(f,u,m);break e}u=x;break e;case 3:x.flags=-65537&x.flags|128;case 0:if(null===(m="function"===typeof(x=p.payload)?x.call(f,u,m):x)||void 0===m)break e;u=M({},u,m);break e;case 2:Fr=!0}}null!==i.callback&&0!==i.lane&&(e.flags|=64,null===(m=n.effects)?n.effects=[i]:m.push(i))}else f={eventTime:f,lane:m,tag:i.tag,payload:i.payload,callback:i.callback,next:null},null===d?(c=d=f,o=u):d=d.next=f,l|=m;if(null===(i=i.next)){if(null===(i=n.shared.pending))break;i=(m=i).next,m.next=null,n.lastBaseUpdate=m,n.shared.pending=null}}if(null===d&&(o=u),n.baseState=o,n.firstBaseUpdate=c,n.lastBaseUpdate=d,null!==(t=n.shared.interleaved)){n=t;do{l|=n.lane,n=n.next}while(n!==t)}else null===r&&(n.shared.lanes=0);Do|=l,e.lanes=l,e.memoizedState=u}}function Wr(e,t,s){if(e=t.effects,t.effects=null,null!==e)for(t=0;t<e.length;t++){var a=e[t],n=a.callback;if(null!==n){if(a.callback=null,a=s,"function"!==typeof n)throw Error(r(191,n));n.call(a)}}}var qr={},Vr=kn(qr),Hr=kn(qr),Qr=kn(qr);function $r(e){if(e===qr)throw Error(r(174));return e}function Jr(e,t){switch(Cn(Qr,t),Cn(Hr,e),Cn(Vr,qr),e=t.nodeType){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:oe(null,"");break;default:t=oe(t=(e=8===e?t.parentNode:t).namespaceURI||null,e=e.tagName)}Sn(Vr),Cn(Vr,t)}function Yr(){Sn(Vr),Sn(Hr),Sn(Qr)}function Kr(e){$r(Qr.current);var t=$r(Vr.current),s=oe(t,e.type);t!==s&&(Cn(Hr,e),Cn(Vr,s))}function Xr(e){Hr.current===e&&(Sn(Vr),Sn(Hr))}var Zr=kn(0);function el(e){for(var t=e;null!==t;){if(13===t.tag){var s=t.memoizedState;if(null!==s&&(null===(s=s.dehydrated)||"$?"===s.data||"$!"===s.data))return t}else if(19===t.tag&&void 0!==t.memoizedProps.revealOrder){if(0!==(128&t.flags))return t}else if(null!==t.child){t.child.return=t,t=t.child;continue}if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var tl=[];function sl(){for(var e=0;e<tl.length;e++)tl[e]._workInProgressVersionPrimary=null;tl.length=0}var al=v.ReactCurrentDispatcher,nl=v.ReactCurrentBatchConfig,rl=0,ll=null,il=null,ol=null,cl=!1,dl=!1,ul=0,ml=0;function fl(){throw Error(r(321))}function xl(e,t){if(null===t)return!1;for(var s=0;s<t.length&&s<e.length;s++)if(!la(e[s],t[s]))return!1;return!0}function pl(e,t,s,a,n,l){if(rl=l,ll=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,al.current=null===e||null===e.memoizedState?Xl:Zl,e=s(a,n),dl){l=0;do{if(dl=!1,ul=0,25<=l)throw Error(r(301));l+=1,ol=il=null,t.updateQueue=null,al.current=ei,e=s(a,n)}while(dl)}if(al.current=Kl,t=null!==il&&null!==il.next,rl=0,ol=il=ll=null,cl=!1,t)throw Error(r(300));return e}function hl(){var e=0!==ul;return ul=0,e}function gl(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return null===ol?ll.memoizedState=ol=e:ol=ol.next=e,ol}function yl(){if(null===il){var e=ll.alternate;e=null!==e?e.memoizedState:null}else e=il.next;var t=null===ol?ll.memoizedState:ol.next;if(null!==t)ol=t,il=e;else{if(null===e)throw Error(r(310));e={memoizedState:(il=e).memoizedState,baseState:il.baseState,baseQueue:il.baseQueue,queue:il.queue,next:null},null===ol?ll.memoizedState=ol=e:ol=ol.next=e}return ol}function bl(e,t){return"function"===typeof t?t(e):t}function vl(e){var t=yl(),s=t.queue;if(null===s)throw Error(r(311));s.lastRenderedReducer=e;var a=il,n=a.baseQueue,l=s.pending;if(null!==l){if(null!==n){var i=n.next;n.next=l.next,l.next=i}a.baseQueue=n=l,s.pending=null}if(null!==n){l=n.next,a=a.baseState;var o=i=null,c=null,d=l;do{var u=d.lane;if((rl&u)===u)null!==c&&(c=c.next={lane:0,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null}),a=d.hasEagerState?d.eagerState:e(a,d.action);else{var m={lane:u,action:d.action,hasEagerState:d.hasEagerState,eagerState:d.eagerState,next:null};null===c?(o=c=m,i=a):c=c.next=m,ll.lanes|=u,Do|=u}d=d.next}while(null!==d&&d!==l);null===c?i=a:c.next=o,la(a,t.memoizedState)||(yi=!0),t.memoizedState=a,t.baseState=i,t.baseQueue=c,s.lastRenderedState=a}if(null!==(e=s.interleaved)){n=e;do{l=n.lane,ll.lanes|=l,Do|=l,n=n.next}while(n!==e)}else null===n&&(s.lanes=0);return[t.memoizedState,s.dispatch]}function jl(e){var t=yl(),s=t.queue;if(null===s)throw Error(r(311));s.lastRenderedReducer=e;var a=s.dispatch,n=s.pending,l=t.memoizedState;if(null!==n){s.pending=null;var i=n=n.next;do{l=e(l,i.action),i=i.next}while(i!==n);la(l,t.memoizedState)||(yi=!0),t.memoizedState=l,null===t.baseQueue&&(t.baseState=l),s.lastRenderedState=l}return[l,a]}function wl(){}function Nl(e,t){var s=ll,a=yl(),n=t(),l=!la(a.memoizedState,n);if(l&&(a.memoizedState=n,yi=!0),a=a.queue,Fl(Cl.bind(null,s,a,e),[e]),a.getSnapshot!==t||l||null!==ol&&1&ol.memoizedState.tag){if(s.flags|=2048,Al(9,Sl.bind(null,s,a,n,t),void 0,null),null===Po)throw Error(r(349));0!==(30&rl)||kl(s,t,n)}return n}function kl(e,t,s){e.flags|=16384,e={getSnapshot:t,value:s},null===(t=ll.updateQueue)?(t={lastEffect:null,stores:null},ll.updateQueue=t,t.stores=[e]):null===(s=t.stores)?t.stores=[e]:s.push(e)}function Sl(e,t,s,a){t.value=s,t.getSnapshot=a,_l(t)&&El(e)}function Cl(e,t,s){return s(function(){_l(t)&&El(e)})}function _l(e){var t=e.getSnapshot;e=e.value;try{var s=t();return!la(e,s)}catch(a){return!0}}function El(e){var t=Rr(e,1);null!==t&&sc(t,e,1,-1)}function Pl(e){var t=gl();return"function"===typeof e&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:bl,lastRenderedState:e},t.queue=e,e=e.dispatch=Ql.bind(null,ll,e),[t.memoizedState,e]}function Al(e,t,s,a){return e={tag:e,create:t,destroy:s,deps:a,next:null},null===(t=ll.updateQueue)?(t={lastEffect:null,stores:null},ll.updateQueue=t,t.lastEffect=e.next=e):null===(s=t.lastEffect)?t.lastEffect=e.next=e:(a=s.next,s.next=e,e.next=a,t.lastEffect=e),e}function Tl(){return yl().memoizedState}function Ll(e,t,s,a){var n=gl();ll.flags|=e,n.memoizedState=Al(1|t,s,void 0,void 0===a?null:a)}function Ol(e,t,s,a){var n=yl();a=void 0===a?null:a;var r=void 0;if(null!==il){var l=il.memoizedState;if(r=l.destroy,null!==a&&xl(a,l.deps))return void(n.memoizedState=Al(t,s,r,a))}ll.flags|=e,n.memoizedState=Al(1|t,s,r,a)}function Rl(e,t){return Ll(8390656,8,e,t)}function Fl(e,t){return Ol(2048,8,e,t)}function Dl(e,t){return Ol(4,2,e,t)}function Ml(e,t){return Ol(4,4,e,t)}function Ul(e,t){return"function"===typeof t?(e=e(),t(e),function(){t(null)}):null!==t&&void 0!==t?(e=e(),t.current=e,function(){t.current=null}):void 0}function zl(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Ol(4,4,Ul.bind(null,t,e),s)}function Il(){}function Gl(e,t){var s=yl();t=void 0===t?null:t;var a=s.memoizedState;return null!==a&&null!==t&&xl(t,a[1])?a[0]:(s.memoizedState=[e,t],e)}function Bl(e,t){var s=yl();t=void 0===t?null:t;var a=s.memoizedState;return null!==a&&null!==t&&xl(t,a[1])?a[0]:(e=e(),s.memoizedState=[e,t],e)}function Wl(e,t,s){return 0===(21&rl)?(e.baseState&&(e.baseState=!1,yi=!0),e.memoizedState=s):(la(s,t)||(s=pt(),ll.lanes|=s,Do|=s,e.baseState=!0),t)}function ql(e,t){var s=bt;bt=0!==s&&4>s?s:4,e(!0);var a=nl.transition;nl.transition={};try{e(!1),t()}finally{bt=s,nl.transition=a}}function Vl(){return yl().memoizedState}function Hl(e,t,s){var a=tc(e);if(s={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null},$l(e))Jl(t,s);else if(null!==(s=Or(e,t,s,a))){sc(s,e,a,ec()),Yl(s,t,a)}}function Ql(e,t,s){var a=tc(e),n={lane:a,action:s,hasEagerState:!1,eagerState:null,next:null};if($l(e))Jl(t,n);else{var r=e.alternate;if(0===e.lanes&&(null===r||0===r.lanes)&&null!==(r=t.lastRenderedReducer))try{var l=t.lastRenderedState,i=r(l,s);if(n.hasEagerState=!0,n.eagerState=i,la(i,l)){var o=t.interleaved;return null===o?(n.next=n,Lr(t)):(n.next=o.next,o.next=n),void(t.interleaved=n)}}catch(c){}null!==(s=Or(e,t,n,a))&&(sc(s,e,a,n=ec()),Yl(s,t,a))}}function $l(e){var t=e.alternate;return e===ll||null!==t&&t===ll}function Jl(e,t){dl=cl=!0;var s=e.pending;null===s?t.next=t:(t.next=s.next,s.next=t),e.pending=t}function Yl(e,t,s){if(0!==(4194240&s)){var a=t.lanes;s|=a&=e.pendingLanes,t.lanes=s,yt(e,s)}}var Kl={readContext:Ar,useCallback:fl,useContext:fl,useEffect:fl,useImperativeHandle:fl,useInsertionEffect:fl,useLayoutEffect:fl,useMemo:fl,useReducer:fl,useRef:fl,useState:fl,useDebugValue:fl,useDeferredValue:fl,useTransition:fl,useMutableSource:fl,useSyncExternalStore:fl,useId:fl,unstable_isNewReconciler:!1},Xl={readContext:Ar,useCallback:function(e,t){return gl().memoizedState=[e,void 0===t?null:t],e},useContext:Ar,useEffect:Rl,useImperativeHandle:function(e,t,s){return s=null!==s&&void 0!==s?s.concat([e]):null,Ll(4194308,4,Ul.bind(null,t,e),s)},useLayoutEffect:function(e,t){return Ll(4194308,4,e,t)},useInsertionEffect:function(e,t){return Ll(4,2,e,t)},useMemo:function(e,t){var s=gl();return t=void 0===t?null:t,e=e(),s.memoizedState=[e,t],e},useReducer:function(e,t,s){var a=gl();return t=void 0!==s?s(t):t,a.memoizedState=a.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},a.queue=e,e=e.dispatch=Hl.bind(null,ll,e),[a.memoizedState,e]},useRef:function(e){return e={current:e},gl().memoizedState=e},useState:Pl,useDebugValue:Il,useDeferredValue:function(e){return gl().memoizedState=e},useTransition:function(){var e=Pl(!1),t=e[0];return e=ql.bind(null,e[1]),gl().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,s){var a=ll,n=gl();if(nr){if(void 0===s)throw Error(r(407));s=s()}else{if(s=t(),null===Po)throw Error(r(349));0!==(30&rl)||kl(a,t,s)}n.memoizedState=s;var l={value:s,getSnapshot:t};return n.queue=l,Rl(Cl.bind(null,a,l,e),[e]),a.flags|=2048,Al(9,Sl.bind(null,a,l,s,t),void 0,null),s},useId:function(){var e=gl(),t=Po.identifierPrefix;if(nr){var s=Kn;t=":"+t+"R"+(s=(Yn&~(1<<32-lt(Yn)-1)).toString(32)+s),0<(s=ul++)&&(t+="H"+s.toString(32)),t+=":"}else t=":"+t+"r"+(s=ml++).toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Zl={readContext:Ar,useCallback:Gl,useContext:Ar,useEffect:Fl,useImperativeHandle:zl,useInsertionEffect:Dl,useLayoutEffect:Ml,useMemo:Bl,useReducer:vl,useRef:Tl,useState:function(){return vl(bl)},useDebugValue:Il,useDeferredValue:function(e){return Wl(yl(),il.memoizedState,e)},useTransition:function(){return[vl(bl)[0],yl().memoizedState]},useMutableSource:wl,useSyncExternalStore:Nl,useId:Vl,unstable_isNewReconciler:!1},ei={readContext:Ar,useCallback:Gl,useContext:Ar,useEffect:Fl,useImperativeHandle:zl,useInsertionEffect:Dl,useLayoutEffect:Ml,useMemo:Bl,useReducer:jl,useRef:Tl,useState:function(){return jl(bl)},useDebugValue:Il,useDeferredValue:function(e){var t=yl();return null===il?t.memoizedState=e:Wl(t,il.memoizedState,e)},useTransition:function(){return[jl(bl)[0],yl().memoizedState]},useMutableSource:wl,useSyncExternalStore:Nl,useId:Vl,unstable_isNewReconciler:!1};function ti(e,t){if(e&&e.defaultProps){for(var s in t=M({},t),e=e.defaultProps)void 0===t[s]&&(t[s]=e[s]);return t}return t}function si(e,t,s,a){s=null===(s=s(a,t=e.memoizedState))||void 0===s?t:M({},t,s),e.memoizedState=s,0===e.lanes&&(e.updateQueue.baseState=s)}var ai={isMounted:function(e){return!!(e=e._reactInternals)&&Be(e)===e},enqueueSetState:function(e,t,s){e=e._reactInternals;var a=ec(),n=tc(e),r=Ur(a,n);r.payload=t,void 0!==s&&null!==s&&(r.callback=s),null!==(t=zr(e,r,n))&&(sc(t,e,n,a),Ir(t,e,n))},enqueueReplaceState:function(e,t,s){e=e._reactInternals;var a=ec(),n=tc(e),r=Ur(a,n);r.tag=1,r.payload=t,void 0!==s&&null!==s&&(r.callback=s),null!==(t=zr(e,r,n))&&(sc(t,e,n,a),Ir(t,e,n))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var s=ec(),a=tc(e),n=Ur(s,a);n.tag=2,void 0!==t&&null!==t&&(n.callback=t),null!==(t=zr(e,n,a))&&(sc(t,e,a,s),Ir(t,e,a))}};function ni(e,t,s,a,n,r,l){return"function"===typeof(e=e.stateNode).shouldComponentUpdate?e.shouldComponentUpdate(a,r,l):!t.prototype||!t.prototype.isPureReactComponent||(!ia(s,a)||!ia(n,r))}function ri(e,t,s){var a=!1,n=_n,r=t.contextType;return"object"===typeof r&&null!==r?r=Ar(r):(n=Ln(t)?An:En.current,r=(a=null!==(a=t.contextTypes)&&void 0!==a)?Tn(e,n):_n),t=new t(s,r),e.memoizedState=null!==t.state&&void 0!==t.state?t.state:null,t.updater=ai,e.stateNode=t,t._reactInternals=e,a&&((e=e.stateNode).__reactInternalMemoizedUnmaskedChildContext=n,e.__reactInternalMemoizedMaskedChildContext=r),t}function li(e,t,s,a){e=t.state,"function"===typeof t.componentWillReceiveProps&&t.componentWillReceiveProps(s,a),"function"===typeof t.UNSAFE_componentWillReceiveProps&&t.UNSAFE_componentWillReceiveProps(s,a),t.state!==e&&ai.enqueueReplaceState(t,t.state,null)}function ii(e,t,s,a){var n=e.stateNode;n.props=s,n.state=e.memoizedState,n.refs={},Dr(e);var r=t.contextType;"object"===typeof r&&null!==r?n.context=Ar(r):(r=Ln(t)?An:En.current,n.context=Tn(e,r)),n.state=e.memoizedState,"function"===typeof(r=t.getDerivedStateFromProps)&&(si(e,t,r,s),n.state=e.memoizedState),"function"===typeof t.getDerivedStateFromProps||"function"===typeof n.getSnapshotBeforeUpdate||"function"!==typeof n.UNSAFE_componentWillMount&&"function"!==typeof n.componentWillMount||(t=n.state,"function"===typeof n.componentWillMount&&n.componentWillMount(),"function"===typeof n.UNSAFE_componentWillMount&&n.UNSAFE_componentWillMount(),t!==n.state&&ai.enqueueReplaceState(n,n.state,null),Br(e,s,n,a),n.state=e.memoizedState),"function"===typeof n.componentDidMount&&(e.flags|=4194308)}function oi(e,t){try{var s="",a=t;do{s+=G(a),a=a.return}while(a);var n=s}catch(r){n="\nError generating stack: "+r.message+"\n"+r.stack}return{value:e,source:t,stack:n,digest:null}}function ci(e,t,s){return{value:e,source:null,stack:null!=s?s:null,digest:null!=t?t:null}}function di(e,t){try{console.error(t.value)}catch(s){setTimeout(function(){throw s})}}var ui="function"===typeof WeakMap?WeakMap:Map;function mi(e,t,s){(s=Ur(-1,s)).tag=3,s.payload={element:null};var a=t.value;return s.callback=function(){qo||(qo=!0,Vo=a),di(0,t)},s}function fi(e,t,s){(s=Ur(-1,s)).tag=3;var a=e.type.getDerivedStateFromError;if("function"===typeof a){var n=t.value;s.payload=function(){return a(n)},s.callback=function(){di(0,t)}}var r=e.stateNode;return null!==r&&"function"===typeof r.componentDidCatch&&(s.callback=function(){di(0,t),"function"!==typeof a&&(null===Ho?Ho=new Set([this]):Ho.add(this));var e=t.stack;this.componentDidCatch(t.value,{componentStack:null!==e?e:""})}),s}function xi(e,t,s){var a=e.pingCache;if(null===a){a=e.pingCache=new ui;var n=new Set;a.set(t,n)}else void 0===(n=a.get(t))&&(n=new Set,a.set(t,n));n.has(s)||(n.add(s),e=Sc.bind(null,e,t,s),t.then(e,e))}function pi(e){do{var t;if((t=13===e.tag)&&(t=null===(t=e.memoizedState)||null!==t.dehydrated),t)return e;e=e.return}while(null!==e);return null}function hi(e,t,s,a,n){return 0===(1&e.mode)?(e===t?e.flags|=65536:(e.flags|=128,s.flags|=131072,s.flags&=-52805,1===s.tag&&(null===s.alternate?s.tag=17:((t=Ur(-1,1)).tag=2,zr(s,t,1))),s.lanes|=1),e):(e.flags|=65536,e.lanes=n,e)}var gi=v.ReactCurrentOwner,yi=!1;function bi(e,t,s,a){t.child=null===e?jr(t,null,s,a):vr(t,e.child,s,a)}function vi(e,t,s,a,n){s=s.render;var r=t.ref;return Pr(t,n),a=pl(e,t,s,a,r,n),s=hl(),null===e||yi?(nr&&s&&er(t),t.flags|=1,bi(e,t,a,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Wi(e,t,n))}function ji(e,t,s,a,n){if(null===e){var r=s.type;return"function"!==typeof r||Lc(r)||void 0!==r.defaultProps||null!==s.compare||void 0!==s.defaultProps?((e=Rc(s.type,null,a,t,t.mode,n)).ref=t.ref,e.return=t,t.child=e):(t.tag=15,t.type=r,wi(e,t,r,a,n))}if(r=e.child,0===(e.lanes&n)){var l=r.memoizedProps;if((s=null!==(s=s.compare)?s:ia)(l,a)&&e.ref===t.ref)return Wi(e,t,n)}return t.flags|=1,(e=Oc(r,a)).ref=t.ref,e.return=t,t.child=e}function wi(e,t,s,a,n){if(null!==e){var r=e.memoizedProps;if(ia(r,a)&&e.ref===t.ref){if(yi=!1,t.pendingProps=a=r,0===(e.lanes&n))return t.lanes=e.lanes,Wi(e,t,n);0!==(131072&e.flags)&&(yi=!0)}}return Si(e,t,s,a,n)}function Ni(e,t,s){var a=t.pendingProps,n=a.children,r=null!==e?e.memoizedState:null;if("hidden"===a.mode)if(0===(1&t.mode))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Cn(Oo,Lo),Lo|=s;else{if(0===(1073741824&s))return e=null!==r?r.baseLanes|s:s,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Cn(Oo,Lo),Lo|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},a=null!==r?r.baseLanes:s,Cn(Oo,Lo),Lo|=a}else null!==r?(a=r.baseLanes|s,t.memoizedState=null):a=s,Cn(Oo,Lo),Lo|=a;return bi(e,t,n,s),t.child}function ki(e,t){var s=t.ref;(null===e&&null!==s||null!==e&&e.ref!==s)&&(t.flags|=512,t.flags|=2097152)}function Si(e,t,s,a,n){var r=Ln(s)?An:En.current;return r=Tn(t,r),Pr(t,n),s=pl(e,t,s,a,r,n),a=hl(),null===e||yi?(nr&&a&&er(t),t.flags|=1,bi(e,t,s,n),t.child):(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~n,Wi(e,t,n))}function Ci(e,t,s,a,n){if(Ln(s)){var r=!0;Dn(t)}else r=!1;if(Pr(t,n),null===t.stateNode)Bi(e,t),ri(t,s,a),ii(t,s,a,n),a=!0;else if(null===e){var l=t.stateNode,i=t.memoizedProps;l.props=i;var o=l.context,c=s.contextType;"object"===typeof c&&null!==c?c=Ar(c):c=Tn(t,c=Ln(s)?An:En.current);var d=s.getDerivedStateFromProps,u="function"===typeof d||"function"===typeof l.getSnapshotBeforeUpdate;u||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(i!==a||o!==c)&&li(t,l,a,c),Fr=!1;var m=t.memoizedState;l.state=m,Br(t,a,l,n),o=t.memoizedState,i!==a||m!==o||Pn.current||Fr?("function"===typeof d&&(si(t,s,d,a),o=t.memoizedState),(i=Fr||ni(t,s,i,a,m,o,c))?(u||"function"!==typeof l.UNSAFE_componentWillMount&&"function"!==typeof l.componentWillMount||("function"===typeof l.componentWillMount&&l.componentWillMount(),"function"===typeof l.UNSAFE_componentWillMount&&l.UNSAFE_componentWillMount()),"function"===typeof l.componentDidMount&&(t.flags|=4194308)):("function"===typeof l.componentDidMount&&(t.flags|=4194308),t.memoizedProps=a,t.memoizedState=o),l.props=a,l.state=o,l.context=c,a=i):("function"===typeof l.componentDidMount&&(t.flags|=4194308),a=!1)}else{l=t.stateNode,Mr(e,t),i=t.memoizedProps,c=t.type===t.elementType?i:ti(t.type,i),l.props=c,u=t.pendingProps,m=l.context,"object"===typeof(o=s.contextType)&&null!==o?o=Ar(o):o=Tn(t,o=Ln(s)?An:En.current);var f=s.getDerivedStateFromProps;(d="function"===typeof f||"function"===typeof l.getSnapshotBeforeUpdate)||"function"!==typeof l.UNSAFE_componentWillReceiveProps&&"function"!==typeof l.componentWillReceiveProps||(i!==u||m!==o)&&li(t,l,a,o),Fr=!1,m=t.memoizedState,l.state=m,Br(t,a,l,n);var x=t.memoizedState;i!==u||m!==x||Pn.current||Fr?("function"===typeof f&&(si(t,s,f,a),x=t.memoizedState),(c=Fr||ni(t,s,c,a,m,x,o)||!1)?(d||"function"!==typeof l.UNSAFE_componentWillUpdate&&"function"!==typeof l.componentWillUpdate||("function"===typeof l.componentWillUpdate&&l.componentWillUpdate(a,x,o),"function"===typeof l.UNSAFE_componentWillUpdate&&l.UNSAFE_componentWillUpdate(a,x,o)),"function"===typeof l.componentDidUpdate&&(t.flags|=4),"function"===typeof l.getSnapshotBeforeUpdate&&(t.flags|=1024)):("function"!==typeof l.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),t.memoizedProps=a,t.memoizedState=x),l.props=a,l.state=x,l.context=o,a=c):("function"!==typeof l.componentDidUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=4),"function"!==typeof l.getSnapshotBeforeUpdate||i===e.memoizedProps&&m===e.memoizedState||(t.flags|=1024),a=!1)}return _i(e,t,s,a,r,n)}function _i(e,t,s,a,n,r){ki(e,t);var l=0!==(128&t.flags);if(!a&&!l)return n&&Mn(t,s,!1),Wi(e,t,r);a=t.stateNode,gi.current=t;var i=l&&"function"!==typeof s.getDerivedStateFromError?null:a.render();return t.flags|=1,null!==e&&l?(t.child=vr(t,e.child,null,r),t.child=vr(t,null,i,r)):bi(e,t,i,r),t.memoizedState=a.state,n&&Mn(t,s,!0),t.child}function Ei(e){var t=e.stateNode;t.pendingContext?Rn(0,t.pendingContext,t.pendingContext!==t.context):t.context&&Rn(0,t.context,!1),Jr(e,t.containerInfo)}function Pi(e,t,s,a,n){return fr(),xr(n),t.flags|=256,bi(e,t,s,a),t.child}var Ai,Ti,Li,Oi,Ri={dehydrated:null,treeContext:null,retryLane:0};function Fi(e){return{baseLanes:e,cachePool:null,transitions:null}}function Di(e,t,s){var a,n=t.pendingProps,l=Zr.current,i=!1,o=0!==(128&t.flags);if((a=o)||(a=(null===e||null!==e.memoizedState)&&0!==(2&l)),a?(i=!0,t.flags&=-129):null!==e&&null===e.memoizedState||(l|=1),Cn(Zr,1&l),null===e)return cr(t),null!==(e=t.memoizedState)&&null!==(e=e.dehydrated)?(0===(1&t.mode)?t.lanes=1:"$!"===e.data?t.lanes=8:t.lanes=1073741824,null):(o=n.children,e=n.fallback,i?(n=t.mode,i=t.child,o={mode:"hidden",children:o},0===(1&n)&&null!==i?(i.childLanes=0,i.pendingProps=o):i=Dc(o,n,0,null),e=Fc(e,n,s,null),i.return=t,e.return=t,i.sibling=e,t.child=i,t.child.memoizedState=Fi(s),t.memoizedState=Ri,e):Mi(t,o));if(null!==(l=e.memoizedState)&&null!==(a=l.dehydrated))return function(e,t,s,a,n,l,i){if(s)return 256&t.flags?(t.flags&=-257,Ui(e,t,i,a=ci(Error(r(422))))):null!==t.memoizedState?(t.child=e.child,t.flags|=128,null):(l=a.fallback,n=t.mode,a=Dc({mode:"visible",children:a.children},n,0,null),(l=Fc(l,n,i,null)).flags|=2,a.return=t,l.return=t,a.sibling=l,t.child=a,0!==(1&t.mode)&&vr(t,e.child,null,i),t.child.memoizedState=Fi(i),t.memoizedState=Ri,l);if(0===(1&t.mode))return Ui(e,t,i,null);if("$!"===n.data){if(a=n.nextSibling&&n.nextSibling.dataset)var o=a.dgst;return a=o,Ui(e,t,i,a=ci(l=Error(r(419)),a,void 0))}if(o=0!==(i&e.childLanes),yi||o){if(null!==(a=Po)){switch(i&-i){case 4:n=2;break;case 16:n=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:n=32;break;case 536870912:n=268435456;break;default:n=0}0!==(n=0!==(n&(a.suspendedLanes|i))?0:n)&&n!==l.retryLane&&(l.retryLane=n,Rr(e,n),sc(a,e,n,-1))}return pc(),Ui(e,t,i,a=ci(Error(r(421))))}return"$?"===n.data?(t.flags|=128,t.child=e.child,t=_c.bind(null,e),n._reactRetry=t,null):(e=l.treeContext,ar=cn(n.nextSibling),sr=t,nr=!0,rr=null,null!==e&&(Qn[$n++]=Yn,Qn[$n++]=Kn,Qn[$n++]=Jn,Yn=e.id,Kn=e.overflow,Jn=t),t=Mi(t,a.children),t.flags|=4096,t)}(e,t,o,n,a,l,s);if(i){i=n.fallback,o=t.mode,a=(l=e.child).sibling;var c={mode:"hidden",children:n.children};return 0===(1&o)&&t.child!==l?((n=t.child).childLanes=0,n.pendingProps=c,t.deletions=null):(n=Oc(l,c)).subtreeFlags=14680064&l.subtreeFlags,null!==a?i=Oc(a,i):(i=Fc(i,o,s,null)).flags|=2,i.return=t,n.return=t,n.sibling=i,t.child=n,n=i,i=t.child,o=null===(o=e.child.memoizedState)?Fi(s):{baseLanes:o.baseLanes|s,cachePool:null,transitions:o.transitions},i.memoizedState=o,i.childLanes=e.childLanes&~s,t.memoizedState=Ri,n}return e=(i=e.child).sibling,n=Oc(i,{mode:"visible",children:n.children}),0===(1&t.mode)&&(n.lanes=s),n.return=t,n.sibling=null,null!==e&&(null===(s=t.deletions)?(t.deletions=[e],t.flags|=16):s.push(e)),t.child=n,t.memoizedState=null,n}function Mi(e,t){return(t=Dc({mode:"visible",children:t},e.mode,0,null)).return=e,e.child=t}function Ui(e,t,s,a){return null!==a&&xr(a),vr(t,e.child,null,s),(e=Mi(t,t.pendingProps.children)).flags|=2,t.memoizedState=null,e}function zi(e,t,s){e.lanes|=t;var a=e.alternate;null!==a&&(a.lanes|=t),Er(e.return,t,s)}function Ii(e,t,s,a,n){var r=e.memoizedState;null===r?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:a,tail:s,tailMode:n}:(r.isBackwards=t,r.rendering=null,r.renderingStartTime=0,r.last=a,r.tail=s,r.tailMode=n)}function Gi(e,t,s){var a=t.pendingProps,n=a.revealOrder,r=a.tail;if(bi(e,t,a.children,s),0!==(2&(a=Zr.current)))a=1&a|2,t.flags|=128;else{if(null!==e&&0!==(128&e.flags))e:for(e=t.child;null!==e;){if(13===e.tag)null!==e.memoizedState&&zi(e,s,t);else if(19===e.tag)zi(e,s,t);else if(null!==e.child){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;null===e.sibling;){if(null===e.return||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}a&=1}if(Cn(Zr,a),0===(1&t.mode))t.memoizedState=null;else switch(n){case"forwards":for(s=t.child,n=null;null!==s;)null!==(e=s.alternate)&&null===el(e)&&(n=s),s=s.sibling;null===(s=n)?(n=t.child,t.child=null):(n=s.sibling,s.sibling=null),Ii(t,!1,n,s,r);break;case"backwards":for(s=null,n=t.child,t.child=null;null!==n;){if(null!==(e=n.alternate)&&null===el(e)){t.child=n;break}e=n.sibling,n.sibling=s,s=n,n=e}Ii(t,!0,s,null,r);break;case"together":Ii(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function Bi(e,t){0===(1&t.mode)&&null!==e&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Wi(e,t,s){if(null!==e&&(t.dependencies=e.dependencies),Do|=t.lanes,0===(s&t.childLanes))return null;if(null!==e&&t.child!==e.child)throw Error(r(153));if(null!==t.child){for(s=Oc(e=t.child,e.pendingProps),t.child=s,s.return=t;null!==e.sibling;)e=e.sibling,(s=s.sibling=Oc(e,e.pendingProps)).return=t;s.sibling=null}return t.child}function qi(e,t){if(!nr)switch(e.tailMode){case"hidden":t=e.tail;for(var s=null;null!==t;)null!==t.alternate&&(s=t),t=t.sibling;null===s?e.tail=null:s.sibling=null;break;case"collapsed":s=e.tail;for(var a=null;null!==s;)null!==s.alternate&&(a=s),s=s.sibling;null===a?t||null===e.tail?e.tail=null:e.tail.sibling=null:a.sibling=null}}function Vi(e){var t=null!==e.alternate&&e.alternate.child===e.child,s=0,a=0;if(t)for(var n=e.child;null!==n;)s|=n.lanes|n.childLanes,a|=14680064&n.subtreeFlags,a|=14680064&n.flags,n.return=e,n=n.sibling;else for(n=e.child;null!==n;)s|=n.lanes|n.childLanes,a|=n.subtreeFlags,a|=n.flags,n.return=e,n=n.sibling;return e.subtreeFlags|=a,e.childLanes=s,t}function Hi(e,t,s){var a=t.pendingProps;switch(tr(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vi(t),null;case 1:case 17:return Ln(t.type)&&On(),Vi(t),null;case 3:return a=t.stateNode,Yr(),Sn(Pn),Sn(En),sl(),a.pendingContext&&(a.context=a.pendingContext,a.pendingContext=null),null!==e&&null!==e.child||(ur(t)?t.flags|=4:null===e||e.memoizedState.isDehydrated&&0===(256&t.flags)||(t.flags|=1024,null!==rr&&(lc(rr),rr=null))),Ti(e,t),Vi(t),null;case 5:Xr(t);var n=$r(Qr.current);if(s=t.type,null!==e&&null!=t.stateNode)Li(e,t,s,a,n),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!a){if(null===t.stateNode)throw Error(r(166));return Vi(t),null}if(e=$r(Vr.current),ur(t)){a=t.stateNode,s=t.type;var l=t.memoizedProps;switch(a[mn]=t,a[fn]=l,e=0!==(1&t.mode),s){case"dialog":Ua("cancel",a),Ua("close",a);break;case"iframe":case"object":case"embed":Ua("load",a);break;case"video":case"audio":for(n=0;n<Ra.length;n++)Ua(Ra[n],a);break;case"source":Ua("error",a);break;case"img":case"image":case"link":Ua("error",a),Ua("load",a);break;case"details":Ua("toggle",a);break;case"input":Y(a,l),Ua("invalid",a);break;case"select":a._wrapperState={wasMultiple:!!l.multiple},Ua("invalid",a);break;case"textarea":ne(a,l),Ua("invalid",a)}for(var o in ye(s,l),n=null,l)if(l.hasOwnProperty(o)){var c=l[o];"children"===o?"string"===typeof c?a.textContent!==c&&(!0!==l.suppressHydrationWarning&&Ka(a.textContent,c,e),n=["children",c]):"number"===typeof c&&a.textContent!==""+c&&(!0!==l.suppressHydrationWarning&&Ka(a.textContent,c,e),n=["children",""+c]):i.hasOwnProperty(o)&&null!=c&&"onScroll"===o&&Ua("scroll",a)}switch(s){case"input":H(a),Z(a,l,!0);break;case"textarea":H(a),le(a);break;case"select":case"option":break;default:"function"===typeof l.onClick&&(a.onclick=Xa)}a=n,t.updateQueue=a,null!==a&&(t.flags|=4)}else{o=9===n.nodeType?n:n.ownerDocument,"http://www.w3.org/1999/xhtml"===e&&(e=ie(s)),"http://www.w3.org/1999/xhtml"===e?"script"===s?((e=o.createElement("div")).innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):"string"===typeof a.is?e=o.createElement(s,{is:a.is}):(e=o.createElement(s),"select"===s&&(o=e,a.multiple?o.multiple=!0:a.size&&(o.size=a.size))):e=o.createElementNS(e,s),e[mn]=t,e[fn]=a,Ai(e,t,!1,!1),t.stateNode=e;e:{switch(o=be(s,a),s){case"dialog":Ua("cancel",e),Ua("close",e),n=a;break;case"iframe":case"object":case"embed":Ua("load",e),n=a;break;case"video":case"audio":for(n=0;n<Ra.length;n++)Ua(Ra[n],e);n=a;break;case"source":Ua("error",e),n=a;break;case"img":case"image":case"link":Ua("error",e),Ua("load",e),n=a;break;case"details":Ua("toggle",e),n=a;break;case"input":Y(e,a),n=J(e,a),Ua("invalid",e);break;case"option":default:n=a;break;case"select":e._wrapperState={wasMultiple:!!a.multiple},n=M({},a,{value:void 0}),Ua("invalid",e);break;case"textarea":ne(e,a),n=ae(e,a),Ua("invalid",e)}for(l in ye(s,n),c=n)if(c.hasOwnProperty(l)){var d=c[l];"style"===l?he(e,d):"dangerouslySetInnerHTML"===l?null!=(d=d?d.__html:void 0)&&ue(e,d):"children"===l?"string"===typeof d?("textarea"!==s||""!==d)&&me(e,d):"number"===typeof d&&me(e,""+d):"suppressContentEditableWarning"!==l&&"suppressHydrationWarning"!==l&&"autoFocus"!==l&&(i.hasOwnProperty(l)?null!=d&&"onScroll"===l&&Ua("scroll",e):null!=d&&b(e,l,d,o))}switch(s){case"input":H(e),Z(e,a,!1);break;case"textarea":H(e),le(e);break;case"option":null!=a.value&&e.setAttribute("value",""+q(a.value));break;case"select":e.multiple=!!a.multiple,null!=(l=a.value)?se(e,!!a.multiple,l,!1):null!=a.defaultValue&&se(e,!!a.multiple,a.defaultValue,!0);break;default:"function"===typeof n.onClick&&(e.onclick=Xa)}switch(s){case"button":case"input":case"select":case"textarea":a=!!a.autoFocus;break e;case"img":a=!0;break e;default:a=!1}}a&&(t.flags|=4)}null!==t.ref&&(t.flags|=512,t.flags|=2097152)}return Vi(t),null;case 6:if(e&&null!=t.stateNode)Oi(e,t,e.memoizedProps,a);else{if("string"!==typeof a&&null===t.stateNode)throw Error(r(166));if(s=$r(Qr.current),$r(Vr.current),ur(t)){if(a=t.stateNode,s=t.memoizedProps,a[mn]=t,(l=a.nodeValue!==s)&&null!==(e=sr))switch(e.tag){case 3:Ka(a.nodeValue,s,0!==(1&e.mode));break;case 5:!0!==e.memoizedProps.suppressHydrationWarning&&Ka(a.nodeValue,s,0!==(1&e.mode))}l&&(t.flags|=4)}else(a=(9===s.nodeType?s:s.ownerDocument).createTextNode(a))[mn]=t,t.stateNode=a}return Vi(t),null;case 13:if(Sn(Zr),a=t.memoizedState,null===e||null!==e.memoizedState&&null!==e.memoizedState.dehydrated){if(nr&&null!==ar&&0!==(1&t.mode)&&0===(128&t.flags))mr(),fr(),t.flags|=98560,l=!1;else if(l=ur(t),null!==a&&null!==a.dehydrated){if(null===e){if(!l)throw Error(r(318));if(!(l=null!==(l=t.memoizedState)?l.dehydrated:null))throw Error(r(317));l[mn]=t}else fr(),0===(128&t.flags)&&(t.memoizedState=null),t.flags|=4;Vi(t),l=!1}else null!==rr&&(lc(rr),rr=null),l=!0;if(!l)return 65536&t.flags?t:null}return 0!==(128&t.flags)?(t.lanes=s,t):((a=null!==a)!==(null!==e&&null!==e.memoizedState)&&a&&(t.child.flags|=8192,0!==(1&t.mode)&&(null===e||0!==(1&Zr.current)?0===Ro&&(Ro=3):pc())),null!==t.updateQueue&&(t.flags|=4),Vi(t),null);case 4:return Yr(),Ti(e,t),null===e&&Ga(t.stateNode.containerInfo),Vi(t),null;case 10:return _r(t.type._context),Vi(t),null;case 19:if(Sn(Zr),null===(l=t.memoizedState))return Vi(t),null;if(a=0!==(128&t.flags),null===(o=l.rendering))if(a)qi(l,!1);else{if(0!==Ro||null!==e&&0!==(128&e.flags))for(e=t.child;null!==e;){if(null!==(o=el(e))){for(t.flags|=128,qi(l,!1),null!==(a=o.updateQueue)&&(t.updateQueue=a,t.flags|=4),t.subtreeFlags=0,a=s,s=t.child;null!==s;)e=a,(l=s).flags&=14680066,null===(o=l.alternate)?(l.childLanes=0,l.lanes=e,l.child=null,l.subtreeFlags=0,l.memoizedProps=null,l.memoizedState=null,l.updateQueue=null,l.dependencies=null,l.stateNode=null):(l.childLanes=o.childLanes,l.lanes=o.lanes,l.child=o.child,l.subtreeFlags=0,l.deletions=null,l.memoizedProps=o.memoizedProps,l.memoizedState=o.memoizedState,l.updateQueue=o.updateQueue,l.type=o.type,e=o.dependencies,l.dependencies=null===e?null:{lanes:e.lanes,firstContext:e.firstContext}),s=s.sibling;return Cn(Zr,1&Zr.current|2),t.child}e=e.sibling}null!==l.tail&&Ke()>Bo&&(t.flags|=128,a=!0,qi(l,!1),t.lanes=4194304)}else{if(!a)if(null!==(e=el(o))){if(t.flags|=128,a=!0,null!==(s=e.updateQueue)&&(t.updateQueue=s,t.flags|=4),qi(l,!0),null===l.tail&&"hidden"===l.tailMode&&!o.alternate&&!nr)return Vi(t),null}else 2*Ke()-l.renderingStartTime>Bo&&1073741824!==s&&(t.flags|=128,a=!0,qi(l,!1),t.lanes=4194304);l.isBackwards?(o.sibling=t.child,t.child=o):(null!==(s=l.last)?s.sibling=o:t.child=o,l.last=o)}return null!==l.tail?(t=l.tail,l.rendering=t,l.tail=t.sibling,l.renderingStartTime=Ke(),t.sibling=null,s=Zr.current,Cn(Zr,a?1&s|2:1&s),t):(Vi(t),null);case 22:case 23:return uc(),a=null!==t.memoizedState,null!==e&&null!==e.memoizedState!==a&&(t.flags|=8192),a&&0!==(1&t.mode)?0!==(1073741824&Lo)&&(Vi(t),6&t.subtreeFlags&&(t.flags|=8192)):Vi(t),null;case 24:case 25:return null}throw Error(r(156,t.tag))}function Qi(e,t){switch(tr(t),t.tag){case 1:return Ln(t.type)&&On(),65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 3:return Yr(),Sn(Pn),Sn(En),sl(),0!==(65536&(e=t.flags))&&0===(128&e)?(t.flags=-65537&e|128,t):null;case 5:return Xr(t),null;case 13:if(Sn(Zr),null!==(e=t.memoizedState)&&null!==e.dehydrated){if(null===t.alternate)throw Error(r(340));fr()}return 65536&(e=t.flags)?(t.flags=-65537&e|128,t):null;case 19:return Sn(Zr),null;case 4:return Yr(),null;case 10:return _r(t.type._context),null;case 22:case 23:return uc(),null;default:return null}}Ai=function(e,t){for(var s=t.child;null!==s;){if(5===s.tag||6===s.tag)e.appendChild(s.stateNode);else if(4!==s.tag&&null!==s.child){s.child.return=s,s=s.child;continue}if(s===t)break;for(;null===s.sibling;){if(null===s.return||s.return===t)return;s=s.return}s.sibling.return=s.return,s=s.sibling}},Ti=function(){},Li=function(e,t,s,a){var n=e.memoizedProps;if(n!==a){e=t.stateNode,$r(Vr.current);var r,l=null;switch(s){case"input":n=J(e,n),a=J(e,a),l=[];break;case"select":n=M({},n,{value:void 0}),a=M({},a,{value:void 0}),l=[];break;case"textarea":n=ae(e,n),a=ae(e,a),l=[];break;default:"function"!==typeof n.onClick&&"function"===typeof a.onClick&&(e.onclick=Xa)}for(d in ye(s,a),s=null,n)if(!a.hasOwnProperty(d)&&n.hasOwnProperty(d)&&null!=n[d])if("style"===d){var o=n[d];for(r in o)o.hasOwnProperty(r)&&(s||(s={}),s[r]="")}else"dangerouslySetInnerHTML"!==d&&"children"!==d&&"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&"autoFocus"!==d&&(i.hasOwnProperty(d)?l||(l=[]):(l=l||[]).push(d,null));for(d in a){var c=a[d];if(o=null!=n?n[d]:void 0,a.hasOwnProperty(d)&&c!==o&&(null!=c||null!=o))if("style"===d)if(o){for(r in o)!o.hasOwnProperty(r)||c&&c.hasOwnProperty(r)||(s||(s={}),s[r]="");for(r in c)c.hasOwnProperty(r)&&o[r]!==c[r]&&(s||(s={}),s[r]=c[r])}else s||(l||(l=[]),l.push(d,s)),s=c;else"dangerouslySetInnerHTML"===d?(c=c?c.__html:void 0,o=o?o.__html:void 0,null!=c&&o!==c&&(l=l||[]).push(d,c)):"children"===d?"string"!==typeof c&&"number"!==typeof c||(l=l||[]).push(d,""+c):"suppressContentEditableWarning"!==d&&"suppressHydrationWarning"!==d&&(i.hasOwnProperty(d)?(null!=c&&"onScroll"===d&&Ua("scroll",e),l||o===c||(l=[])):(l=l||[]).push(d,c))}s&&(l=l||[]).push("style",s);var d=l;(t.updateQueue=d)&&(t.flags|=4)}},Oi=function(e,t,s,a){s!==a&&(t.flags|=4)};var $i=!1,Ji=!1,Yi="function"===typeof WeakSet?WeakSet:Set,Ki=null;function Xi(e,t){var s=e.ref;if(null!==s)if("function"===typeof s)try{s(null)}catch(a){kc(e,t,a)}else s.current=null}function Zi(e,t,s){try{s()}catch(a){kc(e,t,a)}}var eo=!1;function to(e,t,s){var a=t.updateQueue;if(null!==(a=null!==a?a.lastEffect:null)){var n=a=a.next;do{if((n.tag&e)===e){var r=n.destroy;n.destroy=void 0,void 0!==r&&Zi(t,s,r)}n=n.next}while(n!==a)}}function so(e,t){if(null!==(t=null!==(t=t.updateQueue)?t.lastEffect:null)){var s=t=t.next;do{if((s.tag&e)===e){var a=s.create;s.destroy=a()}s=s.next}while(s!==t)}}function ao(e){var t=e.ref;if(null!==t){var s=e.stateNode;e.tag,e=s,"function"===typeof t?t(e):t.current=e}}function no(e){var t=e.alternate;null!==t&&(e.alternate=null,no(t)),e.child=null,e.deletions=null,e.sibling=null,5===e.tag&&(null!==(t=e.stateNode)&&(delete t[mn],delete t[fn],delete t[pn],delete t[hn],delete t[gn])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function ro(e){return 5===e.tag||3===e.tag||4===e.tag}function lo(e){e:for(;;){for(;null===e.sibling;){if(null===e.return||ro(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;5!==e.tag&&6!==e.tag&&18!==e.tag;){if(2&e.flags)continue e;if(null===e.child||4===e.tag)continue e;e.child.return=e,e=e.child}if(!(2&e.flags))return e.stateNode}}function io(e,t,s){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?8===s.nodeType?s.parentNode.insertBefore(e,t):s.insertBefore(e,t):(8===s.nodeType?(t=s.parentNode).insertBefore(e,s):(t=s).appendChild(e),null!==(s=s._reactRootContainer)&&void 0!==s||null!==t.onclick||(t.onclick=Xa));else if(4!==a&&null!==(e=e.child))for(io(e,t,s),e=e.sibling;null!==e;)io(e,t,s),e=e.sibling}function oo(e,t,s){var a=e.tag;if(5===a||6===a)e=e.stateNode,t?s.insertBefore(e,t):s.appendChild(e);else if(4!==a&&null!==(e=e.child))for(oo(e,t,s),e=e.sibling;null!==e;)oo(e,t,s),e=e.sibling}var co=null,uo=!1;function mo(e,t,s){for(s=s.child;null!==s;)fo(e,t,s),s=s.sibling}function fo(e,t,s){if(rt&&"function"===typeof rt.onCommitFiberUnmount)try{rt.onCommitFiberUnmount(nt,s)}catch(i){}switch(s.tag){case 5:Ji||Xi(s,t);case 6:var a=co,n=uo;co=null,mo(e,t,s),uo=n,null!==(co=a)&&(uo?(e=co,s=s.stateNode,8===e.nodeType?e.parentNode.removeChild(s):e.removeChild(s)):co.removeChild(s.stateNode));break;case 18:null!==co&&(uo?(e=co,s=s.stateNode,8===e.nodeType?on(e.parentNode,s):1===e.nodeType&&on(e,s),Bt(e)):on(co,s.stateNode));break;case 4:a=co,n=uo,co=s.stateNode.containerInfo,uo=!0,mo(e,t,s),co=a,uo=n;break;case 0:case 11:case 14:case 15:if(!Ji&&(null!==(a=s.updateQueue)&&null!==(a=a.lastEffect))){n=a=a.next;do{var r=n,l=r.destroy;r=r.tag,void 0!==l&&(0!==(2&r)||0!==(4&r))&&Zi(s,t,l),n=n.next}while(n!==a)}mo(e,t,s);break;case 1:if(!Ji&&(Xi(s,t),"function"===typeof(a=s.stateNode).componentWillUnmount))try{a.props=s.memoizedProps,a.state=s.memoizedState,a.componentWillUnmount()}catch(i){kc(s,t,i)}mo(e,t,s);break;case 21:mo(e,t,s);break;case 22:1&s.mode?(Ji=(a=Ji)||null!==s.memoizedState,mo(e,t,s),Ji=a):mo(e,t,s);break;default:mo(e,t,s)}}function xo(e){var t=e.updateQueue;if(null!==t){e.updateQueue=null;var s=e.stateNode;null===s&&(s=e.stateNode=new Yi),t.forEach(function(t){var a=Ec.bind(null,e,t);s.has(t)||(s.add(t),t.then(a,a))})}}function po(e,t){var s=t.deletions;if(null!==s)for(var a=0;a<s.length;a++){var n=s[a];try{var l=e,i=t,o=i;e:for(;null!==o;){switch(o.tag){case 5:co=o.stateNode,uo=!1;break e;case 3:case 4:co=o.stateNode.containerInfo,uo=!0;break e}o=o.return}if(null===co)throw Error(r(160));fo(l,i,n),co=null,uo=!1;var c=n.alternate;null!==c&&(c.return=null),n.return=null}catch(d){kc(n,t,d)}}if(12854&t.subtreeFlags)for(t=t.child;null!==t;)ho(t,e),t=t.sibling}function ho(e,t){var s=e.alternate,a=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(po(t,e),go(e),4&a){try{to(3,e,e.return),so(3,e)}catch(h){kc(e,e.return,h)}try{to(5,e,e.return)}catch(h){kc(e,e.return,h)}}break;case 1:po(t,e),go(e),512&a&&null!==s&&Xi(s,s.return);break;case 5:if(po(t,e),go(e),512&a&&null!==s&&Xi(s,s.return),32&e.flags){var n=e.stateNode;try{me(n,"")}catch(h){kc(e,e.return,h)}}if(4&a&&null!=(n=e.stateNode)){var l=e.memoizedProps,i=null!==s?s.memoizedProps:l,o=e.type,c=e.updateQueue;if(e.updateQueue=null,null!==c)try{"input"===o&&"radio"===l.type&&null!=l.name&&K(n,l),be(o,i);var d=be(o,l);for(i=0;i<c.length;i+=2){var u=c[i],m=c[i+1];"style"===u?he(n,m):"dangerouslySetInnerHTML"===u?ue(n,m):"children"===u?me(n,m):b(n,u,m,d)}switch(o){case"input":X(n,l);break;case"textarea":re(n,l);break;case"select":var f=n._wrapperState.wasMultiple;n._wrapperState.wasMultiple=!!l.multiple;var x=l.value;null!=x?se(n,!!l.multiple,x,!1):f!==!!l.multiple&&(null!=l.defaultValue?se(n,!!l.multiple,l.defaultValue,!0):se(n,!!l.multiple,l.multiple?[]:"",!1))}n[fn]=l}catch(h){kc(e,e.return,h)}}break;case 6:if(po(t,e),go(e),4&a){if(null===e.stateNode)throw Error(r(162));n=e.stateNode,l=e.memoizedProps;try{n.nodeValue=l}catch(h){kc(e,e.return,h)}}break;case 3:if(po(t,e),go(e),4&a&&null!==s&&s.memoizedState.isDehydrated)try{Bt(t.containerInfo)}catch(h){kc(e,e.return,h)}break;case 4:default:po(t,e),go(e);break;case 13:po(t,e),go(e),8192&(n=e.child).flags&&(l=null!==n.memoizedState,n.stateNode.isHidden=l,!l||null!==n.alternate&&null!==n.alternate.memoizedState||(Go=Ke())),4&a&&xo(e);break;case 22:if(u=null!==s&&null!==s.memoizedState,1&e.mode?(Ji=(d=Ji)||u,po(t,e),Ji=d):po(t,e),go(e),8192&a){if(d=null!==e.memoizedState,(e.stateNode.isHidden=d)&&!u&&0!==(1&e.mode))for(Ki=e,u=e.child;null!==u;){for(m=Ki=u;null!==Ki;){switch(x=(f=Ki).child,f.tag){case 0:case 11:case 14:case 15:to(4,f,f.return);break;case 1:Xi(f,f.return);var p=f.stateNode;if("function"===typeof p.componentWillUnmount){a=f,s=f.return;try{t=a,p.props=t.memoizedProps,p.state=t.memoizedState,p.componentWillUnmount()}catch(h){kc(a,s,h)}}break;case 5:Xi(f,f.return);break;case 22:if(null!==f.memoizedState){jo(m);continue}}null!==x?(x.return=f,Ki=x):jo(m)}u=u.sibling}e:for(u=null,m=e;;){if(5===m.tag){if(null===u){u=m;try{n=m.stateNode,d?"function"===typeof(l=n.style).setProperty?l.setProperty("display","none","important"):l.display="none":(o=m.stateNode,i=void 0!==(c=m.memoizedProps.style)&&null!==c&&c.hasOwnProperty("display")?c.display:null,o.style.display=pe("display",i))}catch(h){kc(e,e.return,h)}}}else if(6===m.tag){if(null===u)try{m.stateNode.nodeValue=d?"":m.memoizedProps}catch(h){kc(e,e.return,h)}}else if((22!==m.tag&&23!==m.tag||null===m.memoizedState||m===e)&&null!==m.child){m.child.return=m,m=m.child;continue}if(m===e)break e;for(;null===m.sibling;){if(null===m.return||m.return===e)break e;u===m&&(u=null),m=m.return}u===m&&(u=null),m.sibling.return=m.return,m=m.sibling}}break;case 19:po(t,e),go(e),4&a&&xo(e);case 21:}}function go(e){var t=e.flags;if(2&t){try{e:{for(var s=e.return;null!==s;){if(ro(s)){var a=s;break e}s=s.return}throw Error(r(160))}switch(a.tag){case 5:var n=a.stateNode;32&a.flags&&(me(n,""),a.flags&=-33),oo(e,lo(e),n);break;case 3:case 4:var l=a.stateNode.containerInfo;io(e,lo(e),l);break;default:throw Error(r(161))}}catch(i){kc(e,e.return,i)}e.flags&=-3}4096&t&&(e.flags&=-4097)}function yo(e,t,s){Ki=e,bo(e,t,s)}function bo(e,t,s){for(var a=0!==(1&e.mode);null!==Ki;){var n=Ki,r=n.child;if(22===n.tag&&a){var l=null!==n.memoizedState||$i;if(!l){var i=n.alternate,o=null!==i&&null!==i.memoizedState||Ji;i=$i;var c=Ji;if($i=l,(Ji=o)&&!c)for(Ki=n;null!==Ki;)o=(l=Ki).child,22===l.tag&&null!==l.memoizedState?wo(n):null!==o?(o.return=l,Ki=o):wo(n);for(;null!==r;)Ki=r,bo(r,t,s),r=r.sibling;Ki=n,$i=i,Ji=c}vo(e)}else 0!==(8772&n.subtreeFlags)&&null!==r?(r.return=n,Ki=r):vo(e)}}function vo(e){for(;null!==Ki;){var t=Ki;if(0!==(8772&t.flags)){var s=t.alternate;try{if(0!==(8772&t.flags))switch(t.tag){case 0:case 11:case 15:Ji||so(5,t);break;case 1:var a=t.stateNode;if(4&t.flags&&!Ji)if(null===s)a.componentDidMount();else{var n=t.elementType===t.type?s.memoizedProps:ti(t.type,s.memoizedProps);a.componentDidUpdate(n,s.memoizedState,a.__reactInternalSnapshotBeforeUpdate)}var l=t.updateQueue;null!==l&&Wr(t,l,a);break;case 3:var i=t.updateQueue;if(null!==i){if(s=null,null!==t.child)switch(t.child.tag){case 5:case 1:s=t.child.stateNode}Wr(t,i,s)}break;case 5:var o=t.stateNode;if(null===s&&4&t.flags){s=o;var c=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":c.autoFocus&&s.focus();break;case"img":c.src&&(s.src=c.src)}}break;case 6:case 4:case 12:case 19:case 17:case 21:case 22:case 23:case 25:break;case 13:if(null===t.memoizedState){var d=t.alternate;if(null!==d){var u=d.memoizedState;if(null!==u){var m=u.dehydrated;null!==m&&Bt(m)}}}break;default:throw Error(r(163))}Ji||512&t.flags&&ao(t)}catch(f){kc(t,t.return,f)}}if(t===e){Ki=null;break}if(null!==(s=t.sibling)){s.return=t.return,Ki=s;break}Ki=t.return}}function jo(e){for(;null!==Ki;){var t=Ki;if(t===e){Ki=null;break}var s=t.sibling;if(null!==s){s.return=t.return,Ki=s;break}Ki=t.return}}function wo(e){for(;null!==Ki;){var t=Ki;try{switch(t.tag){case 0:case 11:case 15:var s=t.return;try{so(4,t)}catch(o){kc(t,s,o)}break;case 1:var a=t.stateNode;if("function"===typeof a.componentDidMount){var n=t.return;try{a.componentDidMount()}catch(o){kc(t,n,o)}}var r=t.return;try{ao(t)}catch(o){kc(t,r,o)}break;case 5:var l=t.return;try{ao(t)}catch(o){kc(t,l,o)}}}catch(o){kc(t,t.return,o)}if(t===e){Ki=null;break}var i=t.sibling;if(null!==i){i.return=t.return,Ki=i;break}Ki=t.return}}var No,ko=Math.ceil,So=v.ReactCurrentDispatcher,Co=v.ReactCurrentOwner,_o=v.ReactCurrentBatchConfig,Eo=0,Po=null,Ao=null,To=0,Lo=0,Oo=kn(0),Ro=0,Fo=null,Do=0,Mo=0,Uo=0,zo=null,Io=null,Go=0,Bo=1/0,Wo=null,qo=!1,Vo=null,Ho=null,Qo=!1,$o=null,Jo=0,Yo=0,Ko=null,Xo=-1,Zo=0;function ec(){return 0!==(6&Eo)?Ke():-1!==Xo?Xo:Xo=Ke()}function tc(e){return 0===(1&e.mode)?1:0!==(2&Eo)&&0!==To?To&-To:null!==pr.transition?(0===Zo&&(Zo=pt()),Zo):0!==(e=bt)?e:e=void 0===(e=window.event)?16:Yt(e.type)}function sc(e,t,s,a){if(50<Yo)throw Yo=0,Ko=null,Error(r(185));gt(e,s,a),0!==(2&Eo)&&e===Po||(e===Po&&(0===(2&Eo)&&(Mo|=s),4===Ro&&ic(e,To)),ac(e,a),1===s&&0===Eo&&0===(1&t.mode)&&(Bo=Ke()+500,zn&&Bn()))}function ac(e,t){var s=e.callbackNode;!function(e,t){for(var s=e.suspendedLanes,a=e.pingedLanes,n=e.expirationTimes,r=e.pendingLanes;0<r;){var l=31-lt(r),i=1<<l,o=n[l];-1===o?0!==(i&s)&&0===(i&a)||(n[l]=ft(i,t)):o<=t&&(e.expiredLanes|=i),r&=~i}}(e,t);var a=mt(e,e===Po?To:0);if(0===a)null!==s&&$e(s),e.callbackNode=null,e.callbackPriority=0;else if(t=a&-a,e.callbackPriority!==t){if(null!=s&&$e(s),1===t)0===e.tag?function(e){zn=!0,Gn(e)}(oc.bind(null,e)):Gn(oc.bind(null,e)),rn(function(){0===(6&Eo)&&Bn()}),s=null;else{switch(vt(a)){case 1:s=Ze;break;case 4:s=et;break;case 16:default:s=tt;break;case 536870912:s=at}s=Pc(s,nc.bind(null,e))}e.callbackPriority=t,e.callbackNode=s}}function nc(e,t){if(Xo=-1,Zo=0,0!==(6&Eo))throw Error(r(327));var s=e.callbackNode;if(wc()&&e.callbackNode!==s)return null;var a=mt(e,e===Po?To:0);if(0===a)return null;if(0!==(30&a)||0!==(a&e.expiredLanes)||t)t=hc(e,a);else{t=a;var n=Eo;Eo|=2;var l=xc();for(Po===e&&To===t||(Wo=null,Bo=Ke()+500,mc(e,t));;)try{yc();break}catch(o){fc(e,o)}Cr(),So.current=l,Eo=n,null!==Ao?t=0:(Po=null,To=0,t=Ro)}if(0!==t){if(2===t&&(0!==(n=xt(e))&&(a=n,t=rc(e,n))),1===t)throw s=Fo,mc(e,0),ic(e,a),ac(e,Ke()),s;if(6===t)ic(e,a);else{if(n=e.current.alternate,0===(30&a)&&!function(e){for(var t=e;;){if(16384&t.flags){var s=t.updateQueue;if(null!==s&&null!==(s=s.stores))for(var a=0;a<s.length;a++){var n=s[a],r=n.getSnapshot;n=n.value;try{if(!la(r(),n))return!1}catch(i){return!1}}}if(s=t.child,16384&t.subtreeFlags&&null!==s)s.return=t,t=s;else{if(t===e)break;for(;null===t.sibling;){if(null===t.return||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}(n)&&(2===(t=hc(e,a))&&(0!==(l=xt(e))&&(a=l,t=rc(e,l))),1===t))throw s=Fo,mc(e,0),ic(e,a),ac(e,Ke()),s;switch(e.finishedWork=n,e.finishedLanes=a,t){case 0:case 1:throw Error(r(345));case 2:case 5:jc(e,Io,Wo);break;case 3:if(ic(e,a),(130023424&a)===a&&10<(t=Go+500-Ke())){if(0!==mt(e,0))break;if(((n=e.suspendedLanes)&a)!==a){ec(),e.pingedLanes|=e.suspendedLanes&n;break}e.timeoutHandle=sn(jc.bind(null,e,Io,Wo),t);break}jc(e,Io,Wo);break;case 4:if(ic(e,a),(4194240&a)===a)break;for(t=e.eventTimes,n=-1;0<a;){var i=31-lt(a);l=1<<i,(i=t[i])>n&&(n=i),a&=~l}if(a=n,10<(a=(120>(a=Ke()-a)?120:480>a?480:1080>a?1080:1920>a?1920:3e3>a?3e3:4320>a?4320:1960*ko(a/1960))-a)){e.timeoutHandle=sn(jc.bind(null,e,Io,Wo),a);break}jc(e,Io,Wo);break;default:throw Error(r(329))}}}return ac(e,Ke()),e.callbackNode===s?nc.bind(null,e):null}function rc(e,t){var s=zo;return e.current.memoizedState.isDehydrated&&(mc(e,t).flags|=256),2!==(e=hc(e,t))&&(t=Io,Io=s,null!==t&&lc(t)),e}function lc(e){null===Io?Io=e:Io.push.apply(Io,e)}function ic(e,t){for(t&=~Uo,t&=~Mo,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var s=31-lt(t),a=1<<s;e[s]=-1,t&=~a}}function oc(e){if(0!==(6&Eo))throw Error(r(327));wc();var t=mt(e,0);if(0===(1&t))return ac(e,Ke()),null;var s=hc(e,t);if(0!==e.tag&&2===s){var a=xt(e);0!==a&&(t=a,s=rc(e,a))}if(1===s)throw s=Fo,mc(e,0),ic(e,t),ac(e,Ke()),s;if(6===s)throw Error(r(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,jc(e,Io,Wo),ac(e,Ke()),null}function cc(e,t){var s=Eo;Eo|=1;try{return e(t)}finally{0===(Eo=s)&&(Bo=Ke()+500,zn&&Bn())}}function dc(e){null!==$o&&0===$o.tag&&0===(6&Eo)&&wc();var t=Eo;Eo|=1;var s=_o.transition,a=bt;try{if(_o.transition=null,bt=1,e)return e()}finally{bt=a,_o.transition=s,0===(6&(Eo=t))&&Bn()}}function uc(){Lo=Oo.current,Sn(Oo)}function mc(e,t){e.finishedWork=null,e.finishedLanes=0;var s=e.timeoutHandle;if(-1!==s&&(e.timeoutHandle=-1,an(s)),null!==Ao)for(s=Ao.return;null!==s;){var a=s;switch(tr(a),a.tag){case 1:null!==(a=a.type.childContextTypes)&&void 0!==a&&On();break;case 3:Yr(),Sn(Pn),Sn(En),sl();break;case 5:Xr(a);break;case 4:Yr();break;case 13:case 19:Sn(Zr);break;case 10:_r(a.type._context);break;case 22:case 23:uc()}s=s.return}if(Po=e,Ao=e=Oc(e.current,null),To=Lo=t,Ro=0,Fo=null,Uo=Mo=Do=0,Io=zo=null,null!==Tr){for(t=0;t<Tr.length;t++)if(null!==(a=(s=Tr[t]).interleaved)){s.interleaved=null;var n=a.next,r=s.pending;if(null!==r){var l=r.next;r.next=n,a.next=l}s.pending=a}Tr=null}return e}function fc(e,t){for(;;){var s=Ao;try{if(Cr(),al.current=Kl,cl){for(var a=ll.memoizedState;null!==a;){var n=a.queue;null!==n&&(n.pending=null),a=a.next}cl=!1}if(rl=0,ol=il=ll=null,dl=!1,ul=0,Co.current=null,null===s||null===s.return){Ro=1,Fo=t,Ao=null;break}e:{var l=e,i=s.return,o=s,c=t;if(t=To,o.flags|=32768,null!==c&&"object"===typeof c&&"function"===typeof c.then){var d=c,u=o,m=u.tag;if(0===(1&u.mode)&&(0===m||11===m||15===m)){var f=u.alternate;f?(u.updateQueue=f.updateQueue,u.memoizedState=f.memoizedState,u.lanes=f.lanes):(u.updateQueue=null,u.memoizedState=null)}var x=pi(i);if(null!==x){x.flags&=-257,hi(x,i,o,0,t),1&x.mode&&xi(l,d,t),c=d;var p=(t=x).updateQueue;if(null===p){var h=new Set;h.add(c),t.updateQueue=h}else p.add(c);break e}if(0===(1&t)){xi(l,d,t),pc();break e}c=Error(r(426))}else if(nr&&1&o.mode){var g=pi(i);if(null!==g){0===(65536&g.flags)&&(g.flags|=256),hi(g,i,o,0,t),xr(oi(c,o));break e}}l=c=oi(c,o),4!==Ro&&(Ro=2),null===zo?zo=[l]:zo.push(l),l=i;do{switch(l.tag){case 3:l.flags|=65536,t&=-t,l.lanes|=t,Gr(l,mi(0,c,t));break e;case 1:o=c;var y=l.type,b=l.stateNode;if(0===(128&l.flags)&&("function"===typeof y.getDerivedStateFromError||null!==b&&"function"===typeof b.componentDidCatch&&(null===Ho||!Ho.has(b)))){l.flags|=65536,t&=-t,l.lanes|=t,Gr(l,fi(l,o,t));break e}}l=l.return}while(null!==l)}vc(s)}catch(v){t=v,Ao===s&&null!==s&&(Ao=s=s.return);continue}break}}function xc(){var e=So.current;return So.current=Kl,null===e?Kl:e}function pc(){0!==Ro&&3!==Ro&&2!==Ro||(Ro=4),null===Po||0===(268435455&Do)&&0===(268435455&Mo)||ic(Po,To)}function hc(e,t){var s=Eo;Eo|=2;var a=xc();for(Po===e&&To===t||(Wo=null,mc(e,t));;)try{gc();break}catch(n){fc(e,n)}if(Cr(),Eo=s,So.current=a,null!==Ao)throw Error(r(261));return Po=null,To=0,Ro}function gc(){for(;null!==Ao;)bc(Ao)}function yc(){for(;null!==Ao&&!Je();)bc(Ao)}function bc(e){var t=No(e.alternate,e,Lo);e.memoizedProps=e.pendingProps,null===t?vc(e):Ao=t,Co.current=null}function vc(e){var t=e;do{var s=t.alternate;if(e=t.return,0===(32768&t.flags)){if(null!==(s=Hi(s,t,Lo)))return void(Ao=s)}else{if(null!==(s=Qi(s,t)))return s.flags&=32767,void(Ao=s);if(null===e)return Ro=6,void(Ao=null);e.flags|=32768,e.subtreeFlags=0,e.deletions=null}if(null!==(t=t.sibling))return void(Ao=t);Ao=t=e}while(null!==t);0===Ro&&(Ro=5)}function jc(e,t,s){var a=bt,n=_o.transition;try{_o.transition=null,bt=1,function(e,t,s,a){do{wc()}while(null!==$o);if(0!==(6&Eo))throw Error(r(327));s=e.finishedWork;var n=e.finishedLanes;if(null===s)return null;if(e.finishedWork=null,e.finishedLanes=0,s===e.current)throw Error(r(177));e.callbackNode=null,e.callbackPriority=0;var l=s.lanes|s.childLanes;if(function(e,t){var s=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var a=e.eventTimes;for(e=e.expirationTimes;0<s;){var n=31-lt(s),r=1<<n;t[n]=0,a[n]=-1,e[n]=-1,s&=~r}}(e,l),e===Po&&(Ao=Po=null,To=0),0===(2064&s.subtreeFlags)&&0===(2064&s.flags)||Qo||(Qo=!0,Pc(tt,function(){return wc(),null})),l=0!==(15990&s.flags),0!==(15990&s.subtreeFlags)||l){l=_o.transition,_o.transition=null;var i=bt;bt=1;var o=Eo;Eo|=4,Co.current=null,function(e,t){if(Za=qt,ma(e=ua())){if("selectionStart"in e)var s={start:e.selectionStart,end:e.selectionEnd};else e:{var a=(s=(s=e.ownerDocument)&&s.defaultView||window).getSelection&&s.getSelection();if(a&&0!==a.rangeCount){s=a.anchorNode;var n=a.anchorOffset,l=a.focusNode;a=a.focusOffset;try{s.nodeType,l.nodeType}catch(j){s=null;break e}var i=0,o=-1,c=-1,d=0,u=0,m=e,f=null;t:for(;;){for(var x;m!==s||0!==n&&3!==m.nodeType||(o=i+n),m!==l||0!==a&&3!==m.nodeType||(c=i+a),3===m.nodeType&&(i+=m.nodeValue.length),null!==(x=m.firstChild);)f=m,m=x;for(;;){if(m===e)break t;if(f===s&&++d===n&&(o=i),f===l&&++u===a&&(c=i),null!==(x=m.nextSibling))break;f=(m=f).parentNode}m=x}s=-1===o||-1===c?null:{start:o,end:c}}else s=null}s=s||{start:0,end:0}}else s=null;for(en={focusedElem:e,selectionRange:s},qt=!1,Ki=t;null!==Ki;)if(e=(t=Ki).child,0!==(1028&t.subtreeFlags)&&null!==e)e.return=t,Ki=e;else for(;null!==Ki;){t=Ki;try{var p=t.alternate;if(0!==(1024&t.flags))switch(t.tag){case 0:case 11:case 15:case 5:case 6:case 4:case 17:break;case 1:if(null!==p){var h=p.memoizedProps,g=p.memoizedState,y=t.stateNode,b=y.getSnapshotBeforeUpdate(t.elementType===t.type?h:ti(t.type,h),g);y.__reactInternalSnapshotBeforeUpdate=b}break;case 3:var v=t.stateNode.containerInfo;1===v.nodeType?v.textContent="":9===v.nodeType&&v.documentElement&&v.removeChild(v.documentElement);break;default:throw Error(r(163))}}catch(j){kc(t,t.return,j)}if(null!==(e=t.sibling)){e.return=t.return,Ki=e;break}Ki=t.return}p=eo,eo=!1}(e,s),ho(s,e),fa(en),qt=!!Za,en=Za=null,e.current=s,yo(s,e,n),Ye(),Eo=o,bt=i,_o.transition=l}else e.current=s;if(Qo&&(Qo=!1,$o=e,Jo=n),l=e.pendingLanes,0===l&&(Ho=null),function(e){if(rt&&"function"===typeof rt.onCommitFiberRoot)try{rt.onCommitFiberRoot(nt,e,void 0,128===(128&e.current.flags))}catch(t){}}(s.stateNode),ac(e,Ke()),null!==t)for(a=e.onRecoverableError,s=0;s<t.length;s++)n=t[s],a(n.value,{componentStack:n.stack,digest:n.digest});if(qo)throw qo=!1,e=Vo,Vo=null,e;0!==(1&Jo)&&0!==e.tag&&wc(),l=e.pendingLanes,0!==(1&l)?e===Ko?Yo++:(Yo=0,Ko=e):Yo=0,Bn()}(e,t,s,a)}finally{_o.transition=n,bt=a}return null}function wc(){if(null!==$o){var e=vt(Jo),t=_o.transition,s=bt;try{if(_o.transition=null,bt=16>e?16:e,null===$o)var a=!1;else{if(e=$o,$o=null,Jo=0,0!==(6&Eo))throw Error(r(331));var n=Eo;for(Eo|=4,Ki=e.current;null!==Ki;){var l=Ki,i=l.child;if(0!==(16&Ki.flags)){var o=l.deletions;if(null!==o){for(var c=0;c<o.length;c++){var d=o[c];for(Ki=d;null!==Ki;){var u=Ki;switch(u.tag){case 0:case 11:case 15:to(8,u,l)}var m=u.child;if(null!==m)m.return=u,Ki=m;else for(;null!==Ki;){var f=(u=Ki).sibling,x=u.return;if(no(u),u===d){Ki=null;break}if(null!==f){f.return=x,Ki=f;break}Ki=x}}}var p=l.alternate;if(null!==p){var h=p.child;if(null!==h){p.child=null;do{var g=h.sibling;h.sibling=null,h=g}while(null!==h)}}Ki=l}}if(0!==(2064&l.subtreeFlags)&&null!==i)i.return=l,Ki=i;else e:for(;null!==Ki;){if(0!==(2048&(l=Ki).flags))switch(l.tag){case 0:case 11:case 15:to(9,l,l.return)}var y=l.sibling;if(null!==y){y.return=l.return,Ki=y;break e}Ki=l.return}}var b=e.current;for(Ki=b;null!==Ki;){var v=(i=Ki).child;if(0!==(2064&i.subtreeFlags)&&null!==v)v.return=i,Ki=v;else e:for(i=b;null!==Ki;){if(0!==(2048&(o=Ki).flags))try{switch(o.tag){case 0:case 11:case 15:so(9,o)}}catch(w){kc(o,o.return,w)}if(o===i){Ki=null;break e}var j=o.sibling;if(null!==j){j.return=o.return,Ki=j;break e}Ki=o.return}}if(Eo=n,Bn(),rt&&"function"===typeof rt.onPostCommitFiberRoot)try{rt.onPostCommitFiberRoot(nt,e)}catch(w){}a=!0}return a}finally{bt=s,_o.transition=t}}return!1}function Nc(e,t,s){e=zr(e,t=mi(0,t=oi(s,t),1),1),t=ec(),null!==e&&(gt(e,1,t),ac(e,t))}function kc(e,t,s){if(3===e.tag)Nc(e,e,s);else for(;null!==t;){if(3===t.tag){Nc(t,e,s);break}if(1===t.tag){var a=t.stateNode;if("function"===typeof t.type.getDerivedStateFromError||"function"===typeof a.componentDidCatch&&(null===Ho||!Ho.has(a))){t=zr(t,e=fi(t,e=oi(s,e),1),1),e=ec(),null!==t&&(gt(t,1,e),ac(t,e));break}}t=t.return}}function Sc(e,t,s){var a=e.pingCache;null!==a&&a.delete(t),t=ec(),e.pingedLanes|=e.suspendedLanes&s,Po===e&&(To&s)===s&&(4===Ro||3===Ro&&(130023424&To)===To&&500>Ke()-Go?mc(e,0):Uo|=s),ac(e,t)}function Cc(e,t){0===t&&(0===(1&e.mode)?t=1:(t=dt,0===(130023424&(dt<<=1))&&(dt=4194304)));var s=ec();null!==(e=Rr(e,t))&&(gt(e,t,s),ac(e,s))}function _c(e){var t=e.memoizedState,s=0;null!==t&&(s=t.retryLane),Cc(e,s)}function Ec(e,t){var s=0;switch(e.tag){case 13:var a=e.stateNode,n=e.memoizedState;null!==n&&(s=n.retryLane);break;case 19:a=e.stateNode;break;default:throw Error(r(314))}null!==a&&a.delete(t),Cc(e,s)}function Pc(e,t){return Qe(e,t)}function Ac(e,t,s,a){this.tag=e,this.key=s,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=a,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function Tc(e,t,s,a){return new Ac(e,t,s,a)}function Lc(e){return!(!(e=e.prototype)||!e.isReactComponent)}function Oc(e,t){var s=e.alternate;return null===s?((s=Tc(e.tag,t,e.key,e.mode)).elementType=e.elementType,s.type=e.type,s.stateNode=e.stateNode,s.alternate=e,e.alternate=s):(s.pendingProps=t,s.type=e.type,s.flags=0,s.subtreeFlags=0,s.deletions=null),s.flags=14680064&e.flags,s.childLanes=e.childLanes,s.lanes=e.lanes,s.child=e.child,s.memoizedProps=e.memoizedProps,s.memoizedState=e.memoizedState,s.updateQueue=e.updateQueue,t=e.dependencies,s.dependencies=null===t?null:{lanes:t.lanes,firstContext:t.firstContext},s.sibling=e.sibling,s.index=e.index,s.ref=e.ref,s}function Rc(e,t,s,a,n,l){var i=2;if(a=e,"function"===typeof e)Lc(e)&&(i=1);else if("string"===typeof e)i=5;else e:switch(e){case N:return Fc(s.children,n,l,t);case k:i=8,n|=8;break;case S:return(e=Tc(12,s,t,2|n)).elementType=S,e.lanes=l,e;case P:return(e=Tc(13,s,t,n)).elementType=P,e.lanes=l,e;case A:return(e=Tc(19,s,t,n)).elementType=A,e.lanes=l,e;case O:return Dc(s,n,l,t);default:if("object"===typeof e&&null!==e)switch(e.$$typeof){case C:i=10;break e;case _:i=9;break e;case E:i=11;break e;case T:i=14;break e;case L:i=16,a=null;break e}throw Error(r(130,null==e?e:typeof e,""))}return(t=Tc(i,s,t,n)).elementType=e,t.type=a,t.lanes=l,t}function Fc(e,t,s,a){return(e=Tc(7,e,a,t)).lanes=s,e}function Dc(e,t,s,a){return(e=Tc(22,e,a,t)).elementType=O,e.lanes=s,e.stateNode={isHidden:!1},e}function Mc(e,t,s){return(e=Tc(6,e,null,t)).lanes=s,e}function Uc(e,t,s){return(t=Tc(4,null!==e.children?e.children:[],e.key,t)).lanes=s,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function zc(e,t,s,a,n){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=ht(0),this.expirationTimes=ht(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=ht(0),this.identifierPrefix=a,this.onRecoverableError=n,this.mutableSourceEagerHydrationData=null}function Ic(e,t,s,a,n,r,l,i,o){return e=new zc(e,t,s,i,o),1===t?(t=1,!0===r&&(t|=8)):t=0,r=Tc(3,null,null,t),e.current=r,r.stateNode=e,r.memoizedState={element:a,isDehydrated:s,cache:null,transitions:null,pendingSuspenseBoundaries:null},Dr(r),e}function Gc(e){if(!e)return _n;e:{if(Be(e=e._reactInternals)!==e||1!==e.tag)throw Error(r(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(Ln(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(null!==t);throw Error(r(171))}if(1===e.tag){var s=e.type;if(Ln(s))return Fn(e,s,t)}return t}function Bc(e,t,s,a,n,r,l,i,o){return(e=Ic(s,a,!0,e,0,r,0,i,o)).context=Gc(null),s=e.current,(r=Ur(a=ec(),n=tc(s))).callback=void 0!==t&&null!==t?t:null,zr(s,r,n),e.current.lanes=n,gt(e,n,a),ac(e,a),e}function Wc(e,t,s,a){var n=t.current,r=ec(),l=tc(n);return s=Gc(s),null===t.context?t.context=s:t.pendingContext=s,(t=Ur(r,l)).payload={element:e},null!==(a=void 0===a?null:a)&&(t.callback=a),null!==(e=zr(n,t,l))&&(sc(e,n,l,r),Ir(e,n,l)),l}function qc(e){return(e=e.current).child?(e.child.tag,e.child.stateNode):null}function Vc(e,t){if(null!==(e=e.memoizedState)&&null!==e.dehydrated){var s=e.retryLane;e.retryLane=0!==s&&s<t?s:t}}function Hc(e,t){Vc(e,t),(e=e.alternate)&&Vc(e,t)}No=function(e,t,s){if(null!==e)if(e.memoizedProps!==t.pendingProps||Pn.current)yi=!0;else{if(0===(e.lanes&s)&&0===(128&t.flags))return yi=!1,function(e,t,s){switch(t.tag){case 3:Ei(t),fr();break;case 5:Kr(t);break;case 1:Ln(t.type)&&Dn(t);break;case 4:Jr(t,t.stateNode.containerInfo);break;case 10:var a=t.type._context,n=t.memoizedProps.value;Cn(wr,a._currentValue),a._currentValue=n;break;case 13:if(null!==(a=t.memoizedState))return null!==a.dehydrated?(Cn(Zr,1&Zr.current),t.flags|=128,null):0!==(s&t.child.childLanes)?Di(e,t,s):(Cn(Zr,1&Zr.current),null!==(e=Wi(e,t,s))?e.sibling:null);Cn(Zr,1&Zr.current);break;case 19:if(a=0!==(s&t.childLanes),0!==(128&e.flags)){if(a)return Gi(e,t,s);t.flags|=128}if(null!==(n=t.memoizedState)&&(n.rendering=null,n.tail=null,n.lastEffect=null),Cn(Zr,Zr.current),a)break;return null;case 22:case 23:return t.lanes=0,Ni(e,t,s)}return Wi(e,t,s)}(e,t,s);yi=0!==(131072&e.flags)}else yi=!1,nr&&0!==(1048576&t.flags)&&Zn(t,Hn,t.index);switch(t.lanes=0,t.tag){case 2:var a=t.type;Bi(e,t),e=t.pendingProps;var n=Tn(t,En.current);Pr(t,s),n=pl(null,t,a,e,n,s);var l=hl();return t.flags|=1,"object"===typeof n&&null!==n&&"function"===typeof n.render&&void 0===n.$$typeof?(t.tag=1,t.memoizedState=null,t.updateQueue=null,Ln(a)?(l=!0,Dn(t)):l=!1,t.memoizedState=null!==n.state&&void 0!==n.state?n.state:null,Dr(t),n.updater=ai,t.stateNode=n,n._reactInternals=t,ii(t,a,e,s),t=_i(null,t,a,!0,l,s)):(t.tag=0,nr&&l&&er(t),bi(null,t,n,s),t=t.child),t;case 16:a=t.elementType;e:{switch(Bi(e,t),e=t.pendingProps,a=(n=a._init)(a._payload),t.type=a,n=t.tag=function(e){if("function"===typeof e)return Lc(e)?1:0;if(void 0!==e&&null!==e){if((e=e.$$typeof)===E)return 11;if(e===T)return 14}return 2}(a),e=ti(a,e),n){case 0:t=Si(null,t,a,e,s);break e;case 1:t=Ci(null,t,a,e,s);break e;case 11:t=vi(null,t,a,e,s);break e;case 14:t=ji(null,t,a,ti(a.type,e),s);break e}throw Error(r(306,a,""))}return t;case 0:return a=t.type,n=t.pendingProps,Si(e,t,a,n=t.elementType===a?n:ti(a,n),s);case 1:return a=t.type,n=t.pendingProps,Ci(e,t,a,n=t.elementType===a?n:ti(a,n),s);case 3:e:{if(Ei(t),null===e)throw Error(r(387));a=t.pendingProps,n=(l=t.memoizedState).element,Mr(e,t),Br(t,a,null,s);var i=t.memoizedState;if(a=i.element,l.isDehydrated){if(l={element:a,isDehydrated:!1,cache:i.cache,pendingSuspenseBoundaries:i.pendingSuspenseBoundaries,transitions:i.transitions},t.updateQueue.baseState=l,t.memoizedState=l,256&t.flags){t=Pi(e,t,a,s,n=oi(Error(r(423)),t));break e}if(a!==n){t=Pi(e,t,a,s,n=oi(Error(r(424)),t));break e}for(ar=cn(t.stateNode.containerInfo.firstChild),sr=t,nr=!0,rr=null,s=jr(t,null,a,s),t.child=s;s;)s.flags=-3&s.flags|4096,s=s.sibling}else{if(fr(),a===n){t=Wi(e,t,s);break e}bi(e,t,a,s)}t=t.child}return t;case 5:return Kr(t),null===e&&cr(t),a=t.type,n=t.pendingProps,l=null!==e?e.memoizedProps:null,i=n.children,tn(a,n)?i=null:null!==l&&tn(a,l)&&(t.flags|=32),ki(e,t),bi(e,t,i,s),t.child;case 6:return null===e&&cr(t),null;case 13:return Di(e,t,s);case 4:return Jr(t,t.stateNode.containerInfo),a=t.pendingProps,null===e?t.child=vr(t,null,a,s):bi(e,t,a,s),t.child;case 11:return a=t.type,n=t.pendingProps,vi(e,t,a,n=t.elementType===a?n:ti(a,n),s);case 7:return bi(e,t,t.pendingProps,s),t.child;case 8:case 12:return bi(e,t,t.pendingProps.children,s),t.child;case 10:e:{if(a=t.type._context,n=t.pendingProps,l=t.memoizedProps,i=n.value,Cn(wr,a._currentValue),a._currentValue=i,null!==l)if(la(l.value,i)){if(l.children===n.children&&!Pn.current){t=Wi(e,t,s);break e}}else for(null!==(l=t.child)&&(l.return=t);null!==l;){var o=l.dependencies;if(null!==o){i=l.child;for(var c=o.firstContext;null!==c;){if(c.context===a){if(1===l.tag){(c=Ur(-1,s&-s)).tag=2;var d=l.updateQueue;if(null!==d){var u=(d=d.shared).pending;null===u?c.next=c:(c.next=u.next,u.next=c),d.pending=c}}l.lanes|=s,null!==(c=l.alternate)&&(c.lanes|=s),Er(l.return,s,t),o.lanes|=s;break}c=c.next}}else if(10===l.tag)i=l.type===t.type?null:l.child;else if(18===l.tag){if(null===(i=l.return))throw Error(r(341));i.lanes|=s,null!==(o=i.alternate)&&(o.lanes|=s),Er(i,s,t),i=l.sibling}else i=l.child;if(null!==i)i.return=l;else for(i=l;null!==i;){if(i===t){i=null;break}if(null!==(l=i.sibling)){l.return=i.return,i=l;break}i=i.return}l=i}bi(e,t,n.children,s),t=t.child}return t;case 9:return n=t.type,a=t.pendingProps.children,Pr(t,s),a=a(n=Ar(n)),t.flags|=1,bi(e,t,a,s),t.child;case 14:return n=ti(a=t.type,t.pendingProps),ji(e,t,a,n=ti(a.type,n),s);case 15:return wi(e,t,t.type,t.pendingProps,s);case 17:return a=t.type,n=t.pendingProps,n=t.elementType===a?n:ti(a,n),Bi(e,t),t.tag=1,Ln(a)?(e=!0,Dn(t)):e=!1,Pr(t,s),ri(t,a,n),ii(t,a,n,s),_i(null,t,a,!0,e,s);case 19:return Gi(e,t,s);case 22:return Ni(e,t,s)}throw Error(r(156,t.tag))};var Qc="function"===typeof reportError?reportError:function(e){console.error(e)};function $c(e){this._internalRoot=e}function Jc(e){this._internalRoot=e}function Yc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType)}function Kc(e){return!(!e||1!==e.nodeType&&9!==e.nodeType&&11!==e.nodeType&&(8!==e.nodeType||" react-mount-point-unstable "!==e.nodeValue))}function Xc(){}function Zc(e,t,s,a,n){var r=s._reactRootContainer;if(r){var l=r;if("function"===typeof n){var i=n;n=function(){var e=qc(l);i.call(e)}}Wc(t,l,e,n)}else l=function(e,t,s,a,n){if(n){if("function"===typeof a){var r=a;a=function(){var e=qc(l);r.call(e)}}var l=Bc(t,a,e,0,null,!1,0,"",Xc);return e._reactRootContainer=l,e[xn]=l.current,Ga(8===e.nodeType?e.parentNode:e),dc(),l}for(;n=e.lastChild;)e.removeChild(n);if("function"===typeof a){var i=a;a=function(){var e=qc(o);i.call(e)}}var o=Ic(e,0,!1,null,0,!1,0,"",Xc);return e._reactRootContainer=o,e[xn]=o.current,Ga(8===e.nodeType?e.parentNode:e),dc(function(){Wc(t,o,s,a)}),o}(s,t,e,n,a);return qc(l)}Jc.prototype.render=$c.prototype.render=function(e){var t=this._internalRoot;if(null===t)throw Error(r(409));Wc(e,t,null,null)},Jc.prototype.unmount=$c.prototype.unmount=function(){var e=this._internalRoot;if(null!==e){this._internalRoot=null;var t=e.containerInfo;dc(function(){Wc(null,e,null,null)}),t[xn]=null}},Jc.prototype.unstable_scheduleHydration=function(e){if(e){var t=kt();e={blockedOn:null,target:e,priority:t};for(var s=0;s<Ot.length&&0!==t&&t<Ot[s].priority;s++);Ot.splice(s,0,e),0===s&&Mt(e)}},jt=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var s=ut(t.pendingLanes);0!==s&&(yt(t,1|s),ac(t,Ke()),0===(6&Eo)&&(Bo=Ke()+500,Bn()))}break;case 13:dc(function(){var t=Rr(e,1);if(null!==t){var s=ec();sc(t,e,1,s)}}),Hc(e,1)}},wt=function(e){if(13===e.tag){var t=Rr(e,134217728);if(null!==t)sc(t,e,134217728,ec());Hc(e,134217728)}},Nt=function(e){if(13===e.tag){var t=tc(e),s=Rr(e,t);if(null!==s)sc(s,e,t,ec());Hc(e,t)}},kt=function(){return bt},St=function(e,t){var s=bt;try{return bt=e,t()}finally{bt=s}},we=function(e,t,s){switch(t){case"input":if(X(e,s),t=s.name,"radio"===s.type&&null!=t){for(s=e;s.parentNode;)s=s.parentNode;for(s=s.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<s.length;t++){var a=s[t];if(a!==e&&a.form===e.form){var n=jn(a);if(!n)throw Error(r(90));Q(a),X(a,n)}}}break;case"textarea":re(e,s);break;case"select":null!=(t=s.value)&&se(e,!!s.multiple,t,!1)}},Ee=cc,Pe=dc;var ed={usingClientEntryPoint:!1,Events:[bn,vn,jn,Ce,_e,cc]},td={findFiberByHostInstance:yn,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},sd={bundleType:td.bundleType,version:td.version,rendererPackageName:td.rendererPackageName,rendererConfig:td.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:v.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return null===(e=Ve(e))?null:e.stateNode},findFiberByHostInstance:td.findFiberByHostInstance||function(){return null},findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__){var ad=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!ad.isDisabled&&ad.supportsFiber)try{nt=ad.inject(sd),rt=ad}catch(de){}}t.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=ed,t.createPortal=function(e,t){var s=2<arguments.length&&void 0!==arguments[2]?arguments[2]:null;if(!Yc(t))throw Error(r(200));return function(e,t,s){var a=3<arguments.length&&void 0!==arguments[3]?arguments[3]:null;return{$$typeof:w,key:null==a?null:""+a,children:e,containerInfo:t,implementation:s}}(e,t,null,s)},t.createRoot=function(e,t){if(!Yc(e))throw Error(r(299));var s=!1,a="",n=Qc;return null!==t&&void 0!==t&&(!0===t.unstable_strictMode&&(s=!0),void 0!==t.identifierPrefix&&(a=t.identifierPrefix),void 0!==t.onRecoverableError&&(n=t.onRecoverableError)),t=Ic(e,1,!1,null,0,s,0,a,n),e[xn]=t.current,Ga(8===e.nodeType?e.parentNode:e),new $c(t)},t.findDOMNode=function(e){if(null==e)return null;if(1===e.nodeType)return e;var t=e._reactInternals;if(void 0===t){if("function"===typeof e.render)throw Error(r(188));throw e=Object.keys(e).join(","),Error(r(268,e))}return e=null===(e=Ve(t))?null:e.stateNode},t.flushSync=function(e){return dc(e)},t.hydrate=function(e,t,s){if(!Kc(t))throw Error(r(200));return Zc(null,e,t,!0,s)},t.hydrateRoot=function(e,t,s){if(!Yc(e))throw Error(r(405));var a=null!=s&&s.hydratedSources||null,n=!1,l="",i=Qc;if(null!==s&&void 0!==s&&(!0===s.unstable_strictMode&&(n=!0),void 0!==s.identifierPrefix&&(l=s.identifierPrefix),void 0!==s.onRecoverableError&&(i=s.onRecoverableError)),t=Bc(t,null,e,1,null!=s?s:null,n,0,l,i),e[xn]=t.current,Ga(e),a)for(e=0;e<a.length;e++)n=(n=(s=a[e])._getVersion)(s._source),null==t.mutableSourceEagerHydrationData?t.mutableSourceEagerHydrationData=[s,n]:t.mutableSourceEagerHydrationData.push(s,n);return new Jc(t)},t.render=function(e,t,s){if(!Kc(t))throw Error(r(200));return Zc(null,e,t,!1,s)},t.unmountComponentAtNode=function(e){if(!Kc(e))throw Error(r(40));return!!e._reactRootContainer&&(dc(function(){Zc(null,null,e,!1,function(){e._reactRootContainer=null,e[xn]=null})}),!0)},t.unstable_batchedUpdates=cc,t.unstable_renderSubtreeIntoContainer=function(e,t,s,a){if(!Kc(s))throw Error(r(200));if(null==e||void 0===e._reactInternals)throw Error(r(38));return Zc(e,t,s,!1,a)},t.version="18.3.1-next-f1338f8080-20240426"},853:(e,t,s)=>{e.exports=s(234)},950:(e,t,s)=>{!function e(){if("undefined"!==typeof __REACT_DEVTOOLS_GLOBAL_HOOK__&&"function"===typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE)try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(e)}catch(t){console.error(t)}}(),e.exports=s(730)}},t={};function s(a){var n=t[a];if(void 0!==n)return n.exports;var r=t[a]={exports:{}};return e[a](r,r.exports,s),r.exports}(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;s.t=function(a,n){if(1&n&&(a=this(a)),8&n)return a;if("object"===typeof a&&a){if(4&n&&a.__esModule)return a;if(16&n&&"function"===typeof a.then)return a}var r=Object.create(null);s.r(r);var l={};e=e||[null,t({}),t([]),t(t)];for(var i=2&n&&a;("object"==typeof i||"function"==typeof i)&&!~e.indexOf(i);i=t(i))Object.getOwnPropertyNames(i).forEach(e=>l[e]=()=>a[e]);return l.default=()=>a,s.d(r,l),r}})(),s.d=(e,t)=>{for(var a in t)s.o(t,a)&&!s.o(e,a)&&Object.defineProperty(e,a,{enumerable:!0,get:t[a]})},s.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),s.r=e=>{"undefined"!==typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})};var a={};s.r(a),s.d(a,{hasBrowserEnv:()=>Jt,hasStandardBrowserEnv:()=>Kt,hasStandardBrowserWebWorkerEnv:()=>Xt,navigator:()=>Yt,origin:()=>Zt});var n,r=s(43),l=s.t(r,2),i=s(391),o=s(950),c=s.t(o,2);function d(){return d=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},d.apply(this,arguments)}!function(e){e.Pop="POP",e.Push="PUSH",e.Replace="REPLACE"}(n||(n={}));const u="popstate";function m(e,t){if(!1===e||null===e||"undefined"===typeof e)throw new Error(t)}function f(e,t){if(!e){"undefined"!==typeof console&&console.warn(t);try{throw new Error(t)}catch(s){}}}function x(e,t){return{usr:e.state,key:e.key,idx:t}}function p(e,t,s,a){return void 0===s&&(s=null),d({pathname:"string"===typeof e?e:e.pathname,search:"",hash:""},"string"===typeof t?g(t):t,{state:s,key:t&&t.key||a||Math.random().toString(36).substr(2,8)})}function h(e){let{pathname:t="/",search:s="",hash:a=""}=e;return s&&"?"!==s&&(t+="?"===s.charAt(0)?s:"?"+s),a&&"#"!==a&&(t+="#"===a.charAt(0)?a:"#"+a),t}function g(e){let t={};if(e){let s=e.indexOf("#");s>=0&&(t.hash=e.substr(s),e=e.substr(0,s));let a=e.indexOf("?");a>=0&&(t.search=e.substr(a),e=e.substr(0,a)),e&&(t.pathname=e)}return t}function y(e,t,s,a){void 0===a&&(a={});let{window:r=document.defaultView,v5Compat:l=!1}=a,i=r.history,o=n.Pop,c=null,f=g();function g(){return(i.state||{idx:null}).idx}function y(){o=n.Pop;let e=g(),t=null==e?null:e-f;f=e,c&&c({action:o,location:v.location,delta:t})}function b(e){let t="null"!==r.location.origin?r.location.origin:r.location.href,s="string"===typeof e?e:h(e);return s=s.replace(/ $/,"%20"),m(t,"No window.location.(origin|href) available to create URL for href: "+s),new URL(s,t)}null==f&&(f=0,i.replaceState(d({},i.state,{idx:f}),""));let v={get action(){return o},get location(){return e(r,i)},listen(e){if(c)throw new Error("A history only accepts one active listener");return r.addEventListener(u,y),c=e,()=>{r.removeEventListener(u,y),c=null}},createHref:e=>t(r,e),createURL:b,encodeLocation(e){let t=b(e);return{pathname:t.pathname,search:t.search,hash:t.hash}},push:function(e,t){o=n.Push;let a=p(v.location,e,t);s&&s(a,e),f=g()+1;let d=x(a,f),u=v.createHref(a);try{i.pushState(d,"",u)}catch(m){if(m instanceof DOMException&&"DataCloneError"===m.name)throw m;r.location.assign(u)}l&&c&&c({action:o,location:v.location,delta:1})},replace:function(e,t){o=n.Replace;let a=p(v.location,e,t);s&&s(a,e),f=g();let r=x(a,f),d=v.createHref(a);i.replaceState(r,"",d),l&&c&&c({action:o,location:v.location,delta:0})},go:e=>i.go(e)};return v}var b;!function(e){e.data="data",e.deferred="deferred",e.redirect="redirect",e.error="error"}(b||(b={}));new Set(["lazy","caseSensitive","path","id","index","children"]);function v(e,t,s){return void 0===s&&(s="/"),j(e,t,s,!1)}function j(e,t,s,a){let n=F(("string"===typeof t?g(t):t).pathname||"/",s);if(null==n)return null;let r=w(e);!function(e){e.sort((e,t)=>e.score!==t.score?t.score-e.score:function(e,t){let s=e.length===t.length&&e.slice(0,-1).every((e,s)=>e===t[s]);return s?e[e.length-1]-t[t.length-1]:0}(e.routesMeta.map(e=>e.childrenIndex),t.routesMeta.map(e=>e.childrenIndex)))}(r);let l=null;for(let i=0;null==l&&i<r.length;++i){let e=R(n);l=L(r[i],e,a)}return l}function w(e,t,s,a){void 0===t&&(t=[]),void 0===s&&(s=[]),void 0===a&&(a="");let n=(e,n,r)=>{let l={relativePath:void 0===r?e.path||"":r,caseSensitive:!0===e.caseSensitive,childrenIndex:n,route:e};l.relativePath.startsWith("/")&&(m(l.relativePath.startsWith(a),'Absolute route path "'+l.relativePath+'" nested under path "'+a+'" is not valid. An absolute child route path must start with the combined path of all its parent routes.'),l.relativePath=l.relativePath.slice(a.length));let i=I([a,l.relativePath]),o=s.concat(l);e.children&&e.children.length>0&&(m(!0!==e.index,'Index routes must not have child routes. Please remove all child routes from route path "'+i+'".'),w(e.children,t,o,i)),(null!=e.path||e.index)&&t.push({path:i,score:T(i,e.index),routesMeta:o})};return e.forEach((e,t)=>{var s;if(""!==e.path&&null!=(s=e.path)&&s.includes("?"))for(let a of N(e.path))n(e,t,a);else n(e,t)}),t}function N(e){let t=e.split("/");if(0===t.length)return[];let[s,...a]=t,n=s.endsWith("?"),r=s.replace(/\?$/,"");if(0===a.length)return n?[r,""]:[r];let l=N(a.join("/")),i=[];return i.push(...l.map(e=>""===e?r:[r,e].join("/"))),n&&i.push(...l),i.map(t=>e.startsWith("/")&&""===t?"/":t)}const k=/^:[\w-]+$/,S=3,C=2,_=1,E=10,P=-2,A=e=>"*"===e;function T(e,t){let s=e.split("/"),a=s.length;return s.some(A)&&(a+=P),t&&(a+=C),s.filter(e=>!A(e)).reduce((e,t)=>e+(k.test(t)?S:""===t?_:E),a)}function L(e,t,s){void 0===s&&(s=!1);let{routesMeta:a}=e,n={},r="/",l=[];for(let i=0;i<a.length;++i){let e=a[i],o=i===a.length-1,c="/"===r?t:t.slice(r.length)||"/",d=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:o},c),u=e.route;if(!d&&o&&s&&!a[a.length-1].route.index&&(d=O({path:e.relativePath,caseSensitive:e.caseSensitive,end:!1},c)),!d)return null;Object.assign(n,d.params),l.push({params:n,pathname:I([r,d.pathname]),pathnameBase:G(I([r,d.pathnameBase])),route:u}),"/"!==d.pathnameBase&&(r=I([r,d.pathnameBase]))}return l}function O(e,t){"string"===typeof e&&(e={path:e,caseSensitive:!1,end:!0});let[s,a]=function(e,t,s){void 0===t&&(t=!1);void 0===s&&(s=!0);f("*"===e||!e.endsWith("*")||e.endsWith("/*"),'Route path "'+e+'" will be treated as if it were "'+e.replace(/\*$/,"/*")+'" because the `*` character must always follow a `/` in the pattern. To get rid of this warning, please change the route path to "'+e.replace(/\*$/,"/*")+'".');let a=[],n="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(e,t,s)=>(a.push({paramName:t,isOptional:null!=s}),s?"/?([^\\/]+)?":"/([^\\/]+)"));e.endsWith("*")?(a.push({paramName:"*"}),n+="*"===e||"/*"===e?"(.*)$":"(?:\\/(.+)|\\/*)$"):s?n+="\\/*$":""!==e&&"/"!==e&&(n+="(?:(?=\\/|$))");let r=new RegExp(n,t?void 0:"i");return[r,a]}(e.path,e.caseSensitive,e.end),n=t.match(s);if(!n)return null;let r=n[0],l=r.replace(/(.)\/+$/,"$1"),i=n.slice(1);return{params:a.reduce((e,t,s)=>{let{paramName:a,isOptional:n}=t;if("*"===a){let e=i[s]||"";l=r.slice(0,r.length-e.length).replace(/(.)\/+$/,"$1")}const o=i[s];return e[a]=n&&!o?void 0:(o||"").replace(/%2F/g,"/"),e},{}),pathname:r,pathnameBase:l,pattern:e}}function R(e){try{return e.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(t){return f(!1,'The URL path "'+e+'" could not be decoded because it is is a malformed URL segment. This is probably due to a bad percent encoding ('+t+")."),e}}function F(e,t){if("/"===t)return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let s=t.endsWith("/")?t.length-1:t.length,a=e.charAt(s);return a&&"/"!==a?null:e.slice(s)||"/"}function D(e,t,s,a){return"Cannot include a '"+e+"' character in a manually specified `to."+t+"` field ["+JSON.stringify(a)+"].  Please separate it out to the `to."+s+'` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.'}function M(e){return e.filter((e,t)=>0===t||e.route.path&&e.route.path.length>0)}function U(e,t){let s=M(e);return t?s.map((e,t)=>t===s.length-1?e.pathname:e.pathnameBase):s.map(e=>e.pathnameBase)}function z(e,t,s,a){let n;void 0===a&&(a=!1),"string"===typeof e?n=g(e):(n=d({},e),m(!n.pathname||!n.pathname.includes("?"),D("?","pathname","search",n)),m(!n.pathname||!n.pathname.includes("#"),D("#","pathname","hash",n)),m(!n.search||!n.search.includes("#"),D("#","search","hash",n)));let r,l=""===e||""===n.pathname,i=l?"/":n.pathname;if(null==i)r=s;else{let e=t.length-1;if(!a&&i.startsWith("..")){let t=i.split("/");for(;".."===t[0];)t.shift(),e-=1;n.pathname=t.join("/")}r=e>=0?t[e]:"/"}let o=function(e,t){void 0===t&&(t="/");let{pathname:s,search:a="",hash:n=""}="string"===typeof e?g(e):e,r=s?s.startsWith("/")?s:function(e,t){let s=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(e=>{".."===e?s.length>1&&s.pop():"."!==e&&s.push(e)}),s.length>1?s.join("/"):"/"}(s,t):t;return{pathname:r,search:B(a),hash:W(n)}}(n,r),c=i&&"/"!==i&&i.endsWith("/"),u=(l||"."===i)&&s.endsWith("/");return o.pathname.endsWith("/")||!c&&!u||(o.pathname+="/"),o}const I=e=>e.join("/").replace(/\/\/+/g,"/"),G=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),B=e=>e&&"?"!==e?e.startsWith("?")?e:"?"+e:"",W=e=>e&&"#"!==e?e.startsWith("#")?e:"#"+e:"";Error;function q(e){return null!=e&&"number"===typeof e.status&&"string"===typeof e.statusText&&"boolean"===typeof e.internal&&"data"in e}const V=["post","put","patch","delete"],H=(new Set(V),["get",...V]);new Set(H),new Set([301,302,303,307,308]),new Set([307,308]);Symbol("deferred");function Q(){return Q=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Q.apply(this,arguments)}const $=r.createContext(null);const J=r.createContext(null);const Y=r.createContext(null);const K=r.createContext(null);const X=r.createContext({outlet:null,matches:[],isDataRoute:!1});const Z=r.createContext(null);function ee(){return null!=r.useContext(K)}function te(){return ee()||m(!1),r.useContext(K).location}function se(e){r.useContext(Y).static||r.useLayoutEffect(e)}function ae(){let{isDataRoute:e}=r.useContext(X);return e?function(){let{router:e}=fe(ue.UseNavigateStable),t=pe(me.UseNavigateStable),s=r.useRef(!1);return se(()=>{s.current=!0}),r.useCallback(function(a,n){void 0===n&&(n={}),s.current&&("number"===typeof a?e.navigate(a):e.navigate(a,Q({fromRouteId:t},n)))},[e,t])}():function(){ee()||m(!1);let e=r.useContext($),{basename:t,future:s,navigator:a}=r.useContext(Y),{matches:n}=r.useContext(X),{pathname:l}=te(),i=JSON.stringify(U(n,s.v7_relativeSplatPath)),o=r.useRef(!1);return se(()=>{o.current=!0}),r.useCallback(function(s,n){if(void 0===n&&(n={}),!o.current)return;if("number"===typeof s)return void a.go(s);let r=z(s,JSON.parse(i),l,"path"===n.relative);null==e&&"/"!==t&&(r.pathname="/"===r.pathname?t:I([t,r.pathname])),(n.replace?a.replace:a.push)(r,n.state,n)},[t,a,i,l,e])}()}function ne(e,t){let{relative:s}=void 0===t?{}:t,{future:a}=r.useContext(Y),{matches:n}=r.useContext(X),{pathname:l}=te(),i=JSON.stringify(U(n,a.v7_relativeSplatPath));return r.useMemo(()=>z(e,JSON.parse(i),l,"path"===s),[e,i,l,s])}function re(e,t,s,a){ee()||m(!1);let{navigator:l}=r.useContext(Y),{matches:i}=r.useContext(X),o=i[i.length-1],c=o?o.params:{},d=(o&&o.pathname,o?o.pathnameBase:"/");o&&o.route;let u,f=te();if(t){var x;let e="string"===typeof t?g(t):t;"/"===d||(null==(x=e.pathname)?void 0:x.startsWith(d))||m(!1),u=e}else u=f;let p=u.pathname||"/",h=p;if("/"!==d){let e=d.replace(/^\//,"").split("/");h="/"+p.replace(/^\//,"").split("/").slice(e.length).join("/")}let y=v(e,{pathname:h});let b=de(y&&y.map(e=>Object.assign({},e,{params:Object.assign({},c,e.params),pathname:I([d,l.encodeLocation?l.encodeLocation(e.pathname).pathname:e.pathname]),pathnameBase:"/"===e.pathnameBase?d:I([d,l.encodeLocation?l.encodeLocation(e.pathnameBase).pathname:e.pathnameBase])})),i,s,a);return t&&b?r.createElement(K.Provider,{value:{location:Q({pathname:"/",search:"",hash:"",state:null,key:"default"},u),navigationType:n.Pop}},b):b}function le(){let e=function(){var e;let t=r.useContext(Z),s=xe(me.UseRouteError),a=pe(me.UseRouteError);if(void 0!==t)return t;return null==(e=s.errors)?void 0:e[a]}(),t=q(e)?e.status+" "+e.statusText:e instanceof Error?e.message:JSON.stringify(e),s=e instanceof Error?e.stack:null,a="rgba(200,200,200, 0.5)",n={padding:"0.5rem",backgroundColor:a};return r.createElement(r.Fragment,null,r.createElement("h2",null,"Unexpected Application Error!"),r.createElement("h3",{style:{fontStyle:"italic"}},t),s?r.createElement("pre",{style:n},s):null,null)}const ie=r.createElement(le,null);class oe extends r.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||"idle"!==t.revalidation&&"idle"===e.revalidation?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:void 0!==e.error?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return void 0!==this.state.error?r.createElement(X.Provider,{value:this.props.routeContext},r.createElement(Z.Provider,{value:this.state.error,children:this.props.component})):this.props.children}}function ce(e){let{routeContext:t,match:s,children:a}=e,n=r.useContext($);return n&&n.static&&n.staticContext&&(s.route.errorElement||s.route.ErrorBoundary)&&(n.staticContext._deepestRenderedBoundaryId=s.route.id),r.createElement(X.Provider,{value:t},a)}function de(e,t,s,a){var n;if(void 0===t&&(t=[]),void 0===s&&(s=null),void 0===a&&(a=null),null==e){var l;if(!s)return null;if(s.errors)e=s.matches;else{if(!(null!=(l=a)&&l.v7_partialHydration&&0===t.length&&!s.initialized&&s.matches.length>0))return null;e=s.matches}}let i=e,o=null==(n=s)?void 0:n.errors;if(null!=o){let e=i.findIndex(e=>e.route.id&&void 0!==(null==o?void 0:o[e.route.id]));e>=0||m(!1),i=i.slice(0,Math.min(i.length,e+1))}let c=!1,d=-1;if(s&&a&&a.v7_partialHydration)for(let r=0;r<i.length;r++){let e=i[r];if((e.route.HydrateFallback||e.route.hydrateFallbackElement)&&(d=r),e.route.id){let{loaderData:t,errors:a}=s,n=e.route.loader&&void 0===t[e.route.id]&&(!a||void 0===a[e.route.id]);if(e.route.lazy||n){c=!0,i=d>=0?i.slice(0,d+1):[i[0]];break}}}return i.reduceRight((e,a,n)=>{let l,u=!1,m=null,f=null;var x;s&&(l=o&&a.route.id?o[a.route.id]:void 0,m=a.route.errorElement||ie,c&&(d<0&&0===n?(x="route-fallback",!1||he[x]||(he[x]=!0),u=!0,f=null):d===n&&(u=!0,f=a.route.hydrateFallbackElement||null)));let p=t.concat(i.slice(0,n+1)),h=()=>{let t;return t=l?m:u?f:a.route.Component?r.createElement(a.route.Component,null):a.route.element?a.route.element:e,r.createElement(ce,{match:a,routeContext:{outlet:e,matches:p,isDataRoute:null!=s},children:t})};return s&&(a.route.ErrorBoundary||a.route.errorElement||0===n)?r.createElement(oe,{location:s.location,revalidation:s.revalidation,component:m,error:l,children:h(),routeContext:{outlet:null,matches:p,isDataRoute:!0}}):h()},null)}var ue=function(e){return e.UseBlocker="useBlocker",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e}(ue||{}),me=function(e){return e.UseBlocker="useBlocker",e.UseLoaderData="useLoaderData",e.UseActionData="useActionData",e.UseRouteError="useRouteError",e.UseNavigation="useNavigation",e.UseRouteLoaderData="useRouteLoaderData",e.UseMatches="useMatches",e.UseRevalidator="useRevalidator",e.UseNavigateStable="useNavigate",e.UseRouteId="useRouteId",e}(me||{});function fe(e){let t=r.useContext($);return t||m(!1),t}function xe(e){let t=r.useContext(J);return t||m(!1),t}function pe(e){let t=function(){let e=r.useContext(X);return e||m(!1),e}(),s=t.matches[t.matches.length-1];return s.route.id||m(!1),s.route.id}const he={};function ge(e,t){null==e||e.v7_startTransition,void 0===(null==e?void 0:e.v7_relativeSplatPath)&&(!t||t.v7_relativeSplatPath),t&&(t.v7_fetcherPersist,t.v7_normalizeFormMethod,t.v7_partialHydration,t.v7_skipActionErrorRevalidation)}l.startTransition;function ye(e){let{to:t,replace:s,state:a,relative:n}=e;ee()||m(!1);let{future:l,static:i}=r.useContext(Y),{matches:o}=r.useContext(X),{pathname:c}=te(),d=ae(),u=z(t,U(o,l.v7_relativeSplatPath),c,"path"===n),f=JSON.stringify(u);return r.useEffect(()=>d(JSON.parse(f),{replace:s,state:a,relative:n}),[d,f,n,s,a]),null}function be(e){m(!1)}function ve(e){let{basename:t="/",children:s=null,location:a,navigationType:l=n.Pop,navigator:i,static:o=!1,future:c}=e;ee()&&m(!1);let d=t.replace(/^\/*/,"/"),u=r.useMemo(()=>({basename:d,navigator:i,static:o,future:Q({v7_relativeSplatPath:!1},c)}),[d,c,i,o]);"string"===typeof a&&(a=g(a));let{pathname:f="/",search:x="",hash:p="",state:h=null,key:y="default"}=a,b=r.useMemo(()=>{let e=F(f,d);return null==e?null:{location:{pathname:e,search:x,hash:p,state:h,key:y},navigationType:l}},[d,f,x,p,h,y,l]);return null==b?null:r.createElement(Y.Provider,{value:u},r.createElement(K.Provider,{children:s,value:b}))}function je(e){let{children:t,location:s}=e;return re(we(t),s)}new Promise(()=>{});r.Component;function we(e,t){void 0===t&&(t=[]);let s=[];return r.Children.forEach(e,(e,a)=>{if(!r.isValidElement(e))return;let n=[...t,a];if(e.type===r.Fragment)return void s.push.apply(s,we(e.props.children,n));e.type!==be&&m(!1),e.props.index&&e.props.children&&m(!1);let l={id:e.props.id||n.join("-"),caseSensitive:e.props.caseSensitive,element:e.props.element,Component:e.props.Component,index:e.props.index,path:e.props.path,loader:e.props.loader,action:e.props.action,errorElement:e.props.errorElement,ErrorBoundary:e.props.ErrorBoundary,hasErrorBoundary:null!=e.props.ErrorBoundary||null!=e.props.errorElement,shouldRevalidate:e.props.shouldRevalidate,handle:e.props.handle,lazy:e.props.lazy};e.props.children&&(l.children=we(e.props.children,n)),s.push(l)}),s}function Ne(){return Ne=Object.assign?Object.assign.bind():function(e){for(var t=1;t<arguments.length;t++){var s=arguments[t];for(var a in s)Object.prototype.hasOwnProperty.call(s,a)&&(e[a]=s[a])}return e},Ne.apply(this,arguments)}function ke(e,t){if(null==e)return{};var s,a,n={},r=Object.keys(e);for(a=0;a<r.length;a++)s=r[a],t.indexOf(s)>=0||(n[s]=e[s]);return n}new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);const Se=["onClick","relative","reloadDocument","replace","state","target","to","preventScrollReset","viewTransition"];try{window.__reactRouterVersion="6"}catch(rn){}new Map;const Ce=l.startTransition;c.flushSync,l.useId;function _e(e){let{basename:t,children:s,future:a,window:n}=e,l=r.useRef();var i;null==l.current&&(l.current=(void 0===(i={window:n,v5Compat:!0})&&(i={}),y(function(e,t){let{pathname:s,search:a,hash:n}=e.location;return p("",{pathname:s,search:a,hash:n},t.state&&t.state.usr||null,t.state&&t.state.key||"default")},function(e,t){return"string"===typeof t?t:h(t)},null,i)));let o=l.current,[c,d]=r.useState({action:o.action,location:o.location}),{v7_startTransition:u}=a||{},m=r.useCallback(e=>{u&&Ce?Ce(()=>d(e)):d(e)},[d,u]);return r.useLayoutEffect(()=>o.listen(m),[o,m]),r.useEffect(()=>ge(a),[a]),r.createElement(ve,{basename:t,children:s,location:c.location,navigationType:c.action,navigator:o,future:a})}const Ee="undefined"!==typeof window&&"undefined"!==typeof window.document&&"undefined"!==typeof window.document.createElement,Pe=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ae=r.forwardRef(function(e,t){let s,{onClick:a,relative:n,reloadDocument:l,replace:i,state:o,target:c,to:d,preventScrollReset:u,viewTransition:f}=e,x=ke(e,Se),{basename:p}=r.useContext(Y),g=!1;if("string"===typeof d&&Pe.test(d)&&(s=d,Ee))try{let e=new URL(window.location.href),t=d.startsWith("//")?new URL(e.protocol+d):new URL(d),s=F(t.pathname,p);t.origin===e.origin&&null!=s?d=s+t.search+t.hash:g=!0}catch(rn){}let y=function(e,t){let{relative:s}=void 0===t?{}:t;ee()||m(!1);let{basename:a,navigator:n}=r.useContext(Y),{hash:l,pathname:i,search:o}=ne(e,{relative:s}),c=i;return"/"!==a&&(c="/"===i?a:I([a,i])),n.createHref({pathname:c,search:o,hash:l})}(d,{relative:n}),b=function(e,t){let{target:s,replace:a,state:n,preventScrollReset:l,relative:i,viewTransition:o}=void 0===t?{}:t,c=ae(),d=te(),u=ne(e,{relative:i});return r.useCallback(t=>{if(function(e,t){return 0===e.button&&(!t||"_self"===t)&&!function(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}(e)}(t,s)){t.preventDefault();let s=void 0!==a?a:h(d)===h(u);c(e,{replace:s,state:n,preventScrollReset:l,relative:i,viewTransition:o})}},[d,c,u,a,n,s,e,l,i,o])}(d,{replace:i,state:o,target:c,preventScrollReset:u,relative:n,viewTransition:f});return r.createElement("a",Ne({},x,{href:s||y,onClick:g||l?a:function(e){a&&a(e),e.defaultPrevented||b(e)},ref:t,target:c}))});var Te,Le;(function(e){e.UseScrollRestoration="useScrollRestoration",e.UseSubmit="useSubmit",e.UseSubmitFetcher="useSubmitFetcher",e.UseFetcher="useFetcher",e.useViewTransitionState="useViewTransitionState"})(Te||(Te={})),function(e){e.UseFetcher="useFetcher",e.UseFetchers="useFetchers",e.UseScrollRestoration="useScrollRestoration"}(Le||(Le={}));function Oe(e){return Oe="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Oe(e)}function Re(e){var t=function(e,t){if("object"!=Oe(e)||!e)return e;var s=e[Symbol.toPrimitive];if(void 0!==s){var a=s.call(e,t||"default");if("object"!=Oe(a))return a;throw new TypeError("@@toPrimitive must return a primitive value.")}return("string"===t?String:Number)(e)}(e,"string");return"symbol"==Oe(t)?t:t+""}function Fe(e,t,s){return(t=Re(t))in e?Object.defineProperty(e,t,{value:s,enumerable:!0,configurable:!0,writable:!0}):e[t]=s,e}function De(e,t){var s=Object.keys(e);if(Object.getOwnPropertySymbols){var a=Object.getOwnPropertySymbols(e);t&&(a=a.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),s.push.apply(s,a)}return s}function Me(e){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?De(Object(s),!0).forEach(function(t){Fe(e,t,s[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(s)):De(Object(s)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(s,t))})}return e}const Ue=window.location.origin;var ze=s(579);const Ie=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{};const s=e.includes("localhost:8000")?e.replace("https://localhost:8000","http://localhost:8000"):e;console.log("\ud83d\udd04 Making request to:",s);let a=null;try{a=await(async()=>{var e;const t=null===(e=document.cookie.split("; ").find(e=>e.startsWith("csrftoken=")))||void 0===e?void 0:e.split("=")[1];if(t)return t;try{var s;const e=await fetch("".concat(Ue,"/api/auth/csrf/"),{method:"GET",credentials:"include"});return e.ok?(await e.json()).csrfToken:null===(s=document.cookie.split("; ").find(e=>e.startsWith("csrftoken=")))||void 0===s?void 0:s.split("=")[1]}catch(a){return console.log("Could not fetch CSRF token:",a),null}})(),console.log("\ud83d\udd11 CSRF token:",a?"obtained":"not available")}catch(r){console.log("\u26a0\ufe0f CSRF token fetch failed:",r.message)}const n=Me({},t.headers);t.body instanceof FormData||(n["Content-Type"]="application/json"),a&&(n["X-CSRFToken"]=a);try{const e=await fetch(s,Me(Me({credentials:"include"},t),{},{headers:n}));return console.log("\u2705 Request completed:",s,"Status:",e.status),e}catch(r){throw console.error("\u274c Request failed:",s,"Error:",r.message),r}},Ge=(0,r.createContext)(),Be=()=>{const e=(0,r.useContext)(Ge);if(!e)throw new Error("useAuth must be used within AuthProvider");return e},We=e=>{let{children:t}=e;const[s,a]=(0,r.useState)(null),[n,l]=(0,r.useState)(!0),[i,o]=(0,r.useState)([]),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)([]),[f,x]=(0,r.useState)(null),p=ae();(0,r.useEffect)(()=>{h()},[]);const h=async()=>{try{const e=await fetch("".concat(Ue,"/api/auth/user/"),{credentials:"include",headers:{"Content-Type":"application/json"}});if(e.ok){const t=await e.json();a(t.user),console.log("\u2705 User authenticated:",t.user),await g()}else console.log("\u274c User not authenticated"),a(null),o([]),d(null)}catch(e){console.error("Auth check failed:",e),a(null)}finally{l(!1)}},g=async()=>{try{const e=await fetch("".concat(Ue,"/api/companies/"),{credentials:"include"});if(e.ok){const t=await e.json(),s=t.results||t;o(s),console.log("\ud83c\udfe2 User companies fetched:",s),console.log("\ud83d\udd0d Available companies for user:",s.map(e=>({id:e.id,name:e.name}))),s.length>0&&(d(s[0]),console.log("\ud83c\udfe2 Using user assigned company:",s[0]))}}catch(e){console.error("Failed to fetch companies:",e)}},y=async()=>{try{const e=await fetch("".concat(Ue,"/api/user/sites/"),{credentials:"include"});if(e.ok){const t=await e.json();m(t),console.log("\ud83c\udfe2 User sites fetched:",t),t.length>0&&x(t[0])}}catch(e){console.error("Failed to fetch user sites:",e)}},b={user:s,loading:n,companies:i,selectedCompany:c,userSites:u,selectedSite:f,login:async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const n={email:e,password:t};s&&(n.company_code=s);const r=await fetch("".concat(Ue,"/api/auth/login/"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify(n)}),l=await r.json();if(r.ok){if(a(l.user),console.log("\u2705 Login successful:",l.user),await g(),await y(),l.requires_password_reset||l.user.must_reset_password)return p("/reset-password"),{success:!0,requiresPasswordReset:!0,message:l.message};{const e=l.redirect_path||"/dashboard";return console.log("\ud83c\udfaf Redirecting user to: ".concat(e," (role: ").concat(l.user.role,")")),p(e),{success:!0,redirectPath:e}}}return console.error("\u274c Login failed:",l.error),{success:!1,error:l.error||"Login failed"}}catch(n){return console.error("Login error:",n),{success:!1,error:"Network error"}}},signup:async(e,t,s,a)=>{try{const n=await fetch("".concat(Ue,"/api/auth/signup/"),{method:"POST",credentials:"include",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:e,email:t,companyName:s,password:a})}),r=await n.json();return n.ok?(console.log("\u2705 Signup successful:",r),{success:!0,emailVerification:!0,message:r.message,userEmail:r.user_email,verificationCode:r.verification_code,emailSent:r.email_sent,nextStep:r.next_step}):(console.error("\u274c Signup failed:",r.error),{success:!1,error:r.error||"Signup failed"})}catch(n){return console.error("Signup error:",n),{success:!1,error:"Network error"}}},logout:async()=>{try{await fetch("".concat(Ue,"/api/auth/logout/"),{method:"POST",credentials:"include"}),console.log("\u2705 Logout successful")}catch(e){console.error("Logout error:",e)}finally{a(null),o([]),d(null),m([]),x(null),p("/login")}},resetPassword:async(e,t)=>{try{const n=await Ie("".concat(Ue,"/api/auth/reset-password/"),{method:"POST",body:JSON.stringify({current_password:e,new_password:t})}),r=await n.json();return n.ok?(console.log("\u2705 Password reset successful"),s&&a(Me(Me({},s),{},{must_reset_password:!1})),{success:!0,message:r.message}):(console.error("\u274c Password reset failed:",r.error),console.error("\u274c Response status:",n.status),console.error("\u274c Full response:",r),{success:!1,error:r.error||"Password reset failed"})}catch(n){return console.error("Password reset error:",n),{success:!1,error:"Network error"}}},checkAuthStatus:h,switchCompany:e=>{d(e),console.log("\ud83c\udfe2 Switched to company:",e)},switchSite:e=>{x(e),console.log("\ud83c\udfe2 Switched to site:",e)},fetchUserCompanies:g,fetchUserSites:y,hasPermission:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"read";if(!s)return!1;const a={super_user:{all:!0},admin:{companyOnboarding:["read","create","update"],frameworkSelection:["read","create","update"],dataChecklist:["read","create","update","assign"],meterManagement:["read","create","update","delete"],dataCollection:["read","create","update","approve"],dashboard:["read"],reports:["read","export"],userManagement:["read","create","update","delete"]},site_manager:{companyOnboarding:["read"],frameworkSelection:["read"],dataChecklist:["read","assign"],meterManagement:["read","create","update","delete"],dataCollection:["read","create","update","review"],dashboard:["read"],reports:["read","export"],userManagement:["read","create","update","delete"]},uploader:{dataCollection:["read","create","update"],dashboard:["read"],reports:["read"]},viewer:{companyOnboarding:["read"],frameworkSelection:["read"],dataChecklist:["read"],meterManagement:["read"],dataCollection:["read"],dashboard:["read"],reports:["read","export"]},meter_manager:{meterManagement:["read","create","update","delete"],dataCollection:["read"],dashboard:["read"],reports:["read"]}}[s.role];return!!a&&(!!a.all||!!a[e]&&a[e].includes(t))}};return(0,ze.jsx)(Ge.Provider,{value:b,children:t})};function qe(e,t){return function(){return e.apply(t,arguments)}}const{toString:Ve}=Object.prototype,{getPrototypeOf:He}=Object,{iterator:Qe,toStringTag:$e}=Symbol,Je=(Ye=Object.create(null),e=>{const t=Ve.call(e);return Ye[t]||(Ye[t]=t.slice(8,-1).toLowerCase())});var Ye;const Ke=e=>(e=e.toLowerCase(),t=>Je(t)===e),Xe=e=>t=>typeof t===e,{isArray:Ze}=Array,et=Xe("undefined");function tt(e){return null!==e&&!et(e)&&null!==e.constructor&&!et(e.constructor)&&nt(e.constructor.isBuffer)&&e.constructor.isBuffer(e)}const st=Ke("ArrayBuffer");const at=Xe("string"),nt=Xe("function"),rt=Xe("number"),lt=e=>null!==e&&"object"===typeof e,it=e=>{if("object"!==Je(e))return!1;const t=He(e);return(null===t||t===Object.prototype||null===Object.getPrototypeOf(t))&&!($e in e)&&!(Qe in e)},ot=Ke("Date"),ct=Ke("File"),dt=Ke("Blob"),ut=Ke("FileList"),mt=Ke("URLSearchParams"),[ft,xt,pt,ht]=["ReadableStream","Request","Response","Headers"].map(Ke);function gt(e,t){let s,a,{allOwnKeys:n=!1}=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{};if(null!==e&&"undefined"!==typeof e)if("object"!==typeof e&&(e=[e]),Ze(e))for(s=0,a=e.length;s<a;s++)t.call(null,e[s],s,e);else{if(tt(e))return;const a=n?Object.getOwnPropertyNames(e):Object.keys(e),r=a.length;let l;for(s=0;s<r;s++)l=a[s],t.call(null,e[l],l,e)}}function yt(e,t){if(tt(e))return null;t=t.toLowerCase();const s=Object.keys(e);let a,n=s.length;for(;n-- >0;)if(a=s[n],t===a.toLowerCase())return a;return null}const bt="undefined"!==typeof globalThis?globalThis:"undefined"!==typeof self?self:"undefined"!==typeof window?window:global,vt=e=>!et(e)&&e!==bt;const jt=(wt="undefined"!==typeof Uint8Array&&He(Uint8Array),e=>wt&&e instanceof wt);var wt;const Nt=Ke("HTMLFormElement"),kt=(e=>{let{hasOwnProperty:t}=e;return(e,s)=>t.call(e,s)})(Object.prototype),St=Ke("RegExp"),Ct=(e,t)=>{const s=Object.getOwnPropertyDescriptors(e),a={};gt(s,(s,n)=>{let r;!1!==(r=t(s,n,e))&&(a[n]=r||s)}),Object.defineProperties(e,a)};const _t=Ke("AsyncFunction"),Et=((e,t)=>{return e?setImmediate:t?(s="axios@".concat(Math.random()),a=[],bt.addEventListener("message",e=>{let{source:t,data:n}=e;t===bt&&n===s&&a.length&&a.shift()()},!1),e=>{a.push(e),bt.postMessage(s,"*")}):e=>setTimeout(e);var s,a})("function"===typeof setImmediate,nt(bt.postMessage)),Pt="undefined"!==typeof queueMicrotask?queueMicrotask.bind(bt):"undefined"!==typeof process&&process.nextTick||Et,At={isArray:Ze,isArrayBuffer:st,isBuffer:tt,isFormData:e=>{let t;return e&&("function"===typeof FormData&&e instanceof FormData||nt(e.append)&&("formdata"===(t=Je(e))||"object"===t&&nt(e.toString)&&"[object FormData]"===e.toString()))},isArrayBufferView:function(e){let t;return t="undefined"!==typeof ArrayBuffer&&ArrayBuffer.isView?ArrayBuffer.isView(e):e&&e.buffer&&st(e.buffer),t},isString:at,isNumber:rt,isBoolean:e=>!0===e||!1===e,isObject:lt,isPlainObject:it,isEmptyObject:e=>{if(!lt(e)||tt(e))return!1;try{return 0===Object.keys(e).length&&Object.getPrototypeOf(e)===Object.prototype}catch(rn){return!1}},isReadableStream:ft,isRequest:xt,isResponse:pt,isHeaders:ht,isUndefined:et,isDate:ot,isFile:ct,isBlob:dt,isRegExp:St,isFunction:nt,isStream:e=>lt(e)&&nt(e.pipe),isURLSearchParams:mt,isTypedArray:jt,isFileList:ut,forEach:gt,merge:function e(){const{caseless:t}=vt(this)&&this||{},s={},a=(a,n)=>{const r=t&&yt(s,n)||n;it(s[r])&&it(a)?s[r]=e(s[r],a):it(a)?s[r]=e({},a):Ze(a)?s[r]=a.slice():s[r]=a};for(let n=0,r=arguments.length;n<r;n++)arguments[n]&&gt(arguments[n],a);return s},extend:function(e,t,s){let{allOwnKeys:a}=arguments.length>3&&void 0!==arguments[3]?arguments[3]:{};return gt(t,(t,a)=>{s&&nt(t)?e[a]=qe(t,s):e[a]=t},{allOwnKeys:a}),e},trim:e=>e.trim?e.trim():e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,""),stripBOM:e=>(65279===e.charCodeAt(0)&&(e=e.slice(1)),e),inherits:(e,t,s,a)=>{e.prototype=Object.create(t.prototype,a),e.prototype.constructor=e,Object.defineProperty(e,"super",{value:t.prototype}),s&&Object.assign(e.prototype,s)},toFlatObject:(e,t,s,a)=>{let n,r,l;const i={};if(t=t||{},null==e)return t;do{for(n=Object.getOwnPropertyNames(e),r=n.length;r-- >0;)l=n[r],a&&!a(l,e,t)||i[l]||(t[l]=e[l],i[l]=!0);e=!1!==s&&He(e)}while(e&&(!s||s(e,t))&&e!==Object.prototype);return t},kindOf:Je,kindOfTest:Ke,endsWith:(e,t,s)=>{e=String(e),(void 0===s||s>e.length)&&(s=e.length),s-=t.length;const a=e.indexOf(t,s);return-1!==a&&a===s},toArray:e=>{if(!e)return null;if(Ze(e))return e;let t=e.length;if(!rt(t))return null;const s=new Array(t);for(;t-- >0;)s[t]=e[t];return s},forEachEntry:(e,t)=>{const s=(e&&e[Qe]).call(e);let a;for(;(a=s.next())&&!a.done;){const s=a.value;t.call(e,s[0],s[1])}},matchAll:(e,t)=>{let s;const a=[];for(;null!==(s=e.exec(t));)a.push(s);return a},isHTMLForm:Nt,hasOwnProperty:kt,hasOwnProp:kt,reduceDescriptors:Ct,freezeMethods:e=>{Ct(e,(t,s)=>{if(nt(e)&&-1!==["arguments","caller","callee"].indexOf(s))return!1;const a=e[s];nt(a)&&(t.enumerable=!1,"writable"in t?t.writable=!1:t.set||(t.set=()=>{throw Error("Can not rewrite read-only method '"+s+"'")}))})},toObjectSet:(e,t)=>{const s={},a=e=>{e.forEach(e=>{s[e]=!0})};return Ze(e)?a(e):a(String(e).split(t)),s},toCamelCase:e=>e.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(e,t,s){return t.toUpperCase()+s}),noop:()=>{},toFiniteNumber:(e,t)=>null!=e&&Number.isFinite(e=+e)?e:t,findKey:yt,global:bt,isContextDefined:vt,isSpecCompliantForm:function(e){return!!(e&&nt(e.append)&&"FormData"===e[$e]&&e[Qe])},toJSONObject:e=>{const t=new Array(10),s=(e,a)=>{if(lt(e)){if(t.indexOf(e)>=0)return;if(tt(e))return e;if(!("toJSON"in e)){t[a]=e;const n=Ze(e)?[]:{};return gt(e,(e,t)=>{const r=s(e,a+1);!et(r)&&(n[t]=r)}),t[a]=void 0,n}}return e};return s(e,0)},isAsyncFn:_t,isThenable:e=>e&&(lt(e)||nt(e))&&nt(e.then)&&nt(e.catch),setImmediate:Et,asap:Pt,isIterable:e=>null!=e&&nt(e[Qe])};function Tt(e,t,s,a,n){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=(new Error).stack,this.message=e,this.name="AxiosError",t&&(this.code=t),s&&(this.config=s),a&&(this.request=a),n&&(this.response=n,this.status=n.status?n.status:null)}At.inherits(Tt,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:At.toJSONObject(this.config),code:this.code,status:this.status}}});const Lt=Tt.prototype,Ot={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(e=>{Ot[e]={value:e}}),Object.defineProperties(Tt,Ot),Object.defineProperty(Lt,"isAxiosError",{value:!0}),Tt.from=(e,t,s,a,n,r)=>{const l=Object.create(Lt);return At.toFlatObject(e,l,function(e){return e!==Error.prototype},e=>"isAxiosError"!==e),Tt.call(l,e.message,t,s,a,n),l.cause=e,l.name=e.name,r&&Object.assign(l,r),l};const Rt=Tt;function Ft(e){return At.isPlainObject(e)||At.isArray(e)}function Dt(e){return At.endsWith(e,"[]")?e.slice(0,-2):e}function Mt(e,t,s){return e?e.concat(t).map(function(e,t){return e=Dt(e),!s&&t?"["+e+"]":e}).join(s?".":""):t}const Ut=At.toFlatObject(At,{},null,function(e){return/^is[A-Z]/.test(e)});const zt=function(e,t,s){if(!At.isObject(e))throw new TypeError("target must be an object");t=t||new FormData;const a=(s=At.toFlatObject(s,{metaTokens:!0,dots:!1,indexes:!1},!1,function(e,t){return!At.isUndefined(t[e])})).metaTokens,n=s.visitor||c,r=s.dots,l=s.indexes,i=(s.Blob||"undefined"!==typeof Blob&&Blob)&&At.isSpecCompliantForm(t);if(!At.isFunction(n))throw new TypeError("visitor must be a function");function o(e){if(null===e)return"";if(At.isDate(e))return e.toISOString();if(At.isBoolean(e))return e.toString();if(!i&&At.isBlob(e))throw new Rt("Blob is not supported. Use a Buffer instead.");return At.isArrayBuffer(e)||At.isTypedArray(e)?i&&"function"===typeof Blob?new Blob([e]):Buffer.from(e):e}function c(e,s,n){let i=e;if(e&&!n&&"object"===typeof e)if(At.endsWith(s,"{}"))s=a?s:s.slice(0,-2),e=JSON.stringify(e);else if(At.isArray(e)&&function(e){return At.isArray(e)&&!e.some(Ft)}(e)||(At.isFileList(e)||At.endsWith(s,"[]"))&&(i=At.toArray(e)))return s=Dt(s),i.forEach(function(e,a){!At.isUndefined(e)&&null!==e&&t.append(!0===l?Mt([s],a,r):null===l?s:s+"[]",o(e))}),!1;return!!Ft(e)||(t.append(Mt(n,s,r),o(e)),!1)}const d=[],u=Object.assign(Ut,{defaultVisitor:c,convertValue:o,isVisitable:Ft});if(!At.isObject(e))throw new TypeError("data must be an object");return function e(s,a){if(!At.isUndefined(s)){if(-1!==d.indexOf(s))throw Error("Circular reference detected in "+a.join("."));d.push(s),At.forEach(s,function(s,r){!0===(!(At.isUndefined(s)||null===s)&&n.call(t,s,At.isString(r)?r.trim():r,a,u))&&e(s,a?a.concat(r):[r])}),d.pop()}}(e),t};function It(e){const t={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(e).replace(/[!'()~]|%20|%00/g,function(e){return t[e]})}function Gt(e,t){this._pairs=[],e&&zt(e,this,t)}const Bt=Gt.prototype;Bt.append=function(e,t){this._pairs.push([e,t])},Bt.toString=function(e){const t=e?function(t){return e.call(this,t,It)}:It;return this._pairs.map(function(e){return t(e[0])+"="+t(e[1])},"").join("&")};const Wt=Gt;function qt(e){return encodeURIComponent(e).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Vt(e,t,s){if(!t)return e;const a=s&&s.encode||qt;At.isFunction(s)&&(s={serialize:s});const n=s&&s.serialize;let r;if(r=n?n(t,s):At.isURLSearchParams(t)?t.toString():new Wt(t,s).toString(a),r){const t=e.indexOf("#");-1!==t&&(e=e.slice(0,t)),e+=(-1===e.indexOf("?")?"?":"&")+r}return e}const Ht=class{constructor(){this.handlers=[]}use(e,t,s){return this.handlers.push({fulfilled:e,rejected:t,synchronous:!!s&&s.synchronous,runWhen:s?s.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){At.forEach(this.handlers,function(t){null!==t&&e(t)})}},Qt={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},$t={isBrowser:!0,classes:{URLSearchParams:"undefined"!==typeof URLSearchParams?URLSearchParams:Wt,FormData:"undefined"!==typeof FormData?FormData:null,Blob:"undefined"!==typeof Blob?Blob:null},protocols:["http","https","file","blob","url","data"]},Jt="undefined"!==typeof window&&"undefined"!==typeof document,Yt="object"===typeof navigator&&navigator||void 0,Kt=Jt&&(!Yt||["ReactNative","NativeScript","NS"].indexOf(Yt.product)<0),Xt="undefined"!==typeof WorkerGlobalScope&&self instanceof WorkerGlobalScope&&"function"===typeof self.importScripts,Zt=Jt&&window.location.href||"http://localhost",es=Me(Me({},a),$t);const ts=function(e){function t(e,s,a,n){let r=e[n++];if("__proto__"===r)return!0;const l=Number.isFinite(+r),i=n>=e.length;if(r=!r&&At.isArray(a)?a.length:r,i)return At.hasOwnProp(a,r)?a[r]=[a[r],s]:a[r]=s,!l;a[r]&&At.isObject(a[r])||(a[r]=[]);return t(e,s,a[r],n)&&At.isArray(a[r])&&(a[r]=function(e){const t={},s=Object.keys(e);let a;const n=s.length;let r;for(a=0;a<n;a++)r=s[a],t[r]=e[r];return t}(a[r])),!l}if(At.isFormData(e)&&At.isFunction(e.entries)){const s={};return At.forEachEntry(e,(e,a)=>{t(function(e){return At.matchAll(/\w+|\[(\w*)]/g,e).map(e=>"[]"===e[0]?"":e[1]||e[0])}(e),a,s,0)}),s}return null};const ss={transitional:Qt,adapter:["xhr","http","fetch"],transformRequest:[function(e,t){const s=t.getContentType()||"",a=s.indexOf("application/json")>-1,n=At.isObject(e);n&&At.isHTMLForm(e)&&(e=new FormData(e));if(At.isFormData(e))return a?JSON.stringify(ts(e)):e;if(At.isArrayBuffer(e)||At.isBuffer(e)||At.isStream(e)||At.isFile(e)||At.isBlob(e)||At.isReadableStream(e))return e;if(At.isArrayBufferView(e))return e.buffer;if(At.isURLSearchParams(e))return t.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let r;if(n){if(s.indexOf("application/x-www-form-urlencoded")>-1)return function(e,t){return zt(e,new es.classes.URLSearchParams,Me({visitor:function(e,t,s,a){return es.isNode&&At.isBuffer(e)?(this.append(t,e.toString("base64")),!1):a.defaultVisitor.apply(this,arguments)}},t))}(e,this.formSerializer).toString();if((r=At.isFileList(e))||s.indexOf("multipart/form-data")>-1){const t=this.env&&this.env.FormData;return zt(r?{"files[]":e}:e,t&&new t,this.formSerializer)}}return n||a?(t.setContentType("application/json",!1),function(e,t,s){if(At.isString(e))try{return(t||JSON.parse)(e),At.trim(e)}catch(rn){if("SyntaxError"!==rn.name)throw rn}return(s||JSON.stringify)(e)}(e)):e}],transformResponse:[function(e){const t=this.transitional||ss.transitional,s=t&&t.forcedJSONParsing,a="json"===this.responseType;if(At.isResponse(e)||At.isReadableStream(e))return e;if(e&&At.isString(e)&&(s&&!this.responseType||a)){const s=!(t&&t.silentJSONParsing)&&a;try{return JSON.parse(e)}catch(rn){if(s){if("SyntaxError"===rn.name)throw Rt.from(rn,Rt.ERR_BAD_RESPONSE,this,null,this.response);throw rn}}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:es.classes.FormData,Blob:es.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};At.forEach(["delete","get","head","post","put","patch"],e=>{ss.headers[e]={}});const as=ss,ns=At.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),rs=Symbol("internals");function ls(e){return e&&String(e).trim().toLowerCase()}function is(e){return!1===e||null==e?e:At.isArray(e)?e.map(is):String(e)}function os(e,t,s,a,n){return At.isFunction(a)?a.call(this,t,s):(n&&(t=s),At.isString(t)?At.isString(a)?-1!==t.indexOf(a):At.isRegExp(a)?a.test(t):void 0:void 0)}class cs{constructor(e){e&&this.set(e)}set(e,t,s){const a=this;function n(e,t,s){const n=ls(t);if(!n)throw new Error("header name must be a non-empty string");const r=At.findKey(a,n);(!r||void 0===a[r]||!0===s||void 0===s&&!1!==a[r])&&(a[r||t]=is(e))}const r=(e,t)=>At.forEach(e,(e,s)=>n(e,s,t));if(At.isPlainObject(e)||e instanceof this.constructor)r(e,t);else if(At.isString(e)&&(e=e.trim())&&!/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(e.trim()))r((e=>{const t={};let s,a,n;return e&&e.split("\n").forEach(function(e){n=e.indexOf(":"),s=e.substring(0,n).trim().toLowerCase(),a=e.substring(n+1).trim(),!s||t[s]&&ns[s]||("set-cookie"===s?t[s]?t[s].push(a):t[s]=[a]:t[s]=t[s]?t[s]+", "+a:a)}),t})(e),t);else if(At.isObject(e)&&At.isIterable(e)){let s,a,n={};for(const t of e){if(!At.isArray(t))throw TypeError("Object iterator must return a key-value pair");n[a=t[0]]=(s=n[a])?At.isArray(s)?[...s,t[1]]:[s,t[1]]:t[1]}r(n,t)}else null!=e&&n(t,e,s);return this}get(e,t){if(e=ls(e)){const s=At.findKey(this,e);if(s){const e=this[s];if(!t)return e;if(!0===t)return function(e){const t=Object.create(null),s=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let a;for(;a=s.exec(e);)t[a[1]]=a[2];return t}(e);if(At.isFunction(t))return t.call(this,e,s);if(At.isRegExp(t))return t.exec(e);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,t){if(e=ls(e)){const s=At.findKey(this,e);return!(!s||void 0===this[s]||t&&!os(0,this[s],s,t))}return!1}delete(e,t){const s=this;let a=!1;function n(e){if(e=ls(e)){const n=At.findKey(s,e);!n||t&&!os(0,s[n],n,t)||(delete s[n],a=!0)}}return At.isArray(e)?e.forEach(n):n(e),a}clear(e){const t=Object.keys(this);let s=t.length,a=!1;for(;s--;){const n=t[s];e&&!os(0,this[n],n,e,!0)||(delete this[n],a=!0)}return a}normalize(e){const t=this,s={};return At.forEach(this,(a,n)=>{const r=At.findKey(s,n);if(r)return t[r]=is(a),void delete t[n];const l=e?function(e){return e.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,t,s)=>t.toUpperCase()+s)}(n):String(n).trim();l!==n&&delete t[n],t[l]=is(a),s[l]=!0}),this}concat(){for(var e=arguments.length,t=new Array(e),s=0;s<e;s++)t[s]=arguments[s];return this.constructor.concat(this,...t)}toJSON(e){const t=Object.create(null);return At.forEach(this,(s,a)=>{null!=s&&!1!==s&&(t[a]=e&&At.isArray(s)?s.join(", "):s)}),t}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(e=>{let[t,s]=e;return t+": "+s}).join("\n")}getSetCookie(){return this.get("set-cookie")||[]}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e){const t=new this(e);for(var s=arguments.length,a=new Array(s>1?s-1:0),n=1;n<s;n++)a[n-1]=arguments[n];return a.forEach(e=>t.set(e)),t}static accessor(e){const t=(this[rs]=this[rs]={accessors:{}}).accessors,s=this.prototype;function a(e){const a=ls(e);t[a]||(!function(e,t){const s=At.toCamelCase(" "+t);["get","set","has"].forEach(a=>{Object.defineProperty(e,a+s,{value:function(e,s,n){return this[a].call(this,t,e,s,n)},configurable:!0})})}(s,e),t[a]=!0)}return At.isArray(e)?e.forEach(a):a(e),this}}cs.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]),At.reduceDescriptors(cs.prototype,(e,t)=>{let{value:s}=e,a=t[0].toUpperCase()+t.slice(1);return{get:()=>s,set(e){this[a]=e}}}),At.freezeMethods(cs);const ds=cs;function us(e,t){const s=this||as,a=t||s,n=ds.from(a.headers);let r=a.data;return At.forEach(e,function(e){r=e.call(s,r,n.normalize(),t?t.status:void 0)}),n.normalize(),r}function ms(e){return!(!e||!e.__CANCEL__)}function fs(e,t,s){Rt.call(this,null==e?"canceled":e,Rt.ERR_CANCELED,t,s),this.name="CanceledError"}At.inherits(fs,Rt,{__CANCEL__:!0});const xs=fs;function ps(e,t,s){const a=s.config.validateStatus;s.status&&a&&!a(s.status)?t(new Rt("Request failed with status code "+s.status,[Rt.ERR_BAD_REQUEST,Rt.ERR_BAD_RESPONSE][Math.floor(s.status/100)-4],s.config,s.request,s)):e(s)}const hs=function(e,t){e=e||10;const s=new Array(e),a=new Array(e);let n,r=0,l=0;return t=void 0!==t?t:1e3,function(i){const o=Date.now(),c=a[l];n||(n=o),s[r]=i,a[r]=o;let d=l,u=0;for(;d!==r;)u+=s[d++],d%=e;if(r=(r+1)%e,r===l&&(l=(l+1)%e),o-n<t)return;const m=c&&o-c;return m?Math.round(1e3*u/m):void 0}};const gs=function(e,t){let s,a,n=0,r=1e3/t;const l=function(t){let r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:Date.now();n=r,s=null,a&&(clearTimeout(a),a=null),e(...t)};return[function(){const e=Date.now(),t=e-n;for(var i=arguments.length,o=new Array(i),c=0;c<i;c++)o[c]=arguments[c];t>=r?l(o,e):(s=o,a||(a=setTimeout(()=>{a=null,l(s)},r-t)))},()=>s&&l(s)]},ys=function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:3,a=0;const n=hs(50,250);return gs(s=>{const r=s.loaded,l=s.lengthComputable?s.total:void 0,i=r-a,o=n(i);a=r;e({loaded:r,total:l,progress:l?r/l:void 0,bytes:i,rate:o||void 0,estimated:o&&l&&r<=l?(l-r)/o:void 0,event:s,lengthComputable:null!=l,[t?"download":"upload"]:!0})},s)},bs=(e,t)=>{const s=null!=e;return[a=>t[0]({lengthComputable:s,total:e,loaded:a}),t[1]]},vs=e=>function(){for(var t=arguments.length,s=new Array(t),a=0;a<t;a++)s[a]=arguments[a];return At.asap(()=>e(...s))},js=es.hasStandardBrowserEnv?((e,t)=>s=>(s=new URL(s,es.origin),e.protocol===s.protocol&&e.host===s.host&&(t||e.port===s.port)))(new URL(es.origin),es.navigator&&/(msie|trident)/i.test(es.navigator.userAgent)):()=>!0,ws=es.hasStandardBrowserEnv?{write(e,t,s,a,n,r){const l=[e+"="+encodeURIComponent(t)];At.isNumber(s)&&l.push("expires="+new Date(s).toGMTString()),At.isString(a)&&l.push("path="+a),At.isString(n)&&l.push("domain="+n),!0===r&&l.push("secure"),document.cookie=l.join("; ")},read(e){const t=document.cookie.match(new RegExp("(^|;\\s*)("+e+")=([^;]*)"));return t?decodeURIComponent(t[3]):null},remove(e){this.write(e,"",Date.now()-864e5)}}:{write(){},read:()=>null,remove(){}};function Ns(e,t,s){let a=!/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t);return e&&(a||0==s)?function(e,t){return t?e.replace(/\/?\/$/,"")+"/"+t.replace(/^\/+/,""):e}(e,t):t}const ks=e=>e instanceof ds?Me({},e):e;function Ss(e,t){t=t||{};const s={};function a(e,t,s,a){return At.isPlainObject(e)&&At.isPlainObject(t)?At.merge.call({caseless:a},e,t):At.isPlainObject(t)?At.merge({},t):At.isArray(t)?t.slice():t}function n(e,t,s,n){return At.isUndefined(t)?At.isUndefined(e)?void 0:a(void 0,e,0,n):a(e,t,0,n)}function r(e,t){if(!At.isUndefined(t))return a(void 0,t)}function l(e,t){return At.isUndefined(t)?At.isUndefined(e)?void 0:a(void 0,e):a(void 0,t)}function i(s,n,r){return r in t?a(s,n):r in e?a(void 0,s):void 0}const o={url:r,method:r,data:r,baseURL:l,transformRequest:l,transformResponse:l,paramsSerializer:l,timeout:l,timeoutMessage:l,withCredentials:l,withXSRFToken:l,adapter:l,responseType:l,xsrfCookieName:l,xsrfHeaderName:l,onUploadProgress:l,onDownloadProgress:l,decompress:l,maxContentLength:l,maxBodyLength:l,beforeRedirect:l,transport:l,httpAgent:l,httpsAgent:l,cancelToken:l,socketPath:l,responseEncoding:l,validateStatus:i,headers:(e,t,s)=>n(ks(e),ks(t),0,!0)};return At.forEach(Object.keys(Me(Me({},e),t)),function(a){const r=o[a]||n,l=r(e[a],t[a],a);At.isUndefined(l)&&r!==i||(s[a]=l)}),s}const Cs=e=>{const t=Ss({},e);let s,{data:a,withXSRFToken:n,xsrfHeaderName:r,xsrfCookieName:l,headers:i,auth:o}=t;if(t.headers=i=ds.from(i),t.url=Vt(Ns(t.baseURL,t.url,t.allowAbsoluteUrls),e.params,e.paramsSerializer),o&&i.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):""))),At.isFormData(a))if(es.hasStandardBrowserEnv||es.hasStandardBrowserWebWorkerEnv)i.setContentType(void 0);else if(!1!==(s=i.getContentType())){const[e,...t]=s?s.split(";").map(e=>e.trim()).filter(Boolean):[];i.setContentType([e||"multipart/form-data",...t].join("; "))}if(es.hasStandardBrowserEnv&&(n&&At.isFunction(n)&&(n=n(t)),n||!1!==n&&js(t.url))){const e=r&&l&&ws.read(l);e&&i.set(r,e)}return t},_s="undefined"!==typeof XMLHttpRequest&&function(e){return new Promise(function(t,s){const a=Cs(e);let n=a.data;const r=ds.from(a.headers).normalize();let l,i,o,c,d,{responseType:u,onUploadProgress:m,onDownloadProgress:f}=a;function x(){c&&c(),d&&d(),a.cancelToken&&a.cancelToken.unsubscribe(l),a.signal&&a.signal.removeEventListener("abort",l)}let p=new XMLHttpRequest;function h(){if(!p)return;const a=ds.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders());ps(function(e){t(e),x()},function(e){s(e),x()},{data:u&&"text"!==u&&"json"!==u?p.response:p.responseText,status:p.status,statusText:p.statusText,headers:a,config:e,request:p}),p=null}p.open(a.method.toUpperCase(),a.url,!0),p.timeout=a.timeout,"onloadend"in p?p.onloadend=h:p.onreadystatechange=function(){p&&4===p.readyState&&(0!==p.status||p.responseURL&&0===p.responseURL.indexOf("file:"))&&setTimeout(h)},p.onabort=function(){p&&(s(new Rt("Request aborted",Rt.ECONNABORTED,e,p)),p=null)},p.onerror=function(){s(new Rt("Network Error",Rt.ERR_NETWORK,e,p)),p=null},p.ontimeout=function(){let t=a.timeout?"timeout of "+a.timeout+"ms exceeded":"timeout exceeded";const n=a.transitional||Qt;a.timeoutErrorMessage&&(t=a.timeoutErrorMessage),s(new Rt(t,n.clarifyTimeoutError?Rt.ETIMEDOUT:Rt.ECONNABORTED,e,p)),p=null},void 0===n&&r.setContentType(null),"setRequestHeader"in p&&At.forEach(r.toJSON(),function(e,t){p.setRequestHeader(t,e)}),At.isUndefined(a.withCredentials)||(p.withCredentials=!!a.withCredentials),u&&"json"!==u&&(p.responseType=a.responseType),f&&([o,d]=ys(f,!0),p.addEventListener("progress",o)),m&&p.upload&&([i,c]=ys(m),p.upload.addEventListener("progress",i),p.upload.addEventListener("loadend",c)),(a.cancelToken||a.signal)&&(l=t=>{p&&(s(!t||t.type?new xs(null,e,p):t),p.abort(),p=null)},a.cancelToken&&a.cancelToken.subscribe(l),a.signal&&(a.signal.aborted?l():a.signal.addEventListener("abort",l)));const g=function(e){const t=/^([-+\w]{1,25})(:?\/\/|:)/.exec(e);return t&&t[1]||""}(a.url);g&&-1===es.protocols.indexOf(g)?s(new Rt("Unsupported protocol "+g+":",Rt.ERR_BAD_REQUEST,e)):p.send(n||null)})},Es=(e,t)=>{const{length:s}=e=e?e.filter(Boolean):[];if(t||s){let s,a=new AbortController;const n=function(e){if(!s){s=!0,l();const t=e instanceof Error?e:this.reason;a.abort(t instanceof Rt?t:new xs(t instanceof Error?t.message:t))}};let r=t&&setTimeout(()=>{r=null,n(new Rt("timeout ".concat(t," of ms exceeded"),Rt.ETIMEDOUT))},t);const l=()=>{e&&(r&&clearTimeout(r),r=null,e.forEach(e=>{e.unsubscribe?e.unsubscribe(n):e.removeEventListener("abort",n)}),e=null)};e.forEach(e=>e.addEventListener("abort",n));const{signal:i}=a;return i.unsubscribe=()=>At.asap(l),i}};function Ps(e,t){this.v=e,this.k=t}function As(e){return function(){return new Ts(e.apply(this,arguments))}}function Ts(e){var t,s;function a(t,s){try{var r=e[t](s),l=r.value,i=l instanceof Ps;Promise.resolve(i?l.v:l).then(function(s){if(i){var o="return"===t?"return":"next";if(!l.k||s.done)return a(o,s);s=e[o](s).value}n(r.done?"return":"normal",s)},function(e){a("throw",e)})}catch(e){n("throw",e)}}function n(e,n){switch(e){case"return":t.resolve({value:n,done:!0});break;case"throw":t.reject(n);break;default:t.resolve({value:n,done:!1})}(t=t.next)?a(t.key,t.arg):s=null}this._invoke=function(e,n){return new Promise(function(r,l){var i={key:e,arg:n,resolve:r,reject:l,next:null};s?s=s.next=i:(t=s=i,a(e,n))})},"function"!=typeof e.return&&(this.return=void 0)}function Ls(e){return new Ps(e,0)}function Os(e){var t={},s=!1;function a(t,a){return s=!0,a=new Promise(function(s){s(e[t](a))}),{done:!1,value:new Ps(a,1)}}return t["undefined"!=typeof Symbol&&Symbol.iterator||"@@iterator"]=function(){return this},t.next=function(e){return s?(s=!1,e):a("next",e)},"function"==typeof e.throw&&(t.throw=function(e){if(s)throw s=!1,e;return a("throw",e)}),"function"==typeof e.return&&(t.return=function(e){return s?(s=!1,e):a("return",e)}),t}function Rs(e){var t,s,a,n=2;for("undefined"!=typeof Symbol&&(s=Symbol.asyncIterator,a=Symbol.iterator);n--;){if(s&&null!=(t=e[s]))return t.call(e);if(a&&null!=(t=e[a]))return new Fs(t.call(e));s="@@asyncIterator",a="@@iterator"}throw new TypeError("Object is not async iterable")}function Fs(e){function t(e){if(Object(e)!==e)return Promise.reject(new TypeError(e+" is not an object."));var t=e.done;return Promise.resolve(e.value).then(function(e){return{value:e,done:t}})}return Fs=function(e){this.s=e,this.n=e.next},Fs.prototype={s:null,n:null,next:function(){return t(this.n.apply(this.s,arguments))},return:function(e){var s=this.s.return;return void 0===s?Promise.resolve({value:e,done:!0}):t(s.apply(this.s,arguments))},throw:function(e){var s=this.s.return;return void 0===s?Promise.reject(e):t(s.apply(this.s,arguments))}},new Fs(e)}Ts.prototype["function"==typeof Symbol&&Symbol.asyncIterator||"@@asyncIterator"]=function(){return this},Ts.prototype.next=function(e){return this._invoke("next",e)},Ts.prototype.throw=function(e){return this._invoke("throw",e)},Ts.prototype.return=function(e){return this._invoke("return",e)};const Ds=function*(e,t){let s=e.byteLength;if(!t||s<t)return void(yield e);let a,n=0;for(;n<s;)a=n+t,yield e.slice(n,a),n=a},Ms=function(){var e=As(function*(e,t){var s,a=!1,n=!1;try{for(var r,l=Rs(Us(e));a=!(r=yield Ls(l.next())).done;a=!1){const e=r.value;yield*Os(Rs(Ds(e,t)))}}catch(i){n=!0,s=i}finally{try{a&&null!=l.return&&(yield Ls(l.return()))}finally{if(n)throw s}}});return function(t,s){return e.apply(this,arguments)}}(),Us=function(){var e=As(function*(e){if(e[Symbol.asyncIterator])return void(yield*Os(Rs(e)));const t=e.getReader();try{for(;;){const{done:e,value:s}=yield Ls(t.read());if(e)break;yield s}}finally{yield Ls(t.cancel())}});return function(t){return e.apply(this,arguments)}}(),zs=(e,t,s,a)=>{const n=Ms(e,t);let r,l=0,i=e=>{r||(r=!0,a&&a(e))};return new ReadableStream({async pull(e){try{const{done:t,value:a}=await n.next();if(t)return i(),void e.close();let r=a.byteLength;if(s){let e=l+=r;s(e)}e.enqueue(new Uint8Array(a))}catch(t){throw i(t),t}},cancel:e=>(i(e),n.return())},{highWaterMark:2})},Is="function"===typeof fetch&&"function"===typeof Request&&"function"===typeof Response,Gs=Is&&"function"===typeof ReadableStream,Bs=Is&&("function"===typeof TextEncoder?(Ws=new TextEncoder,e=>Ws.encode(e)):async e=>new Uint8Array(await new Response(e).arrayBuffer()));var Ws;const qs=function(e){try{for(var t=arguments.length,s=new Array(t>1?t-1:0),a=1;a<t;a++)s[a-1]=arguments[a];return!!e(...s)}catch(rn){return!1}},Vs=Gs&&qs(()=>{let e=!1;const t=new Request(es.origin,{body:new ReadableStream,method:"POST",get duplex(){return e=!0,"half"}}).headers.has("Content-Type");return e&&!t}),Hs=Gs&&qs(()=>At.isReadableStream(new Response("").body)),Qs={stream:Hs&&(e=>e.body)};var $s;Is&&($s=new Response,["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Qs[e]&&(Qs[e]=At.isFunction($s[e])?t=>t[e]():(t,s)=>{throw new Rt("Response type '".concat(e,"' is not supported"),Rt.ERR_NOT_SUPPORT,s)})}));const Js=async(e,t)=>{const s=At.toFiniteNumber(e.getContentLength());return null==s?(async e=>{if(null==e)return 0;if(At.isBlob(e))return e.size;if(At.isSpecCompliantForm(e)){const t=new Request(es.origin,{method:"POST",body:e});return(await t.arrayBuffer()).byteLength}return At.isArrayBufferView(e)||At.isArrayBuffer(e)?e.byteLength:(At.isURLSearchParams(e)&&(e+=""),At.isString(e)?(await Bs(e)).byteLength:void 0)})(t):s},Ys=Is&&(async e=>{let{url:t,method:s,data:a,signal:n,cancelToken:r,timeout:l,onDownloadProgress:i,onUploadProgress:o,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:m}=Cs(e);c=c?(c+"").toLowerCase():"text";let f,x=Es([n,r&&r.toAbortSignal()],l);const p=x&&x.unsubscribe&&(()=>{x.unsubscribe()});let h;try{if(o&&Vs&&"get"!==s&&"head"!==s&&0!==(h=await Js(d,a))){let e,s=new Request(t,{method:"POST",body:a,duplex:"half"});if(At.isFormData(a)&&(e=s.headers.get("content-type"))&&d.setContentType(e),s.body){const[e,t]=bs(h,ys(vs(o)));a=zs(s.body,65536,e,t)}}At.isString(u)||(u=u?"include":"omit");const n="credentials"in Request.prototype;f=new Request(t,Me(Me({},m),{},{signal:x,method:s.toUpperCase(),headers:d.normalize().toJSON(),body:a,duplex:"half",credentials:n?u:void 0}));let r=await fetch(f,m);const l=Hs&&("stream"===c||"response"===c);if(Hs&&(i||l&&p)){const e={};["status","statusText","headers"].forEach(t=>{e[t]=r[t]});const t=At.toFiniteNumber(r.headers.get("content-length")),[s,a]=i&&bs(t,ys(vs(i),!0))||[];r=new Response(zs(r.body,65536,s,()=>{a&&a(),p&&p()}),e)}c=c||"text";let g=await Qs[At.findKey(Qs,c)||"text"](r,e);return!l&&p&&p(),await new Promise((t,s)=>{ps(t,s,{data:g,headers:ds.from(r.headers),status:r.status,statusText:r.statusText,config:e,request:f})})}catch(g){if(p&&p(),g&&"TypeError"===g.name&&/Load failed|fetch/i.test(g.message))throw Object.assign(new Rt("Network Error",Rt.ERR_NETWORK,e,f),{cause:g.cause||g});throw Rt.from(g,g&&g.code,e,f)}}),Ks={http:null,xhr:_s,fetch:Ys};At.forEach(Ks,(e,t)=>{if(e){try{Object.defineProperty(e,"name",{value:t})}catch(rn){}Object.defineProperty(e,"adapterName",{value:t})}});const Xs=e=>"- ".concat(e),Zs=e=>At.isFunction(e)||null===e||!1===e,ea=e=>{e=At.isArray(e)?e:[e];const{length:t}=e;let s,a;const n={};for(let r=0;r<t;r++){let t;if(s=e[r],a=s,!Zs(s)&&(a=Ks[(t=String(s)).toLowerCase()],void 0===a))throw new Rt("Unknown adapter '".concat(t,"'"));if(a)break;n[t||"#"+r]=a}if(!a){const e=Object.entries(n).map(e=>{let[t,s]=e;return"adapter ".concat(t," ")+(!1===s?"is not supported by the environment":"is not available in the build")});let s=t?e.length>1?"since :\n"+e.map(Xs).join("\n"):" "+Xs(e[0]):"as no adapter specified";throw new Rt("There is no suitable adapter to dispatch the request "+s,"ERR_NOT_SUPPORT")}return a};function ta(e){if(e.cancelToken&&e.cancelToken.throwIfRequested(),e.signal&&e.signal.aborted)throw new xs(null,e)}function sa(e){ta(e),e.headers=ds.from(e.headers),e.data=us.call(e,e.transformRequest),-1!==["post","put","patch"].indexOf(e.method)&&e.headers.setContentType("application/x-www-form-urlencoded",!1);return ea(e.adapter||as.adapter)(e).then(function(t){return ta(e),t.data=us.call(e,e.transformResponse,t),t.headers=ds.from(t.headers),t},function(t){return ms(t)||(ta(e),t&&t.response&&(t.response.data=us.call(e,e.transformResponse,t.response),t.response.headers=ds.from(t.response.headers))),Promise.reject(t)})}const aa="1.11.0",na={};["object","boolean","number","function","string","symbol"].forEach((e,t)=>{na[e]=function(s){return typeof s===e||"a"+(t<1?"n ":" ")+e}});const ra={};na.transitional=function(e,t,s){function a(e,t){return"[Axios v"+aa+"] Transitional option '"+e+"'"+t+(s?". "+s:"")}return(s,n,r)=>{if(!1===e)throw new Rt(a(n," has been removed"+(t?" in "+t:"")),Rt.ERR_DEPRECATED);return t&&!ra[n]&&(ra[n]=!0,console.warn(a(n," has been deprecated since v"+t+" and will be removed in the near future"))),!e||e(s,n,r)}},na.spelling=function(e){return(t,s)=>(console.warn("".concat(s," is likely a misspelling of ").concat(e)),!0)};const la={assertOptions:function(e,t,s){if("object"!==typeof e)throw new Rt("options must be an object",Rt.ERR_BAD_OPTION_VALUE);const a=Object.keys(e);let n=a.length;for(;n-- >0;){const r=a[n],l=t[r];if(l){const t=e[r],s=void 0===t||l(t,r,e);if(!0!==s)throw new Rt("option "+r+" must be "+s,Rt.ERR_BAD_OPTION_VALUE);continue}if(!0!==s)throw new Rt("Unknown option "+r,Rt.ERR_BAD_OPTION)}},validators:na},ia=la.validators;class oa{constructor(e){this.defaults=e||{},this.interceptors={request:new Ht,response:new Ht}}async request(e,t){try{return await this._request(e,t)}catch(s){if(s instanceof Error){let e={};Error.captureStackTrace?Error.captureStackTrace(e):e=new Error;const t=e.stack?e.stack.replace(/^.+\n/,""):"";try{s.stack?t&&!String(s.stack).endsWith(t.replace(/^.+\n.+\n/,""))&&(s.stack+="\n"+t):s.stack=t}catch(rn){}}throw s}}_request(e,t){"string"===typeof e?(t=t||{}).url=e:t=e||{},t=Ss(this.defaults,t);const{transitional:s,paramsSerializer:a,headers:n}=t;void 0!==s&&la.assertOptions(s,{silentJSONParsing:ia.transitional(ia.boolean),forcedJSONParsing:ia.transitional(ia.boolean),clarifyTimeoutError:ia.transitional(ia.boolean)},!1),null!=a&&(At.isFunction(a)?t.paramsSerializer={serialize:a}:la.assertOptions(a,{encode:ia.function,serialize:ia.function},!0)),void 0!==t.allowAbsoluteUrls||(void 0!==this.defaults.allowAbsoluteUrls?t.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:t.allowAbsoluteUrls=!0),la.assertOptions(t,{baseUrl:ia.spelling("baseURL"),withXsrfToken:ia.spelling("withXSRFToken")},!0),t.method=(t.method||this.defaults.method||"get").toLowerCase();let r=n&&At.merge(n.common,n[t.method]);n&&At.forEach(["delete","get","head","post","put","patch","common"],e=>{delete n[e]}),t.headers=ds.concat(r,n);const l=[];let i=!0;this.interceptors.request.forEach(function(e){"function"===typeof e.runWhen&&!1===e.runWhen(t)||(i=i&&e.synchronous,l.unshift(e.fulfilled,e.rejected))});const o=[];let c;this.interceptors.response.forEach(function(e){o.push(e.fulfilled,e.rejected)});let d,u=0;if(!i){const e=[sa.bind(this),void 0];for(e.unshift(...l),e.push(...o),d=e.length,c=Promise.resolve(t);u<d;)c=c.then(e[u++],e[u++]);return c}d=l.length;let m=t;for(u=0;u<d;){const e=l[u++],t=l[u++];try{m=e(m)}catch(f){t.call(this,f);break}}try{c=sa.call(this,m)}catch(f){return Promise.reject(f)}for(u=0,d=o.length;u<d;)c=c.then(o[u++],o[u++]);return c}getUri(e){return Vt(Ns((e=Ss(this.defaults,e)).baseURL,e.url,e.allowAbsoluteUrls),e.params,e.paramsSerializer)}}At.forEach(["delete","get","head","options"],function(e){oa.prototype[e]=function(t,s){return this.request(Ss(s||{},{method:e,url:t,data:(s||{}).data}))}}),At.forEach(["post","put","patch"],function(e){function t(t){return function(s,a,n){return this.request(Ss(n||{},{method:e,headers:t?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}oa.prototype[e]=t(),oa.prototype[e+"Form"]=t(!0)});const ca=oa;class da{constructor(e){if("function"!==typeof e)throw new TypeError("executor must be a function.");let t;this.promise=new Promise(function(e){t=e});const s=this;this.promise.then(e=>{if(!s._listeners)return;let t=s._listeners.length;for(;t-- >0;)s._listeners[t](e);s._listeners=null}),this.promise.then=e=>{let t;const a=new Promise(e=>{s.subscribe(e),t=e}).then(e);return a.cancel=function(){s.unsubscribe(t)},a},e(function(e,a,n){s.reason||(s.reason=new xs(e,a,n),t(s.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){this.reason?e(this.reason):this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const t=this._listeners.indexOf(e);-1!==t&&this._listeners.splice(t,1)}toAbortSignal(){const e=new AbortController,t=t=>{e.abort(t)};return this.subscribe(t),e.signal.unsubscribe=()=>this.unsubscribe(t),e.signal}static source(){let e;return{token:new da(function(t){e=t}),cancel:e}}}const ua=da;const ma={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(ma).forEach(e=>{let[t,s]=e;ma[s]=t});const fa=ma;const xa=function e(t){const s=new ca(t),a=qe(ca.prototype.request,s);return At.extend(a,ca.prototype,s,{allOwnKeys:!0}),At.extend(a,s,null,{allOwnKeys:!0}),a.create=function(s){return e(Ss(t,s))},a}(as);xa.Axios=ca,xa.CanceledError=xs,xa.CancelToken=ua,xa.isCancel=ms,xa.VERSION=aa,xa.toFormData=zt,xa.AxiosError=Rt,xa.Cancel=xa.CanceledError,xa.all=function(e){return Promise.all(e)},xa.spread=function(e){return function(t){return e.apply(null,t)}},xa.isAxiosError=function(e){return At.isObject(e)&&!0===e.isAxiosError},xa.mergeConfig=Ss,xa.AxiosHeaders=ds,xa.formToJSON=e=>ts(At.isHTMLForm(e)?new FormData(e):e),xa.getAdapter=ea,xa.HttpStatusCode=fa,xa.default=xa;const pa=xa,ha=(0,r.createContext)(),ga=e=>{let{children:t}=e;const[s,a]=(0,r.useState)(null),[n,l]=(0,r.useState)([]),[i,o]=(0,r.useState)(!0),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(0);(0,r.useEffect)(()=>{console.log("\ud83d\udd04 LocationContext State Update:"),console.log("   - selectedLocation:",s),console.log("   - locations:",n),console.log("   - loading:",i),console.log("   - updateVersion:",u)},[s,n,i,u]),(0,r.useEffect)(()=>{f()},[]);const f=async()=>{try{console.log("\ud83d\udd0d Fetching active location from backend...");const e=await pa.get("".concat(Ue,"/api/sites/active/"),{withCredentials:!0});if(console.log("\ud83d\udce1 Backend response:",e.data),e.data&&e.data.id){if("all"===e.data.id){a({id:"all",name:"All Locations",location:"Combined View",address:"All sites aggregated",is_active:!0}),console.log("\ud83c\udf0d Restored All Locations view from backend")}else a(e.data),console.log("\ud83d\udccd Restored location:",e.data.name);m(e=>e+1)}else console.log("\u2139\ufe0f No active location set in backend")}catch(t){var e;404===(null===(e=t.response)||void 0===e?void 0:e.status)?console.log("\u2139\ufe0f No active location (404)"):console.error("\u274c Error fetching active location:",t)}finally{o(!1),console.log("\u2705 Location loading complete")}},x=(0,r.useCallback)(async e=>{try{const t=(await pa.get("".concat(Ue,"/api/sites/?company_id=").concat(e),{withCredentials:!0})).data.results||[];return l(t),s&&"all"!==s.id&&!t.find(e=>e.id===s.id)&&a(null),t}catch(t){return console.error("Error fetching locations:",t),d("Failed to load locations"),[]}},[s]),p=(0,r.useCallback)(async e=>{if(console.log("\ud83c\udfaf LocationContext.selectLocation called with:",e),console.log("   Previous location:",null===s||void 0===s?void 0:s.name,"(ID: ".concat(null===s||void 0===s?void 0:s.id,")")),console.log("   New location:",null===e||void 0===e?void 0:e.name,"(ID: ".concat(null===e||void 0===e?void 0:e.id,")")),(null===s||void 0===s?void 0:s.id)===(null===e||void 0===e?void 0:e.id))return console.log("   Location already selected, skipping..."),!0;try{if("all"===e.id){console.log("\ud83d\udce1 Setting All Locations view via backend...");await pa.post("".concat(Ue,"/api/sites/set_all_locations/"),{},{withCredentials:!0});console.log("\u2705 Backend updated for All Locations view");const t=Me({},e);return a(t),d(null),m(e=>e+1),console.log("\ud83c\udf0d LocationContext state updated to: All Locations view"),!0}await pa.post("".concat(Ue,"/api/sites/").concat(e.id,"/set_active/"),{},{withCredentials:!0});console.log("\u2705 Backend updated for location ".concat(e.name));const t=Me({},e);return a(t),d(null),m(e=>e+1),console.log("\ud83d\udccd LocationContext state updated to:",t.name),l(t=>t.map(t=>t.id===e.id?Me(Me({},t),{},{is_active:!0}):Me(Me({},t),{},{is_active:!1}))),!0}catch(t){return console.error("\u274c Error setting active location:",t),d("Failed to set active location"),!1}},[s]),h=r.useMemo(()=>({selectedLocation:s,locations:n,loading:i,error:c,selectLocation:p,fetchLocations:x,fetchActiveLocation:f,updateVersion:u}),[s,n,i,c,p,x,u]);return(0,ze.jsx)(ha.Provider,{value:h,children:t})},ya=()=>{const e=(0,r.useContext)(ha);if(!e)throw new Error("useLocationContext must be used within a LocationProvider");return e},ba=e=>{let{children:t}=e;const{user:s,loading:a}=Be(),n=te();return a?(0,ze.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center",children:(0,ze.jsx)("div",{className:"bg-white rounded-lg p-8 shadow-lg",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Loading ESG Portal"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Checking authentication..."})]})]})})}):s?t:(0,ze.jsx)(ye,{to:"/login",state:{from:n},replace:!0})},va=()=>{const[e,t]=(0,r.useState)({email:"",password:"",companyCode:""}),[s,a]=(0,r.useState)(!1),[n,l]=(0,r.useState)(""),{login:i}=Be(),o=s=>{t(Me(Me({},e),{},{[s.target.name]:s.target.value}))};return(0,ze.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,ze.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{className:"mx-auto h-20 w-20 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-leaf text-white text-2xl"})}),(0,ze.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:"Sign in to ESG Portal"}),(0,ze.jsxs)("p",{className:"mt-2 text-center text-sm text-gray-600",children:["Or"," ",(0,ze.jsx)(Ae,{to:"/signup",className:"font-medium text-purple-600 hover:text-purple-500",children:"create a new account"})]})]}),(0,ze.jsxs)("form",{className:"mt-8 space-y-6 bg-white p-8 rounded-xl shadow-lg",onSubmit:async t=>{t.preventDefault(),a(!0),l("");const s=await i(e.email,e.password,e.companyCode);s.success||l(s.error),a(!1)},children:[n&&(0,ze.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:(0,ze.jsxs)("div",{className:"flex",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-circle mt-1 mr-3 text-red-500"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("strong",{className:"font-medium",children:"Authentication Error"}),(0,ze.jsx)("p",{className:"text-sm",children:n})]})]})}),(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"email",name:"email",type:"email",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter your email",value:e.email,onChange:o}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,ze.jsx)("i",{className:"fas fa-envelope text-gray-400"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{htmlFor:"companyCode",className:"block text-sm font-medium text-gray-700",children:["Company Code ",(0,ze.jsx)("span",{className:"text-gray-500 text-xs",children:"(Optional)"})]}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"companyCode",name:"companyCode",type:"text",className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter company code (if provided)",value:e.companyCode,onChange:o}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,ze.jsx)("i",{className:"fas fa-building text-gray-400"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter your password",value:e.password,onChange:o}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,ze.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]})]}),(0,ze.jsx)("div",{children:(0,ze.jsx)("button",{type:"submit",disabled:s,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:s?(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Signing in..."]}):(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-sign-in-alt mr-2"}),"Sign in"]})})}),(0,ze.jsx)("div",{className:"text-center",children:(0,ze.jsx)(Ae,{to:"/forgot-password",className:"text-sm text-purple-600 hover:text-purple-500",children:"Forgot your password?"})})]})]})})},ja=e=>{let{message:t,type:s="info",code:a=null,link:n=null,duration:l=1e4,onClose:i}=e;const[o,c]=(0,r.useState)(!0);(0,r.useEffect)(()=>{if(l>0){const e=setTimeout(()=>{c(!1),i&&i()},l);return()=>clearTimeout(e)}},[l,i]);if(!o)return null;return(0,ze.jsx)("div",{className:"fixed top-4 right-4 z-50 max-w-sm w-full",children:(0,ze.jsx)("div",{className:"border rounded-lg p-4 shadow-lg ".concat((()=>{switch(s){case"success":case"link":return"bg-green-50 border-green-200 text-green-800";case"error":return"bg-red-50 border-red-200 text-red-800";case"warning":return"bg-yellow-50 border-yellow-200 text-yellow-800";case"code":return"bg-purple-50 border-purple-200 text-purple-800";default:return"bg-blue-50 border-blue-200 text-blue-800"}})()," animate-slide-in-right"),children:(0,ze.jsxs)("div",{className:"flex items-start justify-between",children:[(0,ze.jsxs)("div",{className:"flex items-start",children:[(0,ze.jsx)("i",{className:"".concat((()=>{switch(s){case"success":return"fas fa-check-circle text-green-600";case"error":return"fas fa-exclamation-circle text-red-600";case"warning":return"fas fa-exclamation-triangle text-yellow-600";case"code":return"fas fa-code text-purple-600";case"link":return"fas fa-link text-green-600";default:return"fas fa-info-circle text-blue-600"}})()," mt-1 mr-3")}),(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("p",{className:"text-sm font-medium",children:t}),a&&(0,ze.jsxs)("div",{className:"mt-2",children:[(0,ze.jsx)("p",{className:"text-xs opacity-75 mb-1",children:"Verification Code:"}),(0,ze.jsx)("p",{className:"font-bold text-lg font-mono bg-white bg-opacity-50 px-2 py-1 rounded inline-block",children:a})]}),n&&(0,ze.jsxs)("div",{className:"mt-2",children:[(0,ze.jsx)("p",{className:"text-xs opacity-75 mb-1",children:"Magic Link:"}),(0,ze.jsx)("a",{href:n,target:"_blank",rel:"noopener noreferrer",className:"text-sm text-green-700 hover:text-green-900 underline break-all bg-white bg-opacity-50 px-2 py-1 rounded block",children:"Click to verify \u2192"})]})]})]}),(0,ze.jsx)("button",{onClick:()=>{c(!1),i&&i()},className:"ml-3 text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]})})})},wa=()=>{const[e,t]=(0,r.useState)({username:"",email:"",companyName:"",password:"",confirmPassword:""}),[s,a]=(0,r.useState)(!1),[n,l]=(0,r.useState)(""),[i,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)(null),[u,m]=(0,r.useState)(!1),[f,x]=(0,r.useState)(""),[p,h]=(0,r.useState)(!1),[g,y]=(0,r.useState)(!1),[b,v]=(0,r.useState)(null),{signup:j,login:w}=Be(),N=s=>{t(Me(Me({},e),{},{[s.target.name]:s.target.value}))},k=async()=>{if(b)try{y(!1),window.location.href="/onboard"}catch(n){console.error("Auto-login error:",n),window.location.href="/login"}},S=()=>g&&b?(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50",children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-8 max-w-md w-full mx-4 text-center",children:[(0,ze.jsxs)("div",{className:"mb-6",children:[(0,ze.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-4",children:(0,ze.jsx)("i",{className:"fas fa-check text-green-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-2",children:"Email Verified Successfully!"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Welcome to ESG Portal! Let's get your account set up."})]}),(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsx)("button",{onClick:k,className:"w-full bg-purple-600 text-white py-3 px-4 rounded-lg hover:bg-purple-700 focus:ring-4 focus:ring-purple-300 font-medium",children:"Continue to Setup"}),(0,ze.jsx)("button",{onClick:()=>{y(!1),window.location.href="/login"},className:"w-full text-gray-600 hover:text-gray-800 py-2",children:"Go to Login Instead"})]})]})}):null;return(0,ze.jsxs)(ze.Fragment,{children:[p&&(null===c||void 0===c?void 0:c.magic_link_url)&&(0,ze.jsx)(ja,{type:"link",message:"\ud83e\uddea Testing Mode - Magic Link Generated!",link:c.magic_link_url,duration:15e3,onClose:()=>h(!1)}),(0,ze.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-50 to-blue-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,ze.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{className:"mx-auto h-20 w-20 bg-gradient-to-r from-purple-600 to-blue-600 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-leaf text-white text-2xl"})}),(0,ze.jsx)("h2",{className:"mt-6 text-center text-3xl font-extrabold text-gray-900",children:i?u?"Check Your Email":"Account Created!":"Create your account"}),(0,ze.jsx)("p",{className:"mt-2 text-center text-sm text-gray-600",children:i?u?"Click the verification link in your email to activate your account":"":(0,ze.jsxs)(ze.Fragment,{children:["Already have an account?"," ",(0,ze.jsx)(Ae,{to:"/login",className:"font-medium text-purple-600 hover:text-purple-500",children:"Sign in here"})]})})]}),i?u?(0,ze.jsxs)("div",{className:"mt-8 space-y-6 bg-white p-8 rounded-xl shadow-lg",children:[(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"mx-auto h-16 w-16 bg-blue-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-envelope text-blue-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Verification Link Sent!"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"We've sent a verification link to:"}),(0,ze.jsx)("p",{className:"font-semibold text-gray-900 mb-4",children:null===c||void 0===c?void 0:c.userEmail})]}),(0,ze.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4",children:(0,ze.jsxs)("div",{className:"flex items-start",children:[(0,ze.jsx)("i",{className:"fas fa-mouse-pointer text-blue-600 mt-1 mr-3"}),(0,ze.jsxs)("div",{className:"text-left text-sm text-blue-800",children:[(0,ze.jsx)("p",{className:"font-medium mb-2",children:"What to do next:"}),(0,ze.jsxs)("ol",{className:"list-decimal list-inside space-y-1 text-sm",children:[(0,ze.jsx)("li",{children:"Check your email inbox (and spam folder)"}),(0,ze.jsx)("li",{children:"Click the verification link in the email"}),(0,ze.jsx)("li",{children:"You'll be automatically logged in and redirected"})]})]})]})}),(null===c||void 0===c?void 0:c.magic_link_url)&&(0,ze.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-4",children:(0,ze.jsxs)("div",{className:"flex items-start",children:[(0,ze.jsx)("i",{className:"fas fa-link text-yellow-600 mt-1 mr-3"}),(0,ze.jsxs)("div",{className:"text-left text-sm text-yellow-800",children:[(0,ze.jsx)("p",{className:"font-medium mb-1",children:"\ud83e\uddea Testing Mode - Magic Link:"}),(0,ze.jsx)("a",{href:c.magic_link_url,className:"text-blue-600 hover:text-blue-800 underline break-all text-xs",target:"_blank",rel:"noopener noreferrer",children:c.magic_link_url}),(0,ze.jsx)("p",{className:"text-xs mt-1",children:null!==c&&void 0!==c&&c.emailSent?"Also sent to your email":"Email sending failed - using test mode"})]})]})}),(0,ze.jsx)("div",{className:"text-center",children:(0,ze.jsx)("button",{type:"button",onClick:()=>{m(!1),o(!1),x(""),l("")},className:"text-sm text-purple-600 hover:text-purple-500",children:"\u2190 Back to signup"})})]}):(0,ze.jsx)("div",{className:"mt-8 bg-white p-8 rounded-xl shadow-lg",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"mx-auto h-16 w-16 bg-green-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-check-circle text-green-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Account Created Successfully!"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:null===c||void 0===c?void 0:c.message}),(0,ze.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-4 mb-6",children:(0,ze.jsxs)("div",{className:"flex items-start",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle text-blue-600 mt-1 mr-3"}),(0,ze.jsxs)("div",{className:"text-left text-sm text-blue-800",children:[(0,ze.jsx)("p",{className:"font-medium mb-1",children:"What happens next:"}),(0,ze.jsxs)("ul",{className:"space-y-1",children:[(0,ze.jsxs)("li",{children:["\u2022 Check your email at ",(0,ze.jsx)("strong",{children:null===c||void 0===c?void 0:c.userEmail})]}),(0,ze.jsx)("li",{children:"\u2022 Click the verification link in the email"}),(0,ze.jsx)("li",{children:"\u2022 Your account will be activated"}),(0,ze.jsx)("li",{children:"\u2022 You can then log in to start using ESG Portal"})]})]})]})}),(0,ze.jsxs)("div",{className:"flex space-x-4",children:[(0,ze.jsx)(Ae,{to:"/login",className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:"Go to Login"}),(0,ze.jsx)("button",{onClick:()=>{o(!1),d(null),l("")},className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium",children:"Sign Up Again"})]})]})}):(0,ze.jsxs)("form",{className:"mt-8 space-y-6 bg-white p-8 rounded-xl shadow-lg",onSubmit:async t=>{if(t.preventDefault(),a(!0),l(""),!(e.email&&e.email.trim()?e.companyName&&e.companyName.trim()?e.password!==e.confirmPassword?(l("Passwords do not match"),0):e.password.length<6?(l("Password must be at least 6 characters long"),0):!(e.username.length<3)||(l("Username must be at least 3 characters long"),0):(l("Company name is required"),0):(l("Email address is required"),0)))return void a(!1);const s=await j(e.username,e.email,e.companyName,e.password);s.success&&s.emailVerification?(o(!0),m(!0),d(s),s.verificationCode&&h(!0)):s.success||l(s.error),a(!1)},children:[n&&(0,ze.jsx)("div",{className:"bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-md",children:(0,ze.jsxs)("div",{className:"flex",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-circle mt-1 mr-3 text-red-500"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("strong",{className:"font-medium",children:"Signup Error"}),(0,ze.jsx)("p",{className:"text-sm",children:n})]})]})}),(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"username",className:"block text-sm font-medium text-gray-700",children:"Username"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"username",name:"username",type:"text",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Choose a username",value:e.username,onChange:N}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,ze.jsx)("i",{className:"fas fa-user text-gray-400"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"email",className:"block text-sm font-medium text-gray-700",children:"Email Address"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"email",name:"email",type:"email",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter your email address",value:e.email,onChange:N}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,ze.jsx)("i",{className:"fas fa-envelope text-gray-400"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"companyName",className:"block text-sm font-medium text-gray-700",children:"Company Name"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"companyName",name:"companyName",type:"text",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Enter your company name",value:e.companyName,onChange:N}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,ze.jsx)("i",{className:"fas fa-building text-gray-400"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"password",className:"block text-sm font-medium text-gray-700",children:"Password"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"password",name:"password",type:"password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Choose a password (min 6 characters)",value:e.password,onChange:N}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,ze.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm Password"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-md focus:outline-none focus:ring-purple-500 focus:border-purple-500 focus:z-10 sm:text-sm",placeholder:"Confirm your password",value:e.confirmPassword,onChange:N}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center pointer-events-none",children:(0,ze.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]})]}),(0,ze.jsx)("div",{children:(0,ze.jsx)("button",{type:"submit",disabled:s,className:"group relative w-full flex justify-center py-2 px-4 border border-transparent text-sm font-medium rounded-md text-white bg-gradient-to-r from-purple-600 to-blue-600 hover:from-purple-700 hover:to-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-purple-500 disabled:opacity-50 disabled:cursor-not-allowed",children:s?(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Creating account..."]}):(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-user-plus mr-2"}),"Create account"]})})}),(0,ze.jsxs)("div",{className:"text-center text-xs text-gray-600",children:["By creating an account, you agree to our"," ",(0,ze.jsx)(Ae,{to:"/terms",className:"text-purple-600 hover:text-purple-500",children:"Terms of Service"})," ","and"," ",(0,ze.jsx)(Ae,{to:"/privacy",className:"text-purple-600 hover:text-purple-500",children:"Privacy Policy"})]})]})]})}),(0,ze.jsx)(S,{})]})},Na=()=>{var e,t,s,a,n,l,i,o;const c=ae(),d=te(),{user:u,logout:m,selectedCompany:f,companies:x,userSites:p,selectedSite:h,switchSite:g,hasPermission:y}=Be(),{selectedLocation:b,locations:v,selectLocation:j,fetchLocations:w,updateVersion:N}=ya(),[k,S]=(0,r.useState)(!1),[C,_]=(0,r.useState)(!1),[E,P]=(0,r.useState)({canAccessLocationPage:!1,canChangeLocation:!1,showLocationDropdown:!1,role:"viewer",assignedSiteCount:0}),A=(0,r.useRef)(null);(0,r.useEffect)(()=>{f&&w(f.id),u&&(async()=>{try{const e=await Ie("".concat(Ue,"/api/user/permissions/"));if(e.ok){const t=await e.json();P(t)}}catch(e){console.error("Failed to fetch user permissions:",e)}})()},[f,u]),(0,r.useEffect)(()=>{const e=e=>{A.current&&!A.current.contains(e.target)&&_(!1)};return document.addEventListener("mousedown",e),()=>{document.removeEventListener("mousedown",e)}},[]);const T=[{path:"/onboard",label:"Company Info",icon:"fa-solid fa-building"},{path:"/rame",label:"Frameworks",icon:"fa-solid fa-clipboard-list"},{path:"/location",label:"Locations",icon:"fa-solid fa-map-marker-alt"},{path:"/list",label:"Profiling",icon:"fa-solid fa-list-check"},{path:"/meter",label:"Meters",icon:"fa-solid fa-tachometer-alt"},{path:"/data",label:"Data Collection",icon:"fa-solid fa-chart-line"},{path:"/team",label:"Team",icon:"fa-solid fa-users"},{path:"/dashboard",label:"Dashboard",icon:"fa-solid fa-chart-pie"}],L=e=>d.pathname===e,O=()=>{S(!1)};return(0,ze.jsxs)("div",{className:"bg-gradient-to-br from-purple-600 via-purple-700 to-blue-700 shadow-2xl relative",style:{zIndex:1e3},children:[(0,ze.jsx)("div",{className:"absolute inset-0 bg-gradient-to-r from-purple-600/20 to-blue-600/20 backdrop-blur-sm"}),(0,ze.jsx)("div",{className:"absolute top-0 right-0 w-96 h-96 bg-white/5 rounded-full -mr-48 -mt-48"}),(0,ze.jsx)("div",{className:"absolute bottom-0 left-0 w-72 h-72 bg-white/5 rounded-full -ml-36 -mb-36"}),(0,ze.jsxs)("header",{className:"relative z-20 px-6 md:px-8 lg:px-10 py-4 md:py-5",children:[(0,ze.jsxs)("nav",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("button",{onClick:()=>c("/"),className:"flex items-center space-x-2 hover:opacity-80 transition-opacity flex-shrink-0",children:[(0,ze.jsx)("div",{className:"w-8 h-8 md:w-9 md:h-9 bg-white rounded-xl flex items-center justify-center shadow-lg",children:(0,ze.jsx)("i",{className:"fas fa-leaf text-purple-600 text-lg md:text-xl"})}),(0,ze.jsx)("span",{className:"text-white font-bold text-base md:text-lg xl:text-xl",children:"ESG Portal"})]}),(0,ze.jsx)("div",{className:"hidden lg:flex flex-1 justify-center mx-4",children:(0,ze.jsx)("div",{className:"flex items-center gap-1 xl:gap-2 bg-white/10 px-2 py-1.5 rounded-xl backdrop-blur-sm",children:T.map(e=>(0,ze.jsxs)("button",{onClick:()=>c(e.path),className:"flex items-center space-x-1 xl:space-x-2 px-2 xl:px-3 py-1.5 rounded-lg font-medium transition-all duration-200 whitespace-nowrap ".concat(L(e.path)?"bg-white/20 text-white shadow-md":"text-gray-300 hover:text-white hover:bg-purple-600/20"),children:[(0,ze.jsx)("i",{className:"".concat(e.icon," text-sm ").concat(L(e.path)?"text-white":"")}),(0,ze.jsx)("span",{className:"text-sm xl:text-base",children:e.label})]},e.path))})}),(0,ze.jsxs)("div",{className:"hidden lg:flex items-center space-x-1 xl:space-x-2 flex-shrink-0",children:[v&&v.length>0&&E.showLocationDropdown&&(0,ze.jsxs)("div",{className:"relative",ref:A,children:[(0,ze.jsxs)("button",{onClick:()=>_(!C),className:"flex items-center space-x-1 xl:space-x-2 text-xs bg-white/10 border border-white/20 rounded-md px-2 xl:px-3 py-1.5 text-white backdrop-blur-sm hover:bg-white/20 focus:outline-none focus:ring-2 focus:ring-purple-500",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-xs"}),(0,ze.jsx)("span",{className:"max-w-[120px] xl:max-w-[150px] truncate",children:"all"===(null===b||void 0===b?void 0:b.id)?"All":b?b.name:"Select Location"}),(0,ze.jsx)("i",{className:"fas fa-chevron-down text-xs transition-transform ".concat(C?"rotate-180":"")})]},"".concat((null===b||void 0===b?void 0:b.id)||"no-location","-").concat(N)),C&&(0,ze.jsx)("div",{className:"absolute right-0 mt-2 w-64 bg-white rounded-lg shadow-xl overflow-hidden z-50",children:(0,ze.jsxs)("div",{className:"py-2",children:[(0,ze.jsx)("button",{onClick:async()=>{await j({id:"all",name:"All Locations",location:"Combined View",address:"All sites aggregated",is_active:!0}),_(!1)},className:"w-full text-left px-4 py-3 hover:bg-purple-50 transition-colors border-b border-gray-100 ".concat("all"===(null===b||void 0===b?void 0:b.id)?"bg-purple-100 text-purple-700":"text-gray-700"),children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-gradient-to-br from-purple-500 to-blue-500 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-globe text-white text-sm"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{className:"font-medium",children:"All Locations"}),(0,ze.jsx)("div",{className:"text-xs text-gray-500",children:"Combined view"})]})]}),"all"===(null===b||void 0===b?void 0:b.id)&&(0,ze.jsx)("i",{className:"fas fa-check text-purple-600"})]})},"all-locations"),v.map(e=>(0,ze.jsx)("button",{onClick:async()=>{await j(e),_(!1)},className:"w-full text-left px-4 py-2 hover:bg-purple-50 transition-colors ".concat((null===b||void 0===b?void 0:b.id)===e.id?"bg-purple-100 text-purple-700":"text-gray-700"),children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{className:"font-medium",children:e.name}),e.location&&(0,ze.jsx)("div",{className:"text-xs text-gray-500",children:e.location})]}),(null===b||void 0===b?void 0:b.id)===e.id&&(0,ze.jsx)("i",{className:"fas fa-check text-purple-600"})]})},e.id)),(0,ze.jsx)("div",{className:"border-t mt-2 pt-2",children:(0,ze.jsxs)("button",{onClick:()=>{c("/location"),_(!1)},className:"w-full text-left px-4 py-2 text-purple-600 hover:bg-purple-50 transition-colors",children:[(0,ze.jsx)("i",{className:"fas fa-plus mr-2"}),"Manage Locations"]})})]})})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("div",{className:"w-7 h-7 xl:w-8 xl:h-8 rounded-full ring-2 ring-purple-300 bg-purple-500 flex items-center justify-center",children:(0,ze.jsx)("span",{className:"text-white text-xs xl:text-sm font-medium",children:(null===u||void 0===u||null===(e=u.name)||void 0===e||null===(t=e.charAt(0))||void 0===t?void 0:t.toUpperCase())||(null===u||void 0===u||null===(s=u.username)||void 0===s||null===(a=s.charAt(0))||void 0===a?void 0:a.toUpperCase())||"U"})}),(0,ze.jsxs)("div",{className:"hidden xl:flex flex-col max-w-[120px]",children:[(0,ze.jsx)("span",{className:"text-white text-xs font-medium truncate",children:(null===u||void 0===u?void 0:u.name)||(null===u||void 0===u?void 0:u.username)||"User"}),(null===u||void 0===u?void 0:u.role)&&(0,ze.jsx)("span",{className:"text-xs text-purple-200 truncate",children:u.role.replace("_"," ")})]})]}),(0,ze.jsx)("button",{onClick:m,className:"p-1.5 xl:p-2 text-gray-300 hover:text-white hover:bg-white/10 rounded-lg transition-colors",title:"Logout",children:(0,ze.jsx)("i",{className:"fa-solid fa-sign-out-alt text-sm"})})]}),(0,ze.jsx)("button",{onClick:()=>{S(!k)},className:"lg:hidden text-white p-2.5 rounded-lg hover:bg-white/10 transition-colors relative z-50","aria-label":"Toggle mobile menu",type:"button",children:(0,ze.jsx)("i",{className:"fa-solid ".concat(k?"fa-times":"fa-bars"," text-xl")})})]}),k&&(0,ze.jsx)("div",{className:"lg:hidden absolute top-full left-0 right-0 bg-purple-700/95 backdrop-blur-md border-t border-white/10 shadow-lg",style:{zIndex:9999},children:(0,ze.jsxs)("div",{className:"px-6 py-4 space-y-2",children:[T.map(e=>(0,ze.jsxs)("button",{onClick:()=>{c(e.path),O()},className:"flex items-center space-x-3 px-4 py-3 rounded-lg font-medium w-full text-left transition-colors ".concat(L(e.path)?"bg-white/10 text-white":"text-gray-300 hover:text-white hover:bg-purple-600/20"),children:[(0,ze.jsx)("i",{className:"".concat(e.icon," ").concat(L(e.path)?"text-white":"")}),(0,ze.jsx)("span",{children:e.label})]},e.path)),v&&v.length>0&&E.showLocationDropdown&&(0,ze.jsxs)("div",{className:"border-t border-white/10 pt-4 mt-4",children:[(0,ze.jsxs)("label",{className:"text-gray-300 text-sm mb-2 block",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt mr-2"}),"Location"]}),(0,ze.jsxs)("select",{value:(null===b||void 0===b?void 0:b.id)||"",onChange:async e=>{const t=e.target.value;if("all"===t){const e={id:"all",name:"All Locations",location:"Combined View",address:"All sites aggregated",is_active:!0};await j(e)}else if(t){const e=v.find(e=>e.id===parseInt(t));e&&await j(e)}},className:"w-full bg-white/10 border border-white/20 rounded-md px-3 py-2 text-white backdrop-blur-sm",children:[(0,ze.jsx)("option",{value:"",className:"text-gray-800",children:"Select Location"}),(0,ze.jsx)("option",{value:"all",className:"text-gray-800",children:"All Locations"}),v.map(e=>(0,ze.jsx)("option",{value:e.id,className:"text-gray-800",children:e.name},e.id))]}),(0,ze.jsxs)("button",{onClick:()=>{c("/location"),O()},className:"mt-2 w-full text-left px-3 py-2 text-purple-300 hover:text-white transition-colors text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-cog mr-2"}),"Manage Locations"]})]}),(0,ze.jsxs)("div",{className:"border-t border-white/10 pt-4 mt-4",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-2",children:[(0,ze.jsx)("div",{className:"w-9 h-9 rounded-full ring-2 ring-purple-300 bg-purple-500 flex items-center justify-center",children:(0,ze.jsx)("span",{className:"text-white text-sm font-medium",children:(null===u||void 0===u||null===(n=u.name)||void 0===n||null===(l=n.charAt(0))||void 0===l?void 0:l.toUpperCase())||(null===u||void 0===u||null===(i=u.username)||void 0===i||null===(o=i.charAt(0))||void 0===o?void 0:o.toUpperCase())||"U"})}),(0,ze.jsxs)("div",{className:"flex flex-col",children:[(0,ze.jsx)("span",{className:"text-white text-sm font-medium",children:(null===u||void 0===u?void 0:u.name)||(null===u||void 0===u?void 0:u.username)||"User"}),(null===u||void 0===u?void 0:u.role)&&(0,ze.jsx)("div",{className:"flex items-center space-x-2",children:(0,ze.jsx)("span",{className:"text-xs px-2 py-0.5 rounded-full font-medium ".concat((R=u.role,{super_user:"bg-red-100 text-red-700",admin:"bg-blue-100 text-blue-700",site_manager:"bg-green-100 text-green-700",uploader:"bg-yellow-100 text-yellow-700",viewer:"bg-purple-100 text-purple-700",meter_manager:"bg-orange-100 text-orange-700"}[R]||"bg-gray-100 text-gray-700")),children:u.role.replace("_"," ")})})]})]}),(0,ze.jsxs)("button",{onClick:()=>{m(),O()},className:"flex items-center space-x-3 px-4 py-3 rounded-lg text-gray-300 hover:text-white hover:bg-red-500/10 transition-colors font-medium w-full",children:[(0,ze.jsx)("i",{className:"fa-solid fa-sign-out-alt"}),(0,ze.jsx)("span",{children:"Logout"})]})]})]})})]})]});var R},ka=()=>{const e=ae();return(0,ze.jsxs)("div",{className:"min-h-screen bg-gray-50",children:[(0,ze.jsx)("header",{className:"bg-white shadow-sm border-b border-gray-200",children:(0,ze.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,ze.jsxs)("div",{className:"flex justify-between items-center h-16",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-leaf text-white text-lg"})}),(0,ze.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"ESG Portal"})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ze.jsx)(Ae,{to:"/login",className:"text-gray-700 hover:text-gray-900 px-4 py-2 rounded-lg hover:bg-gray-100 transition-colors",children:"Sign In"}),(0,ze.jsx)(Ae,{to:"/signup",className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-lg hover:shadow-lg transition-all duration-200 font-medium",children:"Get Started"})]})]})})}),(0,ze.jsx)("section",{className:"bg-gradient-to-br from-blue-50 via-white to-purple-50 py-20",children:(0,ze.jsx)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:(0,ze.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-12 items-center",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{className:"mb-6",children:(0,ze.jsxs)("span",{className:"inline-flex items-center px-4 py-2 bg-green-100 text-green-800 rounded-full text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-leaf mr-2"}),"Sustainability Made Simple"]})}),(0,ze.jsxs)("h1",{className:"text-5xl font-bold text-gray-900 leading-tight mb-6",children:["Transform Your",(0,ze.jsx)("span",{className:"text-transparent bg-clip-text bg-gradient-to-r from-blue-600 to-purple-600",children:" ESG Journey"})]}),(0,ze.jsx)("p",{className:"text-xl text-gray-600 mb-8 leading-relaxed",children:"Streamline your environmental, social, and governance reporting with our comprehensive platform. Track metrics, ensure compliance, and drive sustainable business practices."}),(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4",children:[(0,ze.jsxs)("button",{onClick:()=>e("/signup"),className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-8 py-4 rounded-lg hover:shadow-xl transition-all duration-200 font-semibold text-lg",children:[(0,ze.jsx)("i",{className:"fas fa-rocket mr-2"}),"Start Free Trial"]}),(0,ze.jsxs)("button",{onClick:()=>e("/login"),className:"border border-gray-300 text-gray-700 px-8 py-4 rounded-lg hover:bg-gray-50 transition-colors font-semibold text-lg",children:[(0,ze.jsx)("i",{className:"fas fa-sign-in-alt mr-2"}),"Sign In"]})]}),(0,ze.jsxs)("div",{className:"mt-8 flex items-center space-x-6 text-sm text-gray-600",children:[(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-check text-green-500 mr-2"}),"No credit card required"]}),(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-clock text-blue-500 mr-2"}),"Setup in minutes"]})]})]}),(0,ze.jsx)("div",{className:"hidden lg:block",children:(0,ze.jsx)("div",{className:"relative",children:(0,ze.jsx)("div",{className:"w-full h-96 bg-gradient-to-br from-blue-100 to-purple-100 rounded-2xl p-8 shadow-xl",children:(0,ze.jsxs)("div",{className:"grid grid-cols-2 gap-4 h-full",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm flex flex-col items-center justify-center",children:[(0,ze.jsx)("i",{className:"fas fa-chart-bar text-3xl text-blue-600 mb-2"}),(0,ze.jsx)("p",{className:"text-sm font-medium text-gray-700 text-center",children:"Real-time Analytics"})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm flex flex-col items-center justify-center",children:[(0,ze.jsx)("i",{className:"fas fa-shield-check text-3xl text-green-600 mb-2"}),(0,ze.jsx)("p",{className:"text-sm font-medium text-gray-700 text-center",children:"Compliance Ready"})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm flex flex-col items-center justify-center",children:[(0,ze.jsx)("i",{className:"fas fa-users text-3xl text-purple-600 mb-2"}),(0,ze.jsx)("p",{className:"text-sm font-medium text-gray-700 text-center",children:"Team Collaboration"})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 shadow-sm flex flex-col items-center justify-center",children:[(0,ze.jsx)("i",{className:"fas fa-gauge text-3xl text-orange-600 mb-2"}),(0,ze.jsx)("p",{className:"text-sm font-medium text-gray-700 text-center",children:"Smart Meters"})]})]})})})})]})})}),(0,ze.jsx)("section",{className:"py-20 bg-white",children:(0,ze.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,ze.jsxs)("div",{className:"text-center mb-16",children:[(0,ze.jsx)("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Everything You Need for ESG Success"}),(0,ze.jsx)("p",{className:"text-xl text-gray-600 max-w-3xl mx-auto",children:"Our comprehensive platform provides all the tools and insights you need to excel in your sustainability journey"})]}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-8",children:[{title:"Real-time Monitoring",description:"Track your environmental impact with automated data collection",icon:"fas fa-chart-line",color:"blue"},{title:"Compliance Management",description:"Stay compliant with DST, Green Key and global ESG standards",icon:"fas fa-shield-check",color:"green"},{title:"Smart Analytics",description:"Get actionable insights from your sustainability data",icon:"fas fa-brain",color:"purple"},{title:"Team Collaboration",description:"Work together with role-based access and task assignments",icon:"fas fa-users",color:"orange"},{title:"Automated Reporting",description:"Generate comprehensive ESG reports with one click",icon:"fas fa-file-alt",color:"teal"},{title:"Meter Integration",description:"Connect smart meters for seamless data collection",icon:"fas fa-gauge",color:"indigo"}].map((e,t)=>(0,ze.jsxs)("div",{className:"bg-gray-50 rounded-2xl p-8 hover:shadow-lg transition-all duration-200",children:[(0,ze.jsx)("div",{className:"w-14 h-14 bg-".concat(e.color,"-100 rounded-xl flex items-center justify-center mb-6"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-2xl text-").concat(e.color,"-600")})}),(0,ze.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-3",children:e.title}),(0,ze.jsx)("p",{className:"text-gray-600 leading-relaxed",children:e.description})]},t))})]})}),(0,ze.jsx)("section",{className:"py-20 bg-gray-50",children:(0,ze.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,ze.jsxs)("div",{className:"text-center mb-16",children:[(0,ze.jsx)("h2",{className:"text-4xl font-bold text-gray-900 mb-4",children:"Trusted by Industry Leaders"}),(0,ze.jsx)("p",{className:"text-xl text-gray-600",children:"Compliant with global ESG frameworks and standards"})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-8",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm text-center",children:[(0,ze.jsx)("i",{className:"fas fa-award text-3xl text-green-600 mb-3"}),(0,ze.jsx)("h4",{className:"font-semibold text-gray-900",children:"Green Key"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Eco-certification"})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm text-center",children:[(0,ze.jsx)("i",{className:"fas fa-certificate text-3xl text-blue-600 mb-3"}),(0,ze.jsx)("h4",{className:"font-semibold text-gray-900",children:"DST"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Dubai Standards"})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm text-center",children:[(0,ze.jsx)("i",{className:"fas fa-globe text-3xl text-purple-600 mb-3"}),(0,ze.jsx)("h4",{className:"font-semibold text-gray-900",children:"GRI"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Global Reporting"})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm text-center",children:[(0,ze.jsx)("i",{className:"fas fa-leaf text-3xl text-orange-600 mb-3"}),(0,ze.jsx)("h4",{className:"font-semibold text-gray-900",children:"SASB"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Sustainability Standards"})]})]})]})}),(0,ze.jsx)("section",{className:"py-20 bg-gradient-to-r from-blue-600 to-purple-600",children:(0,ze.jsxs)("div",{className:"max-w-4xl mx-auto text-center px-4 sm:px-6 lg:px-8",children:[(0,ze.jsx)("h2",{className:"text-4xl font-bold text-white mb-6",children:"Ready to Transform Your ESG Reporting?"}),(0,ze.jsx)("p",{className:"text-xl text-blue-100 mb-8",children:"Join hundreds of companies already using our platform to drive sustainable business practices"}),(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row gap-4 justify-center",children:[(0,ze.jsxs)("button",{onClick:()=>e("/signup"),className:"bg-white text-blue-600 px-8 py-4 rounded-lg hover:bg-gray-100 transition-colors font-semibold text-lg",children:[(0,ze.jsx)("i",{className:"fas fa-rocket mr-2"}),"Start Your Free Trial"]}),(0,ze.jsxs)("button",{onClick:()=>e("/login"),className:"border-2 border-white text-white px-8 py-4 rounded-lg hover:bg-white hover:text-blue-600 transition-colors font-semibold text-lg",children:[(0,ze.jsx)("i",{className:"fas fa-sign-in-alt mr-2"}),"Sign In"]})]})]})}),(0,ze.jsx)("footer",{className:"bg-gray-900 text-white py-12",children:(0,ze.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,ze.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-8",children:[(0,ze.jsxs)("div",{className:"col-span-1 md:col-span-2",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-gradient-to-r from-green-600 to-blue-600 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-leaf text-white text-lg"})}),(0,ze.jsx)("h3",{className:"text-2xl font-bold",children:"ESG Portal"})]}),(0,ze.jsx)("p",{className:"text-gray-400 mb-4 max-w-md",children:"Empowering organizations to achieve their sustainability goals through comprehensive ESG management and reporting."})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"font-semibold mb-4",children:"Platform"}),(0,ze.jsxs)("ul",{className:"space-y-2 text-gray-400",children:[(0,ze.jsx)("li",{children:(0,ze.jsx)(Ae,{to:"/login",className:"hover:text-white transition-colors",children:"Dashboard"})}),(0,ze.jsx)("li",{children:(0,ze.jsx)(Ae,{to:"/login",className:"hover:text-white transition-colors",children:"Analytics"})}),(0,ze.jsx)("li",{children:(0,ze.jsx)(Ae,{to:"/login",className:"hover:text-white transition-colors",children:"Reporting"})}),(0,ze.jsx)("li",{children:(0,ze.jsx)(Ae,{to:"/login",className:"hover:text-white transition-colors",children:"Compliance"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"font-semibold mb-4",children:"Company"}),(0,ze.jsxs)("ul",{className:"space-y-2 text-gray-400",children:[(0,ze.jsx)("li",{children:(0,ze.jsx)(Ae,{to:"/signup",className:"hover:text-white transition-colors",children:"Get Started"})}),(0,ze.jsx)("li",{children:(0,ze.jsx)(Ae,{to:"/login",className:"hover:text-white transition-colors",children:"Sign In"})}),(0,ze.jsx)("li",{children:(0,ze.jsx)("a",{href:"#",className:"hover:text-white transition-colors",children:"Support"})}),(0,ze.jsx)("li",{children:(0,ze.jsx)("a",{href:"#",className:"hover:text-white transition-colors",children:"Privacy"})})]})]})]}),(0,ze.jsx)("div",{className:"border-t border-gray-800 mt-8 pt-8 text-center text-gray-400",children:(0,ze.jsx)("p",{children:"\xa9 2025 ESG Portal. All rights reserved. Built for sustainable business practices."})})]})})]})},Sa=()=>{var e;const t=ae(),{user:s,selectedCompany:a}=Be();return(0,ze.jsxs)("div",{className:"max-w-7xl mx-auto",children:[(0,ze.jsx)("div",{className:"bg-gradient-to-r from-blue-50 to-purple-50 rounded-2xl p-8 mb-8 border border-blue-100",children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-gradient-to-r from-blue-600 to-purple-600 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-leaf text-white text-xl"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"Welcome Back"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Your comprehensive sustainability management platform"})]})]}),a&&(0,ze.jsxs)("div",{className:"flex items-center space-x-2 mb-4",children:[(0,ze.jsxs)("div",{className:"flex items-center bg-white px-4 py-2 rounded-lg border border-blue-200",children:[(0,ze.jsx)("i",{className:"fas fa-building text-blue-600 mr-2"}),(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:a.name})]}),s&&(0,ze.jsxs)("div",{className:"flex items-center bg-white px-4 py-2 rounded-lg border border-purple-200",children:[(0,ze.jsx)("i",{className:"fas fa-user text-purple-600 mr-2"}),(0,ze.jsx)("span",{className:"text-gray-700",children:s.name||s.email}),(0,ze.jsx)("span",{className:"ml-2 text-xs bg-purple-100 text-purple-700 px-2 py-1 rounded-full",children:null===(e=s.role)||void 0===e?void 0:e.replace("_"," ")})]})]}),(0,ze.jsx)("p",{className:"text-gray-700 text-lg leading-relaxed max-w-2xl",children:"Track your environmental, social, and governance performance with our integrated platform. Collect data, generate insights, and ensure compliance with global ESG standards."})]}),(0,ze.jsx)("div",{className:"hidden lg:block",children:(0,ze.jsx)("div",{className:"w-64 h-48 bg-gradient-to-br from-green-100 to-blue-100 rounded-xl flex items-center justify-center",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("i",{className:"fas fa-chart-pie text-5xl text-green-600 mb-4"}),(0,ze.jsx)("p",{className:"text-sm font-medium text-gray-700",children:"Real-time ESG Metrics"})]})})})]})}),(0,ze.jsxs)("div",{className:"mb-12",children:[(0,ze.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Quick Actions"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Get started with common tasks"})]})}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[{title:"Analytics Dashboard",description:"View your ESG metrics and analytics",icon:"fas fa-chart-bar",color:"blue",path:"/dashboard",highlight:!0},{title:"Data Collection",description:"Submit meter readings and ESG data",icon:"fas fa-upload",color:"green",path:"/data"},{title:"Company Profile",description:"Update business information and activities",icon:"fas fa-building",color:"purple",path:"/onboard"},{title:"Framework Setup",description:"Configure ESG frameworks and compliance",icon:"fas fa-list-check",color:"orange",path:"/rame"},{title:"Meter Management",description:"Configure and manage smart meters",icon:"fas fa-gauge",color:"teal",path:"/meter"},{title:"Checklist",description:"Complete profiling and setup tasks",icon:"fas fa-tasks",color:"indigo",path:"/list"}].map((e,s)=>(0,ze.jsx)("button",{onClick:()=>t(e.path),className:"p-6 bg-white rounded-xl border border-gray-200 hover:shadow-lg transition-all duration-200 text-left group ".concat(e.highlight?"ring-2 ring-blue-500 ring-opacity-20":""),children:(0,ze.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center group-hover:bg-").concat(e.color,"-200 transition-colors"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-lg")})}),(0,ze.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ze.jsxs)("h3",{className:"font-semibold text-gray-900 group-hover:text-blue-600 transition-colors",children:[e.title,e.highlight&&(0,ze.jsx)("span",{className:"ml-2 text-xs bg-blue-100 text-blue-700 px-2 py-1 rounded-full",children:"Recommended"})]}),(0,ze.jsx)("p",{className:"text-gray-600 text-sm mt-1 leading-relaxed",children:e.description})]}),(0,ze.jsx)("i",{className:"fas fa-arrow-right text-gray-400 group-hover:text-blue-500 transition-colors"})]})},s))})]}),(0,ze.jsxs)("div",{className:"mb-12",children:[(0,ze.jsxs)("div",{className:"text-center mb-8",children:[(0,ze.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Platform Features"}),(0,ze.jsx)("p",{className:"text-gray-600 mt-2",children:"Everything you need for comprehensive ESG management"})]}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[{icon:"fas fa-leaf",title:"Sustainability Tracking",description:"Monitor your environmental impact with real-time data collection and automated reporting."},{icon:"fas fa-chart-line",title:"Analytics & Insights",description:"Get actionable insights from your ESG data with advanced analytics and visualization tools."},{icon:"fas fa-shield-check",title:"Compliance Management",description:"Stay compliant with various ESG frameworks including DST, Green Key, and industry standards."},{icon:"fas fa-users",title:"Team Collaboration",description:"Collaborate with your team members and assign tasks for efficient data collection."}].map((e,t)=>(0,ze.jsxs)("div",{className:"text-center p-6 bg-white rounded-xl border border-gray-200",children:[(0,ze.jsx)("div",{className:"w-16 h-16 bg-gradient-to-r from-blue-100 to-purple-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-2xl text-blue-600")})}),(0,ze.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:e.title}),(0,ze.jsx)("p",{className:"text-gray-600 text-sm leading-relaxed",children:e.description})]},t))})]}),(0,ze.jsx)("div",{className:"bg-gray-50 rounded-2xl p-8 border border-gray-200",children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("h2",{className:"text-2xl font-bold text-gray-900 mb-2",children:"Getting Started"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-6",children:"New to the platform? Follow these steps to set up your ESG tracking system."}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-4",children:[(0,ze.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-blue-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"1"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"font-medium text-gray-900",children:"Complete Profile"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Set up your company information"})]})]}),(0,ze.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-purple-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"2"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"font-medium text-gray-900",children:"Configure Frameworks"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Select relevant ESG standards"})]})]}),(0,ze.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-green-600 text-white rounded-full flex items-center justify-center text-sm font-bold",children:"3"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"font-medium text-gray-900",children:"Start Collecting Data"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Begin tracking your metrics"})]})]})]})]}),(0,ze.jsx)("div",{className:"hidden lg:block ml-8",children:(0,ze.jsxs)("button",{onClick:()=>t("/onboard"),className:"px-6 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium transition-all duration-200",children:[(0,ze.jsx)("i",{className:"fas fa-rocket mr-2"}),"Get Started"]})})]})})]})},Ca=()=>{console.log("\ud83d\ude80 Onboard component loaded/re-rendered at",(new Date).toLocaleTimeString());const e=ae(),{user:t,selectedCompany:s}=Be(),[a,n]=(0,r.useState)({companyName:"",emirate:"",primarySector:"",activities:[],customActivity:""}),[l,i]=(0,r.useState)(!0),[o,c]=(0,r.useState)(!1),d=(null===s||void 0===s?void 0:s.id)||null,u=(0,r.useRef)(!0),m=(0,r.useRef)(null);if(console.log("\ud83d\udcca Current formData state:",a),console.log("\u23f1\ufe0f Component states - Loading:",l,"Saving:",o,"InitialLoad:",u.current),a.activities&&a.activities.length>0){const e=["Hotel Operations","Food & Beverage","Spa & Wellness","Event Management","Retail Operations","Recreation Facilities","Conference & Meeting Rooms","Housekeeping Services","Laundry Services","Transportation Services"];console.log("\ud83c\udfaf Selected activities details:",a.activities.map(t=>({name:t,isFromPredefined:e.includes(t)})))}(0,r.useEffect)(()=>{if(console.log("\ud83d\udd04 useEffect for data fetching triggered"),!d)return console.log("\u23f8\ufe0f No company selected, skipping data fetch"),void i(!1);(async()=>{try{console.log("\ud83d\udce1 Fetching company data for ID:",d);const e=await Ie("".concat(Ue,"/api/companies/").concat(d,"/"));if(console.log("Company API Response status:",e.status),e.ok){const t=await e.json();console.log("Loaded company data from API:",t);const s=await Ie("".concat(Ue,"/api/companies/").concat(d,"/activities/"));let a=[];if(s.ok){const e=await s.json();console.log("Loaded activities data:",e),a=[...new Set(e.map(e=>e.name))]}else console.log("No activities found for company or API error:",s.status);const r={dubai:"Dubai",abu_dhabi:"Abu Dhabi",sharjah:"Sharjah",ajman:"Ajman",umm_al_quwain:"Umm Al Quwain",ras_al_khaimah:"Ras Al Khaimah",fujairah:"Fujairah"},l={hospitality:"Hospitality & Tourism",real_estate:"Real Estate",financial_services:"Financial Services",manufacturing:"Manufacturing",technology:"Technology",healthcare:"Healthcare",education:"Education",retail:"Retail"},i={companyName:t.name||"",emirate:r[t.emirate]||t.emirate||"",primarySector:l[t.sector]||t.sector||"",activities:a,customActivity:""};console.log("Setting form data:",i),n(i),m.current=i}else if(404===e.status){console.log("Company not found, starting with empty form");const e={companyName:"",emirate:"",primarySector:"",activities:[],customActivity:""};n(e),m.current=e}else{console.error("API error, using empty form");const e={companyName:"",emirate:"",primarySector:"",activities:[],customActivity:""};n(e),m.current=e}}catch(e){console.error("Error fetching company data:",e);const t={companyName:"",emirate:"",primarySector:"",activities:[],customActivity:""};n(t),m.current=t}finally{i(!1),u.current=!1}})()},[d]),(0,r.useEffect)(()=>{},[a,l,o]);const f=[{id:"hotel",name:"Hotel Operations",icon:"fas fa-bed",color:"blue"},{id:"food",name:"Food & Beverage",icon:"fas fa-utensils",color:"green"},{id:"spa",name:"Spa & Wellness",icon:"fas fa-spa",color:"orange"},{id:"events",name:"Event Management",icon:"fas fa-calendar-alt",color:"purple"},{id:"retail",name:"Retail Operations",icon:"fas fa-shopping-bag",color:"red"},{id:"recreation",name:"Recreation Facilities",icon:"fas fa-tree",color:"teal"},{id:"conference",name:"Conference & Meeting Rooms",icon:"fas fa-users",color:"indigo"},{id:"housekeeping",name:"Housekeeping Services",icon:"fas fa-broom",color:"cyan"},{id:"laundry",name:"Laundry Services",icon:"fas fa-tshirt",color:"blue"},{id:"transport",name:"Transportation Services",icon:"fas fa-car",color:"gray"}],x=e=>{n(t=>Me(Me({},t),{},{activities:t.activities.includes(e)?t.activities.filter(t=>t!==e):[...t.activities,e]}))},p=async()=>{const e=a.customActivity.trim();if(e&&!a.activities.includes(e)){n(t=>Me(Me({},t),{},{activities:[...t.activities,e],customActivity:""}));try{const t=await Ie("".concat(Ue,"/api/activities/add_custom/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,company_id:d})});if(t.ok){const e=await t.json();console.log("Custom activity added:",e)}else console.error("Failed to add custom activity to backend")}catch(t){console.error("Error adding custom activity:",t)}}},h=async()=>{await async function(){let e=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(console.log("\ud83d\udcbe saveData function called with showMessage:",e),console.log("\ud83d\udcbe Current saving state:",o),o)console.log("\u274c saveData aborted - already saving");else{console.log("\ud83d\udcbe saveData called, formData:",a),c(!0),console.log("\ud83d\udcbe Set saving state to true"),console.log("\ud83d\udcbe Starting to save company data:",a);try{let e=await Ie("".concat(Ue,"/api/companies/").concat(d,"/")),s=e.ok;const n={Dubai:"dubai","Abu Dhabi":"abu_dhabi",Sharjah:"sharjah",Ajman:"ajman","Umm Al Quwain":"umm_al_quwain","Ras Al Khaimah":"ras_al_khaimah",Fujairah:"fujairah"},r={"Hospitality & Tourism":"hospitality","Real Estate":"real_estate","Financial Services":"financial_services",Manufacturing:"manufacturing",Technology:"technology",Healthcare:"healthcare",Education:"education",Retail:"retail"},l={name:a.companyName||"Unnamed Company",emirate:n[a.emirate]||"dubai",sector:r[a.primarySector]||"hospitality"};if(console.log("Company data to send:",l),s?(console.log("Updating existing company..."),e=await Ie("".concat(Ue,"/api/companies/").concat(d,"/"),{method:"PUT",body:JSON.stringify(l)})):(console.log("Creating new company..."),e=await Ie("".concat(Ue,"/api/companies/"),{method:"POST",body:JSON.stringify(l)})),e.ok){const s=await e.json();console.log("Company data saved successfully:",s);const n=a.activities.filter(e=>!f.some(t=>t.name===e));for(const e of n)try{await Ie("".concat(Ue,"/api/activities/add_custom/"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,company_id:d})})}catch(t){console.error('Error creating custom activity "'.concat(e,'":'),t)}const r=await Ie("".concat(Ue,"/api/activities/"));if(r.ok){const e=await r.json(),t=e.results||e;console.log("All available activities:",t),console.log("Selected activity names:",a.activities),console.log("Database activity names:",t.map(e=>'"'.concat(e.name,'"'))),console.log("Frontend activity names:",a.activities.map(e=>'"'.concat(e,'"')));const s=[];a.activities.forEach(e=>{let a=t.find(t=>t.name===e);a||(a=t.find(t=>t.name.toLowerCase()===e.toLowerCase())),a||(a=t.find(t=>t.name.toLowerCase().includes(e.toLowerCase())||e.toLowerCase().includes(t.name.toLowerCase()))),a?(console.log('\u2713 Found "'.concat(e,'" matched with "').concat(a.name,'" (ID: ').concat(a.id,")")),s.push(a.id)):(console.warn('\u2717 Could not find activity "'.concat(e,'" in database')),console.log("Available activities:",t.map(e=>e.name)),console.log('Creating custom activity: "'.concat(e,'"')))}),console.log("Final activity IDs to save:",s);const n=await Ie("".concat(Ue,"/api/companies/").concat(d,"/save_activities/"),{method:"POST",body:JSON.stringify({activity_ids:s})});if(n.ok){const e=await n.json();console.log("Activities saved successfully:",e),m.current={companyName:a.companyName,emirate:a.emirate,primarySector:a.primarySector,activities:a.activities}}else{console.error("Failed to save activities");const e=await n.text();console.error("Activities save error:",e)}}}else{console.error("Failed to save company data. Status:",e.status);const t=await e.text();console.error("Error response:",t)}}catch(t){console.error("Error saving company data:",t)}finally{c(!1)}}}(!0),e("/rame")};if(l)return(0,ze.jsx)("div",{className:"max-w-6xl mx-auto flex items-center justify-center h-64",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Loading company information..."})]})});if(!(()=>{if(console.log("\ud83d\udd0d Checking onboarding access:",{user:t,role:null===t||void 0===t?void 0:t.role,selectedCompany:s}),!t)return console.log("\u274c No user found"),!1;const e=["super_user","admin","site_manager","viewer"].includes(t.role);return console.log("\u2705 Access check result:",e,"for role:",t.role),e})())return(0,ze.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,ze.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,ze.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access company onboarding."}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});const g=["super_user","admin"].includes(null===t||void 0===t?void 0:t.role),y=["site_manager","viewer"].includes(null===t||void 0===t?void 0:t.role);return(0,ze.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200 mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-building text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Company Information"}),(0,ze.jsx)("p",{className:"text-gray-600",children:g?"Enter your basic company details":"View company information"})]})]}),y&&(0,ze.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-2"}),"View Only Mode"]})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Company Name *"}),(0,ze.jsxs)("div",{className:"relative",children:[g?(0,ze.jsx)("input",{type:"text",className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter company name",value:a.companyName,onChange:e=>n(t=>Me(Me({},t),{},{companyName:e.target.value}))}):(0,ze.jsx)("div",{className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 font-medium",children:a.companyName||"Not specified"}),a.companyName&&g&&(0,ze.jsx)("div",{className:"absolute right-3 top-3 text-green-500",children:(0,ze.jsx)("i",{className:"fas fa-check-circle"})}),y&&(0,ze.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,ze.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,ze.jsx)("i",{className:"fas fa-eye"})})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Emirate *"}),(0,ze.jsxs)("div",{className:"relative",children:[g?(0,ze.jsxs)("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:a.emirate,onChange:e=>n(t=>Me(Me({},t),{},{emirate:e.target.value})),children:[(0,ze.jsx)("option",{value:"",children:"Select Emirate"}),(0,ze.jsx)("option",{value:"Dubai",children:"Dubai"}),(0,ze.jsx)("option",{value:"Abu Dhabi",children:"Abu Dhabi"}),(0,ze.jsx)("option",{value:"Sharjah",children:"Sharjah"}),(0,ze.jsx)("option",{value:"Ajman",children:"Ajman"}),(0,ze.jsx)("option",{value:"Umm Al Quwain",children:"Umm Al Quwain"}),(0,ze.jsx)("option",{value:"Ras Al Khaimah",children:"Ras Al Khaimah"}),(0,ze.jsx)("option",{value:"Fujairah",children:"Fujairah"})]}):(0,ze.jsx)("div",{className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 font-medium",children:a.emirate||"Not specified"}),y&&(0,ze.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,ze.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,ze.jsx)("i",{className:"fas fa-eye"})})})]})]}),(0,ze.jsxs)("div",{className:"md:col-span-2",children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Primary Sector *"}),(0,ze.jsxs)("div",{className:"relative",children:[g?(0,ze.jsxs)("select",{className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:a.primarySector,onChange:e=>n(t=>Me(Me({},t),{},{primarySector:e.target.value})),children:[(0,ze.jsx)("option",{value:"",children:"Select Primary Sector"}),(0,ze.jsx)("option",{value:"Hospitality & Tourism",children:"Hospitality & Tourism"}),(0,ze.jsx)("option",{value:"Real Estate",children:"Real Estate"}),(0,ze.jsx)("option",{value:"Financial Services",children:"Financial Services"}),(0,ze.jsx)("option",{value:"Manufacturing",children:"Manufacturing"}),(0,ze.jsx)("option",{value:"Technology",children:"Technology"}),(0,ze.jsx)("option",{value:"Healthcare",children:"Healthcare"}),(0,ze.jsx)("option",{value:"Education",children:"Education"}),(0,ze.jsx)("option",{value:"Retail",children:"Retail"})]}):(0,ze.jsx)("div",{className:"w-full px-4 py-3 bg-gray-50 border border-gray-200 rounded-lg text-gray-900 font-medium",children:a.primarySector||"Not specified"}),y&&(0,ze.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,ze.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,ze.jsx)("i",{className:"fas fa-eye"})})})]})]})]})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200 mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-list-check text-purple-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Business Activities"}),(0,ze.jsx)("p",{className:"text-gray-600",children:g?"Select all activities your company engages in":"View selected business activities"})]})]}),(0,ze.jsx)("div",{className:"flex space-x-3",children:g?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)("button",{className:"px-4 py-2 bg-green-50 text-green-600 rounded-lg hover:bg-green-100 text-sm font-medium",onClick:()=>n(e=>Me(Me({},e),{},{activities:f.map(e=>e.name)})),children:[(0,ze.jsx)("i",{className:"fas fa-check-double mr-2"}),"Select All"]}),(0,ze.jsxs)("button",{className:"px-4 py-2 bg-gray-50 text-gray-600 rounded-lg hover:bg-gray-100 text-sm font-medium",onClick:()=>n(e=>Me(Me({},e),{},{activities:[]})),children:[(0,ze.jsx)("i",{className:"fas fa-times mr-2"}),"Deselect All"]})]}):(0,ze.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-2"}),"View Only"]})})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4 mb-6",children:[f.map(e=>{const t=a.activities.includes(e.name);return(0,ze.jsxs)("div",{className:"activity-card rounded-lg p-4 transition-all relative ".concat(t?"border-2 border-green-200 bg-green-50":g?"border border-gray-200 bg-white hover:border-green-200 hover:bg-green-50 cursor-pointer":"border border-gray-200 bg-gray-50"),onClick:g?()=>x(e.name):void 0,children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("input",{type:"checkbox",checked:t,onChange:()=>{},className:"w-5 h-5 text-green-600 rounded",disabled:!g}),(0,ze.jsx)("div",{className:"w-8 h-8 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center ").concat(g?"":"opacity-60"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600")})}),(0,ze.jsx)("span",{className:"font-medium ".concat(g?"text-gray-900":"text-gray-600"),children:e.name})]}),y&&(0,ze.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,ze.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,ze.jsx)("i",{className:"fas fa-eye"})})})]},e.id)}),a.activities.filter(e=>!f.some(t=>t.name===e)).map((e,t)=>{const s=(e=>{const t=e.toLowerCase();return t.includes("hotel")||t.includes("accommodation")||t.includes("lodging")||t.includes("room")?{icon:"fas fa-bed",color:"blue"}:t.includes("resort")||t.includes("villa")||t.includes("suite")?{icon:"fas fa-hotel",color:"indigo"}:t.includes("hostel")||t.includes("budget")||t.includes("backpack")?{icon:"fas fa-building",color:"gray"}:t.includes("restaurant")||t.includes("dining")||t.includes("food")||t.includes("kitchen")?{icon:"fas fa-utensils",color:"green"}:t.includes("bar")||t.includes("lounge")||t.includes("pub")||t.includes("beverage")?{icon:"fas fa-cocktail",color:"amber"}:t.includes("coffee")||t.includes("cafe")||t.includes("espresso")?{icon:"fas fa-coffee",color:"yellow"}:t.includes("bakery")||t.includes("pastry")||t.includes("dessert")?{icon:"fas fa-birthday-cake",color:"pink"}:t.includes("catering")||t.includes("banquet")||t.includes("buffet")?{icon:"fas fa-concierge-bell",color:"emerald"}:t.includes("spa")||t.includes("massage")||t.includes("wellness")||t.includes("beauty")?{icon:"fas fa-spa",color:"orange"}:t.includes("gym")||t.includes("fitness")||t.includes("workout")?{icon:"fas fa-dumbbell",color:"red"}:t.includes("pool")||t.includes("swimming")||t.includes("aquatic")?{icon:"fas fa-swimmer",color:"cyan"}:t.includes("sauna")||t.includes("steam")||t.includes("jacuzzi")?{icon:"fas fa-hot-tub",color:"orange"}:t.includes("event")||t.includes("conference")||t.includes("meeting")?{icon:"fas fa-calendar-alt",color:"purple"}:t.includes("wedding")||t.includes("celebration")||t.includes("ceremony")?{icon:"fas fa-heart",color:"rose"}:t.includes("show")||t.includes("entertainment")||t.includes("performance")?{icon:"fas fa-theater-masks",color:"violet"}:t.includes("casino")||t.includes("gaming")||t.includes("slot")?{icon:"fas fa-dice",color:"red"}:t.includes("nightclub")||t.includes("disco")||t.includes("dance")?{icon:"fas fa-music",color:"purple"}:t.includes("retail")||t.includes("shop")||t.includes("store")||t.includes("boutique")?{icon:"fas fa-shopping-bag",color:"red"}:t.includes("gift")||t.includes("souvenir")||t.includes("merchandise")?{icon:"fas fa-gift",color:"green"}:t.includes("market")||t.includes("bazaar")||t.includes("vendor")?{icon:"fas fa-store",color:"orange"}:t.includes("golf")||t.includes("course")?{icon:"fas fa-golf-ball",color:"green"}:t.includes("tennis")||t.includes("court")?{icon:"fas fa-table-tennis",color:"blue"}:t.includes("ski")||t.includes("snow")||t.includes("winter")?{icon:"fas fa-skiing",color:"cyan"}:t.includes("beach")||t.includes("seaside")||t.includes("coastal")?{icon:"fas fa-umbrella-beach",color:"yellow"}:t.includes("water sports")||t.includes("diving")||t.includes("sailing")?{icon:"fas fa-anchor",color:"blue"}:t.includes("business")||t.includes("corporate")||t.includes("office")?{icon:"fas fa-briefcase",color:"slate"}:t.includes("concierge")||t.includes("reception")||t.includes("guest services")?{icon:"fas fa-user-tie",color:"blue"}:t.includes("valet")||t.includes("parking")||t.includes("transport")?{icon:"fas fa-car",color:"gray"}:t.includes("laundry")||t.includes("cleaning")||t.includes("housekeeping")?{icon:"fas fa-tshirt",color:"blue"}:t.includes("tour")||t.includes("excursion")||t.includes("sightseeing")?{icon:"fas fa-map-marked-alt",color:"green"}:t.includes("travel")||t.includes("booking")||t.includes("reservation")?{icon:"fas fa-plane",color:"blue"}:t.includes("cruise")||t.includes("yacht")||t.includes("boat")?{icon:"fas fa-ship",color:"blue"}:t.includes("medical")||t.includes("clinic")||t.includes("health")?{icon:"fas fa-medkit",color:"red"}:t.includes("pet")||t.includes("animal")||t.includes("dog")?{icon:"fas fa-paw",color:"brown"}:t.includes("child")||t.includes("kids")||t.includes("family")?{icon:"fas fa-child",color:"yellow"}:{icon:"fas fa-building-user",color:"purple"}})(e);return(0,ze.jsxs)("div",{className:"activity-card rounded-lg p-4 transition-all relative ".concat(g?"cursor-pointer border-2 border-green-200 bg-green-50":"border-2 border-green-200 bg-green-50 opacity-75"),onClick:g?()=>x(e):void 0,children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("input",{type:"checkbox",checked:!0,onChange:()=>{},className:"w-5 h-5 text-green-600 rounded",disabled:!g}),(0,ze.jsx)("div",{className:"w-8 h-8 bg-".concat(s.color,"-100 rounded-lg flex items-center justify-center ").concat(g?"":"opacity-60"),children:(0,ze.jsx)("i",{className:"".concat(s.icon," text-").concat(s.color,"-600")})}),(0,ze.jsx)("span",{className:"font-medium ".concat(g?"text-gray-900":"text-gray-600"),children:e})]}),y&&(0,ze.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,ze.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,ze.jsx)("i",{className:"fas fa-eye"})})})]},"custom-".concat(t))})]}),g&&(0,ze.jsxs)("div",{className:"border-t border-gray-200 pt-6",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Add Custom Activity"}),(0,ze.jsxs)("div",{className:"flex space-x-3",children:[(0,ze.jsx)("input",{type:"text",placeholder:"Enter custom business activity",className:"flex-1 px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",value:a.customActivity,onChange:e=>n(t=>Me(Me({},t),{},{customActivity:e.target.value})),onKeyPress:e=>{"Enter"===e.key&&p()}}),(0,ze.jsxs)("button",{className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",onClick:p,children:[(0,ze.jsx)("i",{className:"fas fa-plus mr-2"}),"Add Activity"]})]})]})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ze.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle mr-2"}),g?o?"Saving...":"Progress will be automatically saved":"Viewing company information in read-only mode"]}),y&&(0,ze.jsxs)("div",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-lg text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only Access"]})]}),(0,ze.jsx)("div",{className:"flex space-x-4",children:g?(0,ze.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:h,disabled:o,children:[o?"Saving...":"Save & Continue",(0,ze.jsx)("i",{className:"fas ".concat(o?"fa-spinner fa-spin":"fa-arrow-right"," ml-2")})]}):(0,ze.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:h,children:["Continue",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})})]})]})},_a=()=>{const e=ae(),{user:t,selectedCompany:s}=Be(),[a,n]=(0,r.useState)([]),[l,i]=(0,r.useState)([]),[o,c]=(0,r.useState)(!0),[d,u]=(0,r.useState)(!1),m=null===s||void 0===s?void 0:s.id;(0,r.useEffect)(()=>{if(!m)return void console.log("\u23f8\ufe0f No company selected, skipping voluntary framework fetch");(async()=>{try{console.log("\ud83d\udd0d Fetching existing voluntary frameworks for company:",m);const e=await fetch("".concat(Ue,"/api/companies/").concat(m,"/frameworks/"),{credentials:"include"});if(e.ok){const t=(await e.json()).filter(e=>"voluntary"===e.type).map(e=>e.framework_id);console.log("\ud83d\udccb Existing voluntary frameworks from DB:",t),n(t)}}catch(e){console.error("\u274c Error fetching voluntary frameworks:",e)}finally{c(!1)}})()},[m]),(0,r.useEffect)(()=>{if(!m)return void console.log("\u23f8\ufe0f No company selected, skipping framework fetch");(async()=>{try{console.log("\ud83d\udd0d Fetching mandatory frameworks for company:",m);const e=await fetch("".concat(Ue,"/api/companies/").concat(m,"/frameworks/"),{credentials:"include"});if(e.ok){const t=await e.json();console.log("\ud83d\udccb Backend frameworks:",t);const s=[{id:"esg",name:"ESG Framework",description:"Core Environmental, Social, and Governance reporting framework",icon:"fas fa-chart-line",color:"blue",coverage:"Environmental, Social, Governance",reason:"Core framework for all businesses"},{id:"dst",name:"Dubai Sustainable Tourism (DST)",description:"Dubai Department of Economy and Tourism sustainability requirements for all hotels in Dubai",icon:"fas fa-building",color:"green",coverage:"Energy, Water, Waste, Community",reason:"Mandatory for all Dubai hospitality entities"}];let a=[];if(t&&Array.isArray(t)&&t.length>0){const e=t.filter(e=>"mandatory"===e.type);a=e.map(e=>"DST"===e.framework_id?s[1]:"ESG"===e.framework_id?s[0]:{id:e.framework_id.toLowerCase(),name:e.name||e.framework_id,description:e.description||"Framework description",icon:"fas fa-chart-line",color:"blue",coverage:"Various sustainability aspects",reason:"Required for your business profile"}),console.log("\u2705 Mapped backend frameworks:",a)}else console.log("\u26a0\ufe0f Backend returned empty frameworks, using all mandatory frameworks"),a=s;const n=a.map(e=>e.id);s.forEach(e=>{n.includes(e.id)||a.push(e)}),console.log("\u2705 Final mandatory frameworks:",a),i(a)}else console.error("Failed to fetch frameworks, using fallback"),i([{id:"esg",name:"ESG Framework",description:"Core Environmental, Social, and Governance reporting framework",icon:"fas fa-chart-line",color:"blue",coverage:"Environmental, Social, Governance",reason:"Core framework for all businesses"},{id:"dst",name:"Dubai Sustainable Tourism (DST)",description:"Dubai Department of Economy and Tourism sustainability requirements for all hotels in Dubai",icon:"fas fa-building",color:"green",coverage:"Energy, Water, Waste, Community",reason:"Mandatory for all Dubai hospitality entities"}])}catch(e){console.error("Error fetching mandatory frameworks:",e),i([{id:"esg",name:"ESG Framework",description:"Core Environmental, Social, and Governance reporting framework",icon:"fas fa-chart-line",color:"blue",coverage:"Environmental, Social, Governance",reason:"Core framework for all businesses"},{id:"dst",name:"Dubai Sustainable Tourism (DST)",description:"Dubai Department of Economy and Tourism sustainability requirements for all hotels in Dubai",icon:"fas fa-building",color:"green",coverage:"Energy, Water, Waste, Community",reason:"Mandatory for all Dubai hospitality entities"}])}})()},[m]);const f=()=>{e("/location")};if(!t||!["super_user","admin","site_manager","viewer"].includes(t.role))return(0,ze.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,ze.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,ze.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access framework selection."}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});const x=["super_user","admin"].includes(null===t||void 0===t?void 0:t.role),p=["site_manager","viewer"].includes(null===t||void 0===t?void 0:t.role);return(0,ze.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,ze.jsxs)("div",{className:"mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-red-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-lock text-red-600"})}),(0,ze.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Mandatory Frameworks"}),(0,ze.jsx)("div",{className:"bg-red-100 text-red-800 px-3 py-1 rounded-full text-sm font-medium",children:"Required"})]}),p&&(0,ze.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-2"}),"View Only Mode"]})]}),(0,ze.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6",children:l.map(e=>(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border-2 border-red-200",children:[(0,ze.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,ze.jsx)("div",{className:"w-16 h-16 bg-".concat(e.color,"-100 rounded-xl flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-2xl")})}),(0,ze.jsx)("div",{className:"bg-red-500 text-white px-3 py-1 rounded-full text-sm font-medium",children:"Mandatory"})]}),(0,ze.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:e.name}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,ze.jsx)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-lg p-3 mb-4",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle text-yellow-600 text-sm"}),(0,ze.jsxs)("span",{className:"text-yellow-800 text-sm font-medium",children:["Auto-assigned: ",e.reason]})]})}),(0,ze.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,ze.jsx)("span",{className:"font-medium",children:"Coverage:"})," ",e.coverage]})]},e.id))})]}),(0,ze.jsxs)("div",{className:"mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-hand-pointer text-blue-600"})}),(0,ze.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Voluntary Frameworks"}),(0,ze.jsx)("div",{className:"bg-blue-100 text-blue-800 px-3 py-1 rounded-full text-sm font-medium",children:"Optional"})]}),p&&(0,ze.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-2"}),"View Selected Frameworks"]})]}),(0,ze.jsx)("div",{className:"grid grid-cols-1 lg:grid-cols-2 xl:grid-cols-3 gap-6",children:[{id:"GREEN_KEY",name:"Green Key Certification",description:"Eco-label for tourism establishments with comprehensive sustainability criteria",icon:"fas fa-key",color:"green",features:["13 criteria areas","Water & energy efficiency","Guest engagement programs"],bestFor:"Hotels seeking eco-certification"},{id:"GRI",name:"GRI Standards",description:"Global Reporting Initiative - Comprehensive sustainability reporting standards",icon:"fas fa-globe",color:"blue",features:["Universal standards","Stakeholder engagement","Detailed disclosures"],bestFor:"Comprehensive sustainability reporting"},{id:"SASB",name:"SASB Standards",description:"Sustainability Accounting Standards Board - Industry-specific sustainability metrics",icon:"fas fa-chart-bar",color:"purple",features:["Industry-specific metrics","Investor-focused reporting","Materiality assessment"],bestFor:"Public companies, Investor relations"},{id:"TCFD",name:"TCFD",description:"Task Force on Climate-related Financial Disclosures - Climate risk reporting",icon:"fas fa-thermometer-half",color:"orange",features:["Climate risk assessment","Scenario planning","Financial impact disclosure"],bestFor:"Climate-focused reporting"},{id:"CDP",name:"CDP",description:"Carbon Disclosure Project - Environmental disclosure system for companies",icon:"fas fa-cloud",color:"teal",features:["Environmental disclosure","Climate scoring","Water & forest reporting"],bestFor:"Environmental transparency"}].map(e=>{const t=a.includes(e.id);return(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border transition-all relative ".concat(t?"border-blue-300 shadow-md":"border-gray-200"," ").concat(x?"cursor-pointer hover:border-blue-300 hover:shadow-md":"cursor-default"),onClick:x?()=>(async e=>{const t=a.includes(e);u(!0);try{if(t){const t=await fetch("".concat(Ue,"/api/frameworks/remove_voluntary/"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({company_id:m,framework_id:e})});t.ok?(console.log("\u2705 Framework removed successfully:",e),n(t=>t.filter(t=>t!==e))):console.error("\u274c Failed to remove framework:",t.status)}else{const t=await fetch("".concat(Ue,"/api/frameworks/assign_voluntary/"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({company_id:m,framework_id:e})});t.ok?(console.log("\u2705 Framework assigned successfully:",e),n(t=>[...t,e])):console.error("\u274c Failed to assign framework:",t.status)}}catch(s){console.error("\u274c Error toggling framework:",s)}finally{u(!1)}})(e.id):void 0,children:[(0,ze.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,ze.jsx)("div",{className:"w-16 h-16 bg-".concat(e.color,"-100 rounded-xl flex items-center justify-center ").concat(x?"":"opacity-60"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-2xl")})}),(0,ze.jsxs)("label",{className:"relative inline-flex items-center ".concat(x?"cursor-pointer":"cursor-default"),children:[(0,ze.jsx)("input",{type:"checkbox",className:"sr-only peer",checked:t,onChange:()=>{},disabled:!x}),(0,ze.jsx)("div",{className:"w-11 h-6 bg-gray-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:left-[2px] after:bg-white after:rounded-full after:h-5 after:w-5 after:transition-all ".concat(t?"peer-checked:bg-blue-600":""," ").concat(x?"":"opacity-60")})]})]}),p&&(0,ze.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,ze.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,ze.jsx)("i",{className:"fas fa-eye"})})}),(0,ze.jsx)("h3",{className:"text-xl font-bold text-gray-900 mb-2",children:e.name}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:e.description}),(0,ze.jsx)("div",{className:"space-y-2 mb-4",children:e.features.map((e,t)=>(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("i",{className:"fas fa-check text-green-500 text-sm"}),(0,ze.jsx)("span",{className:"text-sm text-gray-600",children:e})]},t))}),(0,ze.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,ze.jsx)("span",{className:"font-medium",children:"Best for:"})," ",e.bestFor]})]},e.id)})})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Selected Frameworks Summary"}),(0,ze.jsxs)("div",{className:"space-y-3",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between p-3 bg-red-50 border border-red-200 rounded-lg",children:[(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:"Mandatory Frameworks"}),(0,ze.jsxs)("span",{className:"text-sm text-red-600 font-medium",children:[l.length," Required"]})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between p-3 bg-blue-50 border border-blue-200 rounded-lg",children:[(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:"Voluntary Frameworks"}),(0,ze.jsxs)("span",{className:"text-sm text-blue-600 font-medium",children:[a.length," Selected"]})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between p-3 bg-green-50 border border-green-200 rounded-lg",children:[(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:"Total Frameworks"}),(0,ze.jsxs)("span",{className:"text-sm text-green-600 font-medium",children:[l.length+a.length," Active"]})]})]})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ze.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>e("/onboard"),children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]}),p&&(0,ze.jsxs)("div",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-lg text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only Access"]})]}),(0,ze.jsx)("div",{className:"flex space-x-4",children:x?(0,ze.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:f,children:["Save & Continue",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]}):(0,ze.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:f,children:["Continue",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})})]})]})};const Ea=function(){const[e,t]=(0,r.useState)([]),[s,a]=(0,r.useState)(!0),[n,l]=(0,r.useState)(!1),[i,o]=(0,r.useState)({name:"",location:"",address:""}),[c,d]=(0,r.useState)(""),[u,m]=(0,r.useState)(null),[f,x]=(0,r.useState)({canAccessLocationPage:!1,canChangeLocation:!1,showLocationDropdown:!1,role:"viewer",assignedSiteCount:0}),p=ae(),{user:h}=Be(),{selectedLocation:g,selectLocation:y,fetchLocations:b}=ya();(0,r.useEffect)(()=>{j(),v()},[]);const v=async()=>{if(h){console.log("\ud83d\udd10 LocationSelection: Fetching user permissions");try{const e=await Ie("".concat(Ue,"/api/user/permissions/"));if(e.ok){const t=await e.json();console.log("\ud83d\udd10 LocationSelection: Received permissions:",t),x(t)}}catch(c){console.error("\ud83d\udd10 LocationSelection: Failed to fetch permissions:",c)}}};(0,r.useEffect)(()=>{},[g]);const j=async()=>{try{const e=await pa.get("".concat(Ue,"/api/companies/"),{withCredentials:!0});if(e.data.results&&e.data.results.length>0){const s=e.data.results[0];m(s.id);const a=await b(s.id);t(a),g?console.log("\ud83d\udccd LocationSelection: Active location from context: ".concat(g.name)):console.log("\ud83d\udccd LocationSelection: No active location in context")}a(!1)}catch(e){console.error("Error fetching sites:",e),d("Failed to load locations"),a(!1)}},w=async e=>{if(!f.canChangeLocation)return console.log("\ud83d\udeab LocationSelection: User cannot change locations - read only mode"),void d("You can only view your assigned location. Contact an administrator to change site assignments.");try{await y(e)||d("Failed to set active location")}catch(t){console.error("Error setting active site:",t),d("Failed to set active location")}};return s?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto flex items-center justify-center h-64",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Loading locations..."})]})}):f.canAccessLocationPage?(0,ze.jsxs)("div",{className:"max-w-6xl mx-auto",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-8 shadow-sm border border-gray-200 mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h2",{className:"text-xl font-semibold text-gray-900",children:["Location Management",!f.canChangeLocation&&(0,ze.jsxs)("span",{className:"ml-3 inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-orange-100 text-orange-800",children:[(0,ze.jsx)("i",{className:"fas fa-lock mr-1"}),"View Only"]})]}),(0,ze.jsx)("p",{className:"text-gray-600",children:f.canChangeLocation?"Select or add locations for your ESG data management":"View your assigned location information"})]})]}),c&&(0,ze.jsx)("div",{className:"mb-6 bg-red-50 border border-red-200 text-red-700 px-4 py-3 rounded-lg",children:c}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-4",children:[f.canChangeLocation&&(0,ze.jsxs)("div",{onClick:()=>(async()=>{if(!f.canChangeLocation)return console.log("\ud83d\udeab LocationSelection: User cannot change to all locations - read only mode"),void d("You can only view your assigned location. Contact an administrator to change site assignments.");try{const e={id:"all",name:"All Locations",location:"Combined View",address:"All sites aggregated",is_active:!0};await y(e)?console.log("\u2705 All Locations view selected"):d("Failed to set All Locations view")}catch(e){console.error("Error setting All Locations view:",e),d("Failed to set All Locations view")}})(),className:"relative bg-gradient-to-br from-purple-50 to-blue-50 border-2 border-dashed rounded-lg p-6 cursor-pointer transition-all hover:from-purple-100 hover:to-blue-100 ".concat("all"===(null===g||void 0===g?void 0:g.id)?"border-purple-500 bg-purple-100":"border-purple-300"),children:["all"===(null===g||void 0===g?void 0:g.id)&&(0,ze.jsx)("i",{className:"fas fa-check-circle absolute top-3 right-3 text-purple-500"}),(0,ze.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-gradient-to-br from-purple-500 to-blue-500 rounded-lg flex items-center justify-center flex-shrink-0",children:(0,ze.jsx)("i",{className:"fas fa-globe text-white"})}),(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"All Locations"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:"View aggregated data from all your locations"}),(0,ze.jsxs)("div",{className:"mt-3 flex items-center text-xs text-purple-600",children:[(0,ze.jsx)("i",{className:"fas fa-chart-bar mr-1"}),"Combined analytics & reports"]})]})]})]}),e.map(e=>(0,ze.jsxs)("div",{onClick:f.canChangeLocation?()=>w(e):void 0,className:"relative bg-gray-50 rounded-lg p-6 transition-all border-2 ".concat((null===g||void 0===g?void 0:g.id)===e.id?"border-blue-500 bg-blue-50":"border-transparent"," ").concat(f.canChangeLocation?"cursor-pointer hover:bg-gray-100":"cursor-default opacity-75"),children:[(null===g||void 0===g?void 0:g.id)===e.id&&(0,ze.jsx)("i",{className:"fas fa-check-circle absolute top-3 right-3 text-blue-500"}),!f.canChangeLocation&&(0,ze.jsx)("div",{className:"absolute top-3 right-3",children:(0,ze.jsx)("i",{className:"fas fa-eye text-gray-400",title:"View Only"})}),(0,ze.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-white rounded-lg flex items-center justify-center flex-shrink-0",children:(0,ze.jsx)("i",{className:"fas fa-building text-gray-600"})}),(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),e.location&&(0,ze.jsx)("p",{className:"text-sm text-gray-600 mt-1",children:e.location}),e.address&&(0,ze.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:e.address}),e.meter_count>0&&(0,ze.jsxs)("div",{className:"mt-3 flex items-center text-xs text-gray-500",children:[(0,ze.jsx)("i",{className:"fas fa-tachometer-alt mr-1"}),e.meter_count," meter",1!==e.meter_count?"s":""]})]})]})]},e.id)),f.canChangeLocation&&(0,ze.jsx)("div",{onClick:()=>{console.log("Add location clicked!"),l(!0),console.log("showAddModal should be true now")},className:"bg-gray-50 rounded-lg p-6 cursor-pointer transition-all hover:bg-gray-100 border-2 border-dashed border-gray-300 hover:border-blue-500 flex items-center justify-center min-h-[120px]",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("i",{className:"fas fa-plus-circle text-3xl text-gray-400 mb-2"}),(0,ze.jsx)("p",{className:"text-gray-600 font-medium",children:"Add New Location"})]})})]})]}),(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200 gap-3 mt-8",children:[(0,ze.jsxs)("button",{onClick:()=>p("/rame"),className:"px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]}),(0,ze.jsxs)("button",{onClick:()=>{0!==e.length?!g&&e.length>0?w(e[0]):p("/list"):d("Please add at least one location to continue")},className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg transition-all duration-200 font-medium",children:[g||e.length>0?"Save & Continue":"Select a Location",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]}),n&&(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000] p-4",onClick:e=>{e.target===e.currentTarget&&(l(!1),d(""),o({name:"",location:"",address:""}))},children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl border-2 border-blue-200 max-w-lg w-full mx-4 overflow-hidden",children:[(0,ze.jsx)("div",{className:"bg-gradient-to-r from-blue-600 to-purple-600 px-6 py-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-white bg-opacity-20 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-white"})}),(0,ze.jsx)("h2",{className:"text-xl font-semibold text-white",children:"Add New Location"})]}),(0,ze.jsx)("button",{onClick:()=>{l(!1),d(""),o({name:"",location:"",address:""})},className:"text-white hover:text-gray-200 transition-colors p-1",children:(0,ze.jsx)("i",{className:"fas fa-times text-lg"})})]})}),(0,ze.jsxs)("div",{className:"p-6",children:[(0,ze.jsxs)("div",{className:"space-y-5",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[(0,ze.jsx)("i",{className:"fas fa-building text-blue-600 mr-2"}),"Location Name *"]}),(0,ze.jsx)("input",{type:"text",value:i.name,onChange:e=>o(Me(Me({},i),{},{name:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"e.g., Main Office, Factory 1, Dubai Branch"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[(0,ze.jsx)("i",{className:"fas fa-city text-blue-600 mr-2"}),"City/Region"]}),(0,ze.jsx)("input",{type:"text",value:i.location,onChange:e=>o(Me(Me({},i),{},{location:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"e.g., Dubai, Abu Dhabi, Sharjah"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{className:"block text-sm font-semibold text-gray-700 mb-2",children:[(0,ze.jsx)("i",{className:"fas fa-map text-blue-600 mr-2"}),"Full Address"]}),(0,ze.jsx)("textarea",{value:i.address,onChange:e=>o(Me(Me({},i),{},{address:e.target.value})),className:"w-full px-4 py-3 border-2 border-gray-300 rounded-lg focus:outline-none focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200 resize-none",rows:"3",placeholder:"Street address, building number, floor, etc."})]})]}),c&&(0,ze.jsx)("div",{className:"mt-5 p-3 bg-red-50 border-l-4 border-red-500 rounded",children:(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-circle text-red-500 mr-2"}),(0,ze.jsx)("span",{className:"text-red-700 text-sm font-medium",children:c})]})})]}),(0,ze.jsx)("div",{className:"bg-gray-50 px-6 py-4",children:(0,ze.jsxs)("div",{className:"flex justify-end gap-3",children:[(0,ze.jsx)("button",{onClick:()=>{l(!1),d(""),o({name:"",location:"",address:""})},className:"px-5 py-2.5 text-gray-600 hover:text-gray-800 hover:bg-gray-200 rounded-lg transition-all duration-200 font-medium",children:"Cancel"}),(0,ze.jsxs)("button",{onClick:async()=>{if(i.name.trim())try{const s=await pa.post("".concat(Ue,"/api/sites/"),Me(Me({},i),{},{company_id:u,is_active:!0}),{withCredentials:!0});t([...e,s.data]),l(!1),o({name:"",location:"",address:""}),d(""),0===e.length&&w(s.data)}catch(s){console.error("Error adding site:",s),d("Failed to add location")}else d("Location name is required")},className:"px-6 py-2.5 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg transition-all duration-200 font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-plus mr-2"}),"Add Location"]})]})})]})})]}):(0,ze.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,ze.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,ze.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access company onboarding."}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})})},Pa=e=>{let{isOpen:t,onClose:s,title:a,message:n,type:r="info",showCloseButton:l=!0,children:i}=e;if(!t)return null;const{icon:c,bgColor:d,iconColor:u,borderColor:m}=(()=>{switch(r){case"success":return{icon:"fas fa-check-circle",bgColor:"bg-green-100",iconColor:"text-green-600",borderColor:"border-green-200"};case"error":return{icon:"fas fa-exclamation-circle",bgColor:"bg-red-100",iconColor:"text-red-600",borderColor:"border-red-200"};case"warning":return{icon:"fas fa-exclamation-triangle",bgColor:"bg-yellow-100",iconColor:"text-yellow-600",borderColor:"border-yellow-200"};default:return{icon:"fas fa-info-circle",bgColor:"bg-blue-100",iconColor:"text-blue-600",borderColor:"border-blue-200"}}})(),f=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},onClick:e=>{e.target===e.currentTarget&&s()},children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 shadow-2xl border-2 ".concat(m),children:[(0,ze.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,ze.jsx)("div",{className:"flex-shrink-0 w-10 h-10 ".concat(d," rounded-full flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"".concat(c," ").concat(u)})}),(0,ze.jsxs)("div",{className:"flex-1 min-w-0",children:[a&&(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:a}),n&&(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:n}),i]})]}),l&&(0,ze.jsx)("div",{className:"flex justify-end mt-6",children:(0,ze.jsx)("button",{onClick:s,className:"px-4 py-2 bg-gray-500 text-white rounded-lg hover:bg-gray-600 transition-colors",children:"OK"})})]})});return(0,o.createPortal)(f,document.body)},Aa=e=>{let{fullName:t,email:s,size:a="md"}=e;return(0,ze.jsx)("div",{className:"".concat({sm:"w-8 h-8 text-sm",md:"w-10 h-10 text-base",lg:"w-12 h-12 text-lg"}[a]," bg-gradient-to-br from-purple-500 to-blue-500 rounded-full flex items-center justify-center font-medium text-white"),children:t?t.split(" ").map(e=>e.charAt(0)).join("").toUpperCase().slice(0,2):s?s.charAt(0).toUpperCase():"U"})},Ta=()=>{const{user:e,logout:t}=Be(),s=te(),[a,n]=(0,r.useState)(!1),l=e=>s.pathname===e,i=[{path:"/dashboard",label:"Dashboard",icon:"fa-solid fa-chart-pie"},{path:"/onboard",label:"Data Wizard",icon:"fa-solid fa-database"},{path:"/data",label:"Data Collection",icon:"fa-solid fa-chart-line"},{path:"/list",label:"Tasks",icon:"fa-solid fa-tasks"},{path:"/meter",label:"Meters",icon:"fa-solid fa-tachometer-alt"},{path:"/users",label:"User Management",icon:"fa-solid fa-users"}],o=()=>{n(!1)};return(0,ze.jsxs)("header",{className:"relative z-20 px-6 lg:px-20 py-6",children:[(0,ze.jsxs)("nav",{className:"flex items-center justify-between gap-6",children:[(0,ze.jsxs)(Ae,{to:"/",className:"flex items-center space-x-3 hover:opacity-80 transition-opacity",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-brand-green rounded-xl flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-compass text-white text-lg"})}),(0,ze.jsx)("span",{className:"text-text-high font-bold text-xl",children:"ESG Portal"})]}),(0,ze.jsx)("div",{className:"hidden lg:flex flex-1 justify-center",children:(0,ze.jsx)("div",{className:"flex items-center gap-4 bg-white/10 px-2 py-1 rounded-xl",children:i.map(e=>(0,ze.jsxs)(Ae,{to:e.path,className:"flex items-center space-x-2 px-4 py-2 rounded-lg text-text-muted hover:text-text-high hover:bg-brand-green/10 transition-colors font-medium ".concat(l(e.path)?"bg-white/10 text-text-high":""),children:[(0,ze.jsx)("i",{className:"".concat(e.icon," ").concat(l(e.path)?"text-brand-green":"")}),(0,ze.jsx)("span",{children:e.label})]},e.path))})}),(0,ze.jsxs)("div",{className:"hidden lg:flex items-center space-x-3",children:[(0,ze.jsx)(Aa,{fullName:null===e||void 0===e?void 0:e.name,email:null===e||void 0===e?void 0:e.email,size:"md"}),(0,ze.jsx)("span",{className:"text-text-high text-sm",children:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.email)||"User"}),(0,ze.jsx)("button",{onClick:t,className:"text-text-muted hover:text-text-high transition-colors ml-2",title:"Logout",children:(0,ze.jsx)("i",{className:"fa-solid fa-sign-out-alt"})})]}),(0,ze.jsx)("button",{onClick:()=>{n(!a)},className:"lg:hidden text-text-high p-2 rounded-lg hover:bg-white/10 transition-colors","aria-label":"Toggle mobile menu",children:(0,ze.jsx)("i",{className:"fa-solid ".concat(a?"fa-times":"fa-bars"," text-xl")})})]}),a&&(0,ze.jsx)("div",{className:"lg:hidden absolute top-full left-0 right-0 bg-[#131A2C]/95 backdrop-blur-md border-t border-white/10",children:(0,ze.jsxs)("div",{className:"px-6 py-4 space-y-2",children:[i.map(e=>(0,ze.jsxs)(Ae,{to:e.path,onClick:o,className:"flex items-center space-x-3 px-4 py-3 rounded-lg text-text-muted hover:text-text-high hover:bg-brand-green/10 transition-colors font-medium ".concat(l(e.path)?"bg-white/10 text-text-high":""),children:[(0,ze.jsx)("i",{className:"".concat(e.icon," ").concat(l(e.path)?"text-brand-green":"")}),(0,ze.jsx)("span",{children:e.label})]},e.path)),(0,ze.jsxs)("div",{className:"border-t border-white/10 pt-4 mt-4",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 px-4 py-2",children:[(0,ze.jsx)(Aa,{fullName:null===e||void 0===e?void 0:e.name,email:null===e||void 0===e?void 0:e.email,size:"sm"}),(0,ze.jsx)("span",{className:"text-text-high text-sm",children:(null===e||void 0===e?void 0:e.name)||(null===e||void 0===e?void 0:e.email)||"User"})]}),(0,ze.jsxs)("button",{onClick:()=>{t(),o()},className:"flex items-center space-x-3 px-4 py-3 rounded-lg text-text-muted hover:text-text-high hover:bg-red-500/10 transition-colors font-medium w-full",children:[(0,ze.jsx)("i",{className:"fa-solid fa-sign-out-alt"}),(0,ze.jsx)("span",{children:"Logout"})]})]})]})})]})},La=e=>{let{children:t,className:s=""}=e;return(0,ze.jsxs)("div",{className:"min-h-screen bg-gradient-to-br from-[#0D1117] via-[#131A2C] to-[#1B2332] ".concat(s),children:[(0,ze.jsx)(Ta,{}),(0,ze.jsx)("main",{className:"px-6 lg:px-20",children:t})]})},Oa=()=>{const e=ae(),{user:t,selectedCompany:s,hasPermission:a}=Be(),{selectedLocation:n,loading:l}=ya(),[i,o]=(0,r.useState)({}),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),[f,x]=(0,r.useState)([]),[p,h]=(0,r.useState)(!0),[g,y]=(0,r.useState)({isOpen:!1,type:"info",title:"",message:""}),[b,v]=(0,r.useState)(!1),[j,w]=(0,r.useState)(!1),[N,k]=(0,r.useState)(null),[S,C]=(0,r.useState)(null),[_,E]=(0,r.useState)([]),[P,A]=(0,r.useState)({category_assignments:{},element_assignments:{}}),[T,L]=(0,r.useState)(!1),[O,R]=(0,r.useState)([]),F=null===s||void 0===s?void 0:s.id;console.log("List component - selectedCompany:",s),console.log("List component - companyId:",F),console.log("List component - user:",t);const D=(e,t,s)=>{y({isOpen:!0,type:e,title:t,message:s})},M=async()=>{if(F)try{console.log("Fetching profiling questions for company:",F);const e=await Ie("".concat(Ue,"/api/profiling-questions/for_company/?company_id=").concat(F));if(console.log("Response status:",e.status,"Response ok:",e.ok),e.ok){const t=await e.json();if(console.log("Fetched questions from backend:",t),console.log("Questions type:",typeof t,"Length:",t.length),Array.isArray(t)&&t.length>0){const e=t.map(e=>({id:e.question_id,text:e.text,activatesElement:e.activates_element,category:"Basic Operations"}));console.log("Transformed questions:",e),x(e)}else console.error("Questions array is empty or not an array:",t)}else{const t=await e.text();console.error("Failed to fetch profiling questions. Status:",e.status,"Error:",t)}}catch(e){console.error("Error fetching profiling questions:",e)}else console.log("No company selected, skipping profiling questions fetch")},U=async()=>{if(F){L(!0);try{const e=await Ie("".concat(Ue,"/api/element-assignments/available_users/?company_id=").concat(F));if(e.ok){const t=await e.json();E(t)}}catch(e){console.error("Error fetching users:",e)}L(!1)}},z=async()=>{if(F)try{const e=await Ie("".concat(Ue,"/api/element-assignments/get_assignments/?company_id=").concat(F));if(e.ok){const t=await e.json();A(t)}}catch(e){console.error("Error fetching assignments:",e)}};(0,r.useEffect)(()=>{F&&!l&&(n?(console.log("\ud83d\udccd Location set: ".concat(n.name," (ID: ").concat(n.id,")")),(async()=>{if(l)return void console.log("\u23f3 Waiting for LocationContext to load...");console.log("\ud83d\udd04 Starting data fetch for location:",null===n||void 0===n?void 0:n.name,"ID:",null===n||void 0===n?void 0:n.id),h(!0),o({}),d(!1),x([]),v(!1),R([]),A({category_assignments:{},element_assignments:{}}),await M(),await I();const e=await G();await B(),console.log("\u2705 Data fetch complete for location:",null===n||void 0===n?void 0:n.name),console.log("   - Checklist exists:",e),console.log("   - Backend checklist items:",O.length),h(!1)})()):(console.log("\u26a0\ufe0f No location selected after loading complete"),h(!1),o({}),d(!1),x([]),v(!1),R([]),A({category_assignments:{},element_assignments:{}})))},[F,null===n||void 0===n?void 0:n.id,l]),(0,r.useEffect)(()=>{c&&F&&z()},[c,F]);const I=async()=>{if(F)try{console.log("Fetching existing profile answers for company:",F);let e="".concat(Ue,"/api/companies/").concat(F,"/profile_answers/");null!==n&&void 0!==n&&n.id&&"all"!==n.id?(e+="?site_id=".concat(n.id),console.log("\ud83d\udccd Fetching answers for location: ".concat(n.name))):"all"===(null===n||void 0===n?void 0:n.id)&&console.log("\ud83c\udf10 Fetching aggregated answers for all locations");const t=await Ie(e);if(t.ok){const e=await t.json();console.log("Loaded profile answers from API:",e);const s={};e.forEach(e=>{s[e.question]=e.answer}),console.log("Setting answers state to:",s),o(s),Object.keys(s).length>0&&console.log("Answers found, checking if should show checklist")}else console.log("No existing answers found or API error, status:",t.status)}catch(e){console.error("Error fetching existing answers:",e)}},G=async()=>{if(!F)return!1;try{console.log("\ud83d\udd0d Checking if checklist exists for company:",F);const e=(new Date).getTime();let t="".concat(Ue,"/api/checklist/?company_id=").concat(F,"&t=").concat(e);null!==n&&void 0!==n&&n.id&&"all"!==n.id?(t+="&site_id=".concat(n.id),console.log("\ud83c\udfe2 Checking checklist for location: ".concat(n.name))):"all"===(null===n||void 0===n?void 0:n.id)&&console.log("\ud83c\udf0d Checking aggregated checklist for all locations");const s=await Ie(t);if(s.ok){const e=await s.json();console.log("\ud83d\udccb Raw checklist response:",e);const t=e.results&&e.results.length>0;if(console.log("\u2705 Checklist exists check result:",t),v(t),t){const t=e.results.map(e=>({id:e.id,name:e.element_name,description:e.element_description,unit:e.element_unit,cadence:e.cadence,frameworks:e.frameworks_list,category:e.category||(e.is_metered?"Environmental":"Social"),isMetered:e.is_metered,locations:e.locations||[],location_count:e.location_count||0,location_type:e.location_type||"unknown"}));R(t),"all"===(null===n||void 0===n?void 0:n.id)&&console.log("\ud83c\udf0d All Locations Aggregation:",{totalElements:t.length,aggregationStats:e.aggregation_stats,elements:t.map(e=>{var t;return{name:e.name,type:e.location_type,count:e.location_count,sites:null===(t=e.locations)||void 0===t?void 0:t.map(e=>e.name).join(", ")}})}),console.log("\u2705 Loaded backend checklist with",t.length,"items")}return t}console.log("\u274c Failed to check checklist:",s.status),v(!1)}catch(e){console.error("\u274c Error checking checklist existence:",e),v(!1)}return!1},B=async()=>{if(F&&n)try{console.log("\ud83d\udd0d Checking wizard completion for location: ".concat(n.name));let e="".concat(Ue,"/api/companies/").concat(F,"/profile_answers/");null!==n&&void 0!==n&&n.id&&"all"!==n.id?e+="?site_id=".concat(n.id):"all"===(null===n||void 0===n?void 0:n.id)&&console.log("\ud83c\udf10 Checking wizard completion for all locations");const t=await Ie(e);if(t.ok){const e=await t.json(),s=await Ie("".concat(Ue,"/api/profiling-questions/for_company/?company_id=").concat(F));if(s.ok){const t=await s.json();e.length>0&&e.length>=t.length?(console.log("\u2705 Profiling wizard completed for ".concat(n.name)),b&&(console.log("\ud83d\udccb Showing checklist view for ".concat(n.name)),d(!0))):(console.log("\u23f3 Wizard not completed for ".concat(n.name,": ").concat(e.length,"/").concat(t.length," questions answered")),d(!1))}}}catch(e){console.error("Error checking wizard completion:",e)}},W=[{id:"electricity",name:"Electricity Consumption",description:"Total electricity from local providers",unit:"kWh",cadence:"Monthly",frameworks:["DST","ESG","Green Key"],category:"Environmental",is_metered:!0,meter_type:"Electricity"},{id:"water",name:"Water Consumption",description:"Total water usage",unit:"m\xb3",cadence:"Monthly",frameworks:["DST","ESG","Green Key"],category:"Environmental",is_metered:!0,meter_type:"Water"},{id:"waste_landfill",name:"Waste to Landfill",description:"Non-recycled waste disposal",unit:"kg",cadence:"Monthly",frameworks:["DST","ESG","Green Key"],category:"Environmental",is_metered:!0,meter_type:"Waste"},{id:"sustainability_policy",name:"Sustainability Policy",description:"Written sustainability policy",unit:"Document",cadence:"Annually",frameworks:["DST","Green Key","ESG"],category:"Social",is_metered:!1},{id:"sustainability_personnel",name:"Sustainability Personnel",description:"Certified sustainability staff",unit:"Count",cadence:"Annually",frameworks:["DST","Green Key"],category:"Social",is_metered:!1},{id:"employee_training",name:"Employee Training Hours",description:"Sustainability training per employee",unit:"Hours",cadence:"Annually",frameworks:["DST","Green Key","ESG"],category:"Social",is_metered:!1},{id:"guest_education",name:"Guest Education",description:"Guest sustainability initiatives",unit:"Count",cadence:"Quarterly",frameworks:["DST","Green Key"],category:"Social",is_metered:!1},{id:"community_initiatives",name:"Community Initiatives",description:"Local community programs",unit:"Count, AED",cadence:"Annually",frameworks:["DST","Green Key","ESG"],category:"Social",is_metered:!1},{id:"government_compliance",name:"Government Compliance",description:"Energy regulation compliance",unit:"Status",cadence:"Annually",frameworks:["DST","ESG"],category:"Governance",is_metered:!1},{id:"action_plan",name:"Action Plan",description:"Annual sustainability objectives",unit:"Document",cadence:"Annually",frameworks:["DST","Green Key","ESG"],category:"Governance",is_metered:!1},{id:"carbon_footprint",name:"Carbon Footprint",description:"Total GHG emissions",unit:"tonnes CO2e",cadence:"Annually",frameworks:["ESG","DST"],category:"Environmental",is_metered:!1},{id:"health_safety",name:"Health & Safety Incidents",description:"Workplace incidents",unit:"Count",cadence:"Monthly",frameworks:["ESG"],category:"Social",is_metered:!1},{id:"anti_corruption",name:"Anti-corruption Policies",description:"Anti-corruption measures",unit:"Status",cadence:"Annually",frameworks:["ESG"],category:"Governance",is_metered:!1},{id:"risk_management",name:"Risk Management",description:"ESG risk framework",unit:"Status",cadence:"Annually",frameworks:["ESG"],category:"Governance",is_metered:!1}],q={generator_fuel:{id:"generator_fuel",name:"Generator Fuel",description:"Fuel for backup generators",unit:"liters",cadence:"Monthly",frameworks:["DST","ESG"],category:"Environmental",is_metered:!0,meter_type:"Generator"},vehicle_fuel:{id:"vehicle_fuel",name:"Vehicle Fuel",description:"Company vehicle fuel",unit:"liters",cadence:"Monthly",frameworks:["DST","ESG"],category:"Environmental",is_metered:!0,meter_type:"Vehicle"},lpg_consumption:{id:"lpg_consumption",name:"LPG Usage",description:"Liquid petroleum gas consumption",unit:"kg",cadence:"Monthly",frameworks:["DST","ESG"],category:"Environmental",is_metered:!0,meter_type:"LPG"},green_events:{id:"green_events",name:"Green Events",description:"Sustainable event services",unit:"Count",cadence:"Quarterly",frameworks:["DST","Green Key"],category:"Social",is_metered:!1},food_sourcing:{id:"food_sourcing",name:"Food Sourcing",description:"Local/organic food purchases",unit:"%",cadence:"Quarterly",frameworks:["Green Key","ESG"],category:"Environmental",is_metered:!1},green_spaces:{id:"green_spaces",name:"Green Spaces",description:"Sustainable landscaping",unit:"m\xb2",cadence:"Annually",frameworks:["Green Key"],category:"Environmental",is_metered:!1},renewable_energy_usage:{id:"renewable_energy_usage",name:"Renewable Energy",description:"Energy from renewable sources",unit:"%",cadence:"Quarterly",frameworks:["Green Key","ESG"],category:"Environmental",is_metered:!0,meter_type:"Renewable Energy"},environmental_management_system:{id:"environmental_management_system",name:"Environmental Management System",description:"EMS certification",unit:"Status",cadence:"Annually",frameworks:["Green Key","ESG"],category:"Governance",is_metered:!1},board_composition:{id:"board_composition",name:"Board Composition",description:"Board diversity metrics",unit:"%",cadence:"Annually",frameworks:["ESG"],category:"Governance",is_metered:!1}},V=async(e,t)=>{if(!a("frameworkSelection","update"))return void D("warning","Permission Denied","You do not have permission to edit profiling answers. This is view-only mode.");if("all"===(null===n||void 0===n?void 0:n.id))return void D("warning","Location Required",'Please select a specific location to edit profile answers. The "All Locations" view is for viewing aggregated data only.');const s=Me(Me({},i),{},{[e]:t});o(s);try{console.log("Saving profiling answer to database:",e,t);const s={question:e,answer:t};null!==n&&void 0!==n&&n.id&&"all"!==n.id&&(s.site_id=n.id);const a=await Ie("".concat(Ue,"/api/companies/").concat(F,"/save_profile_answer/"),{method:"POST",body:JSON.stringify(s)});if(a.ok){const e=await a.json();console.log("Answer saved successfully:",e)}else{console.error("Failed to save answer. Status:",a.status);const e=await a.text();console.error("Error response:",e),403===a.status&&D("error","Permission Denied","You can only view profiling answers.")}}catch(r){console.error("Error saving answer to database:",r)}},H=async e=>{if(!a("frameworkSelection","update"))return void D("warning","Permission Denied","You do not have permission to edit profiling answers. This is view-only mode.");if("all"===(null===n||void 0===n?void 0:n.id))return void D("warning","Location Required",'Please select a specific location to edit profile answers. The "All Locations" view is for viewing aggregated data only.');const t={};f.forEach(s=>{t[s.id]=e}),o(t);try{console.log("Saving all profiling answers to database:",e);const t=f.map(t=>{const s={question:t.id,answer:e};return null!==n&&void 0!==n&&n.id&&"all"!==n.id&&(s.site_id=n.id),Ie("".concat(Ue,"/api/companies/").concat(F,"/save_profile_answer/"),{method:"POST",body:JSON.stringify(s)})}),s=await Promise.all(t);if(s.every(e=>e.ok))console.log("All answers saved successfully");else{console.error("Some answers failed to save");s.some(e=>403===e.status)&&D("error","Permission Denied","You can only view profiling answers.")}}catch(s){console.error("Error saving all answers to database:",s)}},Q=f.length>0&&f.every(e=>i.hasOwnProperty(e.id));console.log("\ud83d\udd0d Component render state:",{companyId:F,answersCount:Object.keys(i).length,questionsCount:f.length,allQuestionsAnswered:Q,showChecklist:c,checklistExists:b,hasEditPermission:a("frameworkSelection","update"),userRole:null===t||void 0===t?void 0:t.role,loading:p});const $="all"===(null===n||void 0===n?void 0:n.id)?[]:(()=>{if(!Q)return[];const e=[...W];return f.forEach(t=>{!0===i[t.id]&&q[t.activatesElement]&&e.push(q[t.activatesElement])}),e.sort((e,t)=>e.category.localeCompare(t.category))})()||[],J=O.length>0?O:$,Y=O.length>0;console.log("\ud83d\udcca Checklist Status:",{backendChecklistCount:O.length,localChecklistCount:$.length,finalChecklistCount:J.length,usingBackend:O.length>0});const K=J?J.reduce((e,t)=>{const s=t.category.toLowerCase();return e[s]=(e[s]||0)+1,e},{environmental:0,social:0,governance:0}):{environmental:0,social:0,governance:0},X=()=>{console.log("Profiling wizard completed, continuing to meters"),e("/meter")};return c&&Q&&n||"all"===(null===n||void 0===n?void 0:n.id)?(0,ze.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200 mb-6 sm:mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-green-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-check-circle text-green-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Personalized Data Checklist"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"all"===(null===n||void 0===n?void 0:n.id)?(0,ze.jsxs)("span",{children:["View: ",(0,ze.jsx)("strong",{className:"text-purple-600",children:"All Locations Combined"})," | Showing aggregated data from all sites"]}):(0,ze.jsxs)("span",{children:["Location: ",(0,ze.jsx)("strong",{className:"text-purple-600",children:null===n||void 0===n?void 0:n.name})," | Site ID: ",(0,ze.jsx)("strong",{children:null===n||void 0===n?void 0:n.id})]})})]})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3 sm:gap-4",children:[(0,ze.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-blue-50 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-blue-600",children:J.length}),(0,ze.jsx)("div",{className:"text-xs sm:text-sm text-gray-600",children:"Total Elements"})]}),(0,ze.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-green-50 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-green-600",children:K.environmental}),(0,ze.jsx)("div",{className:"text-xs sm:text-sm text-gray-600",children:"Environmental"})]}),(0,ze.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-purple-50 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-purple-600",children:K.social}),(0,ze.jsx)("div",{className:"text-xs sm:text-sm text-gray-600",children:"Social"})]}),(0,ze.jsxs)("div",{className:"text-center p-3 sm:p-4 bg-orange-50 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-xl sm:text-2xl font-bold text-orange-600",children:K.governance}),(0,ze.jsx)("div",{className:"text-xs sm:text-sm text-gray-600",children:"Governance"})]})]})]}),["Environmental","Social","Governance"].map(e=>{var t;const s=J.filter(t=>t.category===e),r=null===(t=P.category_assignments)||void 0===t?void 0:t[e];return 0===s.length?null:(0,ze.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6 sm:mb-8",children:[(0,ze.jsx)("div",{className:"p-4 sm:p-6 border-b border-gray-200 ".concat("Environmental"===e?"bg-green-50":"Social"===e?"bg-purple-50":"bg-orange-50"),children:(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:justify-between sm:items-center gap-3",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:[e," Elements"]}),(0,ze.jsxs)("p",{className:"text-sm sm:text-base text-gray-600",children:[s.length," elements in this category"]}),r&&(0,ze.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500 mt-1",children:[(0,ze.jsx)("i",{className:"fas fa-user mr-1"}),"Default assignee: ",(0,ze.jsx)("span",{className:"font-medium",children:r.username})]})]}),a("elementAssignment","create")&&Y&&"all"!==(null===n||void 0===n?void 0:n.id)&&(0,ze.jsxs)("button",{onClick:()=>{C(e),k(null),U(),w(!0)},className:"px-3 sm:px-4 py-2 rounded-lg text-white font-medium text-xs sm:text-sm ".concat("Environmental"===e?"bg-green-600 hover:bg-green-700":"Social"===e?"bg-purple-600 hover:bg-purple-700":"bg-orange-600 hover:bg-orange-700"),children:[(0,ze.jsx)("i",{className:"fas fa-users mr-1 sm:mr-2"}),"Assign Category"]})]})}),(0,ze.jsx)("div",{className:"divide-y divide-gray-100",children:s.map((t,s)=>{const r=((e,t)=>P.element_assignments&&P.element_assignments[e]?P.element_assignments[e]:P.category_assignments&&P.category_assignments[t]?P.category_assignments[t]:null)(t.id,e);return(0,ze.jsx)("div",{className:"p-4 sm:p-6 hover:bg-blue-50 transition-colors",children:(0,ze.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-start lg:justify-between",children:[(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsxs)("div",{className:"flex flex-wrap items-center gap-2 sm:gap-3 mb-3",children:[(0,ze.jsxs)("span",{className:"text-xs sm:text-sm font-bold text-blue-600 bg-blue-100 px-2 py-1 rounded",children:["#",s+1]}),(0,ze.jsx)("h4",{className:"font-bold text-gray-900 text-base sm:text-lg",children:t.name}),(0,ze.jsx)("span",{className:"px-2 sm:px-3 py-1 rounded-full text-xs font-bold ".concat("Environmental"===t.category?"bg-green-200 text-green-900":"Social"===t.category?"bg-purple-200 text-purple-900":"bg-orange-200 text-orange-900"),children:t.category})]}),(0,ze.jsx)("p",{className:"text-gray-700 text-sm sm:text-base mb-4 font-medium",children:t.description}),(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row flex-wrap gap-2 sm:gap-4 text-xs sm:text-sm font-medium text-gray-700",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 px-2 sm:px-3 py-1 sm:py-2 rounded-lg",children:[(0,ze.jsx)("i",{className:"fas fa-ruler text-gray-600"}),(0,ze.jsxs)("span",{children:["Unit: ",(0,ze.jsx)("span",{className:"font-bold text-gray-900",children:t.unit})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 px-2 sm:px-3 py-1 sm:py-2 rounded-lg",children:[(0,ze.jsx)("i",{className:"fas fa-clock text-gray-600"}),(0,ze.jsxs)("span",{children:["Frequency: ",(0,ze.jsx)("span",{className:"font-bold text-gray-900",children:t.cadence})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 px-2 sm:px-3 py-1 sm:py-2 rounded-lg",children:[(0,ze.jsx)("i",{className:"fas fa-tags text-gray-600"}),(0,ze.jsx)("span",{children:"Frameworks:"}),(0,ze.jsx)("div",{className:"flex flex-wrap items-center gap-1",children:t.frameworks.map((e,t)=>(0,ze.jsx)("span",{className:"px-1 sm:px-2 py-0.5 sm:py-1 rounded text-xs font-bold ".concat("DST"===e?"bg-blue-200 text-blue-900":"ESG"===e?"bg-green-200 text-green-900":"Green Key"===e?"bg-teal-200 text-teal-900":"TCFD"===e?"bg-orange-200 text-orange-900":"SASB"===e?"bg-purple-200 text-purple-900":"bg-gray-200 text-gray-900"),children:e},t))})]}),"all"===(null===n||void 0===n?void 0:n.id)&&t.locations&&(0,ze.jsxs)("div",{className:"flex items-center space-x-2 bg-gray-100 px-2 sm:px-3 py-1 sm:py-2 rounded-lg",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-gray-600"}),(0,ze.jsx)("span",{children:"Locations:"}),(0,ze.jsxs)("div",{className:"flex flex-wrap items-center gap-1",children:["shared"===t.location_type&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)("span",{className:"px-1 sm:px-2 py-0.5 sm:py-1 rounded text-xs font-bold bg-blue-200 text-blue-900",children:[(0,ze.jsx)("i",{className:"fas fa-users mr-1"}),"Shared (",t.location_count," sites)"]}),t.locations.map((e,t)=>(0,ze.jsx)("span",{className:"px-1 sm:px-2 py-0.5 sm:py-1 rounded text-xs bg-gray-200 text-gray-700",children:e.name},t))]}),"unique"===t.location_type&&t.locations[0]&&(0,ze.jsxs)("span",{className:"px-1 sm:px-2 py-0.5 sm:py-1 rounded text-xs font-bold bg-amber-200 text-amber-900",children:[(0,ze.jsx)("i",{className:"fas fa-star mr-1"}),"Unique to ",t.locations[0].name]}),"none"===t.location_type&&(0,ze.jsx)("span",{className:"px-1 sm:px-2 py-0.5 sm:py-1 rounded text-xs bg-gray-200 text-gray-500",children:"No site assigned"})]})]})]})]}),(0,ze.jsxs)("div",{className:"mt-4 lg:mt-0 lg:ml-6 text-left lg:text-right",children:[r?(0,ze.jsxs)("div",{className:"mb-2",children:[(0,ze.jsx)("p",{className:"text-xs sm:text-sm text-gray-500",children:"Assigned to:"}),(0,ze.jsx)("p",{className:"font-medium text-sm sm:text-base text-gray-900",children:r.username}),(0,ze.jsx)("p",{className:"text-xs text-gray-500",children:r.email})]}):(0,ze.jsx)("p",{className:"text-xs sm:text-sm text-gray-400 mb-2",children:"Unassigned"}),a("elementAssignment","create")&&Y&&"all"!==(null===n||void 0===n?void 0:n.id)&&(0,ze.jsxs)("button",{onClick:()=>{console.log("Assigning item:",t),k(t),C(null),U(),w(!0)},className:"px-3 py-1.5 bg-blue-600 text-white rounded text-xs sm:text-sm hover:bg-blue-700 whitespace-nowrap",children:[(0,ze.jsx)("i",{className:"fas fa-user-edit mr-1"}),r?"Reassign":"Assign"]})]})]})},t.id)})})]},e)}),(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200 gap-3",children:["all"!==(null===n||void 0===n?void 0:n.id)?(0,ze.jsxs)("button",{className:"w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:async()=>{d(!1),await G()},children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back to Questions"]}):(0,ze.jsx)("div",{}),(0,ze.jsxs)("button",{className:"w-full sm:w-auto px-6 sm:px-8 py-2 sm:py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:X,children:["Save & Continue",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]}),j&&(0,ze.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50 p-4",children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 max-w-md w-full max-h-[90vh] overflow-y-auto",children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-bold text-gray-900 mb-4",children:S?"Assign ".concat(S," Category"):"Assign ".concat(null===N||void 0===N?void 0:N.name)}),T?(0,ze.jsxs)("div",{className:"text-center py-4",children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin text-2xl text-gray-400"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-gray-500 mt-2",children:"Loading users..."})]}):(0,ze.jsx)("div",{className:"max-h-64 overflow-y-auto",children:0===_.length?(0,ze.jsx)("p",{className:"text-sm sm:text-base text-gray-500",children:"No users available"}):_.map(e=>(0,ze.jsxs)("button",{onClick:()=>{S?(async(e,t)=>{try{const s=await Ie("".concat(Ue,"/api/element-assignments/assign_category/"),{method:"POST",body:JSON.stringify({company_id:F,category:e,user_id:t})});if(s.ok){const e=await s.json();D("success","Success",e.message),z(),w(!1),C(null)}else{const e=await s.json();D("error","Error",e.error||"Failed to assign category")}}catch(s){console.error("Error assigning category:",s),D("error","Error","Failed to assign category")}})(S,e.id):N&&(async(e,t)=>{try{console.log("Assigning element - elementId:",e,"userId:",t),console.log("Selected element object:",N);const s=await Ie("".concat(Ue,"/api/element-assignments/assign_element/"),{method:"POST",body:JSON.stringify({checklist_item_id:e,user_id:t})});if(s.ok){const e=await s.json();D("success","Success",e.message),z(),w(!1),k(null)}else{const e=await s.json();D("error","Error",e.error||"Failed to assign element")}}catch(s){console.error("Error assigning element:",s),D("error","Error","Failed to assign element")}})(N.id,e.id)},className:"w-full text-left p-2 sm:p-3 hover:bg-gray-50 rounded-lg mb-2 border border-gray-200",children:[(0,ze.jsx)("div",{className:"font-medium text-sm sm:text-base text-gray-900",children:e.full_name}),(0,ze.jsx)("div",{className:"text-xs sm:text-sm text-gray-500",children:e.email}),(0,ze.jsxs)("div",{className:"text-xs text-gray-400 mt-1",children:["Role: ",e.role," | Active assignments: ",e.assignment_count]})]},e.id))}),(0,ze.jsx)("div",{className:"mt-4 flex justify-end",children:(0,ze.jsx)("button",{onClick:()=>{w(!1),C(null),k(null)},className:"px-3 sm:px-4 py-1.5 sm:py-2 text-sm sm:text-base text-gray-600 hover:text-gray-800",children:"Cancel"})})]})})]}):F?l?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-3 text-sm sm:text-base text-gray-600",children:"Loading location data..."})]})}):p?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-3 text-sm sm:text-base text-gray-600",children:"Loading profiling questions..."})]})}):l||n?0===f.length?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200 mb-6 sm:mb-8",children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4",children:"No Questions Available"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mb-4",children:"No profiling questions found. Please contact support or check your backend configuration."}),(0,ze.jsxs)("div",{className:"text-xs sm:text-sm text-gray-500",children:["Debug info: Company ID: ",F,", Questions loaded: ",f.length,", Loading: ",p.toString()]}),(0,ze.jsx)("div",{className:"mt-4",children:(0,ze.jsx)("button",{className:"px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm sm:text-base",onClick:()=>{h(!0),M()},children:"Retry Loading Questions"})})]})}):(0,ze.jsxs)("div",{className:"max-w-6xl mx-auto px-4",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200 mb-6 sm:mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-question-circle text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-lg sm:text-xl font-semibold text-gray-900",children:"Profiling Wizard"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"Answer these questions to personalize your data requirements"})]})]}),(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,ze.jsxs)("div",{className:"text-xs sm:text-sm text-gray-600",children:[(0,ze.jsx)("span",{className:"font-medium",children:Object.keys(i).length})," of ",(0,ze.jsx)("span",{className:"font-medium",children:f.length})," questions answered",!a("frameworkSelection","update")&&(0,ze.jsxs)("span",{className:"ml-2 sm:ml-4 px-2 sm:px-3 py-1 bg-yellow-100 text-yellow-700 rounded-full text-xs font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only"]})]}),a("frameworkSelection","update")&&"all"!==(null===n||void 0===n?void 0:n.id)&&(0,ze.jsxs)("div",{className:"flex space-x-2 sm:space-x-3",children:[(0,ze.jsxs)("button",{className:"px-3 sm:px-4 py-1.5 sm:py-2 bg-red-100 text-red-700 rounded-lg hover:bg-red-200 text-xs sm:text-sm font-medium",onClick:()=>H(!1),children:[(0,ze.jsx)("i",{className:"fas fa-times mr-1 sm:mr-2"}),"Answer All No"]}),(0,ze.jsxs)("button",{className:"px-3 sm:px-4 py-1.5 sm:py-2 bg-green-100 text-green-700 rounded-lg hover:bg-green-200 text-xs sm:text-sm font-medium",onClick:()=>H(!0),children:[(0,ze.jsx)("i",{className:"fas fa-check mr-1 sm:mr-2"}),"Answer All Yes"]})]})]}),(0,ze.jsx)("div",{className:"mt-4",children:(0,ze.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,ze.jsx)("div",{className:"bg-blue-500 h-2 rounded-full transition-all duration-300",style:{width:"".concat(Object.keys(i).length/f.length*100,"%")}})})})]}),"all"!==(null===n||void 0===n?void 0:n.id)&&["Basic Operations"].map(e=>(0,ze.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:[(0,ze.jsx)("div",{className:"p-4 sm:p-6 border-b border-gray-200",children:(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900",children:e})}),(0,ze.jsx)("div",{className:"p-4 sm:p-6 space-y-4 sm:space-y-6",children:f.filter(t=>t.category===e).map(e=>{var t;return(0,ze.jsx)("div",{className:"border border-gray-200 rounded-lg p-3 sm:p-4",children:(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-start sm:justify-between gap-3",children:[(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("p",{className:"font-medium text-sm sm:text-base text-gray-900 mb-2",children:e.text}),(0,ze.jsxs)("p",{className:"text-xs sm:text-sm text-gray-500",children:["This will activate: ",(0,ze.jsx)("span",{className:"font-medium",children:(null===(t=q[e.activatesElement])||void 0===t?void 0:t.name)||e.activatesElement})]})]}),(0,ze.jsxs)("div",{className:"flex space-x-2 sm:space-x-3",children:[(0,ze.jsx)("button",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg font-medium text-xs sm:text-sm transition-colors ".concat(!1===i[e.id]?"bg-red-100 text-red-700 border-2 border-red-300":a("frameworkSelection","update")&&"all"!==(null===n||void 0===n?void 0:n.id)?"bg-gray-100 text-gray-600 border border-gray-300 hover:bg-red-50":"bg-gray-200 text-gray-500 border border-gray-300 cursor-not-allowed"),onClick:()=>V(e.id,!1),disabled:!a("frameworkSelection","update")||"all"===(null===n||void 0===n?void 0:n.id),children:"No"}),(0,ze.jsx)("button",{className:"px-3 sm:px-4 py-1.5 sm:py-2 rounded-lg font-medium text-xs sm:text-sm transition-colors ".concat(!0===i[e.id]?"bg-green-100 text-green-700 border-2 border-green-300":a("frameworkSelection","update")&&"all"!==(null===n||void 0===n?void 0:n.id)?"bg-gray-100 text-gray-600 border border-gray-300 hover:bg-green-50":"bg-gray-200 text-gray-500 border border-gray-300 cursor-not-allowed"),onClick:()=>V(e.id,!0),disabled:!a("frameworkSelection","update")||"all"===(null===n||void 0===n?void 0:n.id),children:"Yes"})]})]})},e.id)})})]},e)),Q&&a("frameworkSelection","update")&&!b&&"all"!==(null===n||void 0===n?void 0:n.id)&&(0,ze.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 sm:p-6 mb-6 sm:mb-8",children:(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-green-900",children:"All Questions Answered!"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-green-700",children:"Click below to generate your personalized data checklist"})]}),(0,ze.jsx)("button",{className:"px-4 sm:px-6 py-2 sm:py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium disabled:opacity-50 disabled:cursor-not-allowed text-sm sm:text-base",onClick:async()=>{await(async()=>{if(!Q)return!1;m(!0);try{const t=f.map(e=>({question_id:e.id,answer:!0===i[e.id]}));console.log("Sending answers to backend:",t);const s={company_id:F,answers:t};if(null!==n&&void 0!==n&&n.id&&"all"!==n.id)s.site_id=n.id,console.log("\ud83c\udfe2 Saving profile answers for location: ".concat(n.name));else if("all"===(null===n||void 0===n?void 0:n.id))return console.log("\ud83c\udf10 Cannot save answers for All Locations view - please select a specific location"),D("warning","Location Required",'Please select a specific location to save profile answers. The "All Locations" view is for viewing aggregated data only.'),!1;if((await Ie("".concat(Ue,"/api/profiling-questions/save_answers/"),{method:"POST",body:JSON.stringify(s)})).ok){let t="".concat(Ue,"/api/checklist/?company_id=").concat(F);null!==n&&void 0!==n&&n.id&&"all"!==n.id&&(t+="&site_id=".concat(n.id));const s=await Ie(t);if(s.ok){var e;const t=await s.json();console.log("\ud83d\udd0d Raw checklist response for All Locations debug:",t),console.log("\ud83d\udd0d Sample checklist item:",null===(e=t.results)||void 0===e?void 0:e[0]);const a=t.results.map(e=>({id:e.id,name:e.element_name,description:e.element_description,unit:e.element_unit,cadence:e.cadence,frameworks:e.frameworks_list,category:e.category||(e.is_metered?"Environmental":"Social"),isMetered:e.is_metered,locations:e.locations||[],location_count:e.location_count||0,location_type:e.location_type||"unknown"}));return console.log("\ud83d\udd0d Transformed checklist with location data:",a[0]),R(a),a}}throw new Error("Failed to save answers or generate checklist")}catch(t){return console.error("Error saving answers and generating checklist:",t),D("error","Generation Failed","Failed to generate checklist. Please try again."),!1}finally{m(!1)}})()&&(console.log("Profiling wizard completed, showing checklist"),v(!0),d(!0))},disabled:u,children:u?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Generating..."]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-list mr-2"}),"Generate Checklist"]})})]})}),"all"===(null===n||void 0===n?void 0:n.id)&&(0,ze.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 sm:p-6 mb-6 sm:mb-8",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-globe text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-blue-900",children:"All Locations View"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-blue-700",children:"You're viewing aggregated data from all locations. To edit profile answers or generate checklists, please select a specific location."})]})]})}),!a("frameworkSelection","update")&&(0,ze.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 sm:p-6 mb-6 sm:mb-8",children:(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-eye text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-blue-900",children:"Profiling (View Only)"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-blue-700",children:b?"You can view the generated checklist.":"Questions have been answered by an admin. Checklist will be available once generated."})]})]}),b&&(0,ze.jsxs)("button",{className:"px-4 sm:px-6 py-2 sm:py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium text-sm sm:text-base",onClick:()=>d(!0),children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-2"}),"View Checklist"]})]})}),Q&&b&&!c&&a("frameworkSelection","update")&&(0,ze.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-xl p-4 sm:p-6 mb-6 sm:mb-8",children:(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center sm:justify-between gap-3",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-green-900",children:"\u2705 Checklist Ready!"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-green-700",children:"all"===(null===n||void 0===n?void 0:n.id)?"Viewing aggregated checklists from all locations.":"Your personalized data checklist has been created and is ready to view."})]}),(0,ze.jsxs)("button",{className:"px-4 sm:px-6 py-2 sm:py-3 bg-green-600 text-white rounded-lg hover:bg-green-700 font-medium text-sm sm:text-base",onClick:()=>d(!0),children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-2"}),"View Checklist"]})]})}),(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center justify-between bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200 gap-3",children:[(0,ze.jsxs)("button",{className:"w-full sm:w-auto px-4 sm:px-6 py-2 sm:py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium text-sm sm:text-base",onClick:()=>e("/frame"),children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]}),(0,ze.jsx)("div",{className:"text-center",children:(0,ze.jsx)("p",{className:"text-xs sm:text-sm text-gray-600",children:Q?b?"Your checklist is ready for review":a("frameworkSelection","update")?"Generate your checklist to continue":"Waiting for checklist generation":"Answer ".concat(f.length-Object.keys(i).length," more questions to continue")})})]}),(0,ze.jsx)(Pa,{isOpen:g.isOpen,onClose:()=>{y({isOpen:!1,type:"info",title:"",message:""})},type:g.type,title:g.title,message:g.message})]}):(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6 text-center",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-4xl text-yellow-600 mb-4"}),(0,ze.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Location Selected"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"Please select a location to view profiling questions."}),(0,ze.jsxs)("button",{onClick:()=>e("/location"),className:"px-6 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Go to Location Selection"]})]})}):(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200 mb-6 sm:mb-8",children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4",children:"No Company Selected"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-gray-600 mb-4",children:"Please select a company from the navigation bar to continue with profiling."})]})})},Ra=e=>{var t;let{isOpen:s,title:a,meter:n,meterTypes:l,onSave:i,onClose:o}=e;const[c,d]=(0,r.useState)(!0),[u,m]=(0,r.useState)({name:"",type:"",location:"",account_number:""}),[f,x]=(0,r.useState)({show:!1,message:"",type:"error"});r.useEffect(()=>{n?(m({name:n.name||"",type:n.type||"",location:n.location||"",account_number:n.account_number||""}),d(!1)):(m({name:"",type:"",location:"",account_number:""}),d(!0)),x({show:!1,message:"",type:"error"})},[n,s]);const p=(e,t)=>{m(s=>Me(Me({},s),{},{[e]:t})),f.show&&x({show:!1,message:"",type:"error"})};return s?(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,ze.jsx)("div",{className:"bg-white rounded-md p-5 border w-full max-w-md shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-3",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:a}),(0,ze.jsx)("button",{type:"button",className:"text-gray-400 hover:text-gray-600",onClick:o,children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),f.show&&(0,ze.jsx)("div",{className:"p-3 rounded-lg mb-4 ".concat("error"===f.type?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"),children:(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("i",{className:"fas ".concat("error"===f.type?"fa-exclamation-circle":"fa-info-circle"," text-sm")}),(0,ze.jsx)("span",{className:"text-sm font-medium",children:f.message})]})}),c&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"Select the type of meter to add:"}),(0,ze.jsx)("div",{className:"space-y-2",children:l.filter(e=>"total"!==e.id).map(e=>(0,ze.jsx)("button",{type:"button",className:"w-full text-left p-2 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",onClick:()=>(e=>{l.find(t=>t.name.replace(" Meters","").replace(" Trackers","")===e);const t={Electricity:"Electricity Consumption",Water:"Water Consumption",Waste:"Waste to Landfill",Generator:"Generator Fuel Consumption",Vehicle:"Vehicle Fuel Consumption",LPG:"LPG Usage","Renewable Energy":"Renewable Energy Usage"}[e]||e;m(s=>{var a;return Me(Me({},s),{},{type:t,name:null!==n&&void 0!==n&&null!==(a=n.name)&&void 0!==a&&a.includes("Copy")?"".concat(e," Copy"):"",location:"To be configured"})}),d(!1)})(e.name.replace(" Meters","").replace(" Trackers","")),children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.id))})]}),!c&&(0,ze.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),!u.name.trim()||!u.type)return void x({show:!0,message:"Please fill in required fields (Name and Type)",type:"error"});const t=Me(Me({},u),n&&{id:n.id,isAutoCreated:n.isAutoCreated});x({show:!1,message:"",type:"error"}),i(t)},children:[(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Meter Type"}),(0,ze.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,ze.jsx)("div",{className:"flex items-center space-x-3",children:(()=>{const e=l.find(e=>e.name.replace(" Meters","").replace(" Trackers","")===u.type);return(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-".concat(null===e||void 0===e?void 0:e.color,"-100 rounded-lg flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"".concat(null===e||void 0===e?void 0:e.icon," text-").concat(null===e||void 0===e?void 0:e.color,"-600")})}),(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:u.type})]})})()}),(0,ze.jsx)("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-800",onClick:()=>d(!0),children:"Change"})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Meter Name ",(0,ze.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ze.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Main Building Electric, Kitchen Water",value:u.name,onChange:e=>p("name",e.target.value),required:!0})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Location Description"}),(0,ze.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., Main Building, Kitchen Area, Basement",value:u.location,onChange:e=>p("location",e.target.value)})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account/Meter Number"}),(0,ze.jsx)("input",{type:"text",className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., ELE-001-2024, WAT-002-2024",value:u.account_number,onChange:e=>p("account_number",e.target.value)})]})]}),(0,ze.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,ze.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:o,children:"Cancel"}),(0,ze.jsx)("button",{type:"submit",className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:null!==n&&void 0!==n&&null!==(t=n.name)&&void 0!==t&&t.includes("Copy")?"Add Meter":n?"Save Changes":"Add Meter"})]})]})]})})}):null},Fa=e=>{let{isOpen:t,currentFilter:s,uniqueTypes:a,onApply:n,onClose:l}=e;const[i,o]=(0,r.useState)(s);r.useEffect(()=>{o(s)},[s,t]);const c=e=>{o(e),n(e),l()};return t?(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,ze.jsx)("div",{className:"bg-white rounded-md p-3 border w-80 shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-1",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Select Meter Type"}),(0,ze.jsx)("button",{type:"button",onClick:l,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsxs)("div",{className:"space-y-2",children:[(0,ze.jsx)("button",{type:"button",onClick:()=>c("All Types"),className:"w-full text-left p-2 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-th text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900",children:"All Types"}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:"Show all meter types"})]})]})}),a.map(e=>(0,ze.jsx)("button",{type:"button",onClick:()=>c(e),className:"w-full text-left p-2 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas ".concat(e.includes("Electricity")?"fa-bolt text-yellow-600":e.includes("Water")?"fa-tint text-blue-600":e.includes("Waste")?"fa-trash text-red-600":e.includes("Generator")?"fa-cog text-orange-600":e.includes("Vehicle")?"fa-car text-green-600":e.includes("LPG")?"fa-fire text-purple-600":e.includes("Renewable")?"fa-leaf text-green-600":"fa-gauge text-gray-600")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900",children:e}),(0,ze.jsxs)("p",{className:"text-sm text-gray-500",children:["Filter by ",e.toLowerCase()]})]})]})},e))]})]})})}):null},Da=e=>{let{isOpen:t,currentFilter:s,onApply:a,onClose:n}=e;const[l,i]=(0,r.useState)(s);r.useEffect(()=>{i(s)},[s,t]);if(!t)return null;return(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,ze.jsx)("div",{className:"bg-white rounded-md p-3 border w-80 shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-1",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Select Status"}),(0,ze.jsx)("button",{type:"button",onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsx)("div",{className:"space-y-2",children:[{value:"All Status",label:"All Status",description:"Show all meter statuses",icon:"fa-th",color:"text-blue-600",bgColor:"bg-blue-100"},{value:"Active",label:"Active",description:"Show active meters only",icon:"fa-check-circle",color:"text-green-600",bgColor:"bg-green-100"},{value:"Inactive",label:"Inactive",description:"Show inactive meters only",icon:"fa-times-circle",color:"text-gray-600",bgColor:"bg-gray-100"},{value:"Warning",label:"Warning",description:"Show meters with warnings",icon:"fa-exclamation-triangle",color:"text-yellow-600",bgColor:"bg-yellow-100"},{value:"Maintenance",label:"Maintenance",description:"Show meters under maintenance",icon:"fa-wrench",color:"text-orange-600",bgColor:"bg-orange-100"}].map(e=>(0,ze.jsx)("button",{type:"button",onClick:()=>(e=>{i(e),a(e),n()})(e.value),className:"w-full text-left p-2 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 ".concat(e.bgColor," rounded-lg flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"fas ".concat(e.icon," ").concat(e.color)})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.value))})]})})})},Ma=()=>{var e;const t=ae(),{user:s,selectedCompany:a}=Be(),{selectedLocation:n,loading:l}=ya(),[i,o]=(0,r.useState)(null),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),[f,x]=(0,r.useState)(null),[p,h]=(0,r.useState)([]),[g,y]=(0,r.useState)(!0),[b,v]=(0,r.useState)(""),[j,w]=(0,r.useState)("All Types"),[N,k]=(0,r.useState)("All Status"),[S,C]=(0,r.useState)("grid"),[_,E]=(0,r.useState)(!1),[P,A]=(0,r.useState)(!1),[T,L]=(0,r.useState)({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null}),O=function(e,t){L({show:!0,type:arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info",title:e,message:t,onConfirm:()=>L({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null}),onCancel:null})},R=function(e,t,s){let a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null;L({show:!0,type:"confirm",title:e,message:t,onConfirm:()=>{L({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null}),s()},onCancel:a?()=>{L({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null}),a()}:()=>L({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null})})},F=()=>{L({show:!1,type:"info",title:"",message:"",onConfirm:null,onCancel:null})},D=null===a||void 0===a?void 0:a.id,M=async()=>{if(D){y(!0);try{let e="".concat(Ue,"/api/meters/?company_id=").concat(D);null!==n&&void 0!==n&&n.id&&"all"!==n.id?(e+="&site_id=".concat(n.id),console.log("Fetching meters for location: ".concat(n.name))):"all"===(null===n||void 0===n?void 0:n.id)&&console.log("\ud83c\udf10 Fetching meters for all locations");const t=await Ie(e),s=(await t.json()).results.map(e=>{const t=e.name&&e.name.trim().toLowerCase().startsWith("main");return{id:e.id,name:e.name,type:e.type,location:e.location_description||"To be configured",account_number:e.account_number||"",status:"active"===e.status?"Active":"Inactive",lastReading:"No readings yet",lastUpdate:new Date(e.created_at).toLocaleString(),dataPoints:["Primary Measurement"],frameworks:["Auto-assigned"],has_data:e.has_data,isAutoCreated:t}});h(s)}catch(e){console.error("Error fetching meters:",e)}finally{y(!1)}}else console.log("No company selected, skipping meters fetch")},U=async e=>{try{var t;console.log("\ud83d\udd0d CREATE METER - Starting meter creation"),console.log("\ud83d\udcca Company ID:",D),console.log("\ud83d\udcca Original meter data received:",e);const s={company:D,name:e.name,type:e.type,location_description:e.location,account_number:e.account_number,status:(null===(t=e.status)||void 0===t?void 0:t.toLowerCase())||"active",site_id:null!==n&&void 0!==n&&n.id&&"all"!==n.id?n.id:null};console.log("\ud83d\udce4 Request body being sent:",s);let a="".concat(Ue,"/api/meters/?company_id=").concat(D);null!==n&&void 0!==n&&n.id&&"all"!==n.id?(a+="&site_id=".concat(n.id),console.log("Creating meter for location: ".concat(n.name))):"all"===(null===n||void 0===n?void 0:n.id)&&console.log("\ud83c\udf10 Creating meter for company (no specific location)"),console.log("\ud83c\udf10 Request URL:",a);const r=await Ie(a,{method:"POST",body:JSON.stringify(s)});if(console.log("\ud83d\udce5 Response status:",r.status),console.log("\ud83d\udce5 Response ok:",r.ok),r.ok){const e=await r.json();return console.log("\u2705 Meter created successfully:",e),await M(),!0}try{const e=await r.json();console.error("\u274c Server error response:",e)}catch(rn){console.error("\u274c Could not parse error response")}return console.error("\u274c Response status:",r.status,r.statusText),!1}catch(s){return console.error("\ud83d\udca5 Network error creating meter:",s),console.error("\ud83d\udca5 Error details:",{message:s.message,stack:s.stack}),!1}},z=async(e,t)=>{try{var s;return!!(await Ie("".concat(Ue,"/api/meters/").concat(e,"/?company_id=").concat(D),{method:"PATCH",body:JSON.stringify({name:t.name,type:t.type,location_description:t.location,account_number:t.account_number,status:(null===(s=t.status)||void 0===s?void 0:s.toLowerCase())||"active"})})).ok&&(await M(),!0)}catch(a){return console.error("Error updating meter:",a),!1}};(0,r.useEffect)(()=>{D&&M()},[D,n]);const I=[{id:"total",name:"Total Meters",icon:"fas fa-gauge",color:"blue",count:p.length,description:"All configured meters"},{id:"electricity",name:"Electricity Meters",icon:"fas fa-bolt",color:"yellow",count:p.filter(e=>"Electricity Consumption"===e.type).length,description:"Electricity consumption monitoring"},{id:"water",name:"Water Meters",icon:"fas fa-tint",color:"blue",count:p.filter(e=>"Water Consumption"===e.type).length,description:"Water consumption and flow monitoring"},{id:"waste",name:"Waste Trackers",icon:"fas fa-trash-alt",color:"green",count:p.filter(e=>"Waste to Landfill"===e.type).length,description:"Waste generation and disposal monitoring"},{id:"generator",name:"Generator Meters",icon:"fas fa-gas-pump",color:"red",count:p.filter(e=>"Generator Fuel Consumption"===e.type).length,description:"Generator fuel consumption tracking"},{id:"vehicle",name:"Vehicle Trackers",icon:"fas fa-car",color:"purple",count:p.filter(e=>"Vehicle Fuel Consumption"===e.type).length,description:"Vehicle fuel consumption monitoring"},{id:"lpg",name:"LPG Meters",icon:"fas fa-fire",color:"orange",count:p.filter(e=>"LPG Usage"===e.type).length,description:"LPG consumption monitoring"},{id:"renewable",name:"Renewable Energy",icon:"fas fa-solar-panel",color:"teal",count:p.filter(e=>"Renewable Energy Usage"===e.type).length,description:"Renewable energy generation tracking"}],G=e=>{x(Me({},e)),m(!0)},B=async e=>{p.find(t=>t.id===e)&&await(async e=>{const t=p.find(t=>t.id===e);if(!t)return!1;const s="Active"===t.status?"Inactive":"Active",a="Inactive"===s?"deactivate":"activate";return new Promise(n=>{R("".concat(a.charAt(0).toUpperCase()+a.slice(1)," Meter"),"Are you sure you want to ".concat(a,' the meter "').concat(t.name,'" (').concat(t.type,")?"),async()=>{const r=await z(e,Me(Me({},t),{},{status:s}));r&&O("Success","Meter ".concat(a,"d successfully"),"success"),n(r)},()=>n(!1))})})(e)},W=async e=>{const t=p.find(t=>t.id===e);t?t.has_data?O("Cannot Delete",'Cannot delete meter "'.concat(t.name,'" because it has data entries. Please remove all data entries first, or deactivate the meter instead.'),"warning"):R("Delete Meter",'Are you sure you want to permanently delete the meter "'.concat(t.name,'" (').concat(t.type,")?\n\nThis action cannot be undone."),async()=>{try{const s=await Ie("".concat(Ue,"/api/meters/").concat(e,"/?company_id=").concat(D),{method:"DELETE"});if(s.ok)await M(),O("Success",'Meter "'.concat(t.name,'" has been deleted successfully.'),"success");else{const e=await s.json().catch(()=>({}));O("Delete Failed","Failed to delete meter: ".concat(e.error||e.detail||"Unknown error"),"error")}}catch(s){console.error("Error deleting meter:",s),O("Network Error","Network error occurred while deleting meter. Please try again.","error")}}):O("Error","Meter not found","error")},q=p.filter(e=>{const t=e.name.toLowerCase().includes(b.toLowerCase())||e.type.toLowerCase().includes(b.toLowerCase())||e.location.toLowerCase().includes(b.toLowerCase())||e.id.toLowerCase().includes(b.toLowerCase()),s="All Types"===j||e.type===j,a="All Status"===N||e.status===N;return t&&s&&a}),V=q.reduce((e,t)=>{const s=t.type;return e[s]||(e[s]=[]),e[s].push(t),e},{}),H=["Electricity Consumption","Water Consumption","Waste to Landfill","Generator Fuel Consumption","Vehicle Fuel Consumption","LPG Usage","Renewable Energy Usage"],Q=Object.keys(V).sort((e,t)=>{const s=H.indexOf(e),a=H.indexOf(t);return-1===s&&-1===a?e.localeCompare(t):-1===s?1:-1===a?-1:s-a}),$=[...new Set(p.map(e=>e.type))];if(!s||!["super_user","admin","site_manager","meter_manager","uploader","viewer"].includes(s.role))return(0,ze.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,ze.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,ze.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access meter management."}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});const J=["super_user","admin","site_manager","meter_manager"].includes(null===s||void 0===s?void 0:s.role),Y=["uploader","viewer"].includes(null===s||void 0===s?void 0:s.role);return g?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,ze.jsx)("div",{className:"flex items-center justify-center py-12",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"w-16 h-16 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-4",children:(0,ze.jsx)("i",{className:"fas fa-cog fa-spin text-blue-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Setting Up Your Meters"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Auto-creating meters based on your data requirements..."})]})})}):l?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-3 text-sm sm:text-base text-gray-600",children:"Loading location data..."})]})}):g?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-3 text-sm sm:text-base text-gray-600",children:"Loading meters..."})]})}):l||n?(0,ze.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[p.some(e=>e.isAutoCreated)&&(0,ze.jsx)("div",{className:"bg-blue-50 border border-blue-200 rounded-xl p-4 sm:p-6 mb-8",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-magic text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-blue-900",children:"Meters Auto-Created"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-blue-700",children:'Based on your checklist requirements, we\'ve automatically created default "Main" meters for all metered data elements. You can customize these or add additional meters as needed.'})]})]})}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:I.filter(e=>e.count>0).map(e=>(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-lg")})}),(0,ze.jsx)("span",{className:"text-2xl font-bold text-".concat(e.color,"-600"),children:e.count})]}),(0,ze.jsx)("h3",{className:"font-semibold text-gray-900 mb-2",children:e.name}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:e.description})]},e.id))}),(0,ze.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:(0,ze.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Meter Configuration"}),(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[Y&&(0,ze.jsxs)("div",{className:"px-4 py-2 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-2"}),"View Only Mode"]}),J?(0,ze.jsxs)("button",{className:"bg-gradient-to-r from-blue-600 to-purple-600 text-white px-6 py-2 rounded-lg font-medium hover:shadow-lg transition-all",onClick:()=>d(!0),children:[(0,ze.jsx)("i",{className:"fas fa-plus mr-2"}),"Add New Meter"]}):(0,ze.jsxs)("div",{className:"px-6 py-2 bg-gray-300 text-gray-600 rounded-lg font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-lock mr-2"}),"Read Only Access"]})]})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6 space-x-4",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-4 flex-1",children:[(0,ze.jsxs)("div",{className:"relative flex-1 max-w-md",children:[(0,ze.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,ze.jsx)("input",{type:"text",placeholder:"Search meters...",className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-transparent",value:b,onChange:e=>v(e.target.value)})]}),(0,ze.jsxs)("button",{onClick:()=>E(!0),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-filter"}),(0,ze.jsx)("span",{children:j}),(0,ze.jsx)("i",{className:"fas fa-chevron-down ml-1"})]}),(0,ze.jsxs)("button",{onClick:()=>A(!0),className:"flex items-center space-x-2 px-3 py-2 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-circle"}),(0,ze.jsx)("span",{children:N}),(0,ze.jsx)("i",{className:"fas fa-chevron-down ml-1"})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("button",{className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 ".concat("list"===S?"bg-blue-50 border-blue-200":""),onClick:()=>C("list"),children:(0,ze.jsx)("i",{className:"fas fa-list ".concat("list"===S?"text-blue-600":"text-gray-600")})}),(0,ze.jsx)("button",{className:"p-2 border border-gray-300 rounded-lg hover:bg-gray-50 ".concat("grid"===S?"bg-blue-50 border-blue-200":""),onClick:()=>C("grid"),children:(0,ze.jsx)("i",{className:"fas fa-th-large ".concat("grid"===S?"text-blue-600":"text-gray-600")})})]})]}),"grid"===S?(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:Q.map(e=>(0,ze.jsxs)("div",{className:"category-column",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ze.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat("Electricity Consumption"===e?"bg-yellow-100":"Water Consumption"===e?"bg-cyan-100":"Waste to Landfill"===e?"bg-green-100":"Generator Fuel Consumption"===e?"bg-red-100":"Vehicle Fuel Consumption"===e?"bg-purple-100":"LPG Usage"===e?"bg-orange-100":"Renewable Energy Usage"===e?"bg-teal-100":"bg-gray-100"),children:(0,ze.jsx)("i",{className:"".concat("Electricity Consumption"===e?"fas fa-bolt text-yellow-600":"Water Consumption"===e?"fas fa-tint text-cyan-600":"Waste to Landfill"===e?"fas fa-trash-alt text-green-600":"Generator Fuel Consumption"===e?"fas fa-gas-pump text-red-600":"Vehicle Fuel Consumption"===e?"fas fa-car text-purple-600":"LPG Usage"===e?"fas fa-fire text-orange-600":"Renewable Energy Usage"===e?"fas fa-solar-panel text-teal-600":"fas fa-gauge text-gray-600")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"text-lg font-semibold text-gray-900",children:e}),(0,ze.jsxs)("p",{className:"text-sm text-gray-500",children:[V[e].length," meter",1!==V[e].length?"s":""]})]})]}),(0,ze.jsx)("div",{className:"space-y-4",children:V[e].map(e=>(0,ze.jsxs)("div",{className:"meter-card bg-gray-50 rounded-lg p-6 border border-gray-200 hover:shadow-md transition-all",children:[(0,ze.jsxs)("div",{className:"flex items-start justify-between mb-4",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center ".concat("Electricity Consumption"===e.type?"bg-yellow-100":"Water Consumption"===e.type?"bg-cyan-100":"Waste to Landfill"===e.type?"bg-green-100":"Generator Fuel Consumption"===e.type?"bg-red-100":"Vehicle Fuel Consumption"===e.type?"bg-purple-100":"LPG Usage"===e.type?"bg-orange-100":"Renewable Energy Usage"===e.type?"bg-teal-100":"bg-gray-100"),children:(0,ze.jsx)("i",{className:"".concat("Electricity Consumption"===e.type?"fas fa-bolt text-yellow-600":"Water Consumption"===e.type?"fas fa-tint text-cyan-600":"Waste to Landfill"===e.type?"fas fa-trash-alt text-green-600":"Generator Fuel Consumption"===e.type?"fas fa-gas-pump text-red-600":"Vehicle Fuel Consumption"===e.type?"fas fa-car text-purple-600":"LPG Usage"===e.type?"fas fa-fire text-orange-600":"Renewable Energy Usage"===e.type?"fas fa-solar-panel text-teal-600":"fas fa-gauge text-gray-600")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{className:"font-semibold text-gray-900 flex items-center",children:[e.name,e.isAutoCreated&&(0,ze.jsx)("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Auto"})]}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:e.type})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("Active"===e.status?"bg-green-500":"Inactive"===e.status?"bg-red-500":"Warning"===e.status?"bg-yellow-500":"Maintenance"===e.status?"bg-orange-500":"bg-gray-500")}),(0,ze.jsx)("span",{className:"text-sm font-medium ".concat("Active"===e.status?"text-green-600":"Inactive"===e.status?"text-red-600":"Warning"===e.status?"text-yellow-600":"Maintenance"===e.status?"text-orange-600":"text-gray-600"),children:e.status})]})]}),(0,ze.jsxs)("div",{className:"space-y-2 mb-4",children:[(0,ze.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,ze.jsx)("span",{className:"text-gray-500",children:"Account #:"}),(0,ze.jsx)("span",{className:"text-gray-900",children:e.id})]}),(0,ze.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,ze.jsx)("span",{className:"text-gray-500",children:"Location:"}),(0,ze.jsx)("span",{className:"text-gray-900",children:e.location})]}),(0,ze.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,ze.jsx)("span",{className:"text-gray-500",children:"Last Reading:"}),(0,ze.jsx)("span",{className:"text-gray-900",children:new Date(e.lastUpdate).toLocaleDateString()})]}),(0,ze.jsxs)("div",{className:"flex justify-between text-sm",children:[(0,ze.jsx)("span",{className:"text-gray-500",children:"Source:"}),(0,ze.jsx)("span",{className:"text-gray-900",children:e.isAutoCreated?"System":"Manual"})]})]}),(0,ze.jsx)("div",{className:"flex space-x-2",children:J?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)("button",{className:"flex-1 bg-blue-600 text-white py-2 px-3 rounded-lg text-sm font-medium hover:bg-blue-700",onClick:()=>G(e),children:[(0,ze.jsx)("i",{className:"fas fa-edit mr-1"}),"Edit"]}),(0,ze.jsx)("button",{type:"button",className:"py-2 px-3 rounded-lg text-sm ".concat("Active"===e.status?"bg-red-100 text-red-600 hover:bg-red-200":"bg-green-100 text-green-600 hover:bg-green-200"),onClick:t=>{t.preventDefault(),t.stopPropagation(),B(e.id)},title:"Active"===e.status?"Deactivate Meter":"Activate Meter",children:(0,ze.jsx)("i",{className:"fas ".concat("Active"===e.status?"fa-power-off":"fa-play")})}),(0,ze.jsx)("button",{type:"button",className:"py-2 px-3 rounded-lg text-sm bg-red-100 text-red-600 hover:bg-red-200",onClick:t=>{t.preventDefault(),t.stopPropagation(),W(e.id)},title:"Delete Meter",children:(0,ze.jsx)("i",{className:"fas fa-trash"})})]}):(0,ze.jsxs)("div",{className:"flex-1 bg-gray-100 text-gray-500 py-2 px-3 rounded-lg text-sm font-medium text-center",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only"]})})]},e.id))})]},e))}):(0,ze.jsx)("div",{className:"space-y-6",children:Q.map(e=>(0,ze.jsxs)("div",{className:"category-section",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center ".concat("Electricity Consumption"===e?"bg-yellow-100":"Water Consumption"===e?"bg-cyan-100":"Waste to Landfill"===e?"bg-green-100":"Generator Fuel Consumption"===e?"bg-red-100":"Vehicle Fuel Consumption"===e?"bg-purple-100":"LPG Usage"===e?"bg-orange-100":"Renewable Energy Usage"===e?"bg-teal-100":"bg-gray-100"),children:(0,ze.jsx)("i",{className:"".concat("Electricity Consumption"===e?"fas fa-bolt text-yellow-600":"Water Consumption"===e?"fas fa-tint text-cyan-600":"Waste to Landfill"===e?"fas fa-trash-alt text-green-600":"Generator Fuel Consumption"===e?"fas fa-gas-pump text-red-600":"Vehicle Fuel Consumption"===e?"fas fa-car text-purple-600":"LPG Usage"===e?"fas fa-fire text-orange-600":"Renewable Energy Usage"===e?"fas fa-solar-panel text-teal-600":"fas fa-gauge text-gray-600"," text-sm")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"text-md font-semibold text-gray-900",children:e}),(0,ze.jsxs)("p",{className:"text-xs text-gray-500",children:[V[e].length," meter",1!==V[e].length?"s":""]})]})]}),(0,ze.jsx)("div",{className:"overflow-x-auto",children:(0,ze.jsxs)("table",{className:"w-full",children:[(0,ze.jsx)("thead",{className:"bg-gray-50",children:(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Device"}),(0,ze.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),(0,ze.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,ze.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Account #"}),(0,ze.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Source"}),(0,ze.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,ze.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:V[e].map(e=>(0,ze.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,ze.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center ".concat("Electricity Consumption"===e.type?"bg-yellow-100":"Water Consumption"===e.type?"bg-cyan-100":"Waste to Landfill"===e.type?"bg-green-100":"Generator Fuel Consumption"===e.type?"bg-red-100":"Vehicle Fuel Consumption"===e.type?"bg-purple-100":"LPG Usage"===e.type?"bg-orange-100":"Renewable Energy Usage"===e.type?"bg-teal-100":"bg-gray-100"),children:(0,ze.jsx)("i",{className:"".concat("Electricity Consumption"===e.type?"fas fa-bolt text-yellow-600":"Water Consumption"===e.type?"fas fa-tint text-cyan-600":"Waste to Landfill"===e.type?"fas fa-trash-alt text-green-600":"Generator Fuel Consumption"===e.type?"fas fa-gas-pump text-red-600":"Vehicle Fuel Consumption"===e.type?"fas fa-car text-purple-600":"LPG Usage"===e.type?"fas fa-fire text-orange-600":"Renewable Energy Usage"===e.type?"fas fa-solar-panel text-teal-600":"fas fa-gauge text-gray-600"," text-sm")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{className:"text-sm font-medium text-gray-900 flex items-center",children:[e.name,e.isAutoCreated&&(0,ze.jsx)("span",{className:"ml-2 px-2 py-1 bg-blue-100 text-blue-800 text-xs rounded-full",children:"Auto"})]}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:e.id})]})]})}),(0,ze.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.location}),(0,ze.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("div",{className:"w-3 h-3 rounded-full ".concat("Active"===e.status?"bg-green-500":"Inactive"===e.status?"bg-red-500":"Warning"===e.status?"bg-yellow-500":"Maintenance"===e.status?"bg-orange-500":"bg-gray-500")}),(0,ze.jsx)("span",{className:"text-sm font-medium ".concat("Active"===e.status?"text-green-600":"Inactive"===e.status?"text-red-600":"Warning"===e.status?"text-yellow-600":"Maintenance"===e.status?"text-orange-600":"text-gray-600"),children:e.status})]})}),(0,ze.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:e.account_number||e.id}),(0,ze.jsx)("td",{className:"px-6 py-4 whitespace-nowrap",children:(0,ze.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat(e.isAutoCreated?"bg-green-100 text-green-800":"bg-purple-100 text-purple-800"),children:e.isAutoCreated?"System":"Manual"})}),(0,ze.jsx)("td",{className:"px-6 py-4 whitespace-nowrap text-sm font-medium",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("button",{className:"text-blue-600 hover:text-blue-900",onClick:()=>G(e),children:(0,ze.jsx)("i",{className:"fas fa-edit"})}),(0,ze.jsx)("button",{type:"button",className:"".concat("Active"===e.status?"text-red-600 hover:text-red-900":"text-green-600 hover:text-green-900"),onClick:t=>{t.preventDefault(),t.stopPropagation(),B(e.id)},title:"Active"===e.status?"Deactivate Meter":"Activate Meter",children:(0,ze.jsx)("i",{className:"fas ".concat("Active"===e.status?"fa-power-off":"fa-play")})}),(0,ze.jsx)("button",{type:"button",className:"text-red-600 hover:text-red-900",onClick:t=>{t.preventDefault(),t.stopPropagation(),W(e.id)},title:"Delete Meter",children:(0,ze.jsx)("i",{className:"fas fa-trash"})})]})})]},e.id))})]})})]},e))}),0===q.length&&(0,ze.jsxs)("div",{className:"text-center py-12",children:[(0,ze.jsx)("i",{className:"fas fa-search text-gray-400 text-4xl mb-4"}),(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No meters found"}),(0,ze.jsx)("p",{className:"text-gray-600",children:b||"All Types"!==j||"All Status"!==N?"Try adjusting your search or filters":"No meters have been configured yet"})]})]})}),i&&(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,ze.jsx)("div",{className:"bg-white rounded-md p-5 border w-96 shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-3",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:i.name}),(0,ze.jsx)("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>o(null),children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Device ID"}),(0,ze.jsx)("p",{className:"text-sm text-gray-900",children:i.id})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Type"}),(0,ze.jsx)("p",{className:"text-sm text-gray-900",children:i.type})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Location"}),(0,ze.jsx)("p",{className:"text-sm text-gray-900",children:i.location})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Source"}),(0,ze.jsx)("p",{className:"text-sm text-gray-900",children:i.isAutoCreated?"Auto-created from checklist requirements":"Manually added by user"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Data Points"}),(0,ze.jsx)("div",{className:"flex flex-wrap gap-1 mt-1",children:i.dataPoints.map((e,t)=>(0,ze.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium bg-gray-100 text-gray-800",children:e},t))})]})]}),(0,ze.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,ze.jsx)("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:()=>o(null),children:"Close"}),(0,ze.jsx)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700",children:"Configure"})]})]})})}),c&&(0,ze.jsx)(Ra,{isOpen:c,title:"Add New Meter",meter:null,meterTypes:I,onSave:async e=>{await U(e)?d(!1):O("Creation Failed","Failed to create meter. Please try again.","error")},onClose:()=>d(!1)}),u&&(0,ze.jsx)(Ra,{isOpen:u,title:null!==f&&void 0!==f&&null!==(e=f.name)&&void 0!==e&&e.includes("Copy")?"Add Copied Meter":"Edit Meter",meter:f,meterTypes:I,onSave:async e=>{if("string"===typeof e.id&&e.id.startsWith("USER-")&&!p.find(t=>t.id===e.id)){if(!await U(e))return void O("Creation Failed","Failed to create meter. Please try again.","error")}else{if(!await z(e.id,e))return void O("Update Failed","Failed to update meter. Please try again.","error")}m(!1),x(null)},onClose:()=>{m(!1),x(null)}}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-4",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-tools text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Installation Guide"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Steps to set up new meters and sensors"})]})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:[(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,ze.jsx)("span",{className:"text-blue-600 font-bold",children:"1"})}),(0,ze.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Review Requirements"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Check auto-created meters match your needs"})]}),(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,ze.jsx)("span",{className:"text-blue-600 font-bold",children:"2"})}),(0,ze.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Configure Details"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Add location and account information"})]}),(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,ze.jsx)("span",{className:"text-blue-600 font-bold",children:"3"})}),(0,ze.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Install Device"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Follow manufacturer guidelines for installation"})]}),(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-blue-100 rounded-full flex items-center justify-center mx-auto mb-3",children:(0,ze.jsx)("span",{className:"text-blue-600 font-bold",children:"4"})}),(0,ze.jsx)("h4",{className:"font-medium text-gray-900 mb-2",children:"Test & Monitor"}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Verify readings and establish baselines"})]})]})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsx)("div",{className:"flex items-center space-x-4",children:(0,ze.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>t("/list"),children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]})}),(0,ze.jsx)("div",{className:"flex space-x-4",children:(0,ze.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:()=>{t("/data")},children:["Save & Continue",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})})]}),_&&(0,ze.jsx)(Fa,{isOpen:_,currentFilter:j,uniqueTypes:$,onApply:e=>{w(e),E(!1)},onClose:()=>E(!1)}),P&&(0,ze.jsx)(Da,{isOpen:P,currentFilter:N,onApply:e=>{k(e),A(!1)},onClose:()=>A(!1)}),T.show&&(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,ze.jsx)("div",{className:"bg-white rounded-md p-5 border w-96 shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-3",children:[(0,ze.jsx)("div",{className:"flex items-center justify-between mb-4",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 rounded-full flex items-center justify-center ".concat("success"===T.type?"bg-green-100":"error"===T.type?"bg-red-100":"warning"===T.type?"bg-yellow-100":(T.type,"bg-blue-100")),children:(0,ze.jsx)("i",{className:"fas ".concat("success"===T.type?"fa-check text-green-600":"error"===T.type?"fa-times text-red-600":"warning"===T.type?"fa-exclamation-triangle text-yellow-600":"confirm"===T.type?"fa-question text-blue-600":"fa-info text-blue-600")})}),(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:T.title})]})}),(0,ze.jsx)("p",{className:"text-gray-600 mb-6 whitespace-pre-line",children:T.message}),(0,ze.jsx)("div",{className:"flex justify-end space-x-3",children:"confirm"===T.type?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:T.onCancel||F,children:"Cancel"}),(0,ze.jsx)("button",{className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700",onClick:T.onConfirm,children:"Confirm"})]}):(0,ze.jsx)("button",{className:"px-4 py-2 text-white rounded-md hover:opacity-90 ".concat("success"===T.type?"bg-green-600":"error"===T.type?"bg-red-600":"warning"===T.type?"bg-yellow-600":"bg-blue-600"),onClick:T.onConfirm||F,children:"OK"})})]})})})]}):(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6 text-center",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-4xl text-yellow-600 mb-4"}),(0,ze.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Location Selected"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"Please select a location to manage meters."}),(0,ze.jsxs)("button",{onClick:()=>t("/location"),className:"px-6 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Go to Location Selection"]})]})})},Ua=e=>{let{isOpen:t,currentFilter:s,onApply:a,onClose:n}=e;if(!t)return null;return(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,ze.jsx)("div",{className:"bg-white rounded-lg p-4 sm:p-6 border w-full max-w-sm sm:max-w-md shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-1",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-medium text-gray-900",children:"View Filter"}),(0,ze.jsx)("button",{type:"button",onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsx)("div",{className:"space-y-2",children:[{value:"All Items",label:"All Items",description:"Show all data items",icon:"fa-th",color:"text-blue-600",bgColor:"bg-blue-100"},{value:"Metered",label:"Metered",description:"Show metered items only",icon:"fa-tachometer-alt",color:"text-green-600",bgColor:"bg-green-100"},{value:"Non-metered",label:"Non-metered",description:"Show non-metered items only",icon:"fa-file-alt",color:"text-orange-600",bgColor:"bg-orange-100"}].map(e=>(0,ze.jsx)("button",{type:"button",onClick:()=>(e=>{a(e),n()})(e.value),className:"w-full text-left p-2 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 ".concat(e.bgColor," rounded-lg flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"fas ".concat(e.icon," ").concat(e.color)})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.value))})]})})})},za=e=>{let{isOpen:t,currentFilter:s,onApply:a,onClose:n,selectedLocation:r}=e;if(!t)return null;const l=[{value:"Category",label:"Category",description:"Group by data categories",icon:"fa-folder",color:"text-purple-600",bgColor:"bg-purple-100"},{value:"Frequency",label:"Frequency",description:"Group by reporting frequency",icon:"fa-clock",color:"text-blue-600",bgColor:"bg-blue-100"},{value:"Status",label:"Status",description:"Group by completion status",icon:"fa-check-circle",color:"text-green-600",bgColor:"bg-green-100"},..."all"===(null===r||void 0===r?void 0:r.id)?[{value:"Site",label:"Site",description:"Group by location/site",icon:"fa-map-marker-alt",color:"text-orange-600",bgColor:"bg-orange-100"}]:[]];return(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,ze.jsx)("div",{className:"bg-white rounded-lg p-4 sm:p-6 border w-full max-w-sm sm:max-w-md shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-1",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Group By"}),(0,ze.jsx)("button",{type:"button",onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsx)("div",{className:"space-y-2",children:l.map(e=>(0,ze.jsx)("button",{type:"button",onClick:()=>(e=>{a(e),n()})(e.value),className:"w-full text-left p-2 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 ".concat(e.bgColor," rounded-lg flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"fas ".concat(e.icon," ").concat(e.color)})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.value))})]})})})},Ia=e=>{let{isOpen:t,currentFilter:s,onApply:a,onClose:n}=e;if(!t)return null;return(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[100000]",children:(0,ze.jsx)("div",{className:"bg-white rounded-lg p-4 sm:p-6 border w-full max-w-sm sm:max-w-md shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-1",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-3",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Assignment Filter"}),(0,ze.jsx)("button",{type:"button",onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsx)("div",{className:"space-y-2",children:[{value:"all",label:"All Tasks",description:"Show all tasks",icon:"fa-list",color:"text-blue-600",bgColor:"bg-blue-100"},{value:"assigned",label:"Assigned",description:"Show assigned tasks only",icon:"fa-user-check",color:"text-green-600",bgColor:"bg-green-100"},{value:"unassigned",label:"Unassigned",description:"Show unassigned tasks only",icon:"fa-user-times",color:"text-red-600",bgColor:"bg-red-100"}].map(e=>(0,ze.jsx)("button",{type:"button",onClick:()=>(e=>{a(e),n()})(e.value),className:"w-full text-left p-2 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 ".concat(e.bgColor," rounded-lg flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"fas ".concat(e.icon," ").concat(e.color)})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.value))})]})})})},Ga=()=>{var e;const t=ae(),{user:s,selectedCompany:a}=(te(),Be()),{selectedLocation:n,loading:l}=ya(),[i,c]=(0,r.useState)(2025),[d,u]=(0,r.useState)((new Date).getMonth()+1),[m,f]=(0,r.useState)(""),[x,p]=(0,r.useState)("All"),[h,g]=(0,r.useState)("Category"),[y,b]=(0,r.useState)({}),[v,j]=(0,r.useState)({}),[w,N]=(0,r.useState)({}),[k,S]=(0,r.useState)({}),[C,_]=(0,r.useState)(!0),[E,P]=(0,r.useState)([]),[A,T]=(0,r.useState)([]),[L,O]=(0,r.useState)([]),[R,F]=(0,r.useState)(!1),[D,M]=(0,r.useState)(null),[U,z]=(0,r.useState)(!1),[I,G]=(0,r.useState)(null),[B,W]=(0,r.useState)([]),[q,V]=(0,r.useState)(!1),[H,Q]=(0,r.useState)("all"),[$,J]=(0,r.useState)(!1),[Y,K]=(0,r.useState)(!1),[X,Z]=(0,r.useState)(!1),[ee,se]=(0,r.useState)({annual:{data_progress:0,evidence_progress:0,overall_progress:0,total_points:0,completed_points:0,data_complete:0,evidence_complete:0},monthly:{data_progress:0,evidence_progress:0,overall_progress:0,items_remaining:0,completed_points:0,total_points:0}}),ne=null===a||void 0===a?void 0:a.id,re=(e,t)=>{const s=e.toLowerCase().replace(/[^a-z0-9]/g,""),a=t.filter(e=>{const t=e.name.toLowerCase().replace(/[^a-z0-9]/g,""),a=e.meter_type?e.meter_type.toLowerCase().replace(/[^a-z0-9]/g,""):"",n=t.split(/\s+/).filter(e=>e.length>2),r=a.split(/\s+/).filter(e=>e.length>2),l=n.some(e=>s.includes(e)),i=r.some(e=>s.includes(e));return l||i});return a.length>0?a[0]:null},le=async e=>{try{const t=await Ie("".concat(Ue,"/api/data-collection/available_months/?year=").concat(e));return(await t.json()).months||[]}catch(t){return console.error("Error fetching available months:",t),[]}},ie=async(e,t)=>{try{let s="".concat(Ue,"/api/data-collection/tasks/?company_id=").concat(ne,"&year=").concat(e,"&month=").concat(t);null!==n&&void 0!==n&&n.id&&"all"!==n.id?s+="&site_id=".concat(n.id):null===n||void 0===n||n.id;const a=await Ie(s);return await a.json()||[]}catch(s){return console.error("Error fetching data entries:",s),[]}},oe=async function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:null;try{let s="".concat(Ue,"/api/data-collection/progress/?company_id=").concat(ne,"&year=").concat(e);t&&(s+="&month=".concat(t)),null!==n&&void 0!==n&&n.id&&"all"!==(null===n||void 0===n?void 0:n.id)&&(s+="&site_id=".concat(n.id));const a=await Ie(s);return await a.json()}catch(s){return console.error("Error fetching progress:",s),{data_progress:0,evidence_progress:0}}},ce=async function(e,t){let s=arguments.length>2&&void 0!==arguments[2]?arguments[2]:null;try{const a=new FormData;t&&a.append("value",t),s&&a.append("evidence_file",s);return(await Ie("".concat(Ue,"/api/data-collection/").concat(e,"/"),{method:"PATCH",body:a})).ok}catch(a){return console.error("Error saving data entry:",a),!1}},de=async(e,t,s,a)=>await Promise.all(["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"].map(async(n,r)=>{const l=r+1;let i="upcoming";if(l===a)i="selected";else if(l<s)if(e.includes(l))try{const e=await oe(t,l);i=0===e.items_remaining?"complete":"incomplete"}catch(o){i="incomplete"}else i="upcoming";else l===s?i="current":l>11&&(i="disabled");return{id:l,name:n,status:i,available:e.includes(l)}})),ue=e=>{switch(e.status){case"complete":return"bg-green-100 border border-green-300 text-green-700";case"selected":return"bg-blue-100 border-2 border-blue-500 text-blue-700";case"current":return"bg-blue-50 border border-blue-300 text-blue-600";case"incomplete":return"bg-orange-100 border border-orange-300 text-orange-700";case"upcoming":default:return"bg-gray-100 border border-gray-300 text-gray-700";case"disabled":return"bg-gray-200 border border-gray-400 text-gray-500 opacity-50 cursor-not-allowed"}},me=e=>{switch(e){case"complete":return"w-3 h-3 bg-green-500 rounded-full";case"partial":return"w-3 h-3 bg-orange-500 rounded-full";case"missing":return"w-3 h-3 bg-red-500 rounded-full";default:return"w-3 h-3 bg-gray-500 rounded-full"}};(0,r.useEffect)(()=>{(async()=>{if(ne&&n){_(!0);try{const e=await le(i),t=new Date,s=await de(e,i,t.getMonth()+1,d);P(s);const a=await oe(i),r=await oe(i,d);se({annual:{data_progress:a.data_progress||0,evidence_progress:a.evidence_progress||0,overall_progress:a.overall_progress||0,total_points:a.total_points||0,completed_points:a.completed_points||0,data_complete:a.data_complete||0,evidence_complete:a.evidence_complete||0},monthly:{data_progress:r.data_progress||0,evidence_progress:r.evidence_progress||0,overall_progress:r.overall_progress||0,items_remaining:r.items_remaining||0,completed_points:r.completed_points||0,total_points:r.total_points||0}});const l=await ie(i,d);let o=[];if("all"===(null===n||void 0===n?void 0:n.id)&&Array.isArray(l)&&l.length>0&&l[0].site)for(const n of l)for(const e of n.tasks)o.push({id:e.submission.id,name:e.element_name,meter:e.meter?"".concat(e.meter.name," (").concat(e.meter.type,")"):"N/A",meter_id:e.meter?e.meter.id:null,meter_type:e.meter?e.meter.type:null,meter_location:e.meter?e.meter.location:null,frequency:e.cadence,value:e.submission.value||"",unit:e.element_unit||"",status:e.submission.status||"missing",category:e.type,description:e.element_description||"",evidence_file:e.submission.evidence_file||null,site_name:n.site.name,site_id:n.site.id,assignedTo:e.submission.assigned_to?"".concat(e.submission.assigned_to.first_name||""," ").concat(e.submission.assigned_to.last_name||"").trim()||e.submission.assigned_to.username||e.submission.assigned_to.email:null,assignedUserId:e.submission.assigned_to?e.submission.assigned_to.id:null,assignedAt:e.submission.assigned_at||null});else o=l.map(e=>({id:e.submission.id,name:e.element_name,meter:e.meter?"".concat(e.meter.name," (").concat(e.meter.type,")"):"N/A",meter_id:e.meter?e.meter.id:null,meter_type:e.meter?e.meter.type:null,meter_location:e.meter?e.meter.location:null,frequency:e.cadence,value:e.submission.value||"",unit:e.element_unit||"",status:e.submission.status||"missing",category:e.type,description:e.element_description||"",evidence_file:e.submission.evidence_file||null,assignedTo:e.submission.assigned_to?"".concat(e.submission.assigned_to.first_name||""," ").concat(e.submission.assigned_to.last_name||"").trim()||e.submission.assigned_to.username||e.submission.assigned_to.email:null,assignedUserId:e.submission.assigned_to?e.submission.assigned_to.id:null,assignedAt:e.submission.assigned_at||null}));T(o)}catch(e){console.error("Error loading initial data:",e)}finally{_(!1)}}})()},[i,d,ne,n]),(0,r.useEffect)(()=>{"all"===(null===n||void 0===n?void 0:n.id)&&"Site"!==h?g("Site"):"all"!==(null===n||void 0===n?void 0:n.id)&&"Site"===h&&g("Category")},[null===n||void 0===n?void 0:n.id]),(0,r.useEffect)(()=>{let e=he(A);ve&&(e=e.filter(e=>e.assignedUserId===(null===s||void 0===s?void 0:s.id))),"assigned"===H?e=e.filter(e=>e.assignedTo):"unassigned"===H&&(e=e.filter(e=>!e.assignedTo)),O(e)},[m,x,h,A,H]);const fe=async()=>{if(ne)try{const[e,t,s]=await Promise.all([ie(i,d),oe(i),oe(i,d)]);let a=t,n=s;if(we){const r=pe(e);a=Me(Me({},t),r),n=Me(Me(Me({},s),r),{},{items_remaining:Math.max(0,r.total_points-r.completed_points)})}se({annual:a,monthly:n});const r=e.map(e=>{const t=e.submission.assigned_to;let s=null;if(t){const e=t.first_name||"",a=t.last_name||"";s="".concat(e," ").concat(a).trim()||t.username||t.email}return{id:e.submission.id,name:e.element_name,meter:e.meter?"".concat(e.meter.name," (").concat(e.meter.type,")"):"N/A",meter_id:e.meter?e.meter.id:null,meter_type:e.meter?e.meter.type:null,meter_location:e.meter?e.meter.location:null,frequency:e.cadence,value:e.submission.value||"",unit:e.element_unit||"",status:e.submission.status||"missing",category:e.type,description:e.element_description||"",evidence_file:e.submission.evidence_file||null,assignedTo:s,assignedUserId:t?t.id:null,assignedAt:e.submission.assigned_at||null}});T(r)}catch(e){console.error("\u274c Error refreshing data entries:",e)}},xe=async(e,t,s)=>{if(!w[e])if(t||s){N(t=>Me(Me({},t),{},{[e]:!0}));try{if(await ce(e,t,s)){if(s){const s=await Ie("".concat(Ue,"/api/data-collection/").concat(e,"/"));if(s.ok){const a=await s.json();T(s=>s.map(s=>s.id===e?Me(Me({},s),{},{status:(t||s.value)&&a.evidence_file?"complete":"partial",value:t||s.value,evidence_file:a.evidence_file}):s))}}else T(s=>s.map(s=>s.id===e?Me(Me({},s),{},{status:t&&s.evidence_file?"complete":"partial",value:t||s.value}):s));b(t=>{const s=Me({},t);return delete s[e],s}),j(t=>{const s=Me({},t);return delete s[e],s}),await ge()}}catch(a){console.error("Auto-save error:",a)}finally{N(t=>Me(Me({},t),{},{[e]:!1}))}}else{N(t=>Me(Me({},t),{},{[e]:!0}));try{await ce(e,"",null)&&(T(t=>t.map(t=>t.id===e?Me(Me({},t),{},{status:"missing",value:""}):t)),await ge())}catch(a){console.error("Error clearing entry:",a)}finally{N(t=>Me(Me({},t),{},{[e]:!1}))}}},pe=e=>{const t=e.filter(e=>null!==e.meter_id),s=t.length;if(0===s)return{data_progress:0,evidence_progress:0,overall_progress:0,completed_points:0,total_points:0,data_complete:0,evidence_complete:0};const a=t.filter(e=>null!==e.value&&""!==e.value).length,n=t.filter(e=>e.evidence_file).length;return{data_progress:a/s*100,evidence_progress:n/s*100,overall_progress:(a+n)/(2*s)*100,completed_points:a+n,total_points:2*s,data_complete:a,evidence_complete:n}},he=e=>{let t=[...e];return we&&(t=t.filter(e=>null!==e.meter_id)),m.trim()&&(t=t.filter(e=>e.name.toLowerCase().includes(m.toLowerCase())||e.meter.toLowerCase().includes(m.toLowerCase())||e.category.toLowerCase().includes(m.toLowerCase()))),"Metered"===x?t=t.filter(e=>null!==e.meter_id):"Non-metered"===x?t=t.filter(e=>null===e.meter_id):"Missing"===x?t=t.filter(e=>"missing"===e.status):"Partial"===x?t=t.filter(e=>"partial"===e.status):"Complete"===x&&(t=t.filter(e=>"complete"===e.status)),t},ge=async()=>{try{const e=await oe(i),t=await oe(i,d);let s={data_progress:e.data_progress||0,evidence_progress:e.evidence_progress||0,overall_progress:e.overall_progress||0,total_points:e.total_points||0,completed_points:e.completed_points||0,data_complete:e.data_complete||0,evidence_complete:e.evidence_complete||0},a={data_progress:t.data_progress||0,evidence_progress:t.evidence_progress||0,overall_progress:t.overall_progress||0,items_remaining:t.items_remaining||0,completed_points:t.completed_points||0,total_points:t.total_points||0};if(we&&L.length>0){const e=pe(L);s=Me(Me({},s),e),a=Me(Me(Me({},a),e),{},{items_remaining:Math.max(0,e.total_points-e.completed_points)})}se({annual:s,monthly:a});const n=await le(i),r=new Date,l=await de(n,i,r.getMonth()+1,d);P(l)}catch(e){console.error("Error refreshing progress data:",e)}};if(!s||!["super_user","admin","site_manager","uploader","viewer","meter_manager"].includes(s.role))return(0,ze.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,ze.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,ze.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access data collection."}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});const ye=["super_user","admin"].includes(null===s||void 0===s?void 0:s.role),be=["site_manager"].includes(null===s||void 0===s?void 0:s.role),ve=["uploader"].includes(null===s||void 0===s?void 0:s.role),je=["viewer"].includes(null===s||void 0===s?void 0:s.role),we=["meter_manager"].includes(null===s||void 0===s?void 0:s.role),Ne=["super_user"].includes(null===s||void 0===s?void 0:s.role),ke=["admin"].includes(null===s||void 0===s?void 0:s.role),Se=["site_manager"].includes(null===s||void 0===s?void 0:s.role),Ce=(["uploader","viewer","meter_manager"].includes(null===s||void 0===s?void 0:s.role),e=>{G(e),z(!0),(async()=>{if(ne&&s){V(!0);try{const e=await Ie("".concat(Ue,"/api/users/"));if(e.ok){let t=(await e.json()).filter(e=>"viewer"!==e.role);Ne?t=t.filter(e=>["admin","site_manager","uploader","meter_manager"].includes(e.role)):ke?t=t.filter(e=>["site_manager","uploader","meter_manager"].includes(e.role)):Se&&(t=t.filter(e=>["uploader","meter_manager"].includes(e.role))),W(t)}else console.error("Failed to fetch available users, status:",e.status)}catch(e){console.error("Error fetching available users:",e)}finally{V(!1)}}})()});return C?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto",children:(0,ze.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading data collection interface..."})]})}):l?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-3 text-sm sm:text-base text-gray-600",children:"Loading location data..."})]})}):C?(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-center py-12",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-3 text-sm sm:text-base text-gray-600",children:"Loading data entries..."})]})}):l||n?(0,ze.jsxs)("div",{className:"max-w-6xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200 mb-8",children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-semibold text-gray-900 mb-4 sm:mb-6",children:"Reporting Period"}),(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center space-y-4 sm:space-y-0 sm:space-x-6",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Year"}),(0,ze.jsxs)("select",{className:"border border-gray-300 rounded-lg px-4 py-2 w-full sm:w-32",value:i,onChange:e=>c(parseInt(e.target.value)),children:[(0,ze.jsx)("option",{value:2025,children:"2025"}),(0,ze.jsx)("option",{value:2024,children:"2024"}),(0,ze.jsx)("option",{value:2023,children:"2023"}),(0,ze.jsx)("option",{value:2022,children:"2022"})]})]}),(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Month"}),(0,ze.jsx)("div",{className:"grid grid-cols-3 sm:grid-cols-6 gap-2",children:E.map(e=>(0,ze.jsx)("button",{className:"px-3 py-2 rounded-lg text-sm font-medium ".concat(ue(e)),onClick:()=>"disabled"!==e.status&&(async e=>{if(e!==d){_(!0),console.log("\ud83d\udcc5 Month selection: Switching from ".concat(d," to ").concat(e));try{const t=await le(i),s=new Date,a=await de(t,i,s.getMonth()+1,e);P(a);const r=await ie(i,e);let l=[];if("all"===(null===n||void 0===n?void 0:n.id)&&Array.isArray(r)&&r.length>0&&r[0].site)for(const e of r)for(const t of e.tasks)l.push({id:t.submission.id,name:t.element_name,meter:t.meter?"".concat(t.meter.name," (").concat(t.meter.type,")"):"N/A",meter_id:t.meter?t.meter.id:null,meter_type:t.meter?t.meter.type:null,meter_location:t.meter?t.meter.location:null,site_name:e.site.name,frequency:t.cadence,value:t.submission.value||"",unit:t.element_unit||"",status:t.submission.status||"missing",category:t.type,description:t.element_description||"",evidence_file:t.submission.evidence_file||null,assignedTo:t.submission.assigned_to?"".concat(t.submission.assigned_to.first_name||""," ").concat(t.submission.assigned_to.last_name||"").trim()||t.submission.assigned_to.username||t.submission.assigned_to.email:null,assignedUserId:t.submission.assigned_to?t.submission.assigned_to.id:null,assignedAt:t.submission.assigned_at||null});else l=r.map(e=>({id:e.submission.id,name:e.element_name,meter:e.meter?"".concat(e.meter.name," (").concat(e.meter.type,")"):"N/A",meter_id:e.meter?e.meter.id:null,meter_type:e.meter?e.meter.type:null,meter_location:e.meter?e.meter.location:null,frequency:e.cadence,value:e.submission.value||"",unit:e.element_unit||"",status:e.submission.status||"missing",category:e.type,description:e.element_description||"",evidence_file:e.submission.evidence_file||null,assignedTo:e.submission.assigned_to?"".concat(e.submission.assigned_to.first_name||""," ").concat(e.submission.assigned_to.last_name||"").trim()||e.submission.assigned_to.username||e.submission.assigned_to.email:null,assignedUserId:e.submission.assigned_to?e.submission.assigned_to.id:null,assignedAt:e.submission.assigned_at||null}));T(l);const o=await oe(i,e);se(e=>Me(Me({},e),{},{monthly:{data_progress:o.data_progress||0,evidence_progress:o.evidence_progress||0,overall_progress:o.overall_progress||0,items_remaining:o.items_remaining||0,completed_points:o.completed_points||0,total_points:o.total_points||0}})),u(e),console.log("\u2705 Month selection complete: Now showing data for month ".concat(e))}catch(t){console.error("Error loading month data:",t)}finally{_(!1)}}})(e.id),disabled:"disabled"===e.status,children:e.name},e.id))})]})]})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:["Annual Progress (",i,")"]}),(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Data Entry Progress"}),(0,ze.jsxs)("span",{className:"text-sm font-bold text-blue-600",children:[we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,s=12*e.length,a=s>0?t/s*100:0;return Math.round(a)})():(()=>{const e=L,t=e.filter(e=>null!==e.value&&""!==e.value).length,s=12*e.length,a=s>0?t/s*100:0;return Math.round(a)})(),"%"]})]}),(0,ze.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,ze.jsx)("div",{className:"bg-blue-500 h-3 rounded-full",style:{width:"".concat(we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,s=12*e.length;return s>0?t/s*100:0})():(()=>{const e=L,t=e.filter(e=>null!==e.value&&""!==e.value).length,s=12*e.length;return s>0?t/s*100:0})(),"%")}})})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Evidence Upload"}),(0,ze.jsxs)("span",{className:"text-sm font-bold text-green-600",children:[we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>e.evidence_file).length,s=12*e.length,a=s>0?t/s*100:0;return Math.round(a)})():(()=>{const e=L,t=e.filter(e=>e.evidence_file).length,s=12*e.length,a=s>0?t/s*100:0;return Math.round(a)})(),"%"]})]}),(0,ze.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,ze.jsx)("div",{className:"bg-green-500 h-3 rounded-full",style:{width:"".concat(we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>e.evidence_file).length,s=12*e.length;return s>0?t/s*100:0})():(()=>{const e=L,t=e.filter(e=>e.evidence_file).length,s=12*e.length;return s>0?t/s*100:0})(),"%")}})})]}),(0,ze.jsxs)("div",{className:"pt-4 border-t border-gray-200 text-center",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,s=12*(2*e.length);return"".concat(t," / ").concat(s)})():(()=>{const e=L,t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,s=12*(2*e.length);return"".concat(t," / ").concat(s)})()}),(0,ze.jsxs)("div",{className:"text-sm text-gray-500",children:["Tasks Completed (Data + Evidence)",we&&(0,ze.jsx)("span",{className:"text-purple-600 ml-2",children:"\ud83d\udcca Metered Only"})]}),(0,ze.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,s=e.filter(e=>e.evidence_file).length;return"Data Entries: ".concat(t," | Evidence Files: ").concat(s)})():"Data Entries: ".concat(ee.annual.data_complete||0," | Evidence Files: ").concat(ee.annual.evidence_complete||0)})]})]})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("h3",{className:"text-lg font-semibold text-gray-900 mb-6",children:[null===(e=E.find(e=>e.id===d))||void 0===e?void 0:e.name," ",i," Progress"]}),(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Data Entry Progress"}),(0,ze.jsxs)("span",{className:"text-sm font-bold text-orange-600",children:[we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length;return e.length>0?Math.round(t/e.length*100):0})():(()=>{const e=L,t=e.filter(e=>null!==e.value&&""!==e.value).length;return e.length>0?Math.round(t/e.length*100):0})(),"%"]})]}),(0,ze.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,ze.jsx)("div",{className:"bg-orange-500 h-3 rounded-full",style:{width:"".concat(Math.min(100,Math.max(0,we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length;return e.length>0?t/e.length*100:0})():(()=>{const e=L,t=e.filter(e=>null!==e.value&&""!==e.value).length;return e.length>0?t/e.length*100:0})())),"%")}})})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Evidence Upload"}),(0,ze.jsxs)("span",{className:"text-sm font-bold text-purple-600",children:[we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>e.evidence_file).length;return e.length>0?Math.round(t/e.length*100):0})():(()=>{const e=L,t=e.filter(e=>e.evidence_file).length;return e.length>0?Math.round(t/e.length*100):0})(),"%"]})]}),(0,ze.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-3",children:(0,ze.jsx)("div",{className:"bg-purple-500 h-3 rounded-full",style:{width:"".concat(Math.min(100,Math.max(0,we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>e.evidence_file).length;return e.length>0?t/e.length*100:0})():(()=>{const e=L,t=e.filter(e=>e.evidence_file).length;return e.length>0?t/e.length*100:0})())),"%")}})})]}),(0,ze.jsxs)("div",{className:"pt-4 border-t border-gray-200 text-center",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,s=2*e.length;return"".concat(t," / ").concat(s)})():(()=>{const e=L,t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,s=2*e.length;return"".concat(t," / ").concat(s)})()}),(0,ze.jsxs)("div",{className:"text-sm text-gray-500",children:["Tasks Completed This Month",we&&(0,ze.jsx)("span",{className:"text-purple-600 ml-2",children:"\ud83d\udcca Metered Only"})]}),(0,ze.jsx)("div",{className:"text-xs text-red-500 mt-1",children:we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,s=2*e.length;return"".concat(s-t," Tasks Remaining")})():(()=>{const e=L,t=e.filter(e=>null!==e.value&&""!==e.value).length+e.filter(e=>e.evidence_file).length,s=2*e.length,a=Math.max(0,s-t);return"".concat(a," Tasks Remaining")})()}),(0,ze.jsx)("div",{className:"text-xs text-gray-400 mt-1",children:we?(()=>{const e=L.filter(e=>null!==e.meter_id),t=e.filter(e=>null!==e.value&&""!==e.value).length,s=e.filter(e=>e.evidence_file).length;return"Data Entries: ".concat(t," | Evidence Files: ").concat(s)})():(()=>{const e=L,t=e.filter(e=>null!==e.value&&""!==e.value).length,s=e.filter(e=>e.evidence_file).length;return"Data Entries: ".concat(t," | Evidence Files: ").concat(s)})()})]})]})]})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-8",children:[(0,ze.jsxs)("div",{className:"p-6 border-b border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Data Entry Interface"}),je&&(0,ze.jsxs)("div",{className:"px-3 py-1 bg-blue-50 text-blue-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-eye mr-1"}),"View Only"]}),ve&&(0,ze.jsxs)("div",{className:"px-3 py-1 bg-yellow-50 text-yellow-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-tasks mr-1"}),"Assigned Tasks Only"]}),be&&(0,ze.jsxs)("div",{className:"px-3 py-1 bg-orange-50 text-orange-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-clipboard-check mr-1"}),"Review Mode"]}),we&&(0,ze.jsxs)("div",{className:"px-3 py-1 bg-purple-50 text-purple-700 rounded-lg text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-gauge mr-1"}),"Meter Data Only"]})]}),(0,ze.jsxs)("div",{className:"flex space-x-3",children:[(0,ze.jsxs)("button",{className:"bg-orange-100 text-orange-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-orange-200",onClick:fe,title:"Refresh data to check for new meters or tasks",children:[(0,ze.jsx)("i",{className:"fas fa-sync-alt mr-2"}),"Refresh"]}),(ye||ve)&&(0,ze.jsxs)("div",{className:"relative",children:[(0,ze.jsx)("input",{type:"file",multiple:!0,accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx",onChange:e=>(async e=>{F(!0);const t={successful:[],failed:[],unmatched:[]};try{for(let a of e){const e=re(a.name,A);if(e)try{await ce(e.id,null,a)?(t.successful.push({filename:a.name,entryName:e.name,entryId:e.id}),T(t=>t.map(t=>t.id===e.id?Me(Me({},t),{},{status:t.value?"complete":"partial",evidence_file:URL.createObjectURL(a)}):t))):t.failed.push({filename:a.name,reason:"Upload failed"})}catch(s){t.failed.push({filename:a.name,reason:s.message})}else t.unmatched.push(a.name)}await ge(),M(t)}catch(s){console.error("Bulk upload error:",s)}finally{F(!1)}})(Array.from(e.target.files)),className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",id:"multiple-file-upload"}),(0,ze.jsxs)("button",{className:"bg-blue-100 text-blue-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-blue-200 ".concat(R?"opacity-50 cursor-not-allowed":""),disabled:R,children:[(0,ze.jsx)("i",{className:"fas ".concat(R?"fa-spinner fa-spin":"fa-upload"," mr-2")}),R?"Uploading...":"Upload Multiple Files"]})]}),(je||be||we)&&(0,ze.jsxs)("button",{className:"bg-green-100 text-green-700 px-4 py-2 rounded-lg text-sm font-medium hover:bg-green-200",onClick:()=>{},children:[(0,ze.jsx)("i",{className:"fas fa-download mr-2"}),"Export Data"]})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"View by:"}),(0,ze.jsxs)("button",{onClick:()=>J(!0),className:"flex items-center space-x-2 px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-filter"}),(0,ze.jsx)("span",{children:x||"All Items"}),(0,ze.jsx)("i",{className:"fas fa-chevron-down ml-1"})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Group by:"}),(0,ze.jsxs)("button",{onClick:()=>K(!0),className:"flex items-center space-x-2 px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-layer-group"}),(0,ze.jsx)("span",{children:h}),(0,ze.jsx)("i",{className:"fas fa-chevron-down ml-1"})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("label",{className:"text-sm font-medium text-gray-700",children:"Assignment:"}),(0,ze.jsxs)("button",{onClick:()=>Z(!0),className:"flex items-center space-x-2 px-3 py-1 border border-gray-300 rounded-lg hover:bg-gray-50 text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-tasks"}),(0,ze.jsx)("span",{children:"all"===H?"All Tasks":"assigned"===H?"Assigned":"Unassigned"}),(0,ze.jsx)("i",{className:"fas fa-chevron-down ml-1"})]})]}),(0,ze.jsx)("div",{className:"flex-1",children:(0,ze.jsx)("input",{type:"text",placeholder:"Search data elements...",className:"w-full border border-gray-300 rounded-lg px-3 py-1 text-sm",value:m,onChange:e=>f(e.target.value)})})]})]}),(0,ze.jsx)("div",{className:"p-6",children:0===L.length?(0,ze.jsxs)("div",{className:"text-center py-12",children:[(0,ze.jsx)("i",{className:"fas fa-gauge text-gray-400 text-4xl mb-4"}),(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No data entries found"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"Data entries are generated based on your configured meters and checklist requirements."}),(0,ze.jsxs)("button",{className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",onClick:()=>t("/meter"),children:[(0,ze.jsx)("i",{className:"fas fa-cog mr-2"}),"Configure Meters"]})]}):0===L.length?(0,ze.jsxs)("div",{className:"text-center py-12",children:[(0,ze.jsx)("i",{className:"fas fa-search text-gray-400 text-4xl mb-4"}),(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No matching entries found"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"Try adjusting your search terms or filters to find data entries."})]}):(0,ze.jsx)("div",{className:"space-y-6",children:(()=>{const e=(t=L,"Category"===h?t.reduce((e,t)=>{const s=t.category||"Other";return e[s]||(e[s]=[]),e[s].push(t),e},{}):"Frequency"===h?t.reduce((e,t)=>{const s=t.frequency||"Unknown";return e[s]||(e[s]=[]),e[s].push(t),e},{}):"Status"===h?t.reduce((e,t)=>{const s=t.status||"missing",a="complete"===s?"Complete":"partial"===s?"Partial":"Missing";return e[a]||(e[a]=[]),e[a].push(t),e},{}):"Site"===h?t.reduce((e,t)=>{const s=t.site_name||"Unknown Site";return e[s]||(e[s]=[]),e[s].push(t),e},{}):{"All Items":t});var t;return Object.entries(e).map(t=>{let[s,a]=t;return(0,ze.jsxs)("div",{children:[Object.keys(e).length>1&&(0,ze.jsxs)("div",{className:"flex items-center mb-4",children:[(0,ze.jsx)("h4",{className:"text-lg font-semibold text-gray-800 mr-3",children:s}),(0,ze.jsx)("div",{className:"flex-1 h-px bg-gray-200"}),(0,ze.jsxs)("span",{className:"ml-3 text-sm text-gray-500 bg-gray-100 px-2 py-1 rounded",children:[a.length," ",1===a.length?"item":"items"]})]}),(0,ze.jsx)("div",{className:"space-y-4",children:a.map(e=>(0,ze.jsxs)("div",{className:"rounded-xl shadow-sm hover:shadow-md transition-shadow duration-200 ".concat("complete"===e.status?"bg-green-50 border border-green-200":"partial"===e.status?"bg-orange-50 border border-orange-200":"missing"===e.status?"bg-red-50 border border-red-200":"bg-gray-50 border border-gray-200"),children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between p-4 border-b border-gray-100",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:me(e.status)}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"font-semibold text-gray-900",children:e.name}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2 mt-1",children:[e.meter_id&&(0,ze.jsxs)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-blue-100 text-blue-800",children:[(0,ze.jsx)("i",{className:"fas fa-gauge mr-1"}),e.meter.split(" (")[0]," (",e.meter_type,")"]}),(0,ze.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-gray-100 text-gray-700",children:e.frequency}),e.meter_location&&(0,ze.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-md text-xs font-medium bg-purple-100 text-purple-800",children:e.meter_location})]})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(Ne||ke||Se)&&(0,ze.jsxs)("div",{className:"flex items-center space-x-2 text-xs",children:[(0,ze.jsx)("span",{className:"text-gray-500",children:e.assignedTo?"Assigned: ".concat(e.assignedTo):"Unassigned"}),(0,ze.jsxs)("button",{className:"px-2 py-1 bg-blue-50 text-blue-600 rounded text-xs font-medium hover:bg-blue-100",onClick:()=>Ce(e),children:[(0,ze.jsx)("i",{className:"fas fa-user-plus mr-1"}),e.assignedTo?"Reassign":"Assign"]})]}),(0,ze.jsx)("div",{className:"flex items-center space-x-2",children:w[e.id]?(0,ze.jsxs)("div",{className:"flex items-center text-sm text-blue-600",children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),(0,ze.jsx)("span",{className:"text-xs",children:"Auto-saving..."})]}):"complete"===e.status?(0,ze.jsxs)("div",{className:"flex items-center text-sm text-green-600",children:[(0,ze.jsx)("i",{className:"fas fa-check mr-1"}),(0,ze.jsx)("span",{className:"text-xs",children:"Complete"})]}):"partial"===e.status?(0,ze.jsxs)("div",{className:"flex items-center text-sm text-orange-600",children:[(0,ze.jsx)("i",{className:"fas fa-clock mr-1"}),(0,ze.jsx)("span",{className:"text-xs",children:"Partial"})]}):(0,ze.jsxs)("div",{className:"flex items-center text-sm text-gray-500",children:[(0,ze.jsx)("i",{className:"fas fa-circle mr-1"}),(0,ze.jsx)("span",{className:"text-xs",children:"Missing"})]})})]})]}),(0,ze.jsxs)("div",{className:"flex",children:[(0,ze.jsx)("div",{className:"flex-1 p-4 pr-2",style:{width:"50%"},children:(0,ze.jsxs)("div",{className:"space-y-3",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,ze.jsx)("i",{className:"fas fa-chart-line text-blue-500 text-sm"}),(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Data Entry"})]}),(0,ze.jsx)("div",{className:"flex items-center space-x-3",children:(0,ze.jsxs)("div",{className:"relative flex-1",children:[!(ye||ve||be)||je||we?(0,ze.jsx)("div",{className:"w-full bg-gray-100 border border-gray-200 rounded-lg px-4 py-3 text-lg font-medium text-gray-500",children:void 0!==y[e.id]?y[e.id]:e.value||"0"}):(0,ze.jsx)("input",{type:"number",value:void 0!==y[e.id]?y[e.id]:e.value||"",onChange:t=>((e,t)=>{b(s=>Me(Me({},s),{},{[e]:t})),k[e]&&clearTimeout(k[e]);const s=setTimeout(()=>{xe(e,t,v[e])},1500);S(t=>Me(Me({},t),{},{[e]:s}))})(e.id,t.target.value),className:"w-full bg-gray-50 border border-gray-200 rounded-lg px-4 py-3 text-lg font-medium focus:bg-white focus:ring-2 focus:ring-blue-500 focus:border-blue-500 transition-all duration-200",placeholder:"0"}),(0,ze.jsx)("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 text-sm font-medium text-gray-500 bg-white px-2 rounded",children:e.unit}),(je||we)&&(0,ze.jsx)("div",{className:"absolute -top-1 -right-1",children:(0,ze.jsx)("div",{className:"px-1 py-0.5 bg-blue-100 text-blue-600 text-xs rounded-full",children:(0,ze.jsx)("i",{className:"fas fa-eye"})})})]})})]})}),(0,ze.jsx)("div",{className:"w-px bg-gray-200"}),(0,ze.jsx)("div",{className:"p-4 pl-2",style:{width:"50%"},children:(0,ze.jsxs)("div",{className:"space-y-3",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("i",{className:"fas fa-paperclip text-purple-500 text-sm"}),(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Evidence"})]}),e.evidence_file&&(0,ze.jsx)("button",{onClick:()=>(async e=>{j(t=>{const s=Me({},t);return delete s[e],s}),N(t=>Me(Me({},t),{},{[e]:!0}));try{const t=new FormData;t.append("remove_evidence","true"),(await Ie("".concat(Ue,"/api/data-collection/").concat(e,"/"),{method:"PATCH",body:t})).ok&&(T(t=>t.map(t=>t.id===e?Me(Me({},t),{},{status:t.value?"partial":"missing",evidence_file:null}):t)),await ge())}catch(t){console.error("Error clearing file:",t)}finally{N(t=>Me(Me({},t),{},{[e]:!1}))}})(e.id),className:"p-1 text-red-500 hover:bg-red-50 rounded text-xs",title:"Remove file",children:(0,ze.jsx)("i",{className:"fas fa-trash"})})]}),(0,ze.jsx)("div",{className:"relative",children:!(ye||ve||be)||je||we?(0,ze.jsx)("div",{className:"border-2 border-gray-200 rounded-lg p-3 text-center bg-gray-50",children:e.evidence_file?(0,ze.jsxs)("div",{className:"space-y-2",children:[(0,ze.jsx)("i",{className:"fas fa-file-alt text-gray-400 text-lg"}),(0,ze.jsx)("div",{className:"text-xs text-gray-500 truncate",children:e.evidence_file.split("/").pop()}),(0,ze.jsx)("div",{className:"text-xs text-gray-500",children:"View only"})]}):(0,ze.jsxs)("div",{className:"space-y-1",children:[(0,ze.jsx)("i",{className:"fas fa-file text-gray-400 text-lg"}),(0,ze.jsx)("div",{className:"text-xs text-gray-500",children:"No evidence uploaded"})]})}):(0,ze.jsxs)("div",{className:"border-2 border-dashed border-gray-300 rounded-lg p-3 text-center hover:border-blue-400 hover:bg-blue-50 transition-colors duration-200 cursor-pointer",children:[(0,ze.jsx)("input",{type:"file",onChange:t=>{return s=e.id,a=t.target.files[0],j(e=>Me(Me({},e),{},{[s]:a})),void xe(s,y[s],a);var s,a},className:"absolute inset-0 w-full h-full opacity-0 cursor-pointer",accept:".pdf,.jpg,.jpeg,.png,.doc,.docx,.xls,.xlsx"}),e.evidence_file?(0,ze.jsxs)("div",{className:"space-y-2",children:[(0,ze.jsx)("i",{className:"fas fa-file-alt text-green-500 text-lg"}),(0,ze.jsx)("div",{className:"text-xs text-gray-600 truncate",children:e.evidence_file.split("/").pop()}),(0,ze.jsx)("div",{className:"text-xs text-green-600 font-medium",children:"File uploaded"})]}):(0,ze.jsxs)("div",{className:"space-y-1",children:[(0,ze.jsx)("i",{className:"fas fa-upload text-gray-400 text-lg"}),(0,ze.jsx)("div",{className:"text-xs text-gray-500",children:"Drop file or click"})]})]})})]})})]})]},e.id))})]},s)})})()})})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsx)("div",{className:"flex items-center space-x-4",children:(0,ze.jsxs)("button",{className:"px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",onClick:()=>t("/meter"),children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]})}),(0,ze.jsx)("div",{className:"flex space-x-4",children:(0,ze.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:()=>{t("/team")},children:["Complete Setup",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})})]}),D&&(0,o.createPortal)((0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Upload Results"}),(0,ze.jsx)("button",{onClick:()=>M(null),className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsxs)("div",{className:"space-y-4",children:[D.successful.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{className:"text-sm font-medium text-green-600 mb-2",children:["\u2705 Successfully Uploaded (",D.successful.length,")"]}),(0,ze.jsx)("div",{className:"space-y-1",children:D.successful.map((e,t)=>(0,ze.jsxs)("div",{className:"text-xs text-gray-600 bg-green-50 p-2 rounded",children:[(0,ze.jsx)("div",{className:"font-medium",children:e.filename}),(0,ze.jsxs)("div",{children:["\u2192 ",e.entryName]})]},t))})]}),D.unmatched.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{className:"text-sm font-medium text-yellow-600 mb-2",children:["\u26a0\ufe0f No Match Found (",D.unmatched.length,")"]}),(0,ze.jsx)("div",{className:"space-y-1",children:D.unmatched.map((e,t)=>(0,ze.jsx)("div",{className:"text-xs text-gray-600 bg-yellow-50 p-2 rounded",children:e},t))})]}),D.failed.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("h4",{className:"text-sm font-medium text-red-600 mb-2",children:["\u274c Failed Uploads (",D.failed.length,")"]}),(0,ze.jsx)("div",{className:"space-y-1",children:D.failed.map((e,t)=>(0,ze.jsxs)("div",{className:"text-xs text-gray-600 bg-red-50 p-2 rounded",children:[(0,ze.jsx)("div",{className:"font-medium",children:e.filename}),(0,ze.jsxs)("div",{children:["Error: ",e.reason]})]},t))})]})]}),(0,ze.jsx)("div",{className:"mt-6 flex justify-end",children:(0,ze.jsx)("button",{onClick:()=>M(null),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Close"})})]})}),document.body),U&&I&&(0,o.createPortal)((0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 max-h-96 overflow-y-auto",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Assign Task"}),(0,ze.jsx)("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>{z(!1),G(null)},children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,ze.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:I.name}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:I.description}),(0,ze.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,ze.jsxs)("span",{children:["Unit: ",I.unit]}),(0,ze.jsxs)("span",{children:["Frequency: ",I.frequency]}),I.meter&&(0,ze.jsxs)("span",{children:["Meter: ",I.meter]})]})]}),(0,ze.jsxs)("div",{className:"mb-4",children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select User to Assign:"}),q?(0,ze.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Loading users..."})]}):0===B.length?(0,ze.jsx)("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No users available for assignment"}):(0,ze.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:B.map(e=>(0,ze.jsxs)("div",{className:"flex items-center justify-between p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>(async(e,t)=>{try{const s=await Ie("".concat(Ue,"/api/data-collection/assign-task/"),{method:"POST",body:JSON.stringify({task_id:t,assigned_user_id:e})});if(s.ok){await s.json();const a=B.find(t=>t.id===e),n=a?"".concat(a.first_name||""," ").concat(a.last_name||"").trim()||a.name||a.email:"Unknown User";T(s=>s.map(s=>s.id===t?Me(Me({},s),{},{assignedTo:n,assignedUserId:e}):s)),z(!1),G(null),fe()}else{console.error("Failed to assign task, status:",s.status);const e=await s.text();console.error("Error response:",e)}}catch(s){console.error("Error assigning task:",s)}})(e.id,I.id),children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-blue-100 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-user text-blue-600 text-sm"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{className:"font-medium text-gray-900",children:[e.first_name," ",e.last_name]}),(0,ze.jsxs)("div",{className:"text-xs text-gray-500",children:[e.role," \u2022 ",e.email]})]})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[e.sites&&e.sites.length>0&&(0,ze.jsxs)("span",{className:"text-xs bg-gray-100 text-gray-600 px-2 py-1 rounded",children:[e.sites.length," site",e.sites.length>1?"s":""]}),(0,ze.jsx)("i",{className:"fas fa-chevron-right text-gray-400 text-xs"})]})]},e.id))})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between pt-4 border-t border-gray-200",children:[(0,ze.jsxs)("div",{className:"text-xs text-gray-500",children:[Ne&&"System-wide assignment",ke&&"Company-wide assignment",Se&&"Site-level assignment (Uploaders only)"]}),(0,ze.jsx)("button",{className:"px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-sm font-medium",onClick:()=>{z(!1),G(null)},children:"Cancel"})]})]})}),document.body),$&&(0,ze.jsx)(Ua,{isOpen:$,currentFilter:x||"All Items",onApply:e=>{p("All Items"===e?"All":e),J(!1)},onClose:()=>J(!1)}),Y&&(0,ze.jsx)(za,{isOpen:Y,currentFilter:h,onApply:e=>{g(e),K(!1)},onClose:()=>K(!1),selectedLocation:n}),X&&(0,ze.jsx)(Ia,{isOpen:X,currentFilter:H,onApply:e=>{Q(e),Z(!1)},onClose:()=>Z(!1)})]}):(0,ze.jsx)("div",{className:"max-w-6xl mx-auto px-4",children:(0,ze.jsxs)("div",{className:"bg-yellow-50 border border-yellow-200 rounded-xl p-6 text-center",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-4xl text-yellow-600 mb-4"}),(0,ze.jsx)("h2",{className:"text-xl font-semibold text-gray-900 mb-2",children:"No Location Selected"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"Please select a location to manage data entries."}),(0,ze.jsxs)("button",{onClick:()=>t("/location"),className:"px-6 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Go to Location Selection"]})]})})},Ba=()=>{const{user:e,selectedCompany:t,hasPermission:s}=Be(),[a,n]=(0,r.useState)([]),[l,i]=(0,r.useState)([]),[o,c]=(0,r.useState)([]),[d,u]=(0,r.useState)(!0),[m,f]=(0,r.useState)(!1),[x,p]=(0,r.useState)([]),[h,g]=(0,r.useState)(""),[y,b]=(0,r.useState)({priority:0,notes:"",due_date:""}),[v,j]=(0,r.useState)("all"),[w,N]=(0,r.useState)({total:0,pending:0,in_progress:0,completed:0,overdue:0}),k=null===t||void 0===t?void 0:t.id;(0,r.useEffect)(()=>{k&&S()},[k,v]);const S=async()=>{u(!0);try{const e=s("elementAssignment","view_all")?"".concat(Ue,"/api/element-assignments/company_assignments/?company_id=").concat(k):"".concat(Ue,"/api/element-assignments/my_assignments/"),t=await Ie(e);if(t.ok){const e=await t.json();s("elementAssignment","view_all")?(n(e.assignments||[]),N(e.statistics||w)):n(e)}if(s("elementAssignment","create")){const e=await Ie("".concat(Ue,"/api/checklist/?company_id=").concat(k));if(e.ok){const t=await e.json();i(t.results||[])}const t=await Ie("".concat(Ue,"/api/element-assignments/available_users/?company_id=").concat(k));if(t.ok){const e=await t.json();c(e)}}}catch(e){console.error("Error fetching data:",e)}finally{u(!1)}},C=a.filter(e=>"all"===v||e.status===v);return d?(0,ze.jsx)(La,{children:(0,ze.jsx)("div",{className:"flex justify-center items-center h-64",children:(0,ze.jsx)("div",{className:"text-xl text-gray-600",children:"Loading assignments..."})})}):(0,ze.jsx)(La,{children:(0,ze.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6 mb-6",children:[(0,ze.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Element Assignments"}),(0,ze.jsx)("p",{className:"text-gray-600 mt-2",children:"Manage and track data element assignments to team members"})]}),s("elementAssignment","create")&&(0,ze.jsxs)("button",{onClick:()=>f(!0),className:"px-6 py-3 bg-blue-600 text-white rounded-lg hover:bg-blue-700 font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-plus mr-2"}),"Assign Elements"]})]}),s("elementAssignment","view_all")&&(0,ze.jsxs)("div",{className:"grid grid-cols-5 gap-4 mt-6",children:[(0,ze.jsxs)("div",{className:"bg-gray-50 p-4 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:w.total}),(0,ze.jsx)("div",{className:"text-sm text-gray-600",children:"Total"})]}),(0,ze.jsxs)("div",{className:"bg-yellow-50 p-4 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-yellow-600",children:w.pending}),(0,ze.jsx)("div",{className:"text-sm text-gray-600",children:"Pending"})]}),(0,ze.jsxs)("div",{className:"bg-blue-50 p-4 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-blue-600",children:w.in_progress}),(0,ze.jsx)("div",{className:"text-sm text-gray-600",children:"In Progress"})]}),(0,ze.jsxs)("div",{className:"bg-green-50 p-4 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-green-600",children:w.completed}),(0,ze.jsx)("div",{className:"text-sm text-gray-600",children:"Completed"})]}),(0,ze.jsxs)("div",{className:"bg-red-50 p-4 rounded-lg",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-red-600",children:w.overdue}),(0,ze.jsx)("div",{className:"text-sm text-gray-600",children:"Overdue"})]})]})]}),(0,ze.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 mb-6",children:(0,ze.jsx)("div",{className:"flex border-b border-gray-200",children:["all","pending","in_progress","completed","overdue"].map(e=>(0,ze.jsx)("button",{onClick:()=>j(e),className:"px-6 py-3 font-medium capitalize ".concat(v===e?"border-b-2 border-blue-500 text-blue-600":"text-gray-600 hover:text-gray-900"),children:e.replace("_"," ")},e))})}),(0,ze.jsx)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200",children:0===C.length?(0,ze.jsxs)("div",{className:"p-12 text-center",children:[(0,ze.jsx)("i",{className:"fas fa-clipboard-list text-4xl text-gray-400 mb-4"}),(0,ze.jsx)("p",{className:"text-gray-500",children:"No assignments found"})]}):(0,ze.jsx)("div",{className:"divide-y divide-gray-200",children:C.map(t=>{const a=(e=>{switch(e){case 2:return{text:"High",color:"red"};case 1:return{text:"Medium",color:"yellow"};default:return{text:"Low",color:"gray"}}})(t.priority),n=(e=>{switch(e){case"completed":return"green";case"in_progress":return"blue";case"overdue":return"red";default:return"gray"}})(t.status);return(0,ze.jsx)("div",{className:"p-6 hover:bg-gray-50",children:(0,ze.jsxs)("div",{className:"flex justify-between items-start",children:[(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:t.element_name}),(0,ze.jsx)("p",{className:"text-gray-600 mt-1",children:t.element_description}),(0,ze.jsxs)("div",{className:"flex items-center space-x-4 mt-3",children:[(0,ze.jsxs)("span",{className:"text-sm text-gray-500",children:[(0,ze.jsx)("i",{className:"fas fa-user mr-1"}),t.assigned_to_username]}),t.due_date&&(0,ze.jsxs)("span",{className:"text-sm ".concat(t.is_overdue?"text-red-600":"text-gray-500"),children:[(0,ze.jsx)("i",{className:"fas fa-calendar mr-1"}),"Due: ",new Date(t.due_date).toLocaleDateString()]}),(0,ze.jsxs)("span",{className:"text-sm px-2 py-1 rounded bg-".concat(a.color,"-100 text-").concat(a.color,"-700"),children:[a.text," Priority"]})]}),t.notes&&(0,ze.jsxs)("div",{className:"mt-3 p-3 bg-gray-50 rounded text-sm text-gray-600",children:[(0,ze.jsx)("i",{className:"fas fa-sticky-note mr-2"}),t.notes]})]}),(0,ze.jsxs)("div",{className:"ml-6 flex items-center space-x-3",children:[(0,ze.jsx)("span",{className:"px-3 py-1 rounded-full text-sm font-medium bg-".concat(n,"-100 text-").concat(n,"-700"),children:t.status.replace("_"," ")}),(t.assigned_to===e.id||s("elementAssignment","update"))&&(0,ze.jsxs)("select",{value:t.status,onChange:e=>(async(e,t)=>{try{const s=await Ie("".concat(Ue,"/api/element-assignments/").concat(e,"/update_status/"),{method:"POST",body:JSON.stringify({status:t})});if(s.ok)S();else{const e=await s.json();alert(e.error||"Failed to update status")}}catch(s){console.error("Error updating status:",s),alert("Failed to update status")}})(t.id,e.target.value),className:"px-3 py-1 border border-gray-300 rounded-lg text-sm",children:[(0,ze.jsx)("option",{value:"pending",children:"Pending"}),(0,ze.jsx)("option",{value:"in_progress",children:"In Progress"}),(0,ze.jsx)("option",{value:"completed",children:"Completed"})]})]})]})},t.id)})})}),m&&(0,ze.jsx)("div",{className:"fixed inset-0 z-50 flex items-center justify-center bg-black bg-opacity-50",children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-3xl w-full max-h-[80vh] overflow-y-auto",children:[(0,ze.jsx)("h2",{className:"text-xl font-bold text-gray-900 mb-4",children:"Assign Elements to User"}),(0,ze.jsxs)("div",{className:"mb-4",children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assign To"}),(0,ze.jsxs)("select",{value:h,onChange:e=>g(e.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",children:[(0,ze.jsx)("option",{value:"",children:"Select a user"}),o.map(e=>(0,ze.jsxs)("option",{value:e.id,children:[e.full_name," (",e.email,") - ",e.role," - ",e.assignment_count," active"]},e.id))]})]}),(0,ze.jsxs)("div",{className:"mb-4",children:[(0,ze.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Select Elements (",x.length," selected)"]}),(0,ze.jsx)("div",{className:"max-h-48 overflow-y-auto border border-gray-300 rounded-lg p-3",children:l.map(e=>(0,ze.jsxs)("label",{className:"flex items-center p-2 hover:bg-gray-50 cursor-pointer",children:[(0,ze.jsx)("input",{type:"checkbox",checked:x.includes(e.id),onChange:t=>{t.target.checked?p([...x,e.id]):p(x.filter(t=>t!==e.id))},className:"mr-3"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{className:"font-medium",children:e.element_name}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:e.element_description})]})]},e.id))})]}),(0,ze.jsxs)("div",{className:"mb-4",children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Priority"}),(0,ze.jsxs)("select",{value:y.priority,onChange:e=>b(Me(Me({},y),{},{priority:parseInt(e.target.value)})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg",children:[(0,ze.jsx)("option",{value:0,children:"Low"}),(0,ze.jsx)("option",{value:1,children:"Medium"}),(0,ze.jsx)("option",{value:2,children:"High"})]})]}),(0,ze.jsxs)("div",{className:"mb-4",children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Due Date (Optional)"}),(0,ze.jsx)("input",{type:"date",value:y.due_date,onChange:e=>b(Me(Me({},y),{},{due_date:e.target.value})),className:"w-full px-4 py-2 border border-gray-300 rounded-lg"})]}),(0,ze.jsxs)("div",{className:"mb-6",children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Notes (Optional)"}),(0,ze.jsx)("textarea",{value:y.notes,onChange:e=>b(Me(Me({},y),{},{notes:e.target.value})),rows:3,className:"w-full px-4 py-2 border border-gray-300 rounded-lg",placeholder:"Add any instructions or notes for the assignee"})]}),(0,ze.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,ze.jsx)("button",{onClick:()=>{f(!1),p([]),g(""),b({priority:0,notes:"",due_date:""})},className:"px-6 py-2 border border-gray-300 rounded-lg text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,ze.jsx)("button",{onClick:async()=>{if(h&&0!==x.length)try{const e=await Ie("".concat(Ue,"/api/element-assignments/bulk_assign/"),{method:"POST",body:JSON.stringify({checklist_item_ids:x,assigned_to_id:h,priority:y.priority,notes:y.notes,due_date:y.due_date||null})});if(e.ok){const t=await e.json();alert("Successfully assigned ".concat(t.total_created," items")),f(!1),p([]),g(""),b({priority:0,notes:"",due_date:""}),S()}else{const t=await e.json();alert(t.error||"Failed to create assignments")}}catch(e){console.error("Error creating assignments:",e),alert("Failed to create assignments")}else alert("Please select items and a user to assign")},disabled:!h||0===x.length,className:"px-6 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed",children:"Assign Elements"})]})]})})]})})},Wa=e=>{let{chartData:t,meterType:s}=e;if(!t||!t.labels||!t.data||0===t.data.length)return(0,ze.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,ze.jsx)("p",{className:"text-gray-500",children:"No chart data available"})});const a=t.data.some(e=>e>0),n=Math.max(...t.data.filter(e=>e>0))||100,r=null!==s&&void 0!==s&&s.includes("Electricity")?"kWh":null!==s&&void 0!==s&&s.includes("Fuel")||null!==s&&void 0!==s&&s.includes("Water")?"L":"units";return a?(0,ze.jsxs)("div",{className:"h-full flex flex-col bg-white",children:[(0,ze.jsx)("div",{className:"flex-1 flex items-end space-x-1 pb-4 min-h-[180px]",children:t.data.map((e,s)=>{const a=e>0?Math.max(e/n*80,10):0,l=e>0;return(0,ze.jsxs)("div",{className:"flex-1 flex flex-col items-center",children:[(0,ze.jsx)("div",{className:"relative w-full flex items-end",style:{height:"180px"},children:e>0?(0,ze.jsx)("div",{className:"w-full rounded-t-md transition-all duration-300 ".concat(l?"bg-green-600":"bg-blue-400"),style:{height:"".concat(a,"%")},title:"".concat(t.labels[s],": ").concat(e.toLocaleString()," ").concat(r," (Real Data)")}):(0,ze.jsx)("div",{className:"w-full h-1 bg-gray-200 rounded-full opacity-50",title:"".concat(t.labels[s],": No data")})}),(0,ze.jsx)("div",{className:"mt-2 text-xs text-gray-700 font-medium",children:t.labels[s]}),(0,ze.jsx)("div",{className:"text-xs ".concat(e>0?"text-green-600 font-semibold":"text-gray-400"),children:e>0?e.toLocaleString():"0"})]},s)})}),(0,ze.jsxs)("div",{className:"text-xs text-gray-500 text-center pt-2 border-t border-gray-200",children:["Unit: ",r," | ",(0,ze.jsx)("span",{className:"text-green-600",children:"\u25cf"})," Submitted data | ",(0,ze.jsx)("span",{className:"text-gray-400",children:"\u2500"})," No data"]})]}):(0,ze.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("i",{className:"fas fa-chart-line text-gray-300 text-3xl mb-2"}),(0,ze.jsx)("p",{className:"text-gray-500",children:"No data submitted for this meter"}),(0,ze.jsx)("p",{className:"text-gray-400 text-sm",children:"Submit data to see chart visualization"})]})})},qa=e=>{let{emissionsData:t,selectedScope:s}=e;if(!t||0===Object.keys(t).length)return(0,ze.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,ze.jsx)("p",{className:"text-gray-500",children:"No emissions data available"})});const a=Object.values(t).reduce((e,t)=>e+t.value,0),n=Object.entries(t);return(0,ze.jsxs)("div",{className:"h-full flex",children:[(0,ze.jsx)("div",{className:"flex-1 flex items-center justify-center",children:(0,ze.jsx)("div",{className:"relative w-40 h-40",children:(0,ze.jsxs)("div",{className:"w-full h-full rounded-full relative overflow-hidden",children:[n.map((e,t)=>{let[r,l]=e;const i=(a>0?l.value/a*100:0)/100*360,o=n.slice(0,t).reduce((e,t)=>{let[,s]=t;return e+s.value/a*360},0);return(0,ze.jsx)("div",{className:"absolute inset-0 ".concat(s===r?"opacity-100":"opacity-70"),style:{background:"conic-gradient(from ".concat(o,"deg, ").concat(l.color," 0deg, ").concat(l.color," ").concat(i,"deg, transparent ").concat(i,"deg)"),transform:s===r?"scale(1.05)":"scale(1)",transition:"all 0.3s ease"}},r)}),(0,ze.jsx)("div",{className:"absolute inset-4 bg-white rounded-full flex items-center justify-center",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"text-lg font-bold text-gray-900",children:Math.round(a)}),(0,ze.jsx)("div",{className:"text-xs text-gray-600",children:"tCO2e"})]})})]})})}),(0,ze.jsx)("div",{className:"w-40 pl-3 flex flex-col justify-center",children:n.map(e=>{let[t,n]=e;const r=a>0?n.value/a*100:0;return s===t?(0,ze.jsxs)("div",{className:"p-3 rounded-lg border border-blue-300 bg-blue-50 transition-all",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-2 mb-2",children:[(0,ze.jsx)("div",{className:"w-3 h-3 rounded-full",style:{backgroundColor:n.color}}),(0,ze.jsx)("span",{className:"font-medium text-sm text-gray-900",children:t})]}),(0,ze.jsxs)("div",{className:"text-lg font-bold text-gray-900 mb-1",children:[Math.round(n.value)," tCO2e"]}),(0,ze.jsxs)("div",{className:"text-xs text-gray-600 mb-2",children:[r.toFixed(1),"% of total"]}),n.items.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h4",{className:"text-xs font-medium text-gray-700 mb-1",children:"Sources:"}),(0,ze.jsx)("div",{className:"space-y-1 max-h-24 overflow-y-auto",children:n.items.map((e,t)=>(0,ze.jsx)("div",{className:"text-xs text-gray-600 bg-white px-2 py-1 rounded",title:e,children:e},t))})]}),0===n.items.length&&(0,ze.jsx)("div",{className:"text-xs text-gray-500 italic",children:"No data sources"})]},t):null})})]})},Va=e=>{var t,s;let{isOpen:a,onClose:n,onConfirm:r,data:l}=e;return a?(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-[9999] flex items-center justify-center p-4",children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl max-w-lg w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,ze.jsx)("div",{className:"p-6 border-b ".concat("warning"===l.type?"bg-yellow-50":"bg-green-50"),children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:["warning"===l.type?(0,ze.jsx)("div",{className:"w-12 h-12 bg-yellow-100 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-exclamation-triangle text-yellow-600 text-xl"})}):(0,ze.jsx)("div",{className:"w-12 h-12 bg-green-100 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-check-circle text-green-600 text-xl"})}),(0,ze.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:l.title})]}),(0,ze.jsx)("button",{onClick:n,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times text-xl"})})]})}),(0,ze.jsx)("div",{className:"p-6",children:"warning"===l.type?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("p",{className:"text-gray-700 mb-4",children:l.message}),(0,ze.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4 mb-4",children:[(0,ze.jsx)("h3",{className:"font-semibold text-red-900 mb-2",children:"Missing Data:"}),(0,ze.jsx)("ul",{className:"space-y-1",children:null===(t=l.missingItems)||void 0===t?void 0:t.map((e,t)=>(0,ze.jsx)("li",{className:"text-red-700 text-sm",children:e},t))})]}),l.missingMeters&&l.missingMeters.length>0&&(0,ze.jsxs)("div",{className:"bg-orange-50 border border-orange-200 rounded-lg p-4 mb-4",children:[(0,ze.jsx)("h3",{className:"font-semibold text-orange-900 mb-2",children:"Meters Without Data:"}),(0,ze.jsx)("div",{className:"flex flex-wrap gap-2",children:l.missingMeters.map((e,t)=>(0,ze.jsx)("span",{className:"px-2 py-1 bg-orange-100 text-orange-700 rounded text-sm",children:e},t))})]}),(0,ze.jsx)("p",{className:"text-gray-600 text-sm",children:"Do you want to continue generating the report with incomplete data?"})]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)("div",{className:"space-y-3",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,ze.jsx)("span",{className:"text-gray-600",children:"File Name:"}),(0,ze.jsx)("span",{className:"font-mono text-sm bg-gray-100 px-2 py-1 rounded",children:l.filename})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,ze.jsx)("span",{className:"text-gray-600",children:"Report Period:"}),(0,ze.jsx)("span",{className:"font-semibold",children:l.period})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between py-2 border-b",children:[(0,ze.jsx)("span",{className:"text-gray-600",children:"Completeness:"}),(0,ze.jsxs)("span",{className:"font-semibold ".concat(100===l.completeness?"text-green-600":"text-orange-600"),children:[l.completeness,"%"]})]})]}),(0,ze.jsxs)("div",{className:"mt-4 p-4 bg-gray-50 rounded-lg",children:[(0,ze.jsx)("h4",{className:"font-semibold text-gray-900 mb-2",children:"Report Includes:"}),(0,ze.jsx)("ul",{className:"space-y-1",children:null===(s=l.includes)||void 0===s?void 0:s.map((e,t)=>(0,ze.jsxs)("li",{className:"text-gray-600 text-sm flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-check text-green-500 mr-2"}),e]},t))})]}),l.completeness<100&&(0,ze.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,ze.jsxs)("p",{className:"text-yellow-800 text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle mr-2"}),"Report contains incomplete data (",l.completeness,"% complete)"]})})]})}),(0,ze.jsx)("div",{className:"p-6 border-t bg-gray-50 flex justify-end space-x-3",children:"warning"===l.type?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:n,className:"px-4 py-2 bg-gray-200 text-gray-700 rounded-lg hover:bg-gray-300 transition-colors",children:"Cancel & Complete Data"}),(0,ze.jsx)("button",{onClick:r,className:"px-4 py-2 bg-yellow-600 text-white rounded-lg hover:bg-yellow-700 transition-colors",children:"Export Anyway"})]}):(0,ze.jsx)("button",{onClick:n,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 transition-colors",children:"Done"})})]})}):null},Ha=e=>{let{isOpen:t,onClose:s,onSelectType:a}=e;if(!t)return null;return(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 z-50 flex items-center justify-center p-4",children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl max-w-2xl w-full max-h-[90vh] overflow-y-auto shadow-2xl",children:[(0,ze.jsx)("div",{className:"p-6 border-b bg-blue-50",children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-calendar-plus text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-xl font-semibold text-gray-900",children:"Add New Deadline"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Choose the type of deadline you want to add"})]})]}),(0,ze.jsx)("button",{onClick:s,className:"p-2 hover:bg-white rounded-lg transition-colors",children:(0,ze.jsx)("i",{className:"fas fa-times text-gray-500"})})]})}),(0,ze.jsx)("div",{className:"p-6",children:(0,ze.jsx)("div",{className:"space-y-4",children:[{id:"data",icon:"fas fa-database",title:"Data Collection Deadline",description:"Add monthly submission deadline for meter readings and ESG data",color:"blue"},{id:"framework",icon:"fas fa-file-alt",title:"Framework Compliance Deadline",description:"Add reporting deadline for ESG frameworks (DST, Green Key, etc.)",color:"green"},{id:"checklist",icon:"fas fa-tasks",title:"ESG Action Item Deadline",description:"Add deadline for checklist items and sustainability initiatives",color:"purple"}].map(e=>(0,ze.jsx)("button",{onClick:()=>a(e.id),className:"w-full p-6 rounded-xl border-2 border-gray-200 hover:border-".concat(e.color,"-300 hover:shadow-md transition-all duration-200 text-left group"),children:(0,ze.jsxs)("div",{className:"flex items-start space-x-4",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center flex-shrink-0 group-hover:bg-").concat(e.color,"-200 transition-colors"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-lg")})}),(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2 group-hover:text-blue-600 transition-colors",children:e.title}),(0,ze.jsx)("p",{className:"text-gray-600 leading-relaxed",children:e.description})]}),(0,ze.jsx)("div",{className:"flex-shrink-0",children:(0,ze.jsx)("i",{className:"fas fa-arrow-right text-gray-400 group-hover:text-blue-500 transition-colors"})})]})},e.id))})}),(0,ze.jsxs)("div",{className:"p-6 border-t bg-gray-50 flex justify-between",children:[(0,ze.jsxs)("div",{className:"text-sm text-gray-500",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle mr-2"}),"You'll be taken to the relevant page to set up your deadline"]}),(0,ze.jsx)("button",{onClick:s,className:"px-6 py-2 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 font-medium",children:"Cancel"})]})]})})},Qa=()=>{const e=ae(),{user:t,selectedCompany:s}=Be(),{selectedLocation:a}=ya(),n=()=>["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"][(new Date).getMonth()],[l,i]=(0,r.useState)("".concat(n()," 2025")),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)(!0),[m,f]=(0,r.useState)(null),[x,p]=(0,r.useState)(0),[h,g]=(0,r.useState)("Scope 2"),[y,b]=(0,r.useState)({isOpen:!1,type:"",data:{}}),[v,j]=(0,r.useState)(!1),w=null===s||void 0===s?void 0:s.id,N=async()=>{if(!w)return console.log("No company selected, skipping dashboard data fetch"),null;try{const e="all"!==(null===a||void 0===a?void 0:a.id)&&null!==a&&void 0!==a&&a.id?"".concat(Ue,"/api/dashboard/?company_id=").concat(w,"&site_id=").concat(a.id):"".concat(Ue,"/api/dashboard/?company_id=").concat(w),t="all"!==(null===a||void 0===a?void 0:a.id)&&null!==a&&void 0!==a&&a.id?"".concat(Ue,"/api/companies/").concat(w,"/frameworks/?site_id=").concat(a.id):"".concat(Ue,"/api/companies/").concat(w,"/frameworks/"),s="all"!==(null===a||void 0===a?void 0:a.id)&&null!==a&&void 0!==a&&a.id?"".concat(Ue,"/api/companies/").concat(w,"/progress/?site_id=").concat(a.id):"".concat(Ue,"/api/companies/").concat(w,"/progress/"),[n,r,l]=await Promise.all([fetch(e,{credentials:"include"}),fetch(s,{credentials:"include"}),fetch(t,{credentials:"include"})]),i=await n.json(),o=await r.json(),c=await l.json();return Me(Me({},i),{},{progress:o,frameworks:Array.isArray(c)?c:c.results||[]})}catch(e){return console.error("Error fetching dashboard data:",e),null}},k=async()=>{if(!w)return console.log("No company selected, skipping chart data fetch"),{meters:[],dataEntries:[]};try{const r=new Date;let i=[];if("Last Quarter"===l){const e=r.getMonth()+1;for(let t=2;t>=0;t--){let s=e-t,a=r.getFullYear();s<=0&&(s+=12,a-=1),i.push({year:a,month:s})}}else if("Last Year"===l){const e=r.getFullYear();for(let t=1;t<=12;t++)i.push({year:e,month:t})}else if(!l.includes("2025")||l.includes("Quarter")||l.includes("Last"))i.push({year:r.getFullYear(),month:r.getMonth()+1});else{const e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],t=l.split(" ")[0],s=e.indexOf(t);-1!==s&&i.push({year:2025,month:s+1})}console.log("\ud83d\udcc5 Fetching data for time range: ".concat(l)),console.log("\ud83d\uddd3\ufe0f Target months:",i.map(e=>"".concat(e.year,"-").concat(e.month.toString().padStart(2,"0")))),console.log("\ud83d\udccd Selected location: ".concat(null===a||void 0===a?void 0:a.id," (").concat((null===a||void 0===a?void 0:a.name)||"All Locations",")"));const o="all"!==(null===a||void 0===a?void 0:a.id)&&null!==a&&void 0!==a&&a.id?"".concat(Ue,"/api/meters/?company_id=").concat(w,"&site_id=").concat(a.id):"".concat(Ue,"/api/meters/?company_id=").concat(w),c=i.map(e=>{let{year:t,month:s}=e;const n="all"!==(null===a||void 0===a?void 0:a.id)&&null!==a&&void 0!==a&&a.id?"".concat(Ue,"/api/data-collection/tasks/?company_id=").concat(w,"&site_id=").concat(a.id,"&year=").concat(t,"&month=").concat(s):"".concat(Ue,"/api/data-collection/tasks/?company_id=").concat(w,"&year=").concat(t,"&month=").concat(s);return console.log("\ud83d\udd17 Fetching: ".concat(n)),fetch(n,{credentials:"include"})}),[d,...u]=await Promise.all([fetch(o,{credentials:"include"}),...c]),m=await d.json(),f=[];for(let e=0;e<u.length;e++){const t=u[e],s=await t.json();Array.isArray(s)&&("all"===(null===a||void 0===a?void 0:a.id)?s.forEach(e=>{const t=f.find(t=>{var s,a;return(null===(s=t.site)||void 0===s?void 0:s.id)===(null===(a=e.site)||void 0===a?void 0:a.id)});t?e.tasks&&Array.isArray(e.tasks)&&t.tasks.push(...e.tasks):f.push(Me(Me({},e),{},{tasks:e.tasks?[...e.tasks]:[]}))}):f.push(...s))}const x=f;var e,t,s,n;if(console.log("\ud83d\udcca Combined data from ".concat(i.length," months")),console.log("\ud83d\udcca Final data structure:","all"===(null===a||void 0===a?void 0:a.id)?"Grouped by site":"Flat array"),console.log("\ud83d\udcca Data entries after combination:",(null===x||void 0===x?void 0:x.length)||0),console.log("\ud83d\udcca RAW API RESPONSE - Meters:",m),console.log("\ud83d\udcca RAW API RESPONSE - Data Entries:",x),console.log("\ud83d\udcca Data entries count:",(null===x||void 0===x?void 0:x.length)||0),x&&x.length>0)console.log("\ud83d\udcca FULL STRUCTURE - First data entry:",JSON.stringify(x[0],null,2)),console.log("\ud83d\udcca Available keys in first entry:",Object.keys(x[0]||{})),console.log("\ud83d\udcca Value field check:",null===(e=x[0])||void 0===e?void 0:e.value,typeof(null===(t=x[0])||void 0===t?void 0:t.value)),console.log("\ud83d\udcca Meter field check:",null===(s=x[0])||void 0===s?void 0:s.meter,typeof(null===(n=x[0])||void 0===n?void 0:n.meter));return{meters:m.results||m,dataEntries:x||[]}}catch(r){return console.error("Error fetching chart data:",r),{meters:[],dataEntries:[]}}};(0,r.useEffect)(()=>{(async()=>{u(!0);try{const[e,t]=await Promise.all([N(),k()]);c(e),f(t)}catch(e){console.error("Error loading dashboard:",e),c(null),f(null)}finally{u(!1)}})()},[w,l,a]);const S=(0,r.useCallback)(()=>{if(null===m||void 0===m||!m.dataEntries)return[];const e=[];if("all"===(null===a||void 0===a?void 0:a.id))m.dataEntries.forEach(t=>{t.tasks&&Array.isArray(t.tasks)&&t.tasks.forEach(s=>{if(s.meter&&s.submission&&s.submission.value&&parseFloat(s.submission.value)>0){var a;const l="".concat(s.meter.type,"|").concat((null===(a=t.site)||void 0===a?void 0:a.name)||"Unknown");var n,r;if(!e.some(e=>e.key===l))e.push({key:l,type:s.meter.type,siteName:(null===(n=t.site)||void 0===n?void 0:n.name)||"Unknown",displayName:"".concat(s.meter.type," - ").concat((null===(r=t.site)||void 0===r?void 0:r.name)||"Unknown")})}})});else{const t=new Set;m.dataEntries.forEach(e=>{e.meter&&e.submission&&e.submission.value&&parseFloat(e.submission.value)>0&&t.add(e.meter.type)}),Array.from(t).forEach(t=>{e.push({key:"".concat(t,"|").concat(null===a||void 0===a?void 0:a.name),type:t,siteName:null===a||void 0===a?void 0:a.name,displayName:"".concat(t," - ").concat(null===a||void 0===a?void 0:a.name)})})}return e},[m,a]),C=(0,r.useCallback)(e=>{const t=S();t.length<=1||p("next"===e?e=>(e+1)%t.length:e=>(e-1+t.length)%t.length)},[S]);(0,r.useEffect)(()=>{const e=e=>{if(!m||!m.dataEntries)return;S().length<=1||("ArrowLeft"===e.key?(e.preventDefault(),C("prev")):"ArrowRight"===e.key&&(e.preventDefault(),C("next")))};return window.addEventListener("keydown",e),()=>window.removeEventListener("keydown",e)},[m,C]);const _=o?(e=>{let t="",s=o.total_data_elements||0,a=0;switch(l){case"Last 7 Days":t="7d",s=(null===m||void 0===m||null===(e=m.dataEntries)||void 0===e?void 0:e.filter(e=>{var t;return null===(t=e.submission)||void 0===t?void 0:t.value}).length)||0,a=15.2;break;default:l.includes("2025")&&!l.includes("Quarter")&&(t="30d",s=o.total_data_elements||0,a=8.5);break;case"Last Quarter":t="Q3",s=o.total_data_elements||0,a=-2.1;break;case"Last Year":t="12m",s=o.total_data_elements||0,a=24.7}return[{title:"Data Points (".concat(t,")"),value:s,unit:"items",change:a,trend:a>=0?"up":"down",color:"blue",icon:"fas fa-database"},{title:"Active Meters",value:o.active_meters||"0",unit:"units",change:0,trend:"up",color:"green",icon:"fas fa-gauge"},{title:"Frameworks",value:o.total_frameworks||"0",unit:"active",change:0,trend:"up",color:"purple",icon:"fas fa-list-check"},{title:"Completeness (".concat(t,")"),value:Math.round(o.data_completeness_percentage||0),unit:"%",change:"Last 7 Days"===l?5.2:l.includes("2025")&&!l.includes("Quarter")?3.1:"Last Quarter"===l?-1.5:11,trend:"Last Quarter"===l?"down":"up",color:"yellow",icon:"fas fa-chart-pie"}]})():[{title:"Energy Consumption",value:"2,450",unit:"kWh",change:-12.5,trend:"down",color:"yellow",icon:"fas fa-bolt"},{title:"Water Usage",value:"1,250",unit:"L/day",change:8.2,trend:"up",color:"blue",icon:"fas fa-tint"},{title:"GHG Emissions",value:"245",unit:"tCO2e",change:-15.7,trend:"down",color:"gray",icon:"fas fa-smog"},{title:"Waste Generated",value:"89",unit:"kg/day",change:-22.1,trend:"down",color:"green",icon:"fas fa-trash-alt"}],E=(()=>{const e=Math.round((null===o||void 0===o?void 0:o.data_completeness_percentage)||0);return null!==o&&void 0!==o&&o.frameworks&&Array.isArray(o.frameworks)?o.frameworks.map(t=>({name:t.name||t.framework_id||"Unknown Framework",progress:e,color:e<30?"red":e<70?"orange":"green",status:e<30?"Just Started":e<70?"In Progress":"On Track",type:t.type||("DST"===t.framework_id?"mandatory_conditional":"mandatory"),framework_id:t.framework_id})):[]})(),P=(null===o||void 0===o?void 0:o.recent_activities)||(()=>{const e=[];let t=1;if(null!==m&&void 0!==m&&m.dataEntries){"all"===(null===a||void 0===a?void 0:a.id)?m.dataEntries.forEach(s=>{s.tasks&&Array.isArray(s.tasks)&&s.tasks.forEach(a=>{if(a.submission&&a.submission.value&&parseFloat(a.submission.value)>0){var n,r;const l=new Date(a.submission.updated_at||a.submission.created_at),i=Math.floor((new Date-l)/36e5),o=i<1?"Just now":i<24?"".concat(i," hours ago"):"".concat(Math.floor(i/24)," days ago");e.push({id:t++,action:"".concat((null===(n=a.meter)||void 0===n?void 0:n.type)||a.element_name," data submitted"),description:"Value: ".concat(parseFloat(a.submission.value).toLocaleString()," ").concat(a.element_unit).concat(null!==(r=s.site)&&void 0!==r&&r.name?" (Site: ".concat(s.site.name,")"):""),time:o,submissionDate:l,type:"data",icon:"fas fa-chart-line",color:"green"})}})}):m.dataEntries.forEach(s=>{if(s.submission&&s.submission.value&&parseFloat(s.submission.value)>0){var n;const r=new Date(s.submission.updated_at||s.submission.created_at),l=Math.floor((new Date-r)/36e5),i=l<1?"Just now":l<24?"".concat(l," hours ago"):"".concat(Math.floor(l/24)," days ago");e.push({id:t++,action:"".concat((null===(n=s.meter)||void 0===n?void 0:n.type)||s.element_name," data submitted"),description:"Value: ".concat(parseFloat(s.submission.value).toLocaleString()," ").concat(s.element_unit," (Site: ").concat((null===a||void 0===a?void 0:a.name)||"Current",")"),time:i,submissionDate:r,type:"data",icon:"fas fa-chart-line",color:"green"})}})}if(null!==o&&void 0!==o&&o.progress){const s=o.progress;s.module_5_complete&&e.push({id:t++,action:"Data collection completed",description:"".concat(Math.round(o.data_completeness_percentage||0),"% data completeness achieved"),time:"2 hours ago",type:"milestone",icon:"fas fa-trophy",color:"yellow"}),s.module_4_complete&&e.push({id:t++,action:"Smart meters activated",description:"".concat(o.active_meters||0," meters configured and monitoring"),time:"1 day ago",type:"system",icon:"fas fa-gauge",color:"blue"}),s.module_3_complete&&e.push({id:t++,action:"ESG profiling completed",description:"Company sustainability profile generated",time:"2 days ago",type:"completion",icon:"fas fa-user-check",color:"purple"}),s.module_2_complete&&e.push({id:t++,action:"Frameworks configured",description:"".concat(o.total_frameworks||0," ESG frameworks activated"),time:"3 days ago",type:"setup",icon:"fas fa-list-check",color:"indigo"})}return e.sort((e,t)=>e.submissionDate&&t.submissionDate?t.submissionDate-e.submissionDate:"data"===e.type&&"data"!==t.type?-1:"data"===t.type&&"data"!==e.type?1:e.time.includes("hour")?-1:1).slice(0,4)})(),A=(null===o||void 0===o?void 0:o.upcoming_deadlines)||(()=>{const e=[],t=new Date;null!==o&&void 0!==o&&o.frameworks&&o.frameworks.forEach(s=>{const a=E.find(e=>e.name===s.name);if(a){let n,r;"mandatory"===s.type?(n=30,r=a.progress<80?"High":"Medium"):"mandatory_conditional"===s.type?(n=45,r=a.progress<70?"High":"Medium"):(n=90,r=a.progress<50?"Medium":"Low");const l=new Date(t);l.setDate(t.getDate()+n),e.push({name:"".concat(s.name," Compliance Report"),date:l.toISOString().split("T")[0],daysLeft:n,priority:r,type:"framework"})}});const s=t.getMonth()+1,a=t.getFullYear(),n=new Date(a,s,0),r=Math.ceil((n-t)/864e5);if(r>0&&r<=31){const t=(null===o||void 0===o?void 0:o.data_completeness_percentage)||0;e.push({name:"".concat(n.toLocaleDateString("en-US",{month:"long"})," Data Collection"),date:n.toISOString().split("T")[0],daysLeft:r,priority:t<50?"High":t<80?"Medium":"Low",type:"data"})}const l=[3,6,9,12].find(e=>e>s)||12,i=new Date(a,l-1,new Date(a,l,0).getDate()),c=Math.ceil((i-t)/864e5);c>0&&c<=120&&e.push({name:"Q".concat(Math.ceil(l/3)," ESG Quarterly Report"),date:i.toISOString().split("T")[0],daysLeft:c,priority:c<=30?"High":c<=60?"Medium":"Low",type:"quarterly"});const d=new Date(a,11,31),u=Math.ceil((d-t)/864e5);return u>0&&u<=365&&e.push({name:"Annual ESG Compliance Audit",date:d.toISOString().split("T")[0],daysLeft:u,priority:u<=90?"High":u<=180?"Medium":"Low",type:"annual"}),e.sort((e,t)=>e.daysLeft-t.daysLeft).slice(0,4)})(),T=e=>{switch(e){case"High":return"text-red-600 bg-red-100";case"Medium":return"text-yellow-600 bg-yellow-100";case"Low":return"text-green-600 bg-green-100";default:return"text-gray-600 bg-gray-100"}},L=async()=>{try{var e;const t=Math.round((null===o||void 0===o?void 0:o.data_completeness_percentage)||0),s=Math.round((null===o||void 0===o?void 0:o.evidence_completeness_percentage)||0),a=(new Date).toISOString().split("T")[0],n=l,r=[["ESG Dashboard Report - Generated on",(new Date).toLocaleDateString()],["Company","Emirates Hotels Group"],["Report Period",n],[""],["=== OVERVIEW METRICS (".concat(n,") ===")],["Metric","Value","Unit"],["Total Data Elements",(null===o||void 0===o?void 0:o.total_data_elements)||"0","items"],["Active Meters",(null===o||void 0===o?void 0:o.active_meters)||"0","units"],["Total Frameworks",(null===o||void 0===o?void 0:o.total_frameworks)||"0","active"],["Data Completeness","".concat(t,"%"),t<100?"\u26a0\ufe0f INCOMPLETE":"\u2713 Complete"],["Evidence Completeness","".concat(s,"%"),s<100?"\u26a0\ufe0f INCOMPLETE":"\u2713 Complete"],[""],["=== FRAMEWORK PROGRESS ==="],["Framework","Progress (%)","Status","Type"]];if(null!==o&&void 0!==o&&o.frameworks&&E.forEach(e=>{const t=o.frameworks.find(t=>t.name===e.name);r.push([e.name,e.progress,e.status,(null===t||void 0===t?void 0:t.type)||"N/A"])}),null!==m&&void 0!==m&&m.meters){let e="";switch(l){case"Last 7 Days":e="PAST 7 DAYS";break;case"Last Quarter":{const t=(new Date).getMonth(),s=["JAN","FEB","MAR","APR","MAY","JUN","JUL","AUG","SEP","OCT","NOV","DEC"],a=s[(t-2+12)%12],n=(s[(t-1+12)%12],s[t]),r=Math.ceil((t+1)/3);e="Q".concat(r," 2025 (").concat(a,"-").concat(n,")")}break;case"Last Year":e="YEAR 2025";break;default:e=l.includes("2025")&&!l.includes("Quarter")?"".concat(l.toUpperCase()):"AUGUST 2025"}r.push([""],["=== METER DATA (".concat(e,") ===")],["Meter","Type","Value","Status","Completeness"]),m.meters.forEach(e=>{var t,s;const a=m.dataEntries.find(t=>t.meter&&t.meter.id===e.id),n=(null===a||void 0===a||null===(t=a.submission)||void 0===t?void 0:t.value)||"0",l=(null===a||void 0===a||null===(s=a.submission)||void 0===s?void 0:s.status)||"missing",i=n&&"0"!==n?"\u2713":"\u26a0\ufe0f MISSING";r.push([e.name,e.type,n,l,i])});const t=m.meters.length,s=m.meters.filter(e=>{let t=!1;return m.dataEntries.forEach(s=>{s.tasks&&Array.isArray(s.tasks)&&s.tasks.forEach(s=>{s.meter&&s.meter.id===e.id&&s.submission&&s.submission.value&&"0"!==s.submission.value&&(t=!0)})}),t}).length;r.push([""],["METER SUMMARY","".concat(s," of ").concat(t," meters have data"),"","".concat(Math.round(s/t*100),"% complete")])}r.push([""],["=== UPCOMING DEADLINES ==="],["Deadline","Date","Days Left","Priority"]),A.forEach(e=>{r.push([e.name,e.date,e.daysLeft,e.priority])});const i=r.map(e=>e.map(e=>'"'.concat(e,'"')).join(",")).join("\n"),c=l.toLowerCase().replace(/ /g,"-"),d="esg-report-".concat(c,"-").concat(a,".csv"),u=new Blob([i],{type:"text/csv;charset=utf-8;"}),f=window.URL.createObjectURL(u),x=document.createElement("a");x.href=f,x.download=d,document.body.appendChild(x),x.click(),document.body.removeChild(x),window.URL.revokeObjectURL(f),b({isOpen:!0,type:"success",data:{type:"success",title:"Export Successful",filename:d,period:n,completeness:t,includes:["Overview metrics for ".concat(n),"Framework progress (".concat(E.length," frameworks)"),"Meter data (".concat((null===m||void 0===m||null===(e=m.meters)||void 0===e?void 0:e.length)||0," meters)"),"Upcoming deadlines"]}})}catch(t){console.error("Export failed:",t),b({isOpen:!0,type:"error",data:{type:"error",title:"Export Failed",message:"The export failed. Please try again or contact support."}})}},O=async()=>{const e=Math.round((null===o||void 0===o?void 0:o.data_completeness_percentage)||0),t=Math.round((null===o||void 0===o?void 0:o.evidence_completeness_percentage)||0);if(e<100||t<100){var s;const a=[];e<100&&a.push("Data completeness: ".concat(e,"% (").concat(100-e,"% missing)")),t<100&&a.push("Evidence completeness: ".concat(t,"% (").concat(100-t,"% missing)"));const n=(null===m||void 0===m||null===(s=m.meters)||void 0===s?void 0:s.filter(e=>{var t;const s=m.dataEntries.find(t=>t.meter&&t.meter.id===e.id);return!(null!==s&&void 0!==s&&null!==(t=s.submission)&&void 0!==t&&t.value)}))||[];return n.length>0&&a.push("".concat(n.length," meters have no data submitted")),void b({isOpen:!0,type:"warning",data:{type:"warning",title:"Incomplete Data Warning",message:"Your ESG data is incomplete. The report will be missing important information.",missingItems:a,missingMeters:n.map(e=>e.type)}})}L()},R=()=>{b({isOpen:!1,type:"",data:{}})};return d?(0,ze.jsx)("div",{className:"max-w-7xl mx-auto flex items-center justify-center h-64",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin text-4xl text-blue-600 mb-4"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):(0,ze.jsxs)("div",{className:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8",children:[(0,ze.jsx)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-4",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ze.jsxs)("button",{onClick:()=>e("/"),className:"flex items-center text-gray-600 hover:text-gray-800 transition-colors",children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),(0,ze.jsx)("span",{className:"hidden sm:inline",children:"Back to Main"}),(0,ze.jsx)("span",{className:"sm:hidden",children:"Back"})]}),(0,ze.jsx)("h1",{className:"text-xl sm:text-2xl font-bold text-gray-900",children:"ESG Dashboard"})]})}),(0,ze.jsxs)("div",{className:"flex flex-col lg:flex-row lg:items-center justify-between mb-8 gap-4",children:[(0,ze.jsx)("div",{className:"flex flex-wrap gap-2 sm:gap-4",children:["Last 7 Days","".concat(n()," 2025"),"Last Quarter","Last Year"].map(e=>(0,ze.jsx)("button",{className:"px-3 sm:px-4 py-2 rounded-lg font-medium text-xs sm:text-sm transition-colors ".concat(l===e?"bg-blue-600 text-white":"bg-gray-100 text-gray-600 hover:bg-gray-200"),onClick:()=>i(e),children:e},e))}),(0,ze.jsxs)("div",{className:"flex flex-wrap gap-2 sm:gap-3",children:[(0,ze.jsxs)("button",{onClick:O,className:"px-3 sm:px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 text-xs sm:text-sm font-medium transition-colors",children:[(0,ze.jsx)("i",{className:"fas fa-download mr-1 sm:mr-2"}),(0,ze.jsx)("span",{children:"Export"})]}),(0,ze.jsxs)("button",{onClick:O,className:"px-3 sm:px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-xs sm:text-sm font-medium transition-colors",children:[(0,ze.jsx)("i",{className:"fas fa-file-chart-line mr-1 sm:mr-2"}),(0,ze.jsx)("span",{className:"hidden sm:inline",children:"Generate Report"}),(0,ze.jsx)("span",{className:"sm:hidden",children:"Report"})]})]})]}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:_.map((e,t)=>(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("div",{className:"w-12 h-12 bg-".concat(e.color,"-100 rounded-lg flex items-center justify-center"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-lg")})}),(0,ze.jsxs)("div",{className:"flex items-center text-sm font-medium ".concat("up"===e.trend?"text-red-600":"text-green-600"),children:[(0,ze.jsx)("i",{className:"fas fa-arrow-".concat(e.trend," mr-1")}),Math.abs(e.change),"%"]})]}),(0,ze.jsx)("h3",{className:"font-semibold text-gray-900 mb-1",children:e.title}),(0,ze.jsxs)("div",{className:"flex items-baseline space-x-2",children:[(0,ze.jsx)("span",{className:"text-2xl font-bold text-gray-900",children:e.value}),(0,ze.jsx)("span",{className:"text-sm text-gray-500",children:e.unit})]})]},t))}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-3 gap-6 lg:gap-8 mb-8",children:[(0,ze.jsxs)("div",{className:"xl:col-span-2 bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-2",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-lg sm:text-xl font-bold text-gray-900",children:"Framework Compliance"}),(0,ze.jsx)("p",{className:"text-sm sm:text-base text-gray-600",children:"Progress across selected ESG frameworks"})]}),(0,ze.jsx)("button",{onClick:()=>e("/rame"),className:"text-blue-600 hover:text-blue-800 text-xs sm:text-sm font-medium transition-colors self-start sm:self-auto",children:"View Details"})]}),(0,ze.jsx)("div",{className:"space-y-4",children:E.map((e,t)=>(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:e.name}),(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("span",{className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium ".concat("Complete"===e.status?"bg-green-100 text-green-800":"On Track"===e.status?"bg-blue-100 text-blue-800":"Needs Attention"===e.status?"bg-yellow-100 text-yellow-800":"bg-red-100 text-red-800"),children:e.status}),(0,ze.jsxs)("span",{className:"text-sm font-bold text-gray-900",children:[e.progress,"%"]})]})]}),(0,ze.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,ze.jsx)("div",{className:"bg-".concat(e.color,"-500 h-2 rounded-full"),style:{width:"".concat(e.progress,"%")}})})]},t))})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200",children:[(0,ze.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-base sm:text-lg font-bold text-gray-900",children:"Recent Activity"}),(0,ze.jsx)("p",{className:"text-gray-600 text-xs sm:text-sm",children:"Latest system updates"})]})}),(0,ze.jsx)("div",{className:"space-y-4",children:P.map(e=>(0,ze.jsxs)("div",{className:"flex items-start space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-".concat(e.color,"-100 rounded-full flex items-center justify-center flex-shrink-0"),children:(0,ze.jsx)("i",{className:"".concat(e.icon," text-").concat(e.color,"-600 text-xs")})}),(0,ze.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900 text-sm",children:e.action}),(0,ze.jsx)("p",{className:"text-gray-600 text-xs mt-1",children:e.description}),(0,ze.jsx)("p",{className:"text-gray-400 text-xs mt-1",children:e.time})]})]},e.id))})]})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 xl:grid-cols-2 gap-6 lg:gap-8 mb-8",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-4 sm:p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex flex-col sm:flex-row sm:items-center justify-between mb-6 gap-2",children:[(0,ze.jsxs)("div",{className:"flex-1 min-w-0",children:[(0,ze.jsx)("h3",{className:"text-base sm:text-lg font-bold text-gray-900",children:"Meter Data Analytics"}),(0,ze.jsx)("div",{className:"h-5",children:(0,ze.jsx)("p",{className:"text-gray-600 text-xs sm:text-sm truncate",children:(()=>{const e=S();if(0===e.length)return"No data available";return e[x%e.length].displayName})()})})]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2 sm:space-x-4 self-start sm:self-auto",children:[(()=>{const e=S();return e.length<=1?null:(0,ze.jsxs)("span",{className:"text-sm text-gray-500",children:[x%e.length+1," of ",e.length]})})(),(0,ze.jsx)("span",{className:"px-3 py-1 bg-blue-100 text-blue-800 rounded-full text-xs font-medium",children:(()=>{const e=S();if(0===e.length)return"Units";const t=e[x%e.length].type;return null!==t&&void 0!==t&&t.includes("Electricity")?"kWh":null!==t&&void 0!==t&&t.includes("Fuel")||null!==t&&void 0!==t&&t.includes("Water")?"Liters":"Units"})()})]})]}),(0,ze.jsxs)("div",{className:"h-48 sm:h-64 bg-gray-50 rounded-lg p-2 sm:p-4 relative group",children:[S().length<=1?null:(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("button",{onClick:()=>C("prev"),className:"absolute left-2 top-1/2 transform -translate-y-1/2 z-10\r p-2 bg-white/90 hover:bg-white rounded-full shadow-lg\r opacity-0 group-hover:opacity-100 transition-all duration-200\r hover:scale-110",title:"Previous meter type",children:(0,ze.jsx)("i",{className:"fas fa-chevron-left text-gray-700 text-sm"})}),(0,ze.jsx)("button",{onClick:()=>C("next"),className:"absolute right-2 top-1/2 transform -translate-y-1/2 z-10\r p-2 bg-white/90 hover:bg-white rounded-full shadow-lg\r opacity-0 group-hover:opacity-100 transition-all duration-200\r hover:scale-110",title:"Next meter type",children:(0,ze.jsx)("i",{className:"fas fa-chevron-right text-gray-700 text-sm"})})]}),m?(0,ze.jsx)(Wa,{chartData:(()=>{let e=[];switch(l){case"Last 7 Days":e=["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];break;case"Last Quarter":{const t=(new Date).getMonth(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];e=[s[(t-2+12)%12],s[(t-1+12)%12],s[t]]}break;case"Last Year":e=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];break;default:e=l.includes("2025")&&!l.includes("Quarter")?["Week 1","Week 2","Week 3","Week 4","Current"]:["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug"]}if(!m||!m.dataEntries)return{labels:e,data:e.map(()=>0)};const t=S();if(0===t.length)return{labels:e,data:e.map(()=>0)};const s=t[x%t.length],n="all"===(null===a||void 0===a?void 0:a.id);console.log("\ud83d\udcca Selected meter: ".concat(s.displayName," (index ").concat(x,", available: ").concat(t.length,")"));let r=0;if(console.log("\ud83d\udcca Processing data entries: ".concat(m.dataEntries.length)),n)m.dataEntries.forEach(e=>{e.tasks&&Array.isArray(e.tasks)&&e.tasks.forEach(t=>{var a;if(t.meter&&t.meter.type===s.type&&(null===(a=e.site)||void 0===a?void 0:a.name)===s.siteName&&t.submission&&t.submission.value){var n;const s=parseFloat(t.submission.value);console.log("  Found ".concat(t.meter.type,': value="').concat(t.submission.value,'", parsed=').concat(s," (site: ").concat(null===(n=e.site)||void 0===n?void 0:n.name,")")),s>0&&(r+=s)}})});else if("Last Quarter"===l||"Last Year"===l){var i;let e=0,t=null;m.dataEntries.forEach(a=>{if(a.meter&&a.meter.type===s.type&&a.submission&&a.submission.value){const s=parseFloat(a.submission.value),n=new Date(a.submission.updated_at||a.submission.created_at);console.log("  Found ".concat(a.meter.type,': value="').concat(a.submission.value,'", parsed=').concat(s,", date=").concat(n.toISOString()," (site: specific)")),s>0&&(!t||n>t)&&(e=s,t=n)}}),r=e,console.log("  \ud83d\udcc5 Using latest value: ".concat(r," from ").concat(null===(i=t)||void 0===i?void 0:i.toISOString()))}else m.dataEntries.forEach(e=>{if(e.meter&&e.meter.type===s.type&&e.submission&&e.submission.value){const t=parseFloat(e.submission.value);console.log("  Found ".concat(e.meter.type,': value="').concat(e.submission.value,'", parsed=').concat(t," (site: specific)")),t>0&&(r+=t)}});console.log("\ud83d\udcca Total aggregated value for ".concat(s.displayName,": ").concat(r));const o=e.map(()=>0);if("Last Quarter"===l||"Last Year"===l){console.log("\ud83d\udcca Distributing data across month columns for ".concat(l));const e={};n?m.dataEntries.forEach(t=>{t.tasks&&Array.isArray(t.tasks)&&t.tasks.forEach(a=>{var n;if(a.meter&&a.meter.type===s.type&&(null===(n=t.site)||void 0===n?void 0:n.name)===s.siteName&&a.submission&&a.submission.value){const t=parseFloat(a.submission.value),s=a.submission.reporting_period;t>0&&s&&(e[s]||(e[s]=0),e[s]+=t,console.log("  \ud83d\udcc5 ".concat(s,": +").concat(t," = ").concat(e[s])))}})}):m.dataEntries.forEach(t=>{if(t.meter&&t.meter.type===s.type&&t.submission&&t.submission.value){const s=parseFloat(t.submission.value),a=t.submission.reporting_period;s>0&&a&&(e[a]||(e[a]=0),e[a]+=s,console.log("  \ud83d\udcc5 ".concat(a,": +").concat(s," = ").concat(e[a])))}});const t=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];if("Last Quarter"===l){const t=(new Date).getMonth(),s=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"],a=[s[(t-2+12)%12],s[(t-1+12)%12],s[t]];console.log("  \ud83d\udcca Quarter months mapping: ".concat(a)),a.forEach((t,s)=>{e[t]&&(o[s]=e[t],console.log("  \ud83d\udcca ".concat(t," \u2192 data[").concat(s,"] = ").concat(e[t])))})}else"Last Year"===l&&t.forEach((t,s)=>{e[t]&&(o[s]=e[t],console.log("  \ud83d\udcca ".concat(t," \u2192 data[").concat(s,"] = ").concat(e[t])))})}else r>0&&(o[o.length-1]=r);return{labels:e,data:o}})(),meterType:(()=>{const e=S();if(0===e.length)return null;return e[x%e.length].type})()}):(0,ze.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin text-2xl text-blue-600 mb-2"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Loading chart data..."})]})})]})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-lg font-bold text-gray-900",children:"GHG Emissions Breakdown"}),(0,ze.jsx)("p",{className:"text-gray-600 text-sm",children:"By source category (tCO2e)"})]}),(0,ze.jsx)("div",{className:"flex space-x-2",children:["Scope 1","Scope 2","Scope 3"].map(e=>(0,ze.jsx)("button",{onClick:()=>g(e),className:"px-3 py-1 rounded-full text-xs font-medium transition-colors ".concat(h===e?"bg-blue-100 text-blue-800":"bg-gray-100 text-gray-600 hover:bg-gray-200"),children:e},e))})]}),(0,ze.jsx)("div",{className:"h-64 bg-gray-50 rounded-lg p-4",children:m?(0,ze.jsx)(qa,{emissionsData:(()=>{if(!m||!m.dataEntries)return{"Scope 1":{value:0,color:"#ef4444",items:[]},"Scope 2":{value:0,color:"#3b82f6",items:[]},"Scope 3":{value:0,color:"#6b7280",items:[]}};const e={"Scope 1":{value:0,color:"#ef4444",items:[]},"Scope 2":{value:0,color:"#3b82f6",items:[]},"Scope 3":{value:0,color:"#6b7280",items:[]}};return"all"===(null===a||void 0===a?void 0:a.id)?m.dataEntries.forEach(t=>{t.tasks&&Array.isArray(t.tasks)&&t.tasks.forEach(t=>{if(t.meter&&t.submission&&t.submission.value){const s=t.meter.type.toLowerCase(),a=parseFloat(t.submission.value)||0,n=t.meter.type;s.includes("fuel")||s.includes("gas")||s.includes("lpg")?(e["Scope 1"].value+=2.3*a,e["Scope 1"].items.push(n)):s.includes("electricity")||s.includes("energy")||s.includes("renewable")?(e["Scope 2"].value+=.85*a,e["Scope 2"].items.push(n)):(e["Scope 3"].value+=.1*a,e["Scope 3"].items.push(n))}})}):m.dataEntries.forEach(t=>{if(t.meter&&t.submission&&t.submission.value){const s=t.meter.type.toLowerCase(),a=parseFloat(t.submission.value)||0,n=t.meter.type;s.includes("fuel")||s.includes("gas")||s.includes("lpg")?(e["Scope 1"].value+=2.3*a,e["Scope 1"].items.push(n)):s.includes("electricity")||s.includes("energy")||s.includes("renewable")?(e["Scope 2"].value+=.85*a,e["Scope 2"].items.push(n)):(e["Scope 3"].value+=.1*a,e["Scope 3"].items.push(n))}}),Object.keys(e).forEach(t=>{e[t].items=[...new Set(e[t].items)]}),e})(),selectedScope:h}):(0,ze.jsx)("div",{className:"flex items-center justify-center h-full",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin text-2xl text-blue-600 mb-2"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Loading emissions data..."})]})})})]})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200 mb-8",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Upcoming Deadlines"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Important compliance and reporting dates"})]}),(0,ze.jsxs)("button",{onClick:()=>{j(!0)},className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 text-sm font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-calendar-plus mr-2"}),"Add Deadline"]})]}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4",children:A.map((t,s)=>(0,ze.jsxs)("div",{onClick:()=>(t=>{switch(t.type){case"framework":e("/rame");break;case"data":e("/data");break;case"quarterly":case"annual":e("/dashboard");break;default:e("/list")}})(t),className:"border border-gray-200 rounded-lg p-4 cursor-pointer hover:border-blue-300 hover:shadow-md transition-all duration-200",title:"Click to manage ".concat(t.type," tasks"),children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-2",children:[(0,ze.jsx)("span",{className:"inline-flex items-center px-2 py-1 rounded-full text-xs font-medium ".concat(T(t.priority)),children:t.priority}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsxs)("span",{className:"text-sm text-gray-500",children:[t.daysLeft," days"]}),(0,ze.jsx)("i",{className:"fas fa-external-link-alt text-xs text-gray-400"})]})]}),(0,ze.jsx)("h4",{className:"font-semibold text-gray-900 mb-1 hover:text-blue-600 transition-colors",children:t.name}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:t.date}),t.type&&(0,ze.jsxs)("p",{className:"text-xs text-gray-500 mt-2 capitalize",children:[t.type," deadline"]})]},s))})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsx)("div",{className:"flex items-center justify-between mb-6",children:(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-xl font-bold text-gray-900",children:"Quick Actions"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Common tasks and shortcuts"})]})}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-3 lg:grid-cols-6 gap-4",children:[{icon:"fas fa-upload",title:"Upload Data",color:"blue",path:"/data",description:"Enter ESG data entries"},{icon:"fas fa-file-alt",title:"Generate Report",color:"green",action:"export",description:"Export current data"},{icon:"fas fa-cog",title:"Configure Meters",color:"orange",path:"/meter",description:"Manage meter settings"},{icon:"fas fa-chart-bar",title:"View Analytics",color:"purple",path:"/dashboard",description:"Current page"},{icon:"fas fa-bell",title:"Profiling",color:"red",path:"/rame",description:"Company profiling"},{icon:"fas fa-list",title:"Checklist",color:"gray",path:"/list",description:"ESG checklist"}].map((t,s)=>(0,ze.jsxs)("button",{onClick:()=>(t=>{t.path?e(t.path):"export"===t.action&&O()})(t),className:"p-4 text-center bg-".concat(t.color,"-50 hover:bg-").concat(t.color,"-100 rounded-lg transition-colors group"),title:t.description,children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-".concat(t.color,"-100 group-hover:bg-").concat(t.color,"-200 rounded-lg flex items-center justify-center mx-auto mb-2 transition-colors"),children:(0,ze.jsx)("i",{className:"".concat(t.icon," text-").concat(t.color,"-600")})}),(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-900",children:t.title})]},s))})]}),(0,ze.jsx)(Va,{isOpen:y.isOpen,onClose:R,onConfirm:()=>{R(),L()},data:y.data}),(0,ze.jsx)(Ha,{isOpen:v,onClose:()=>{j(!1)},onSelectType:t=>{switch(j(!1),t){case"data":e("/data");break;case"framework":e("/rame");break;case"checklist":e("/list")}}})]})},$a=()=>{const e=ae();return(0,ze.jsxs)("div",{className:"max-w-7xl mx-auto p-4",children:[(0,ze.jsx)("h1",{className:"text-3xl font-bold text-gray-900 mb-4",children:"Dashboard Test"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"This is a minimal test version to verify the dashboard can render."}),(0,ze.jsx)("button",{onClick:()=>e("/"),className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700",children:"Back to Main"}),(0,ze.jsxs)("div",{className:"mt-8 grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6",children:[(0,ze.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Card 1"}),(0,ze.jsx)("p",{className:"text-2xl font-bold text-blue-600",children:"123"})]}),(0,ze.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Card 2"}),(0,ze.jsx)("p",{className:"text-2xl font-bold text-green-600",children:"456"})]}),(0,ze.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Card 3"}),(0,ze.jsx)("p",{className:"text-2xl font-bold text-purple-600",children:"789"})]}),(0,ze.jsxs)("div",{className:"bg-white p-6 rounded-lg shadow",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Test Card 4"}),(0,ze.jsx)("p",{className:"text-2xl font-bold text-orange-600",children:"101"})]})]})]})},Ja=()=>{var e,t;const{user:s,selectedCompany:a,hasPermission:n}=Be(),[l,i]=(0,r.useState)("month"),[o,c]=(0,r.useState)(null),[d,u]=(0,r.useState)("all"),[m,f]=(0,r.useState)(!0),[x,p]=(0,r.useState)({esgScores:{environmental:{score:null,grade:null,trend:null,metrics:[]},social:{score:null,grade:null,trend:null,metrics:[]},governance:{score:null,grade:null,trend:null,metrics:[]},overall:null},meters:{active:[],inactive:[],alerts:[],consumption:{},trends:{}},emissions:{scope1:{value:null,percentage:null,sources:[]},scope2:{value:null,percentage:null,sources:[]},scope3:{value:null,percentage:null,sources:[]},total:null,intensity:{},opportunities:[]},recentActivities:[],kpiData:[],frameworkData:[]}),h={super_user:["all"],admin:["esg","meters","emissions","activities","frameworks"],site_manager:["esg_limited","meters_site","emissions_site","activities_site"],uploader:["personal_progress","assigned_meters","activities_own"],viewer:["esg_view","meters_view","emissions_view","activities_view"],meter_manager:["meters_full","meter_health","activities_meter"]},g=e=>{const t=h[null===s||void 0===s?void 0:s.role]||[];return t.includes("all")||t.includes(e)};(0,r.useEffect)(()=>{(async()=>{if(null!==a&&void 0!==a&&a.id)try{var e;f(!0),console.log("\ud83d\udd04 Fetching unified dashboard data for company:",a.id);const m=(new Date).getFullYear(),h=(new Date).getMonth()+1,[g,y,b,v,j,w]=await Promise.all([fetch("".concat(Ue,"/api/dashboard/?company_id=").concat(a.id),{credentials:"include"}),fetch("".concat(Ue,"/api/companies/").concat(a.id,"/progress/"),{credentials:"include"}),fetch("".concat(Ue,"/api/companies/").concat(a.id,"/frameworks/"),{credentials:"include"}),fetch("".concat(Ue,"/api/meters/?company_id=").concat(a.id),{credentials:"include"}),fetch("".concat(Ue,"/api/data-collection/tasks/?company_id=").concat(a.id,"&year=").concat(m,"&month=").concat(h),{credentials:"include"}),Ie("".concat(Ue,"/api/data-collection/progress/?company_id=").concat(a.id,"&year=").concat(m,"&month=").concat(h))]);console.log("\ud83d\udcca Unified Dashboard API Response Status:",{dashboard:g.status,progress:y.status,frameworks:b.status,meters:v.status,data:j.status,progressDetail:"made request"});const N=g.ok?await g.json():{},k=y.ok?await y.json():{},S=b.ok?await b.json():{},C=v.ok?await v.json():{},_=j.ok?await j.json():[],E=w.ok?await w.json():{data_progress:0,evidence_progress:0,overall_progress:0};console.log("\ud83d\udd0d Raw API Data:",{dashboard:N,progress:k,frameworksData:S,metersData:C,metersCount:Array.isArray(C)?C.length:(null===C||void 0===C||null===(e=C.results)||void 0===e?void 0:e.length)||0,dataEntriesCount:Array.isArray(_)?_.length:0,progressDetail:E});const P=Me({},x),A=Array.isArray(_)?_.filter(e=>e.value||e.evidence_file):[],T=Array.isArray(_)?_.length:0,L=T>0?Math.round(A.length/T*100):0,O=Array.isArray(_)?_.filter(e=>e.evidence_file):[],R=T>0?Math.round(O.length/T*100):0,F=Array.isArray(C)?C:(null===C||void 0===C?void 0:C.results)||(null===C||void 0===C?void 0:C.data)||[];console.log("\ud83d\udd27 Processed Meters:",F.length,"meters found",F);const D=F.filter(e=>"inactive"!==e.status&&!1!==e.is_active),M=F.filter(e=>!0===e.has_alerts||"alert"===e.status),U=Array.isArray(_)?_.filter(e=>!e.value&&!e.evidence_file):[];P.kpiData=[{id:"data_progress",title:"Data Progress",value:E.data_progress||L,unit:"%",icon:"chart-line",color:"blue"},{id:"evidence_progress",title:"Evidence Progress",value:E.evidence_progress||R,unit:"%",icon:"file-upload",color:"green"},{id:"active_meters",title:"Active Meters",value:D.length,unit:"",icon:"tachometer-alt",color:"purple"},{id:"pending_tasks",title:"Pending Tasks",value:U.length,unit:"",icon:"tasks",color:"orange"}],P.esgScores={environmental:{score:N.environmental_score||0,grade:N.environmental_grade||"N/A",trend:N.environmental_trend},social:{score:N.social_score||0,grade:N.social_grade||"N/A",trend:N.social_trend},governance:{score:N.governance_score||0,grade:N.governance_grade||"N/A",trend:N.governance_trend},overall:N.overall_esg_score||E.overall_progress||0};let z=[];S&&(Array.isArray(S)?z=S:S.results&&Array.isArray(S.results)?z=S.results:S.data&&Array.isArray(S.data)?z=S.data:"object"===typeof S&&(z=[S])),0===z.length&&(z=[{framework_id:"ESG",name:"ESG Standards",type:"mandatory",progress:L},{framework_id:"DST",name:"Dubai Sustainable Tourism",type:"mandatory_conditional",progress:R},{framework_id:"GRI",name:"GRI Standards",type:"voluntary",progress:Math.round((L+R)/2)}]),P.frameworkData=z.map(e=>({id:e.framework_id||e.id||e.name,name:e.name||e.framework_name,progress:Math.round(e.progress||e.completion_percentage||0)})),P.meters={active:D.map(e=>({id:e.id,name:e.name,type:e.type||e.meter_type,location:e.location_description||e.location||"Not configured",status:e.status||"active",account_number:e.account_number})),inactive:F.filter(e=>"inactive"===e.status||!1===e.is_active),alerts:M,consumption:{},trends:{}},D.length>0&&!o&&c(D[0].id);const I=Array.isArray(_)?_.filter(e=>e.updated_at||e.created_at).slice(0,10).map((e,t)=>({id:"activity_".concat(e.id||t),type:e.evidence_file?"DATA_SUBMISSION":e.value?"DATA_ENTRY":"TASK_ASSIGNED",description:"".concat(e.value?"Data entered":e.evidence_file?"Evidence uploaded":"Task assigned"," for ").concat(e.name),timestamp:e.updated_at||e.created_at||(new Date).toISOString(),user:e.assigned_user||(null===s||void 0===s?void 0:s.name)||"System",user_id:e.assigned_user_id||(null===s||void 0===s?void 0:s.id),value:e.value||null})).sort((e,t)=>new Date(t.timestamp)-new Date(e.timestamp)):[];var t,n,r,l,i,d,u;P.recentActivities=I,(N.emissions_data||N.scope1_emissions)&&(P.emissions={scope1:{value:N.scope1_emissions||(null===(t=N.emissions_data)||void 0===t?void 0:t.scope1_total),percentage:N.scope1_percentage||(null===(n=N.emissions_data)||void 0===n?void 0:n.scope1_percentage)||0},scope2:{value:N.scope2_emissions||(null===(r=N.emissions_data)||void 0===r?void 0:r.scope2_total),percentage:N.scope2_percentage||(null===(l=N.emissions_data)||void 0===l?void 0:l.scope2_percentage)||0},scope3:{value:N.scope3_emissions||(null===(i=N.emissions_data)||void 0===i?void 0:i.scope3_total),percentage:N.scope3_percentage||(null===(d=N.emissions_data)||void 0===d?void 0:d.scope3_percentage)||0},total:N.total_emissions||(null===(u=N.emissions_data)||void 0===u?void 0:u.total_emissions)||0}),p(P),console.log("\u2705 Unified dashboard data processed:",P)}catch(m){console.error("\u274c Failed to fetch unified dashboard data:",m)}finally{f(!1)}else console.log("No company selected, skipping dashboard data fetch")})()},[a,null===s||void 0===s?void 0:s.role,l]);const y=e=>{let{selected:t,onChange:s}=e;return(0,ze.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-6",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-700",children:"Time Range:"}),(0,ze.jsx)("div",{className:"flex space-x-2",children:["week","month","quarter","year"].map(e=>(0,ze.jsx)("button",{onClick:()=>s(e),className:"px-3 py-1 rounded-md text-sm font-medium transition-colors ".concat(t===e?"bg-purple-100 text-purple-800":"text-gray-600 hover:text-gray-800 hover:bg-gray-100"),children:e.charAt(0).toUpperCase()+e.slice(1)},e))})]})})},b=e=>{let{title:t,value:s,unit:a,change:n,trend:r,icon:l,color:i}=e;"bg-".concat(i,"-100"),"text-".concat(i,"-600");return(0,ze.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("div",{className:"w-12 h-12 rounded-lg flex items-center justify-center ".concat("green"===i?"bg-green-100":"blue"===i?"bg-blue-100":"purple"===i?"bg-purple-100":"orange"===i?"bg-orange-100":"bg-gray-100"),children:(0,ze.jsx)("i",{className:"fas fa-".concat(l," text-xl ").concat("green"===i?"text-green-600":"blue"===i?"text-blue-600":"purple"===i?"text-purple-600":"orange"===i?"text-orange-600":"text-gray-600")})}),(0,ze.jsxs)("div",{className:"ml-4",children:[(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:t}),(0,ze.jsxs)("p",{className:"text-2xl font-bold text-gray-800",children:[void 0!==s&&null!==s&&"--"!==s?s:"--"," ",a]}),n&&r&&(0,ze.jsxs)("span",{className:"text-sm ".concat("up"===r?"text-green-600":"text-red-600"),children:["up"===r?"\u2191":"\u2193"," ",Math.abs(n),"%"]})]})]})})},v=e=>{let{meters:t,selectedMeter:s,onMeterSelect:a}=e;const n=e=>{if(null===t||void 0===t||!t.length)return;const n=t.findIndex(e=>e.id===s);let r;r="prev"===e?n>0?n-1:t.length-1:n<t.length-1?n+1:0,a(t[r].id)};if(null===t||void 0===t||!t.length)return null;const r=t.find(e=>e.id===s)||t[0],l=t.findIndex(e=>e.id===s);return(0,ze.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4 mb-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsx)("button",{onClick:()=>n("prev"),disabled:t.length<=1,className:"w-10 h-10 rounded-full flex items-center justify-center transition-colors ".concat(t.length<=1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800"),children:(0,ze.jsx)("i",{className:"fas fa-chevron-left"})}),(0,ze.jsx)("div",{className:"flex-1 mx-4 text-center",children:(0,ze.jsxs)("div",{onClick:()=>a(r.id),className:"cursor-pointer p-4 rounded-lg border-2 border-purple-200 bg-purple-50 hover:bg-purple-100 transition-colors",children:[(0,ze.jsx)("h3",{className:"font-semibold text-purple-900 text-lg",children:r.name}),(0,ze.jsx)("p",{className:"text-purple-700 text-sm",children:r.type}),(0,ze.jsx)("p",{className:"text-purple-600 text-xs",children:r.location}),(0,ze.jsxs)("div",{className:"mt-2 flex items-center justify-center space-x-4",children:[(0,ze.jsxs)("span",{className:"text-xs text-purple-600",children:[l+1," of ",t.length]}),(0,ze.jsx)("span",{className:"inline-flex px-2 py-1 rounded-full text-xs font-medium ".concat("active"===r.status||"Active"===r.status?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:r.status})]})]})}),(0,ze.jsx)("button",{onClick:()=>n("next"),disabled:t.length<=1,className:"w-10 h-10 rounded-full flex items-center justify-center transition-colors ".concat(t.length<=1?"bg-gray-100 text-gray-400 cursor-not-allowed":"bg-gray-100 text-gray-600 hover:bg-gray-200 hover:text-gray-800"),children:(0,ze.jsx)("i",{className:"fas fa-chevron-right"})})]})})},j=e=>{var t,s,a;let{meter:n,timeRange:r}=e;if(!n)return(0,ze.jsx)("div",{className:"bg-white rounded-lg shadow-md p-6",children:(0,ze.jsxs)("div",{className:"text-center text-gray-500",children:[(0,ze.jsx)("i",{className:"fas fa-tachometer-alt text-4xl mb-4"}),(0,ze.jsx)("p",{children:"No meter selected"})]})});const l=((e,t)=>{const s={week:7,month:30,quarter:90,year:12}[t]||30,a=[],n=null!==e&&void 0!==e&&e.toLowerCase().includes("electric")?1e3:null!==e&&void 0!==e&&e.toLowerCase().includes("water")?500:null!==e&&void 0!==e&&e.toLowerCase().includes("gas")?200:300;for(let r=0;r<s;r++){const e=.3*(Math.random()-.5)*n,t=r*(.02*n/s);a.push(Math.max(0,Math.round(n+e+t)))}return a})(n.type,r),i=l[l.length-1],o=l[l.length-2],c=i-o,d=o?Math.round(c/o*100):0,u=Math.max(...l),m=Math.min(...l),f=Math.round(l.reduce((e,t)=>e+t,0)/l.length),x=null!==(t=n.type)&&void 0!==t&&t.toLowerCase().includes("electric")?"kWh":null!==(s=n.type)&&void 0!==s&&s.toLowerCase().includes("water")?"L":null!==(a=n.type)&&void 0!==a&&a.toLowerCase().includes("gas")?"m\xb3":"units";return(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-800",children:n.name}),(0,ze.jsxs)("p",{className:"text-sm text-gray-600",children:[n.type," \u2022 ",n.location]})]}),(0,ze.jsxs)("div",{className:"text-right",children:[(0,ze.jsx)("p",{className:"text-2xl font-bold text-gray-900",children:i.toLocaleString()}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:x})]})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-3 gap-4 mb-6",children:[(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Current"}),(0,ze.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:i.toLocaleString()}),(0,ze.jsx)("div",{className:"flex items-center justify-center mt-1",children:(0,ze.jsxs)("span",{className:"text-sm flex items-center ".concat(c>=0?"text-red-600":"text-green-600"),children:[(0,ze.jsx)("i",{className:"fas fa-arrow-".concat(c>=0?"up":"down"," mr-1")}),Math.abs(d),"%"]})})]}),(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Average"}),(0,ze.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:f.toLocaleString()}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:x})]}),(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Peak"}),(0,ze.jsx)("p",{className:"text-xl font-semibold text-gray-900",children:u.toLocaleString()}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:x})]})]}),(0,ze.jsxs)("div",{className:"mb-4",children:[(0,ze.jsxs)("h4",{className:"text-sm font-medium text-gray-700 mb-2",children:["Usage Trend (",r,")"]}),(0,ze.jsx)("div",{className:"h-32 flex items-end space-x-1",children:l.map((e,t)=>{const s=(e-m)/(u-m)*100;return(0,ze.jsx)("div",{className:"flex-1 bg-gradient-to-t from-purple-500 to-purple-300 rounded-t",style:{height:"".concat(Math.max(s,5),"%")},title:"".concat(e.toLocaleString()," ").concat(x)},t)})})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("p",{className:"text-sm text-gray-600",children:["Total Usage (",r,")"]}),(0,ze.jsxs)("p",{className:"text-lg font-semibold text-gray-900",children:[l.reduce((e,t)=>e+t,0).toLocaleString()," ",x]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Efficiency Rating"}),(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("div",{className:"flex-1 bg-gray-200 rounded-full h-2 mr-2",children:(0,ze.jsx)("div",{className:"bg-green-500 h-2 rounded-full",style:{width:"".concat(85,"%")}})}),(0,ze.jsx)("span",{className:"text-sm font-medium text-gray-900",children:"85%"})]})]})]}),c>.2*o&&(0,ze.jsx)("div",{className:"mt-4 p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-triangle text-yellow-600 mr-2"}),(0,ze.jsxs)("span",{className:"text-sm text-yellow-800",children:["High usage detected - ",d,"% increase from last reading"]})]})})]})},w=e=>{let{frameworks:t}=e;return(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Framework Compliance"}),(null===t||void 0===t?void 0:t.map(e=>(0,ze.jsxs)("div",{className:"mb-4",children:[(0,ze.jsxs)("div",{className:"flex justify-between mb-2",children:[(0,ze.jsx)("span",{className:"font-medium",children:e.name}),(0,ze.jsxs)("span",{className:"text-sm text-gray-600",children:[e.progress||0,"%"]})]}),(0,ze.jsx)("div",{className:"w-full bg-gray-200 rounded-full h-2",children:(0,ze.jsx)("div",{className:"bg-blue-600 h-2 rounded-full transition-all duration-500",style:{width:"".concat(e.progress||0,"%")}})})]},e.id)))||(0,ze.jsx)("p",{className:"text-gray-500",children:"No framework data available"})]})},N=e=>{let{esgScores:t}=e;return(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"ESG Scores"}),(0,ze.jsxs)("div",{className:"space-y-4",children:[["environmental","social","governance"].map(e=>{var s,a,n;return(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("div",{className:"w-10 h-10 rounded-lg flex items-center justify-center mr-3 ".concat("environmental"===e?"bg-green-100":"social"===e?"bg-blue-100":"bg-purple-100"),children:(0,ze.jsx)("i",{className:"fas ".concat("environmental"===e?"fa-leaf":"social"===e?"fa-users":"fa-balance-scale"," ").concat("environmental"===e?"text-green-600":"social"===e?"text-blue-600":"text-purple-600")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium capitalize",children:e}),(0,ze.jsxs)("p",{className:"text-sm text-gray-500",children:["Grade: ",(null===t||void 0===t||null===(s=t[e])||void 0===s?void 0:s.grade)||"N/A"]})]})]}),(0,ze.jsxs)("div",{className:"text-right",children:[(0,ze.jsx)("p",{className:"text-xl font-bold",children:(null===t||void 0===t||null===(a=t[e])||void 0===a?void 0:a.score)||"--"}),(null===t||void 0===t||null===(n=t[e])||void 0===n?void 0:n.trend)&&(0,ze.jsx)("span",{className:"text-sm ".concat("up"===t[e].trend?"text-green-600":"text-red-600"),children:"up"===t[e].trend?"\u2191":"\u2193"})]})]},e)}),(null===t||void 0===t?void 0:t.overall)&&(0,ze.jsx)("div",{className:"border-t pt-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsx)("span",{className:"font-semibold",children:"Overall ESG Score"}),(0,ze.jsx)("span",{className:"text-2xl font-bold text-purple-600",children:t.overall})]})})]})]})},k=e=>{let{emissionsData:t,selectedScope:s,onScopeChange:a}=e;return(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold",children:"Emissions by Scope"}),(0,ze.jsxs)("select",{value:s,onChange:e=>a(e.target.value),className:"border border-gray-300 rounded px-3 py-1 focus:ring-2 focus:ring-purple-500",children:[(0,ze.jsx)("option",{value:"all",children:"All Scopes"}),(0,ze.jsx)("option",{value:"scope1",children:"Scope 1"}),(0,ze.jsx)("option",{value:"scope2",children:"Scope 2"}),(0,ze.jsx)("option",{value:"scope3",children:"Scope 3"})]})]}),(0,ze.jsxs)("div",{className:"space-y-4",children:[["scope1","scope2","scope3"].map(e=>{var s,a;return(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("div",{className:"w-4 h-4 rounded mr-3 ".concat("scope1"===e?"bg-red-500":"scope2"===e?"bg-yellow-500":"bg-green-500")}),(0,ze.jsx)("span",{className:"font-medium capitalize",children:e.replace("scope","Scope ")})]}),(0,ze.jsxs)("div",{className:"text-right",children:[(0,ze.jsxs)("p",{className:"font-semibold",children:[(null===t||void 0===t||null===(s=t[e])||void 0===s?void 0:s.value)||"--"," tCO\u2082e"]}),(0,ze.jsxs)("p",{className:"text-sm text-gray-500",children:[(null===t||void 0===t||null===(a=t[e])||void 0===a?void 0:a.percentage)||"--","%"]})]})]},e)}),(null===t||void 0===t?void 0:t.total)&&(0,ze.jsx)("div",{className:"border-t pt-4",children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsx)("span",{className:"font-semibold",children:"Total Emissions"}),(0,ze.jsxs)("span",{className:"text-xl font-bold",children:[t.total," tCO\u2082e"]})]})})]})]})},S=e=>{let{activities:t,userRole:a}=e;const n=((e,t)=>{if(null===e||void 0===e||!e.length)return[];switch(t){case"super_user":case"admin":case"viewer":case"auditor":return e;case"site_manager":return e.filter(e=>"SYSTEM_ALERT"!==e.type);case"uploader":return e.filter(e=>e.user_id===(null===s||void 0===s?void 0:s.id));case"meter_manager":return e.filter(e=>["METER_UPDATE","SYSTEM_ALERT"].includes(e.type));default:return[]}})(t,a);return(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-800 mb-4",children:"Recent Activity"}),(0,ze.jsx)("div",{className:"space-y-3",children:(null===n||void 0===n?void 0:n.length)>0?n.slice(0,10).map(e=>{return(0,ze.jsxs)("div",{className:"flex items-center space-x-3 p-3 rounded-lg bg-gray-50",children:[(0,ze.jsx)("div",{className:"w-8 h-8 rounded-full bg-gray-200 flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas ".concat((t=e.type,{DATA_SUBMISSION:"fa-database",METER_UPDATE:"fa-tachometer-alt",FRAMEWORK_PROGRESS:"fa-chart-line",USER_ACTION:"fa-user",SYSTEM_ALERT:"fa-exclamation-triangle",REPORT_GENERATION:"fa-file-alt",TASK_COMPLETION:"fa-check-circle"}[t]||"fa-info-circle")," text-gray-600 text-sm")})}),(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("p",{className:"text-sm font-medium text-gray-900",children:e.description}),(0,ze.jsxs)("div",{className:"flex items-center space-x-2 text-xs text-gray-500",children:[(0,ze.jsx)("span",{children:e.user}),(0,ze.jsx)("span",{children:"\u2022"}),(0,ze.jsx)("span",{children:new Date(e.timestamp).toLocaleString()})]})]}),e.value&&(0,ze.jsx)("div",{className:"text-right",children:(0,ze.jsx)("p",{className:"text-sm font-medium",children:e.value})})]},e.id);var t}):(0,ze.jsx)("p",{className:"text-gray-500",children:"No recent activities"})})]})};return m?(0,ze.jsx)("div",{className:"min-h-screen bg-gray-50 flex items-center justify-center",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-12 w-12 border-b-2 border-purple-600 mx-auto mb-4"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Loading dashboard..."})]})}):(0,ze.jsx)("div",{className:"min-h-screen bg-gray-50",children:(0,ze.jsxs)("div",{className:"max-w-7xl mx-auto p-6",children:[(0,ze.jsxs)("div",{className:"mb-6",children:[(0,ze.jsx)("h1",{className:"text-3xl font-bold text-gray-900",children:"super_user"===(null===s||void 0===s?void 0:s.role)?"System Overview":"admin"===(null===s||void 0===s?void 0:s.role)?"Company Dashboard":"site_manager"===(null===s||void 0===s?void 0:s.role)?"Site Dashboard":"uploader"===(null===s||void 0===s?void 0:s.role)?"My Progress":"meter_manager"===(null===s||void 0===s?void 0:s.role)?"Meter Management":"Dashboard"}),(0,ze.jsxs)("p",{className:"text-gray-600",children:[(null===a||void 0===a?void 0:a.name)||"ESG Portal"," \u2022 ",null===s||void 0===s?void 0:s.name]})]}),(0,ze.jsx)(y,{selected:l,onChange:i}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8",children:(null===(e=x.kpiData)||void 0===e?void 0:e.length)>0?x.kpiData.map(e=>(0,ze.jsx)(b,Me({},e),e.id)):[{id:"esg",title:"ESG Score",value:"--",unit:"",icon:"leaf",color:"green"},{id:"progress",title:"Data Progress",value:"--",unit:"%",icon:"chart-line",color:"blue"},{id:"meters",title:"Active Meters",value:"--",unit:"",icon:"tachometer-alt",color:"purple"},{id:"tasks",title:"Pending Tasks",value:"--",unit:"",icon:"tasks",color:"orange"}].map(e=>(0,ze.jsx)(b,Me({},e),e.id))}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8",children:[(g("esg")||g("esg_view")||g("esg_limited"))&&(0,ze.jsx)(N,{esgScores:x.esgScores}),(g("meters")||g("meters_full")||g("meters_site")||g("meters_view")||g("assigned_meters"))&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)(v,{meters:x.meters.active,selectedMeter:o,onMeterSelect:c}),(0,ze.jsx)(j,{meter:null===(t=x.meters.active)||void 0===t?void 0:t.find(e=>e.id===o),timeRange:l})]})]}),(g("emissions")||g("emissions_view")||g("emissions_site"))&&(0,ze.jsx)("div",{className:"mb-8",children:(0,ze.jsx)(k,{emissionsData:x.emissions,selectedScope:d,onScopeChange:u})}),g("frameworks")&&(0,ze.jsx)("div",{className:"mb-8",children:(0,ze.jsx)(w,{frameworks:x.frameworkData})}),(0,ze.jsx)(S,{activities:x.recentActivities,userRole:null===s||void 0===s?void 0:s.role})]})})},Ya=()=>{var e,t,s;const a=ae(),{user:n,selectedCompany:l,hasPermission:i,userSites:c}=Be(),[d,u]=(0,r.useState)([]),[m,f]=(0,r.useState)(!0),[x,p]=(0,r.useState)(!1),[h,g]=(0,r.useState)(null),[y,b]=(0,r.useState)(!1),[v,j]=(0,r.useState)(!1),[w,N]=(0,r.useState)(!1),[k,S]=(0,r.useState)(null),[C,_]=(0,r.useState)(null),[E,P]=(0,r.useState)(!1),[A,T]=(0,r.useState)({show:!1,type:"",title:"",message:"",details:""}),[L,O]=(0,r.useState)(""),[R,F]=(0,r.useState)("all"),[D,M]=(0,r.useState)("all"),[U,z]=(0,r.useState)(!1),[I,G]=(0,r.useState)(!1),[B,W]=(0,r.useState)(!1),[q,V]=(0,r.useState)([]),[H,Q]=(0,r.useState)([]),$=[{value:"super_user",label:"Super User",description:"System-wide administrator with full access"},{value:"admin",label:"Admin",description:"Company-level administrator"},{value:"site_manager",label:"Site Manager",description:"Site/location manager"},{value:"uploader",label:"Uploader",description:"Data entry specialist"},{value:"viewer",label:"Viewer/Auditor",description:"Read-only access with reports"},{value:"meter_manager",label:"Meter Manager",description:"Meter infrastructure specialist"}],J=()=>{if(!n)return[];switch(n.role){case"super_user":return $;case"admin":return $.filter(e=>"super_user"!==e.value);case"site_manager":return $.filter(e=>!["super_user","admin"].includes(e.value));default:return[]}},Y=e=>{if(!n)return!1;return({super_user:["super_user","admin","site_manager","uploader","viewer","meter_manager"],admin:["site_manager","uploader","viewer","meter_manager"],site_manager:["uploader","viewer","meter_manager"],uploader:[],viewer:[],meter_manager:[]}[n.role]||[]).includes(e)},K=async()=>{try{f(!0);const e="super_user"===n.role?"".concat(Ue,"/api/users/"):"".concat(Ue,"/api/users/my-team/"),t=await Ie(e);if(t.ok){const e=await t.json(),s=Array.isArray(e)?e:e.results||[];console.log("\ud83c\udfe2 Company Data Structure Debug:"),console.log("selectedCompany:",l),console.log("users array:",s),s.length>0&&(console.log("First user object:",s[0]),console.log("First user company:",s[0].company)),u(s)}}catch(e){console.error("Failed to fetch users:",e)}finally{f(!1)}};(0,r.useEffect)(()=>{i("userManagement","read")&&K()},[l,i]),(0,r.useEffect)(()=>{null!==l&&void 0!==l&&l.id&&(async()=>{try{if(null===l||void 0===l||!l.id)return;const e=await Ie("".concat(Ue,"/api/sites/?company_id=").concat(l.id));if(e.ok){const t=await e.json(),s=t.results||t;console.log("\ud83c\udfe2 Fetched company sites:",s.length),Q(s)}else console.error("Failed to fetch company sites")}catch(e){console.error("Error fetching company sites:",e)}})()},[l]);const X=e=>({super_user:"bg-red-100 text-red-800",admin:"bg-purple-100 text-purple-800",site_manager:"bg-blue-100 text-blue-800",uploader:"bg-green-100 text-green-800",viewer:"bg-gray-100 text-gray-800",meter_manager:"bg-orange-100 text-orange-800"}[e]||"bg-gray-100 text-gray-800"),Z=function(e,t,s){T({show:!0,type:e,title:t,message:s,details:arguments.length>3&&void 0!==arguments[3]?arguments[3]:""})},ee=e=>{let{isOpen:t,onClose:s,onRoleSelect:a}=e;if((0,r.useEffect)(()=>(document.body.style.overflow=t?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[t]),!t)return null;const n=J(),l=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999999]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:e=>{e.target===e.currentTarget&&s()},children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl mx-4 max-h-[90vh] overflow-y-auto shadow-2xl relative z-[9999999]",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-6",children:"Select User Role"}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:n.map(e=>(0,ze.jsx)("button",{onClick:()=>{g(e),a(e),s()},className:"text-left p-4 border border-gray-200 rounded-lg hover:border-purple-300 hover:bg-purple-50 transition-colors",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas ".concat(te(e.value)," text-purple-600")})}),(0,ze.jsxs)("div",{className:"flex-1",children:[(0,ze.jsx)("h4",{className:"font-medium text-gray-900",children:e.label}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.value))}),(0,ze.jsx)("div",{className:"flex justify-end pt-6",children:(0,ze.jsx)("button",{onClick:s,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"})})]})});return(0,o.createPortal)(l,document.body)},te=e=>{switch(e){case"super_user":return"fa-crown";case"admin":return"fa-user-shield";case"site_manager":return"fa-building";case"uploader":return"fa-upload";case"viewer":return"fa-eye";case"meter_manager":return"fa-tachometer-alt";default:return"fa-user"}},se=e=>{let{isOpen:t,onClose:s}=e;if(!t)return null;const a=e=>{F(e),s()},n=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999999]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:e=>{e.target===e.currentTarget&&s()},children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm mx-4",children:[(0,ze.jsx)("h3",{className:"text-base font-medium text-gray-900 mb-3",children:"Filter by Role"}),(0,ze.jsxs)("div",{className:"space-y-2",children:[(0,ze.jsx)("button",{onClick:()=>a("all"),className:"w-full text-left p-3 rounded-lg border transition-colors ".concat("all"===R?"border-purple-300 bg-purple-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-users text-gray-600"})}),(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:"All Roles"})]})}),$.map(e=>(0,ze.jsx)("button",{onClick:()=>a(e.value),className:"w-full text-left p-3 rounded-lg border transition-colors ".concat(R===e.value?"border-purple-300 bg-purple-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center ".concat(X(e.value)),children:(0,ze.jsx)("i",{className:"fas ".concat(te(e.value)," text-sm")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,ze.jsx)("p",{className:"text-xs text-gray-500",children:e.description})]})]})},e.value))]})]})});return(0,o.createPortal)(n,document.body)},ne=e=>{let{isOpen:t,onClose:s}=e;if(!t)return null;const a=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[9999999]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:e=>{e.target===e.currentTarget&&s()},children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-4 w-full max-w-sm mx-4",children:[(0,ze.jsx)("h3",{className:"text-base font-medium text-gray-900 mb-3",children:"Filter by Status"}),(0,ze.jsx)("div",{className:"space-y-2",children:[{value:"all",label:"All Status",icon:"fa-users",color:"bg-gray-100 text-gray-600"},{value:"active",label:"Active",icon:"fa-check-circle",color:"bg-green-100 text-green-600"},{value:"inactive",label:"Inactive",icon:"fa-times-circle",color:"bg-red-100 text-red-600"}].map(e=>(0,ze.jsx)("button",{onClick:()=>{return t=e.value,M(t),void s();var t},className:"w-full text-left p-3 rounded-lg border transition-colors ".concat(D===e.value?"border-purple-300 bg-purple-50":"border-gray-200 hover:border-gray-300 hover:bg-gray-50"),children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 rounded-lg flex items-center justify-center ".concat(e.color),children:(0,ze.jsx)("i",{className:"fas ".concat(e.icon," text-sm")})}),(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:e.label})]})},e.value))})]})});return(0,o.createPortal)(a,document.body)},re=e=>{var t;let{isOpen:s,onClose:a,onSiteSelect:l,selectedRole:i}=e;const[d,u]=(0,r.useState)([]);(0,r.useEffect)(()=>(document.body.style.overflow=s?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[s]);const m=()=>n&&H?["super_user","admin"].includes(n.role)?H:"site_manager"===n.role&&c.length>0?c:H:[];(0,r.useEffect)(()=>{if(s&&"site_manager"===n.role){const e=m();1===e.length&&u([e[0].id])}},[s,n.role]);const f=()=>{u([]),a()};if(!s)return null;const x=m(),p="site_manager"===n.role&&1===x.length,h=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black/60 backdrop-blur-sm flex items-center justify-center p-4 z-[9999]",children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl shadow-xl w-full max-w-md max-h-[90vh] overflow-hidden",children:[(0,ze.jsx)("div",{className:"bg-gradient-to-r from-purple-600 to-blue-600 text-white p-6",children:(0,ze.jsxs)("div",{className:"flex items-center justify-between",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h2",{className:"text-xl font-bold",children:"Select Sites"}),(0,ze.jsxs)("p",{className:"text-purple-100 mt-1",children:["Choose sites for ",null===i||void 0===i?void 0:i.label]})]}),(0,ze.jsx)("button",{onClick:f,className:"w-8 h-8 rounded-full bg-white/10 flex items-center justify-center hover:bg-white/20 transition-colors",children:(0,ze.jsx)("i",{className:"fas fa-times text-sm"})})]})}),(0,ze.jsx)("div",{className:"p-6",children:p?(0,ze.jsxs)("div",{className:"text-center py-4",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle text-blue-500 text-2xl mb-3"}),(0,ze.jsx)("h3",{className:"font-semibold text-gray-800 mb-2",children:"Auto-Selected Site"}),(0,ze.jsx)("p",{className:"text-gray-600 text-sm mb-4",children:"As a Site Manager with access to one site, the user will be automatically assigned to:"}),(0,ze.jsxs)("div",{className:"bg-blue-50 border border-blue-200 rounded-lg p-3",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-blue-600 mr-2"}),(0,ze.jsx)("span",{className:"font-medium text-blue-800",children:null===(t=x[0])||void 0===t?void 0:t.name})]})]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsxs)("p",{className:"text-gray-600 text-sm",children:["Select which sites this ",null===i||void 0===i?void 0:i.label," should have access to:"]}),x.length>1&&(0,ze.jsx)("button",{type:"button",onClick:()=>{const e=m(),t=e.map(e=>e.id);d.length===e.length?u([]):u(t)},className:"text-sm text-purple-600 hover:text-purple-700 font-medium",children:d.length===x.length?"Deselect All":"Select All"})]}),0===x.length?(0,ze.jsxs)("div",{className:"text-center py-8",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-triangle text-yellow-500 text-2xl mb-3"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"No sites available"})]}):(0,ze.jsx)("div",{className:"space-y-3 max-h-60 overflow-y-auto",children:x.map(e=>(0,ze.jsxs)("label",{className:"flex items-center p-3 border border-gray-200 rounded-lg hover:bg-gray-50 cursor-pointer",children:[(0,ze.jsx)("input",{type:"checkbox",checked:d.includes(e.id),onChange:()=>{return t=e.id,void u(e=>e.includes(t)?e.filter(e=>e!==t):[...e,t]);var t},className:"w-4 h-4 text-purple-600 border-gray-300 rounded focus:ring-purple-500"}),(0,ze.jsxs)("div",{className:"ml-3 flex-1",children:[(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt text-gray-400 mr-2"}),(0,ze.jsx)("span",{className:"font-medium text-gray-800",children:e.name})]}),e.location&&(0,ze.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:e.location})]})]},e.id))})]})}),(0,ze.jsxs)("div",{className:"bg-gray-50 px-6 py-4 flex justify-between items-center",children:[(0,ze.jsx)("button",{onClick:f,className:"px-4 py-2 text-gray-600 hover:text-gray-800 font-medium",children:"Cancel"}),(0,ze.jsxs)("button",{onClick:()=>{l(d),u([])},disabled:!p&&0===d.length,className:"px-6 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 disabled:opacity-50 disabled:cursor-not-allowed font-medium",children:["Continue",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]})]})});return(0,o.createPortal)(h,document.body)},le=e=>{let{isOpen:t,onClose:s,onSuccess:a,selectedRole:n,selectedSites:l=[]}=e;const[i,c]=(0,r.useState)({email:"",name:"",role:(null===n||void 0===n?void 0:n.value)||"",sites:[],sendWelcomeEmail:!0}),[d,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>(document.body.style.overflow=t?"hidden":"unset",()=>{document.body.style.overflow="unset"}),[t]),(0,r.useEffect)(()=>{n&&c(e=>Me(Me({},e),{},{role:n.value}))},[n]),(0,r.useEffect)(()=>{c(e=>Me(Me({},e),{},{sites:l}))},[l]);const m=H.filter(e=>l.includes(e.id));if(!t)return null;const f=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},onClick:e=>{e.target===e.currentTarget&&(s(),p(!0))},children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4 max-h-[90vh] overflow-y-auto shadow-2xl relative z-[10000001]",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsxs)("h3",{className:"text-lg font-medium text-gray-900",children:["Add New ",null===n||void 0===n?void 0:n.label]}),(0,ze.jsx)("button",{type:"button",onClick:()=>{s(),p(!0)},className:"text-sm text-purple-600 hover:text-purple-800",children:"Change Role"})]}),(0,ze.jsx)("div",{className:"mb-4 p-3 bg-purple-50 rounded-lg border border-purple-200",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas ".concat(te(null===n||void 0===n?void 0:n.value)," text-purple-600 text-sm")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-purple-900",children:null===n||void 0===n?void 0:n.label}),(0,ze.jsx)("p",{className:"text-xs text-purple-700",children:null===n||void 0===n?void 0:n.description})]})]})}),(0,ze.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0);try{const e=await Ie("".concat(Ue,"/api/users/"),{method:"POST",body:JSON.stringify(i)});if(e.ok){await e.json();Z("success","User Created Successfully","".concat(i.name," has been added to the system"),"A welcome email has been sent with login credentials"),a(),c({email:"",name:"",role:"",sites:[],sendWelcomeEmail:!0})}else{const t=await e.json();Z("error","User Creation Failed","Unable to create new user",t.error||"Unknown error occurred")}}catch(t){console.error("Failed to create user:",t),Z("error","User Creation Failed","Network error occurred","Please check your connection and try again")}finally{u(!1)}},className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Email"}),(0,ze.jsx)("input",{type:"email",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",value:i.email,onChange:e=>c(Me(Me({},i),{},{email:e.target.value}))})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Full Name"}),(0,ze.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",value:i.name,onChange:e=>c(Me(Me({},i),{},{name:e.target.value}))})]}),["site_manager","uploader","meter_manager","super_user"].includes(i.role)&&m.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assigned Sites"}),(0,ze.jsxs)("div",{className:"mt-1 p-3 bg-green-50 rounded-lg border border-green-200",children:[(0,ze.jsxs)("p",{className:"text-sm text-green-700 mb-2",children:[(0,ze.jsx)("i",{className:"fas fa-check-circle mr-1"}),"super_user"===i.role?"Automatically assigned to all sites":"Sites selected in previous step"]}),(0,ze.jsx)("div",{className:"space-y-1",children:m.map(e=>(0,ze.jsxs)("div",{className:"flex items-center text-sm",children:[(0,ze.jsx)("i",{className:"fas fa-check text-green-600 mr-2"}),(0,ze.jsx)("span",{className:"text-gray-700",children:e.name})]},e.id))})]})]}),(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("input",{type:"checkbox",className:"mr-2",checked:i.sendWelcomeEmail,onChange:e=>c(Me(Me({},i),{},{sendWelcomeEmail:e.target.checked}))}),(0,ze.jsx)("label",{className:"text-sm text-gray-700",children:"Send welcome email"})]}),(0,ze.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,ze.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,ze.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:d?"Creating...":"Create User"})]})]})]})});return(0,o.createPortal)(f,document.body)},ie=e=>{var t;let{isOpen:s,onClose:a,user:n,onSuccess:l}=e;const[i,o]=(0,r.useState)({email:"",name:"",role:"",sites:[],is_active:!0}),[d,u]=(0,r.useState)(!1),[m,f]=(0,r.useState)({show:!1,message:"",type:"error"}),[x,p]=(0,r.useState)(!1);(0,r.useEffect)(()=>{if(n){const e=n.sites?n.sites.map(e=>"object"===typeof e?e.id:e):[];console.log("\ud83d\udd27 EditUserModal: User sites:",n.sites),console.log("\ud83d\udd27 EditUserModal: Extracted site IDs:",e),o({email:n.email||"",name:n.name||"",role:n.role||"",sites:e,is_active:!1!==n.is_active})}f({show:!1,message:"",type:"error"})},[n,s]);if(!s||!n)return null;const h=J();return(0,ze.jsx)("div",{className:"fixed inset-0 bg-gray-600 bg-opacity-50 flex items-center justify-center z-[9999999]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},children:(0,ze.jsx)("div",{className:"bg-white rounded-md p-5 border w-full max-w-md shadow-lg mx-4",children:(0,ze.jsxs)("div",{className:"mt-3",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-6",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:"Edit User"}),(0,ze.jsx)("button",{type:"button",onClick:a,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),m.show&&(0,ze.jsx)("div",{className:"p-3 rounded-lg mb-4 ".concat("error"===m.type?"bg-red-100 text-red-800 border border-red-200":"bg-blue-100 text-blue-800 border border-blue-200"),children:(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("i",{className:"fas ".concat("error"===m.type?"fa-exclamation-triangle":"fa-info-circle")}),(0,ze.jsx)("span",{className:"text-sm",children:m.message})]})}),(0,ze.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),n)if(i.email.trim()&&i.name.trim()&&i.role){f({show:!1,message:"",type:"error"}),u(!0),console.log("\ud83d\ude80 EditUserModal: Submitting form data:",i),console.log("\ud83d\ude80 EditUserModal: Sites being sent:",i.sites);try{const e=await Ie("".concat(Ue,"/api/users/").concat(n.id,"/"),{method:"PUT",body:JSON.stringify(i)});if(e.ok)Z("success","User Updated Successfully","".concat(n.name,"'s information has been updated"),"Changes have been saved to the system"),l();else{const t=await e.json();Z("error","Update Failed","Unable to update user information",t.error||"Unknown error occurred")}}catch(t){console.error("Failed to update user:",t),Z("error","Update Failed","Network error occurred","Please check your connection and try again")}finally{u(!1)}}else f({show:!0,message:"Please fill in required fields (Email, Name, and Role)",type:"error"})},className:"space-y-6",children:[x?(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"Select the role for this user:"}),(0,ze.jsx)("div",{className:"space-y-2",children:h.map(e=>(0,ze.jsx)("button",{type:"button",className:"w-full text-left p-3 border border-gray-200 rounded-lg hover:bg-gray-50 hover:border-blue-300 transition-colors",onClick:()=>{o(Me(Me({},i),{},{role:e.value})),p(!1)},children:(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-gray-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas ".concat(te(e.value)," text-gray-600")})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"font-medium text-gray-900",children:e.label}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:e.description})]})]})},e.value))})]}):(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"User Role"}),(0,ze.jsxs)("div",{className:"flex items-center justify-between p-3 bg-gray-50 rounded-lg",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas ".concat(te(i.role)," text-purple-600")})}),(0,ze.jsx)("span",{className:"font-medium text-gray-900",children:(null===(t=$.find(e=>e.value===i.role))||void 0===t?void 0:t.label)||i.role})]}),(0,ze.jsx)("button",{type:"button",className:"text-sm text-blue-600 hover:text-blue-800",onClick:()=>p(!0),children:"Change Role"})]})]}),!x&&(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Email Address ",(0,ze.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ze.jsx)("input",{type:"email",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., john.doe@company.com",value:i.email,onChange:e=>o(Me(Me({},i),{},{email:e.target.value}))})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsxs)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:["Full Name ",(0,ze.jsx)("span",{className:"text-red-500",children:"*"})]}),(0,ze.jsx)("input",{type:"text",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-blue-500 focus:border-blue-500",placeholder:"e.g., John Doe",value:i.name,onChange:e=>o(Me(Me({},i),{},{name:e.target.value}))})]}),["site_manager","uploader","meter_manager"].includes(i.role)&&c.length>0&&(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assign Sites"}),(0,ze.jsx)("div",{className:"mt-1 space-y-2 max-h-32 overflow-y-auto border border-gray-300 rounded-md p-2",children:c.map(e=>(0,ze.jsxs)("label",{className:"flex items-center",children:[(0,ze.jsx)("input",{type:"checkbox",className:"mr-2",checked:i.sites.includes(e.id),onChange:t=>{const s=t.target.checked?[...i.sites,e.id]:i.sites.filter(t=>t!==e.id);o(Me(Me({},i),{},{sites:s}))}}),(0,ze.jsx)("span",{className:"text-sm",children:e.name})]},e.id))})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Account Status"}),(0,ze.jsxs)("div",{className:"flex space-x-2",children:[(0,ze.jsx)("button",{type:"button",onClick:()=>o(Me(Me({},i),{},{is_active:!0})),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(i.is_active?"bg-green-100 text-green-800 border border-green-200":"bg-gray-100 text-gray-600 border border-gray-200 hover:bg-gray-200"),children:"Active"}),(0,ze.jsx)("button",{type:"button",onClick:()=>o(Me(Me({},i),{},{is_active:!1})),className:"px-4 py-2 rounded-md text-sm font-medium transition-colors ".concat(i.is_active?"bg-gray-100 text-gray-600 border border-gray-200 hover:bg-gray-200":"bg-red-100 text-red-800 border border-red-200"),children:"Inactive"})]}),(0,ze.jsx)("p",{className:"text-xs text-gray-500 mt-2",children:i.is_active?"User can log in and access the system":"User cannot log in or access the system"})]}),(0,ze.jsxs)("div",{className:"flex justify-end space-x-3 mt-6",children:[(0,ze.jsx)("button",{type:"button",className:"px-4 py-2 bg-gray-300 text-gray-700 rounded-md hover:bg-gray-400",onClick:a,children:"Cancel"}),(0,ze.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-blue-600 text-white rounded-md hover:bg-blue-700 disabled:opacity-50",children:d?"Saving Changes...":"Save Changes"})]})]})]})]})})})},oe=e=>{let{isOpen:t,onClose:s,user:a,onConfirm:n,isProcessing:r}=e;return t&&a?(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-red-900",children:"Delete User"}),(0,ze.jsx)("button",{type:"button",onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsx)("div",{className:"mb-6",children:(0,ze.jsxs)("div",{className:"text-center mb-4",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-triangle text-red-500 text-4xl mb-4"}),(0,ze.jsxs)("p",{className:"text-gray-700",children:["Are you sure you want to delete ",(0,ze.jsx)("strong",{children:a.name})," (",a.email,")?"]}),(0,ze.jsx)("p",{className:"text-sm text-red-600 mt-2",children:"This action cannot be undone. The user will lose access to the system immediately."})]})}),(0,ze.jsxs)("div",{className:"flex justify-end space-x-3",children:[(0,ze.jsx)("button",{type:"button",onClick:s,disabled:r,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50 disabled:opacity-50",children:"Cancel"}),(0,ze.jsx)("button",{type:"button",onClick:n,disabled:r,className:"px-4 py-2 bg-red-600 text-white rounded-md hover:bg-red-700 disabled:opacity-50",children:r?"Deleting...":"Delete User"})]})]})}):null},ce=e=>{let{notification:t,onClose:s}=e;if(!t.show)return null;return(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[10000010]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh",margin:0,padding:0},children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md mx-4 relative z-[10000011]",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900",children:t.title}),(0,ze.jsx)("button",{type:"button",onClick:s,className:"text-gray-400 hover:text-gray-600",children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsx)("div",{className:"p-4 rounded-lg border ".concat((()=>{switch(t.type){case"success":return"bg-green-50 border-green-200";case"error":return"bg-red-50 border-red-200";case"warning":return"bg-yellow-50 border-yellow-200";default:return"bg-blue-50 border-blue-200"}})()," mb-4"),children:(0,ze.jsxs)("div",{className:"flex items-start",children:[(0,ze.jsx)("div",{className:"flex-shrink-0",children:(0,ze.jsx)("i",{className:"".concat((()=>{switch(t.type){case"success":return"fas fa-check-circle text-green-500";case"error":return"fas fa-exclamation-triangle text-red-500";case"warning":return"fas fa-exclamation-triangle text-yellow-500";default:return"fas fa-info-circle text-blue-500"}})()," text-2xl")})}),(0,ze.jsxs)("div",{className:"ml-3 flex-1",children:[(0,ze.jsx)("p",{className:"text-sm font-medium text-gray-900",children:t.message}),t.details&&(0,ze.jsx)("div",{className:"mt-2",children:(0,ze.jsx)("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:t.details})})]})]})}),(0,ze.jsx)("div",{className:"flex justify-end",children:(0,ze.jsx)("button",{type:"button",onClick:s,className:"px-4 py-2 bg-gray-600 text-white rounded-md hover:bg-gray-700",children:"OK"})})]})})};if(!n||!["super_user","admin","site_manager"].includes(n.role))return(0,ze.jsx)("div",{className:"flex items-center justify-center min-h-screen bg-gray-50",children:(0,ze.jsx)("div",{className:"max-w-md mx-auto text-center",children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-8",children:[(0,ze.jsx)("div",{className:"w-16 h-16 mx-auto bg-red-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-lock text-red-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900 mb-2",children:"Access Denied"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-4",children:"You don't have permission to access user management."}),(0,ze.jsx)("p",{className:"text-sm text-gray-500",children:"Contact your administrator if you need access to this feature."})]})})});if(m)return(0,ze.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),(0,ze.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading users..."})]});const de=d.filter(e=>{const t=e.name.toLowerCase().includes(L.toLowerCase())||e.email.toLowerCase().includes(L.toLowerCase()),s="all"===R||e.role===R,a="all"===D||"active"===D&&e.is_active||"inactive"===D&&!e.is_active;return t&&s&&a});return(0,ze.jsxs)("div",{className:"max-w-6xl mx-auto space-y-6",children:[(0,ze.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Team Management"}),(0,ze.jsxs)("div",{className:"flex items-center space-x-4 mt-1",children:[(0,ze.jsx)("p",{className:"text-gray-600",children:"Manage users and their access to the platform"}),l&&(0,ze.jsxs)("div",{className:"flex items-center text-sm text-purple-700 bg-purple-50 px-3 py-1 rounded-md border border-purple-200",children:[(0,ze.jsx)("i",{className:"fas fa-building mr-2 text-purple-600"}),(0,ze.jsx)("span",{className:"font-medium",children:"Code:"}),(0,ze.jsx)("span",{className:"ml-1",children:(null===(e=d[0])||void 0===e||null===(t=e.company)||void 0===t?void 0:t.company_code)||(null===l||void 0===l?void 0:l.company_code)||"N/A"})]})]})]}),i("userManagement","create")&&(0,ze.jsxs)("button",{onClick:()=>p(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-plus mr-2"}),"Add User"]})]}),(0,ze.jsx)("div",{className:"bg-white rounded-lg shadow-sm border border-gray-200 p-4",children:(0,ze.jsxs)("div",{className:"flex flex-wrap gap-4 items-center",children:[(0,ze.jsx)("div",{className:"flex-1 min-w-64",children:(0,ze.jsxs)("div",{className:"relative",children:[(0,ze.jsx)("i",{className:"fas fa-search absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,ze.jsx)("input",{type:"text",placeholder:"Search by name or email...",value:L,onChange:e=>O(e.target.value),className:"w-full pl-10 pr-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500"})]})}),(0,ze.jsxs)("button",{onClick:()=>z(!0),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white hover:bg-gray-50 transition-colors flex items-center space-x-2",children:[(0,ze.jsx)("span",{children:"all"===R?"All Roles":null===(s=$.find(e=>e.value===R))||void 0===s?void 0:s.label}),(0,ze.jsx)("i",{className:"fas fa-chevron-down text-gray-400"})]}),(0,ze.jsxs)("button",{onClick:()=>G(!0),className:"px-3 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 bg-white hover:bg-gray-50 transition-colors flex items-center space-x-2",children:[(0,ze.jsx)("span",{children:"all"===D?"All Status":"active"===D?"Active":"Inactive"}),(0,ze.jsx)("i",{className:"fas fa-chevron-down text-gray-400"})]}),(0,ze.jsxs)("div",{className:"text-sm text-gray-600",children:["Showing ",de.length," of ",d.length," users"]})]})}),(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,ze.jsx)("div",{className:"overflow-x-auto",children:(0,ze.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,ze.jsx)("thead",{className:"bg-gray-50",children:(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider min-w-[200px]",children:"User"}),(0,ze.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),(0,ze.jsx)("th",{className:"hidden md:table-cell px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Sites/Access"}),(0,ze.jsx)("th",{className:"hidden lg:table-cell px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),(0,ze.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),(0,ze.jsx)("th",{className:"px-3 sm:px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),(0,ze.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:de.map(e=>{var t,s,a,n,r;return(0,ze.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,ze.jsx)("td",{className:"px-3 sm:px-6 py-4",children:(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("div",{className:"h-8 w-8 sm:h-10 sm:w-10 bg-gray-300 rounded-full flex items-center justify-center flex-shrink-0",children:(0,ze.jsx)("span",{className:"text-gray-700 font-medium text-sm",children:(null===(t=e.name)||void 0===t||null===(s=t.charAt(0))||void 0===s?void 0:s.toUpperCase())||"U"})}),(0,ze.jsxs)("div",{className:"ml-2 sm:ml-4 min-w-0",children:[(0,ze.jsx)("div",{className:"text-sm font-medium text-gray-900 truncate",children:e.name}),(0,ze.jsx)("div",{className:"text-xs sm:text-sm text-gray-500 truncate",children:e.email})]})]})}),(0,ze.jsx)("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:(0,ze.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat(X(e.role)),children:[(0,ze.jsx)("span",{className:"hidden sm:inline",children:(null===(a=$.find(t=>t.value===e.role))||void 0===a?void 0:a.label)||e.role}),(0,ze.jsx)("span",{className:"sm:hidden",children:((null===(n=$.find(t=>t.value===e.role))||void 0===n?void 0:n.label)||e.role).substring(0,3)})]})}),(0,ze.jsx)("td",{className:"hidden md:table-cell px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-900",children:"super_user"===e.role?(0,ze.jsx)("span",{className:"text-blue-600 font-medium",children:"All Sites"}):e.sites&&e.sites.length>0?(0,ze.jsx)("div",{className:"max-w-32 overflow-hidden",children:(0,ze.jsx)("div",{className:"truncate",title:e.sites.map(e=>"object"===typeof e?e.name:e).join(", "),children:e.sites.map(e=>"object"===typeof e?e.name:e).join(", ")})}):(0,ze.jsx)("span",{className:"text-gray-500 italic",children:"No sites"})}),(0,ze.jsx)("td",{className:"hidden lg:table-cell px-3 sm:px-6 py-4 whitespace-nowrap text-sm text-gray-500",children:(r=e.last_login,r?new Date(r).toLocaleDateString():"Never")}),(0,ze.jsx)("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap",children:(0,ze.jsxs)("span",{className:"inline-flex px-2 py-1 text-xs font-medium rounded-full ".concat(e.is_active?"bg-green-100 text-green-800":"bg-red-100 text-red-800"),children:[(0,ze.jsx)("span",{className:"hidden sm:inline",children:e.is_active?"Active":"Inactive"}),(0,ze.jsx)("span",{className:"sm:hidden",children:e.is_active?"A":"I"})]})}),(0,ze.jsxs)("td",{className:"px-3 sm:px-6 py-4 whitespace-nowrap text-sm font-medium space-x-1 sm:space-x-2",children:[i("userManagement","update")&&(0,ze.jsx)("button",{className:"text-purple-600 hover:text-purple-900 disabled:opacity-50",onClick:()=>(e=>{Y(e.role)?(S(e),j(!0)):T({show:!0,type:"error",title:"Update Failed",message:"Unable to update user information",details:"You cannot manage users with ".concat(e.role," role")})})(e),disabled:E,title:"Edit User",children:(0,ze.jsx)("i",{className:"fas fa-edit"})}),i("userManagement","delete")&&(0,ze.jsx)("button",{className:"text-red-600 hover:text-red-900 disabled:opacity-50",onClick:()=>(e=>{Y(e.role)?(_(e),N(!0)):T({show:!0,type:"error",title:"Delete Failed",message:"Unable to delete user",details:"You cannot manage users with ".concat(e.role," role")})})(e),disabled:E,title:"Delete User",children:(0,ze.jsx)("i",{className:"fas fa-trash"})}),!1]})]},e.id)})})]})}),0===d.length&&(0,ze.jsxs)("div",{className:"text-center py-8",children:[(0,ze.jsx)("i",{className:"fas fa-users text-4xl text-gray-400 mb-4"}),(0,ze.jsx)("p",{className:"text-gray-500",children:"No users found. Create your first team member!"})]}),d.length>0&&0===de.length&&(0,ze.jsxs)("div",{className:"text-center py-8",children:[(0,ze.jsx)("i",{className:"fas fa-search text-4xl text-gray-400 mb-4"}),(0,ze.jsx)("p",{className:"text-gray-500",children:"No users match your current filters."}),(0,ze.jsx)("button",{onClick:()=>{O(""),F("all"),M("all")},className:"mt-2 text-purple-600 hover:text-purple-800 text-sm",children:"Clear all filters"})]})]}),(0,ze.jsxs)("div",{className:"flex items-center justify-between bg-white rounded-xl p-6 shadow-sm border border-gray-200",children:[(0,ze.jsxs)("button",{className:"px-6 py-3 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 font-medium transition-colors",onClick:()=>a("/data"),children:[(0,ze.jsx)("i",{className:"fas fa-arrow-left mr-2"}),"Back"]}),(0,ze.jsxs)("div",{className:"flex items-center space-x-4",children:[(0,ze.jsxs)("span",{className:"text-sm text-gray-600",children:[(0,ze.jsx)("i",{className:"fas fa-users mr-2"}),d.length," user",1!==d.length?"s":""," in your team",de.length!==d.length&&(0,ze.jsxs)("span",{className:"ml-2 text-purple-600",children:["(",de.length," shown)"]})]}),(0,ze.jsxs)("button",{className:"px-8 py-3 bg-gradient-to-r from-blue-600 to-purple-600 text-white rounded-lg hover:shadow-lg font-medium",onClick:()=>{window.location.href="/dashboard"},children:["Continue",(0,ze.jsx)("i",{className:"fas fa-arrow-right ml-2"})]})]})]}),(0,ze.jsx)(ee,{isOpen:x,onClose:()=>p(!1),onRoleSelect:e=>{if(t=e.value,!n||!({super_user:["super_user","admin","site_manager","uploader","viewer","meter_manager"],admin:["admin","site_manager","uploader","viewer","meter_manager"],site_manager:["uploader","viewer","meter_manager"],uploader:[],viewer:[],meter_manager:[]}[n.role]||[]).includes(t))return T({show:!0,type:"error",title:"Create User Failed",message:"Unable to create user",details:"You cannot create users with ".concat(e.value," role")}),void p(!1);var t;if(g(e),p(!1),["site_manager","uploader","meter_manager"].includes(e.value))W(!0);else if("super_user"===e.value){const e=H.map(e=>e.id);V(e),b(!0)}else V([]),b(!0)}}),(0,ze.jsx)(re,{isOpen:B,onClose:()=>{W(!1),g(null),V([])},onSiteSelect:e=>{V(e),W(!1),b(!0)},selectedRole:h}),(0,ze.jsx)(le,{isOpen:y,onClose:()=>{b(!1),g(null),V([])},selectedRole:h,selectedSites:q,onSuccess:()=>{b(!1),g(null),V([]),K()}}),(0,ze.jsx)(ie,{isOpen:v,onClose:()=>{j(!1),S(null)},user:k,onSuccess:()=>{j(!1),S(null),K()}}),(0,ze.jsx)(oe,{isOpen:w,onClose:()=>{N(!1),_(null)},user:C,onConfirm:async()=>{if(C){P(!0);try{const e=await Ie("".concat(Ue,"/api/users/").concat(C.id,"/"),{method:"DELETE"});if(e.ok)Z("success","User Deleted Successfully","".concat(C.name," has been removed from the system"),"The user no longer has access to the platform"),K(),N(!1),_(null);else{const t=await e.json();Z("error","Delete Failed","Unable to delete user",t.error||"Unknown error occurred")}}catch(e){console.error("Delete user failed:",e),Z("error","Delete Failed","Network error occurred","Please check your connection and try again")}finally{P(!1)}}},isProcessing:E}),(0,ze.jsx)(se,{isOpen:U,onClose:()=>z(!1)}),(0,ze.jsx)(ne,{isOpen:I,onClose:()=>G(!1)}),(0,ze.jsx)(ce,{notification:A,onClose:()=>{T({show:!1,type:"",title:"",message:"",details:""})}})]})},Ka=()=>{const{user:e,selectedCompany:t,hasPermission:s}=Be(),[a,n]=(0,r.useState)([]),[l,i]=(0,r.useState)(!0),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),f=["Abu Dhabi","Dubai","Sharjah","Ajman","Umm Al Quwain","Ras Al Khaimah","Fujairah"];(0,r.useEffect)(()=>{t&&s("siteManagement","read")&&x()},[t]);const x=async()=>{try{i(!0);const e=await Ie("".concat(Ue,"/api/companies/").concat(t.id,"/sites/"));if(e.ok){const t=await e.json();n(Array.isArray(t)?t:t.results||[])}}catch(e){console.error("Failed to fetch sites:",e)}finally{i(!1)}},p=e=>{let{isOpen:s,onClose:a,onSuccess:n,editSite:l=null}=e;const[i,c]=(0,r.useState)({name:"",emirate:"",address:"",description:""}),[d,u]=(0,r.useState)(!1);(0,r.useEffect)(()=>{c(l?{name:l.name||"",emirate:l.emirate||"",address:l.address||"",description:l.description||""}:{name:"",emirate:"",address:"",description:""})},[l]);if(!s)return null;const m=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-md",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:l?"Edit Site":"Add New Site"}),(0,ze.jsxs)("form",{onSubmit:async e=>{e.preventDefault(),u(!0);try{const e=l?"".concat(Ue,"/api/sites/").concat(l.id,"/"):"".concat(Ue,"/api/companies/").concat(t.id,"/sites/"),s=l?"PUT":"POST";(await Ie(e,{method:s,body:JSON.stringify(i)})).ok&&(n(),c({name:"",emirate:"",address:"",description:""}))}catch(s){console.error("Failed to save site:",s)}finally{u(!1)}},className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Site Name"}),(0,ze.jsx)("input",{type:"text",required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"e.g., Dubai Main Hotel",value:i.name,onChange:e=>c(Me(Me({},i),{},{name:e.target.value}))})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Emirate"}),(0,ze.jsxs)("select",{required:!0,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",value:i.emirate,onChange:e=>c(Me(Me({},i),{},{emirate:e.target.value})),children:[(0,ze.jsx)("option",{value:"",children:"Select Emirate"}),f.map(e=>(0,ze.jsx)("option",{value:e,children:e},e))]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Address"}),(0,ze.jsx)("textarea",{rows:3,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Full address of the site",value:i.address,onChange:e=>c(Me(Me({},i),{},{address:e.target.value}))})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Description (Optional)"}),(0,ze.jsx)("textarea",{rows:2,className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2 focus:ring-purple-500 focus:border-purple-500",placeholder:"Additional details about this site",value:i.description,onChange:e=>c(Me(Me({},i),{},{description:e.target.value}))})]}),(0,ze.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,ze.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,ze.jsx)("button",{type:"submit",disabled:d,className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700 disabled:opacity-50",children:d?l?"Updating...":"Creating...":l?"Update Site":"Create Site"})]})]})]})});return(0,o.createPortal)(m,document.body)};return s("siteManagement","read")?l?(0,ze.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),(0,ze.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading sites..."})]}):(0,ze.jsxs)("div",{className:"space-y-6",children:[(0,ze.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Site Management"}),(0,ze.jsxs)("p",{className:"text-gray-600",children:["Manage locations and sites for ",null===t||void 0===t?void 0:t.name]})]}),s("siteManagement","create")&&(0,ze.jsxs)("button",{onClick:()=>d(!0),className:"bg-purple-600 text-white px-4 py-2 rounded-lg hover:bg-purple-700 flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-plus mr-2"}),"Add Site"]})]}),(0,ze.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:a.map(e=>(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-md p-6 hover:shadow-lg transition-shadow",children:[(0,ze.jsxs)("div",{className:"flex justify-between items-start mb-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:e.name}),(0,ze.jsx)("p",{className:"text-sm text-purple-600 font-medium",children:e.emirate})]}),(0,ze.jsxs)("div",{className:"flex space-x-2",children:[s("siteManagement","update")&&(0,ze.jsx)("button",{onClick:()=>{m(e),d(!0)},className:"text-gray-500 hover:text-purple-600",title:"Edit Site",children:(0,ze.jsx)("i",{className:"fas fa-edit"})}),s("siteManagement","delete")&&(0,ze.jsx)("button",{onClick:()=>(async e=>{if(window.confirm("Are you sure you want to delete this site? This action cannot be undone."))try{(await Ie("".concat(Ue,"/api/sites/").concat(e,"/"),{method:"DELETE"})).ok&&n(a.filter(t=>t.id!==e))}catch(t){console.error("Failed to delete site:",t)}})(e.id),className:"text-gray-500 hover:text-red-600",title:"Delete Site",children:(0,ze.jsx)("i",{className:"fas fa-trash"})})]})]}),e.address&&(0,ze.jsx)("div",{className:"mb-4",children:(0,ze.jsxs)("p",{className:"text-sm text-gray-600",children:[(0,ze.jsx)("i",{className:"fas fa-map-marker-alt mr-2"}),e.address]})}),e.description&&(0,ze.jsx)("div",{className:"mb-4",children:(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:e.description})}),(0,ze.jsxs)("div",{className:"grid grid-cols-2 gap-4 pt-4 border-t border-gray-200",children:[(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:e.users_count||0}),(0,ze.jsx)("div",{className:"text-xs text-gray-500",children:"Assigned Users"})]}),(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"text-lg font-semibold text-gray-900",children:e.meters_count||0}),(0,ze.jsx)("div",{className:"text-xs text-gray-500",children:"Active Meters"})]})]}),(0,ze.jsxs)("div",{className:"mt-4 pt-4 border-t border-gray-200 flex justify-between",children:[(0,ze.jsxs)("button",{className:"text-sm text-purple-600 hover:text-purple-700 flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-users mr-1"}),"Manage Users"]}),(0,ze.jsxs)("button",{className:"text-sm text-purple-600 hover:text-purple-700 flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-chart-bar mr-1"}),"View Data"]})]})]},e.id))}),0===a.length&&(0,ze.jsxs)("div",{className:"text-center py-12",children:[(0,ze.jsx)("div",{className:"text-gray-400 mb-4",children:(0,ze.jsx)("i",{className:"fas fa-building text-6xl"})}),(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-2",children:"No sites configured"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-6",children:"Create your first site to start collecting ESG data across multiple locations."}),s("siteManagement","create")&&(0,ze.jsx)("button",{onClick:()=>d(!0),className:"bg-purple-600 text-white px-6 py-2 rounded-lg hover:bg-purple-700",children:"Create First Site"})]}),(0,ze.jsx)(p,{isOpen:c,onClose:()=>{d(!1),m(null)},onSuccess:()=>{d(!1),m(null),x()},editSite:u})]}):(0,ze.jsx)("div",{className:"text-center py-8",children:(0,ze.jsxs)("div",{className:"text-gray-500",children:[(0,ze.jsx)("i",{className:"fas fa-lock text-4xl mb-4"}),(0,ze.jsx)("p",{children:"You don't have permission to access site management."})]})})},Xa=()=>{const{user:e,selectedCompany:t,userSites:s,hasPermission:a}=Be(),[n,l]=(0,r.useState)([]),[i,c]=(0,r.useState)([]),[d,u]=(0,r.useState)([]),[m,f]=(0,r.useState)(!0),[x,p]=(0,r.useState)(null),[h,g]=(0,r.useState)(null),[y,b]=(0,r.useState)("all"),[v,j]=(0,r.useState)(!1),[w,N]=(0,r.useState)(!1),[k,S]=(0,r.useState)(null),[C,_]=(0,r.useState)([]),[E,P]=(0,r.useState)(!1);(0,r.useEffect)(()=>{t&&a("dataChecklist","assign")&&A()},[t]);const A=async()=>{try{f(!0),await Promise.all([T(),L(),O()])}catch(e){console.error("Failed to fetch data:",e)}finally{f(!1)}},T=async()=>{try{const e=await Ie("".concat(Ue,"/api/companies/").concat(t.id,"/data-elements/"));if(e.ok){const t=await e.json();l(Array.isArray(t)?t:t.results||[])}}catch(e){console.error("Failed to fetch data elements:",e)}},L=async()=>{try{const e=await Ie("".concat(Ue,"/api/tasks/assignments/"));if(e.ok){const t=await e.json();c(Array.isArray(t)?t:t.results||[])}}catch(e){console.error("Failed to fetch assignments:",e)}},O=async()=>{try{const e=await Ie("".concat(Ue,"/api/users/my-team/"));if(e.ok){const t=await e.json();u(Array.isArray(t)?t:t.results||[])}}catch(e){console.error("Failed to fetch users:",e)}},R=(e,t)=>i.find(s=>s.data_element_id===e&&s.site_id===t),F=async e=>{S(e),N(!0),P(!0);try{const e=await Ie("".concat(Ue,"/api/users/my-team/"));if(e.ok){const t=await e.json();_(t)}}catch(t){console.error("Error fetching users:",t),_([])}finally{P(!1)}},D=e=>{if(!e)return(0,ze.jsx)("i",{className:"fas fa-user-plus text-gray-400",title:"Unassigned"});const t={pending:(0,ze.jsx)("i",{className:"fas fa-clock text-yellow-500",title:"Pending"}),in_progress:(0,ze.jsx)("i",{className:"fas fa-play text-orange-500",title:"In Progress"}),completed:(0,ze.jsx)("i",{className:"fas fa-check text-green-500",title:"Completed"}),overdue:(0,ze.jsx)("i",{className:"fas fa-exclamation-triangle text-red-500",title:"Overdue"})};return t[e.status]||t.pending},M=n.filter(e=>"assigned"===y?s.some(t=>R(e.id,t.id)):"unassigned"!==y||s.some(t=>!R(e.id,t.id))),U=e=>{let{isOpen:t,onClose:a,onSuccess:l}=e;const[i,c]=(0,r.useState)({assignTo:"",site:"",elements:[],action:"assign"});if(!t)return null;const u=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg p-6 w-full max-w-2xl",children:[(0,ze.jsx)("h3",{className:"text-lg font-medium text-gray-900 mb-4",children:"Bulk Assignment"}),(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Assign To"}),(0,ze.jsxs)("select",{className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",value:i.assignTo,onChange:e=>c(Me(Me({},i),{},{assignTo:e.target.value})),children:[(0,ze.jsx)("option",{value:"",children:"Select User"}),d.filter(e=>["uploader","site_manager"].includes(e.role)).map(e=>(0,ze.jsx)("option",{value:e.id,children:e.name},e.id))]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700",children:"Site"}),(0,ze.jsxs)("select",{className:"mt-1 block w-full border border-gray-300 rounded-md px-3 py-2",value:i.site,onChange:e=>c(Me(Me({},i),{},{site:e.target.value})),children:[(0,ze.jsx)("option",{value:"",children:"Select Site"}),s.map(e=>(0,ze.jsx)("option",{value:e.id,children:e.name},e.id))]})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Assignment Options"}),(0,ze.jsxs)("div",{className:"space-y-2",children:[(0,ze.jsxs)("button",{type:"button",className:"w-full text-left p-3 border rounded-lg hover:bg-gray-50",onClick:()=>{c(Me(Me({},i),{},{elements:n.filter(e=>"Environmental"===e.category).map(e=>e.id)}))},children:[(0,ze.jsx)("div",{className:"font-medium",children:"Assign all Environmental tasks"}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:"All electricity, water, waste, and energy tasks"})]}),(0,ze.jsxs)("button",{type:"button",className:"w-full text-left p-3 border rounded-lg hover:bg-gray-50",onClick:()=>{c(Me(Me({},i),{},{elements:n.filter(e=>"Social"===e.category).map(e=>e.id)}))},children:[(0,ze.jsx)("div",{className:"font-medium",children:"Assign all Social tasks"}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:"Employee training, community initiatives"})]}),(0,ze.jsxs)("button",{type:"button",className:"w-full text-left p-3 border rounded-lg hover:bg-gray-50",onClick:()=>{c(Me(Me({},i),{},{elements:n.filter(e=>e.is_metered).map(e=>e.id)}))},children:[(0,ze.jsx)("div",{className:"font-medium",children:"Assign all metered tasks"}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:"Tasks requiring meter readings"})]})]})]}),(0,ze.jsxs)("div",{className:"flex justify-end space-x-3 pt-4",children:[(0,ze.jsx)("button",{type:"button",onClick:a,className:"px-4 py-2 border border-gray-300 rounded-md text-gray-700 hover:bg-gray-50",children:"Cancel"}),(0,ze.jsx)("button",{type:"button",onClick:async()=>{try{(await Ie("".concat(Ue,"/api/tasks/bulk-assign/"),{method:"POST",body:JSON.stringify(i)})).ok&&l()}catch(e){console.error("Failed to bulk assign:",e)}},className:"px-4 py-2 bg-purple-600 text-white rounded-md hover:bg-purple-700",children:"Apply Assignment"})]})]})]})});return(0,o.createPortal)(u,document.body)};return a("dataChecklist","assign")?m?(0,ze.jsxs)("div",{className:"flex justify-center items-center py-8",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600"}),(0,ze.jsx)("span",{className:"ml-3 text-gray-600",children:"Loading task assignments..."})]}):(0,ze.jsxs)("div",{className:"space-y-6",children:[(0,ze.jsxs)("div",{className:"flex justify-between items-center",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h1",{className:"text-2xl font-bold text-gray-900",children:"Task Assignment"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Assign data collection tasks to team members"})]}),(0,ze.jsx)("div",{className:"flex space-x-3",children:(0,ze.jsxs)("button",{onClick:()=>j(!0),className:"bg-green-600 text-white px-4 py-2 rounded-lg hover:bg-green-700 flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-layer-group mr-2"}),"Bulk Assign"]})})]}),(0,ze.jsxs)("div",{className:"flex space-x-4",children:[(0,ze.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-2 bg-white",value:y,onChange:e=>b(e.target.value),children:[(0,ze.jsx)("option",{value:"all",children:"All Tasks"}),(0,ze.jsx)("option",{value:"assigned",children:"Assigned Tasks"}),(0,ze.jsx)("option",{value:"unassigned",children:"Unassigned Tasks"})]}),(0,ze.jsxs)("select",{className:"border border-gray-300 rounded-md px-3 py-2 bg-white",value:h||"",onChange:e=>g(e.target.value||null),children:[(0,ze.jsx)("option",{value:"",children:"All Users"}),d.map(e=>(0,ze.jsxs)("option",{value:e.id,children:[e.name," (",e.role,")"]},e.id))]})]}),(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow overflow-hidden",children:[(0,ze.jsxs)("table",{className:"min-w-full divide-y divide-gray-200",children:[(0,ze.jsx)("thead",{className:"bg-gray-50",children:(0,ze.jsxs)("tr",{children:[(0,ze.jsx)("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Data Element"}),s.map(e=>(0,ze.jsx)("th",{className:"px-6 py-3 text-center text-xs font-medium text-gray-500 uppercase tracking-wider",children:e.name},e.id))]})}),(0,ze.jsx)("tbody",{className:"bg-white divide-y divide-gray-200",children:M.map(e=>(0,ze.jsxs)("tr",{className:"hover:bg-gray-50",children:[(0,ze.jsx)("td",{className:"px-6 py-4",children:(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name}),(0,ze.jsxs)("div",{className:"text-sm text-gray-500",children:[e.category," \u2022 ",e.frequency,e.is_metered&&(0,ze.jsx)("span",{className:"ml-2 text-purple-600",children:"\ud83d\udcca Metered"})]})]})}),s.map(t=>{var s;const a=R(e.id,t.id);return(0,ze.jsx)("td",{className:"px-6 py-4 text-center",children:(0,ze.jsxs)("div",{className:"flex items-center justify-center space-x-2",children:[D(a),a?(0,ze.jsxs)("div",{className:"text-sm",children:[(0,ze.jsx)("div",{className:"font-medium text-gray-900",children:(null===(s=d.find(e=>e.id===a.assigned_to))||void 0===s?void 0:s.name)||"Unknown User"}),(0,ze.jsx)("div",{className:"text-xs text-gray-500",children:new Date(a.assigned_at).toLocaleDateString()}),(0,ze.jsxs)("div",{className:"flex items-center space-x-1 mt-1",children:[(0,ze.jsx)("button",{onClick:()=>F({id:a.id,name:e.name,description:e.category,unit:e.unit||"N/A",frequency:e.frequency,meter:e.is_metered?"Metered":"N/A"}),className:"text-xs text-blue-600 hover:text-blue-800",children:"Reassign"}),(0,ze.jsx)("button",{onClick:()=>(async e=>{try{(await Ie("".concat(Ue,"/api/tasks/assignments/").concat(e,"/"),{method:"DELETE"})).ok&&L()}catch(t){console.error("Failed to unassign task:",t)}})(a.id),className:"text-xs text-red-600 hover:text-red-800",children:"Unassign"})]})]}):(0,ze.jsxs)("div",{className:"space-y-1",children:[(0,ze.jsxs)("select",{className:"text-sm border border-gray-300 rounded px-2 py-1 w-full",onChange:s=>{s.target.value&&(async(e,t,s)=>{try{(await Ie("".concat(Ue,"/api/tasks/assign/"),{method:"POST",body:JSON.stringify({data_element_id:e,site_id:t,assigned_to:s})})).ok&&L()}catch(a){console.error("Failed to assign task:",a)}})(e.id,t.id,s.target.value)},children:[(0,ze.jsx)("option",{value:"",children:"Quick assign..."}),d.filter(e=>["uploader","site_manager"].includes(e.role)).map(e=>(0,ze.jsx)("option",{value:e.id,children:e.name},e.id))]}),(0,ze.jsxs)("button",{onClick:()=>F({id:"".concat(e.id,"-").concat(t.id),name:e.name,description:e.category,unit:e.unit||"N/A",frequency:e.frequency,meter:e.is_metered?"Metered":"N/A",site:t.name}),className:"text-xs text-purple-600 hover:text-purple-800 bg-purple-50 px-2 py-1 rounded w-full",children:[(0,ze.jsx)("i",{className:"fas fa-user-plus mr-1"}),"Assign Task"]})]})]})},t.id)})]},e.id))})]}),0===M.length&&(0,ze.jsxs)("div",{className:"text-center py-8",children:[(0,ze.jsx)("i",{className:"fas fa-tasks text-4xl text-gray-400 mb-4"}),(0,ze.jsx)("p",{className:"text-gray-500",children:"No data elements found matching the selected filters."})]})]}),(0,ze.jsxs)("div",{className:"grid grid-cols-1 md:grid-cols-4 gap-4",children:[(0,ze.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-gray-900",children:n.length}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:"Total Tasks"})]}),(0,ze.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-green-600",children:i.filter(e=>"completed"===e.status).length}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:"Completed"})]}),(0,ze.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-orange-600",children:i.filter(e=>"in_progress"===e.status).length}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:"In Progress"})]}),(0,ze.jsxs)("div",{className:"bg-white p-4 rounded-lg shadow",children:[(0,ze.jsx)("div",{className:"text-2xl font-bold text-red-600",children:i.filter(e=>"overdue"===e.status).length}),(0,ze.jsx)("div",{className:"text-sm text-gray-500",children:"Overdue"})]})]}),(0,ze.jsx)(U,{isOpen:v,onClose:()=>j(!1),onSuccess:()=>{j(!1),L()}}),w&&k&&(0,o.createPortal)((0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,ze.jsxs)("div",{className:"bg-white rounded-xl p-6 max-w-md w-full mx-4 max-h-96 overflow-y-auto",children:[(0,ze.jsxs)("div",{className:"flex items-center justify-between mb-4",children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Assign Task"}),(0,ze.jsx)("button",{className:"text-gray-400 hover:text-gray-600",onClick:()=>{N(!1),S(null)},children:(0,ze.jsx)("i",{className:"fas fa-times"})})]}),(0,ze.jsxs)("div",{className:"mb-4 p-3 bg-gray-50 rounded-lg",children:[(0,ze.jsx)("h4",{className:"font-medium text-gray-900 mb-1",children:k.name}),(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:k.description}),(0,ze.jsxs)("div",{className:"flex items-center space-x-4 mt-2 text-xs text-gray-500",children:[(0,ze.jsxs)("span",{children:["Unit: ",k.unit]}),(0,ze.jsxs)("span",{children:["Frequency: ",k.frequency]}),k.meter&&(0,ze.jsxs)("span",{children:["Meter: ",k.meter]}),k.site&&(0,ze.jsxs)("span",{children:["Site: ",k.site]})]})]}),(0,ze.jsxs)("div",{className:"mb-4",children:[(0,ze.jsx)("label",{className:"block text-sm font-medium text-gray-700 mb-2",children:"Select User to Assign:"}),E?(0,ze.jsxs)("div",{className:"flex items-center justify-center py-4",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-6 w-6 border-b-2 border-blue-600"}),(0,ze.jsx)("span",{className:"ml-2 text-sm text-gray-600",children:"Loading users..."})]}):0===C.length?(0,ze.jsx)("div",{className:"text-sm text-gray-500 py-4 text-center",children:"No users available for assignment"}):(0,ze.jsx)("div",{className:"space-y-2 max-h-48 overflow-y-auto",children:C.map(e=>(0,ze.jsxs)("div",{className:"flex items-center justify-between p-3 border rounded-lg hover:bg-gray-50 cursor-pointer",onClick:()=>(async(e,t)=>{try{(await Ie("".concat(Ue,"/api/data-collection/assign-task/"),{method:"POST",body:JSON.stringify({task_id:t,assigned_user_id:e})})).ok?(N(!1),S(null),L()):console.error("Failed to assign task")}catch(s){console.error("Error assigning task:",s)}})(e.id,k.id),children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3",children:[(0,ze.jsx)("div",{className:"w-8 h-8 bg-purple-100 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-user text-purple-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("div",{className:"text-sm font-medium text-gray-900",children:e.name||"".concat(e.first_name," ").concat(e.last_name).trim()||e.username}),(0,ze.jsxs)("div",{className:"text-xs text-gray-500",children:[e.role.replace("_"," ").replace(/\b\w/g,e=>e.toUpperCase())," \u2022 ",e.email]})]})]}),(0,ze.jsx)("button",{className:"text-blue-600 hover:text-blue-800",children:(0,ze.jsx)("i",{className:"fas fa-plus-circle"})})]},e.id))})]}),(0,ze.jsx)("div",{className:"flex justify-end space-x-3",children:(0,ze.jsx)("button",{onClick:()=>{N(!1),S(null)},className:"px-4 py-2 text-gray-600 border border-gray-300 rounded-lg hover:bg-gray-50",children:"Cancel"})})]})}),document.body)]}):(0,ze.jsx)("div",{className:"text-center py-8",children:(0,ze.jsxs)("div",{className:"text-gray-500",children:[(0,ze.jsx)("i",{className:"fas fa-lock text-4xl mb-4"}),(0,ze.jsx)("p",{children:"You don't have permission to assign tasks."})]})})},Za=()=>{const e=ae(),{user:t,resetPassword:s}=Be(),[a,n]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[l,i]=(0,r.useState)(""),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(!1),[f,x]=(0,r.useState)(!0),[p,h]=(0,r.useState)(""),[g,y]=(0,r.useState)(null),[b,v]=(0,r.useState)(!1);r.useEffect(()=>{t&&!t.must_reset_password?e("/dashboard"):t&&t.must_reset_password&&f&&j()},[t,e]);const j=async()=>{if(t&&t.email)try{const e=await fetch("".concat(Ue,"/api/auth/send-reset-code/"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t.email})}),s=await e.json();e.ok&&s.success?(y(s),s.verification_code&&v(!0)):i(s.message||"Failed to send verification code")}catch(l){i("Network error. Please try again."),console.error("Error sending verification code:",l)}},w=e=>{n(Me(Me({},a),{},{[e.target.name]:e.target.value})),i("")},N=()=>{m(!1),e("/dashboard")},k=()=>{const e=(0,ze.jsx)("div",{className:"fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-[100000]",style:{position:"fixed",top:0,left:0,right:0,bottom:0,width:"100vw",height:"100vh"},children:(0,ze.jsx)("div",{className:"bg-white rounded-xl p-8 max-w-md w-full mx-4 shadow-2xl",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"mx-auto flex items-center justify-center h-16 w-16 rounded-full bg-green-100 mb-6",children:(0,ze.jsx)("i",{className:"fas fa-check text-green-600 text-2xl"})}),(0,ze.jsx)("h3",{className:"text-xl font-semibold text-gray-900 mb-4",children:"Password Reset Successfully!"}),(0,ze.jsx)("p",{className:"text-gray-600 mb-8",children:"Your password has been updated successfully. You can now access the dashboard with your new password."}),(0,ze.jsx)("div",{className:"flex space-x-4",children:(0,ze.jsxs)("button",{onClick:N,className:"flex-1 bg-gradient-to-r from-green-600 to-blue-600 text-white py-3 px-6 rounded-lg font-medium hover:from-green-700 hover:to-blue-700 transition-all duration-200",children:[(0,ze.jsx)("i",{className:"fas fa-arrow-right mr-2"}),"Continue to Dashboard"]})})]})})});return(0,o.createPortal)(e,document.body)};return(0,ze.jsxs)(ze.Fragment,{children:[b&&(null===g||void 0===g?void 0:g.verification_code)&&(0,ze.jsx)(ja,{type:"code",message:"\ud83e\uddea Testing Mode - Password Reset Code Generated!",code:g.verification_code,duration:15e3,onClose:()=>v(!1)}),(0,ze.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-blue-50 via-white to-green-50 flex items-center justify-center py-12 px-4 sm:px-6 lg:px-8",children:(0,ze.jsxs)("div",{className:"max-w-md w-full space-y-8",children:[(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"mx-auto h-12 w-12 bg-yellow-100 rounded-xl flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-key text-yellow-600 text-xl"})}),(0,ze.jsx)("h2",{className:"mt-6 text-3xl font-bold text-gray-900",children:f?"Verify Your Identity":"Reset Your Password"}),(0,ze.jsx)("p",{className:"mt-2 text-sm text-gray-600",children:f?"Enter the verification code sent to your email":"You must reset your password to continue"})]}),!f&&("super_user"===(null===t||void 0===t?void 0:t.role)?null:(0,ze.jsx)("div",{className:"mb-4 p-4 bg-blue-50 border border-blue-200 rounded-lg",children:(0,ze.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle text-blue-600"}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("p",{className:"text-sm font-medium text-blue-800",children:"First time login?"}),(0,ze.jsx)("p",{className:"text-sm text-blue-700",children:"Use your company code as the current password. You can get this from your administrator."})]})]})})),f?(0,ze.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async e=>{if(e.preventDefault(),d(!0),i(""),!p||6!==p.length)return i("Please enter a valid 6-digit verification code"),void d(!1);try{const e=await fetch("".concat(Ue,"/api/auth/verify-reset-code/"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({email:t.email,verification_code:p})}),s=await e.json();e.ok&&s.verified?(x(!1),i("")):i(s.error||"Invalid verification code")}catch(l){i("Network error. Please try again.")}d(!1)},children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"verificationCode",className:"block text-sm font-medium text-gray-700",children:"Verification Code"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"verificationCode",name:"verificationCode",type:"text",maxLength:"6",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm text-center text-xl letter-spacing-wide",placeholder:"123456",value:p,onChange:e=>{h(e.target.value),i("")}}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,ze.jsx)("i",{className:"fas fa-shield-alt text-gray-400"})})]}),(0,ze.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Enter the 6-digit code sent to your email"})]}),l&&(0,ze.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,ze.jsxs)("div",{className:"flex",children:[(0,ze.jsx)("div",{className:"flex-shrink-0",children:(0,ze.jsx)("i",{className:"fas fa-exclamation-circle text-red-400"})}),(0,ze.jsx)("div",{className:"ml-3",children:(0,ze.jsx)("h3",{className:"text-sm font-medium text-red-800",children:l})})]})}),(0,ze.jsx)("div",{children:(0,ze.jsx)("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:c?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Verifying..."]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-check-circle mr-2"}),"Verify Code"]})})}),(0,ze.jsx)("div",{className:"text-center",children:(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Didn't receive the code? Check your spam folder or contact your administrator"})})]}):(0,ze.jsxs)("form",{className:"mt-8 space-y-6",onSubmit:async e=>{if(e.preventDefault(),i(""),d(!0),!a.currentPassword||!a.newPassword||!a.confirmPassword)return i("All fields are required"),void d(!1);if(a.newPassword!==a.confirmPassword)return i("New passwords do not match"),void d(!1);if(a.newPassword.length<6)return i("New password must be at least 6 characters long"),void d(!1);if(a.currentPassword===a.newPassword)return i("New password must be different from current password"),void d(!1);try{const e=await s(a.currentPassword,a.newPassword);e.success?m(!0):i(e.error)}catch(l){i("An error occurred. Please try again.")}finally{d(!1)}},children:[(0,ze.jsxs)("div",{className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700",children:"Current Password"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"currentPassword",name:"currentPassword",type:"password",autoComplete:"current-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your current password",value:a.currentPassword,onChange:w}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,ze.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700",children:"New Password"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"newPassword",name:"newPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Enter your new password",value:a.newPassword,onChange:w}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,ze.jsx)("i",{className:"fas fa-key text-gray-400"})})]}),(0,ze.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters long"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700",children:"Confirm New Password"}),(0,ze.jsxs)("div",{className:"mt-1 relative",children:[(0,ze.jsx)("input",{id:"confirmPassword",name:"confirmPassword",type:"password",autoComplete:"new-password",required:!0,className:"appearance-none relative block w-full px-3 py-2 border border-gray-300 placeholder-gray-500 text-gray-900 rounded-lg focus:outline-none focus:ring-blue-500 focus:border-blue-500 focus:z-10 sm:text-sm",placeholder:"Confirm your new password",value:a.confirmPassword,onChange:w}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,ze.jsx)("i",{className:"fas fa-check text-gray-400"})})]})]})]}),l&&(0,ze.jsx)("div",{className:"rounded-md bg-red-50 p-4",children:(0,ze.jsxs)("div",{className:"flex",children:[(0,ze.jsx)("div",{className:"flex-shrink-0",children:(0,ze.jsx)("i",{className:"fas fa-exclamation-circle text-red-400"})}),(0,ze.jsx)("div",{className:"ml-3",children:(0,ze.jsx)("h3",{className:"text-sm font-medium text-red-800",children:l})})]})}),(0,ze.jsx)("div",{children:(0,ze.jsx)("button",{type:"submit",disabled:c,className:"group relative w-full flex justify-center py-3 px-4 border border-transparent text-sm font-medium rounded-lg text-white bg-gradient-to-r from-blue-600 to-green-600 hover:from-blue-700 hover:to-green-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed transition-all duration-200",children:c?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Resetting Password..."]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-save mr-2"}),"Reset Password"]})})}),(0,ze.jsx)("div",{className:"text-center",children:(0,ze.jsx)("p",{className:"text-sm text-gray-600",children:"Need help? Contact your system administrator"})})]})]})}),u&&(0,ze.jsx)(k,{})]})},en=()=>{const e=ae(),{user:t,checkAuthStatus:s}=Be(),[a,n]=(0,r.useState)({newPassword:"",confirmPassword:""}),[l,i]=(0,r.useState)(""),[o,c]=(0,r.useState)(!1),[d,u]=(0,r.useState)(null);(0,r.useEffect)(()=>{(async()=>{if(t){if(u(t),!t.must_reset_password){const s={super_user:"/onboard",admin:"/onboard",site_manager:"/onboard",viewer:"/onboard",meter_manager:"/meter",uploader:"/data"}[t.role]||"/dashboard";e(s)}}else await s()})()},[t,e,s]);const m=e=>{n(Me(Me({},a),{},{[e.target.name]:e.target.value})),i("")};return d?(0,ze.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-400 to-blue-600 flex items-center justify-center p-4",children:(0,ze.jsxs)("div",{className:"bg-white rounded-lg shadow-xl p-8 w-full max-w-md",children:[(0,ze.jsxs)("div",{className:"text-center mb-8",children:[(0,ze.jsx)("div",{className:"mx-auto w-16 h-16 bg-purple-100 rounded-full flex items-center justify-center mb-4",children:(0,ze.jsx)("i",{className:"fas fa-key text-purple-600 text-2xl"})}),(0,ze.jsx)("h2",{className:"text-2xl font-bold text-gray-900",children:"Welcome to ESG Portal!"}),(0,ze.jsxs)("p",{className:"text-gray-600 mt-2",children:["Hi ",(0,ze.jsx)("span",{className:"font-medium text-purple-600",children:d.name}),", please create your password to complete account setup."]})]}),(0,ze.jsxs)("form",{onSubmit:async s=>{if(s.preventDefault(),c(!0),i(""),!a.newPassword||!a.confirmPassword)return i("Please fill in both password fields"),void c(!1);if(a.newPassword!==a.confirmPassword)return i("Passwords do not match"),void c(!1);if(a.newPassword.length<6)return i("Password must be at least 6 characters long"),void c(!1);try{const s=await fetch("".concat(Ue,"/api/auth/reset-password/"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({current_password:"temporary_setup_password",new_password:a.newPassword})}),n=await s.json();if(s.ok&&n.success){const s=(null===t||void 0===t?void 0:t.role)||(null===d||void 0===d?void 0:d.role);console.log("\u2705 Password setup completed for role: ".concat(s));const a={super_user:"/onboard",admin:"/onboard",site_manager:"/onboard",viewer:"/onboard",meter_manager:"/meter",uploader:"/data"}[s]||"/dashboard";console.log("\ud83c\udfaf Redirecting user with role ".concat(s," to: ").concat(a)),setTimeout(()=>{e(a)},100)}else i(n.error||"Failed to set up password")}catch(l){i("Network error. Please try again."),console.error("Error setting up password:",l)}finally{c(!1)}},className:"space-y-6",children:[l&&(0,ze.jsx)("div",{className:"p-4 bg-red-100 border border-red-200 text-red-800 rounded-lg",children:(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-triangle mr-2"}),(0,ze.jsx)("span",{className:"text-sm",children:l})]})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"New Password"}),(0,ze.jsxs)("div",{className:"relative",children:[(0,ze.jsx)("i",{className:"fas fa-lock absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,ze.jsx)("input",{type:"password",id:"newPassword",name:"newPassword",value:a.newPassword,onChange:m,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition duration-200",placeholder:"Enter your new password",required:!0})]}),(0,ze.jsx)("p",{className:"text-xs text-gray-500 mt-1",children:"Must be at least 6 characters long"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-2",children:"Confirm Password"}),(0,ze.jsxs)("div",{className:"relative",children:[(0,ze.jsx)("i",{className:"fas fa-lock absolute left-3 top-1/2 transform -translate-y-1/2 text-gray-400"}),(0,ze.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",value:a.confirmPassword,onChange:m,className:"w-full pl-10 pr-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-purple-500 focus:border-purple-500 transition duration-200",placeholder:"Confirm your password",required:!0})]})]}),(0,ze.jsx)("button",{type:"submit",disabled:o,className:"w-full bg-gradient-to-r from-purple-600 to-blue-600 text-white py-3 px-4 rounded-lg hover:from-purple-700 hover:to-blue-700 focus:ring-4 focus:ring-purple-500 focus:ring-opacity-50 transition duration-200 font-medium disabled:opacity-50 disabled:cursor-not-allowed",children:o?(0,ze.jsxs)("div",{className:"flex items-center justify-center",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-5 w-5 border-b-2 border-white mr-2"}),"Setting up password..."]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-check mr-2"}),"Complete Account Setup"]})})]}),(0,ze.jsx)("div",{className:"mt-6 text-center",children:(0,ze.jsxs)("p",{className:"text-xs text-gray-500",children:[(0,ze.jsx)("i",{className:"fas fa-shield-alt mr-1"}),"Your account will be ready to use after setting up your password"]})})]})}):(0,ze.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-400 to-blue-600 flex items-center justify-center p-4",children:(0,ze.jsx)("div",{className:"bg-white rounded-lg shadow-xl p-8 w-full max-w-md",children:(0,ze.jsxs)("div",{className:"text-center",children:[(0,ze.jsx)("div",{className:"animate-spin rounded-full h-8 w-8 border-b-2 border-purple-600 mx-auto"}),(0,ze.jsx)("p",{className:"mt-4 text-gray-600",children:"Setting up your account..."})]})})})},tn=()=>{const{user:e,resetPassword:t}=Be(),[s,a]=(0,r.useState)({currentPassword:"",newPassword:"",confirmPassword:""}),[n,l]=(0,r.useState)(""),[i,o]=(0,r.useState)(!1),[c,d]=(0,r.useState)({isOpen:!1,type:"info",title:"",message:""}),u=e=>{a(Me(Me({},s),{},{[e.target.name]:e.target.value})),l("")};return(0,ze.jsxs)("div",{className:"bg-white rounded-xl shadow-sm border border-gray-200 p-6",children:[(0,ze.jsxs)("div",{className:"flex items-center space-x-3 mb-6",children:[(0,ze.jsx)("div",{className:"w-10 h-10 bg-blue-100 rounded-lg flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-key text-blue-600"})}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("h3",{className:"text-lg font-semibold text-gray-900",children:"Change Password"}),(0,ze.jsx)("p",{className:"text-gray-600",children:"Update your account password"})]})]}),(0,ze.jsxs)("form",{onSubmit:async e=>{if(e.preventDefault(),l(""),o(!0),!s.currentPassword||!s.newPassword||!s.confirmPassword)return l("All fields are required"),void o(!1);if(s.newPassword!==s.confirmPassword)return l("New passwords do not match"),void o(!1);if(s.newPassword.length<6)return l("New password must be at least 6 characters long"),void o(!1);if(s.currentPassword===s.newPassword)return l("New password must be different from current password"),void o(!1);try{const e=await t(s.currentPassword,s.newPassword);e.success?(a({currentPassword:"",newPassword:"",confirmPassword:""}),d({isOpen:!0,type:"success",title:"Password Changed Successfully",message:"Your password has been updated successfully."})):l(e.error)}catch(n){l("An error occurred. Please try again.")}finally{o(!1)}},className:"space-y-4",children:[(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"currentPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Current Password"}),(0,ze.jsxs)("div",{className:"relative",children:[(0,ze.jsx)("input",{type:"password",id:"currentPassword",name:"currentPassword",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your current password",value:s.currentPassword,onChange:u}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,ze.jsx)("i",{className:"fas fa-lock text-gray-400"})})]})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"newPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"New Password"}),(0,ze.jsxs)("div",{className:"relative",children:[(0,ze.jsx)("input",{type:"password",id:"newPassword",name:"newPassword",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Enter your new password",value:s.newPassword,onChange:u}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,ze.jsx)("i",{className:"fas fa-key text-gray-400"})})]}),(0,ze.jsx)("p",{className:"mt-1 text-xs text-gray-500",children:"Must be at least 6 characters long"})]}),(0,ze.jsxs)("div",{children:[(0,ze.jsx)("label",{htmlFor:"confirmPassword",className:"block text-sm font-medium text-gray-700 mb-1",children:"Confirm New Password"}),(0,ze.jsxs)("div",{className:"relative",children:[(0,ze.jsx)("input",{type:"password",id:"confirmPassword",name:"confirmPassword",required:!0,className:"w-full px-3 py-2 border border-gray-300 rounded-lg focus:ring-blue-500 focus:border-blue-500",placeholder:"Confirm your new password",value:s.confirmPassword,onChange:u}),(0,ze.jsx)("div",{className:"absolute inset-y-0 right-0 pr-3 flex items-center",children:(0,ze.jsx)("i",{className:"fas fa-check text-gray-400"})})]})]}),n&&(0,ze.jsx)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-3",children:(0,ze.jsxs)("div",{className:"flex",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-circle text-red-400 mr-2 mt-0.5"}),(0,ze.jsx)("p",{className:"text-sm text-red-600",children:n})]})}),(0,ze.jsxs)("div",{className:"flex items-center justify-between pt-4",children:[(0,ze.jsxs)("div",{className:"text-sm text-gray-600",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle text-blue-500 mr-1"}),"Password will be changed immediately"]}),(0,ze.jsx)("button",{type:"submit",disabled:i,className:"px-4 py-2 bg-blue-600 text-white rounded-lg hover:bg-blue-700 disabled:opacity-50 disabled:cursor-not-allowed transition-colors",children:i?(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-spinner fa-spin mr-2"}),"Updating..."]}):(0,ze.jsxs)(ze.Fragment,{children:[(0,ze.jsx)("i",{className:"fas fa-save mr-2"}),"Change Password"]})})]})]}),(0,ze.jsx)(Pa,{isOpen:c.isOpen,onClose:()=>{d({isOpen:!1,type:"info",title:"",message:""})},type:c.type,title:c.title,message:c.message})]})},sn=()=>{const{token:e}=function(){let{matches:e}=r.useContext(X),t=e[e.length-1];return t?t.params:{}}(),t=ae(),[s,a]=(0,r.useState)("verifying"),[n,l]=(0,r.useState)(""),[i,o]=(0,r.useState)(!0);(0,r.useEffect)(()=>{c()},[e]);const c=async()=>{if(!e)return a("error"),l("Invalid verification link - no token provided."),void o(!1);window.location.href="".concat(Ue,"/api/auth/magic-link/").concat(e,"/")};return(0,ze.jsx)("div",{className:"min-h-screen bg-gradient-to-br from-purple-600 via-purple-700 to-blue-700 flex items-center justify-center p-4",children:(0,ze.jsxs)("div",{className:"max-w-md w-full",children:[(0,ze.jsxs)("div",{className:"bg-white rounded-xl shadow-2xl p-8",children:[(0,ze.jsxs)("div",{className:"text-center mb-6",children:[(0,ze.jsx)("div",{className:"w-16 h-16 mx-auto mb-4",children:i?(0,ze.jsx)("div",{className:"w-16 h-16 border-4 border-purple-200 border-t-purple-600 rounded-full animate-spin"}):"success"===s?(0,ze.jsx)("div",{className:"w-16 h-16 bg-green-100 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-check-circle text-green-600 text-2xl"})}):(0,ze.jsx)("div",{className:"w-16 h-16 bg-red-100 rounded-full flex items-center justify-center",children:(0,ze.jsx)("i",{className:"fas fa-times-circle text-red-600 text-2xl"})})}),(0,ze.jsx)("h1",{className:"text-2xl font-bold text-gray-900 mb-2",children:i?"Verifying Email...":"success"===s?"Email Verified!":"Verification Failed"}),(0,ze.jsx)("p",{className:"text-sm ".concat("success"===s?"text-green-600":"error"===s?"text-red-600":"text-gray-600"),children:i?"Please wait while we verify your email address...":n})]}),(0,ze.jsxs)("div",{className:"space-y-4",children:["success"===s&&!i&&(0,ze.jsx)("div",{className:"bg-green-50 border border-green-200 rounded-lg p-4",children:(0,ze.jsxs)("div",{className:"flex items-center",children:[(0,ze.jsx)("i",{className:"fas fa-info-circle text-green-600 mr-2"}),(0,ze.jsx)("p",{className:"text-sm text-green-800",children:"Redirecting to login page in 3 seconds..."})]})}),"error"===s&&!i&&(0,ze.jsxs)("div",{className:"bg-red-50 border border-red-200 rounded-lg p-4",children:[(0,ze.jsxs)("div",{className:"flex items-center mb-2",children:[(0,ze.jsx)("i",{className:"fas fa-exclamation-triangle text-red-600 mr-2"}),(0,ze.jsx)("p",{className:"text-sm font-medium text-red-800",children:"What to do next:"})]}),(0,ze.jsxs)("ul",{className:"text-sm text-red-700 space-y-1 ml-6",children:[(0,ze.jsx)("li",{children:"\u2022 Check if the link has expired (valid for 24 hours)"}),(0,ze.jsx)("li",{children:"\u2022 Make sure you clicked the correct link from your email"}),(0,ze.jsx)("li",{children:"\u2022 Contact support if the problem persists"})]})]}),(0,ze.jsxs)("div",{className:"flex space-x-4",children:[(0,ze.jsxs)("button",{onClick:()=>t("/login"),className:"flex-1 px-4 py-2 bg-gray-100 text-gray-700 rounded-lg hover:bg-gray-200 transition-colors font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-sign-in-alt mr-2"}),"Go to Login"]}),"error"===s&&(0,ze.jsxs)("button",{onClick:()=>t("/signup"),className:"flex-1 px-4 py-2 bg-purple-600 text-white rounded-lg hover:bg-purple-700 transition-colors font-medium",children:[(0,ze.jsx)("i",{className:"fas fa-user-plus mr-2"}),"Sign Up Again"]})]})]})]}),(0,ze.jsx)("div",{className:"text-center mt-6 text-white text-sm",children:(0,ze.jsx)("p",{children:"\xa9 2024 ESG Portal - Sustainable Business Management"})})]})})};console.log("App.js loaded");const an=function(){return console.log("App component rendering"),(0,ze.jsx)(_e,{children:(0,ze.jsx)(We,{children:(0,ze.jsx)(ga,{children:(0,ze.jsx)("div",{className:"App min-h-screen bg-gray-50",children:(0,ze.jsxs)(je,{children:[(0,ze.jsx)(be,{path:"/login",element:(0,ze.jsx)(va,{})}),(0,ze.jsx)(be,{path:"/signup",element:(0,ze.jsx)(wa,{})}),(0,ze.jsx)(be,{path:"/verify-email/:token",element:(0,ze.jsx)(sn,{})}),(0,ze.jsx)(be,{path:"/reset-password",element:(0,ze.jsx)(ba,{children:(0,ze.jsx)(Za,{})})}),(0,ze.jsx)(be,{path:"/setup-account",element:(0,ze.jsx)(ba,{children:(0,ze.jsx)(en,{})})}),(0,ze.jsx)(be,{path:"/",element:(0,ze.jsx)(ka,{})}),(0,ze.jsx)(be,{path:"/home",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Sa,{})})]})}),(0,ze.jsx)(be,{path:"/onboard",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Ca,{})})]})}),(0,ze.jsx)(be,{path:"/rame",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(_a,{})})]})}),(0,ze.jsx)(be,{path:"/framework",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(_a,{})})]})}),(0,ze.jsx)(be,{path:"/location",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Ea,{})})]})}),(0,ze.jsx)(be,{path:"/list",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Oa,{})})]})}),(0,ze.jsx)(be,{path:"/meter",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Ma,{})})]})}),(0,ze.jsx)(be,{path:"/data",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Ga,{})})]})}),(0,ze.jsx)(be,{path:"/element-assignments",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Ba,{})})]})}),(0,ze.jsx)(be,{path:"/dashboard",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)(Qa,{})]})}),(0,ze.jsx)(be,{path:"/dashboard-test",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)($a,{})})]})}),(0,ze.jsx)(be,{path:"/dashboard-old",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Qa,{})})]})}),(0,ze.jsx)(be,{path:"/unified-dashboard",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)(Ja,{})]})}),(0,ze.jsx)(be,{path:"/team",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Ya,{})})]})}),(0,ze.jsx)(be,{path:"/sites",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Ka,{})})]})}),(0,ze.jsx)(be,{path:"/tasks",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(Xa,{})})]})}),(0,ze.jsx)(be,{path:"/change-password",element:(0,ze.jsxs)(ba,{children:[(0,ze.jsx)(Na,{}),(0,ze.jsx)("div",{className:"w-full px-4 py-8",children:(0,ze.jsx)(tn,{})})]})})]})})})})})};console.log("index.js loaded");const nn=document.getElementById("root");if(console.log("Root element:",nn),nn){const e=i.createRoot(nn);console.log("Rendering App..."),e.render((0,ze.jsx)(an,{})),console.log("App render called")}else console.error("Root element not found!")})();
//# sourceMappingURL=main.bde407fe.js.map